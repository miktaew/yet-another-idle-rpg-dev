"use strict";(()=>{var Qc=Object.defineProperty;var Uc=(e,t,i)=>t in e?Qc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var Va=(e,t,i)=>Uc(e,typeof t!="symbol"?t+"":t,i);function Tn(e){this.year=e.year,this.month=e.month,this.day=e.day,this.hour=e.hour,this.minute=e.minute,this.day_count=e.day_count??1,this.goUp=function(t){if(this.minute+=t??1,this.minute>=60){let i=this.minute%60,a=Math.floor(this.minute/60);this.minute=i,this.hour+=a}if(this.hour>=24){let i=this.hour%24,a=Math.floor(this.hour/24);this.hour=i,this.day+=a,this.day_count+=a}if(this.day>30){let i=this.day%30,a=Math.floor(this.day/30);this.day=i,this.month+=a}if(this.month>12){let i=this.month%12,a=Math.floor(this.month/12);this.month=i,this.year+=a}},this.goUp(0),this.loadTime=function(t){this.year=t.year,this.month=t.month,this.day=t.day,this.hour=t.hour,this.minute=t.minute,this.day_count=t.day_count},this.getSeason=function(t){let i;return t?i=this.month+Math.floor((this.day+t)/30):i=this.month,i>9?xi[3]:i>6?xi[2]:i>3?xi[1]:xi[0]},this.getTimeOfDay=function(){return this.hour>=21||this.hour<4?"Night":this.hour>=4&&this.hour<8?"Dawn":this.hour>=8&&this.hour<18?"Day":"Dusk"},this.getTimeOfDaySimple=function(){return this.hour>=21||this.hour<4?"Night":"Day"},this.getDayOfTheWeek=function(){switch(this.day_count%7){case 0:return"Sun";case 1:return"Mon";case 2:return"Tue";case 3:return"Wed";case 4:return"Thu";case 5:return"Fri";case 6:return"Sat"}},this.getMoonPhase=function(){return this.day_count%29.5/29.5},this.getMoonPhaseName=function(t){let i=["Full","Waning","New","Waxing"];return i[Math.floor(t*i.length)]}}Tn.prototype.toString=function(){let e=(this.day>9?this.day:`0${this.day}`)+"/";return e+=(this.month>9?this.month:`0${this.month}`)+"/",e+=this.year+" ",e+=(this.hour>9?this.hour:`0${this.hour}`)+":",e+=(this.minute>9?this.minute:`0${this.minute}`)+", ",e+=this.getSeason()+", "+this.getDayOfTheWeek(),e};function qi({time:e,long_names:t,round:i=!0}){if(!e)throw"No time passed in arguments!";e.minutes=Math.ceil(e.minutes),i&&(e.minutes>=60&&(e.hours=e.hours+Math.floor(e.minutes/60)||Math.floor(e.minutes/60),e.minutes=e.minutes%60),e.hours>=24&&(e.days=e.days+Math.floor(e.hours/24)||Math.floor(e.hours/24),e.hours=e.hours%24),e.days>30&&(e.months=e.months+Math.floor(e.days/30)||Math.floor(e.days/30),e.days=e.days%30),e.months>12&&(e.years=e.years+Math.floor(e.months/12)||Math.floor(e.months/12),e.months=e.months%12));let a="";if(e.years>0){let s=e.years==1?"year":"years";a+=t?`${e.year} ${s} `:`${e.year}Y`}if(e.months>0){let s=e.months==1?"month":"months";a+=t?`${e.months} ${s} `:`${e.months}M`}if(e.days>0){let s=e.days==1?"day":"days";a+=t?`${e.days} ${s} `:`${e.days}D`}if(e.hours>0){let s=e.hours==1?"hour":"hours";a+=t?`${e.hours} ${s} `:`${e.hours}h`}if(e.minutes>0){let s=e.minutes==1?"minute":"minutes";a+=t?`${e.minutes} ${s} `:`${e.minutes}m`}return a}function Si(e){return e=e||E,e.hour>=20||e.hour<4}var xi=["Spring","Summer","Autumn","Winter"],E=new Tn({year:999,month:4,day:1,hour:8,minute:0,day_count:1});var Je={strength:"str",health:"hp",max_health:"hp",health_regeneration_flat:"hp regen",health_regeneration_percent:"hp % regen",health_loss_flat:"hp loss",health_loss_percent:"hp % loss",stamina_regeneration_flat:"stam regen",stamina_regeneration_percent:"stam % regen",max_stamina:"stamina",agility:"agl",dexterity:"dex",magic:"magic",attack_speed:"attack speed",attack_power:"attack power",crit_rate:"crit rate",crit_multiplier:"crit dmg",stamina_efficiency:"stamina efficiency",intuition:"int",block_strength:"shield strength",hit_chance:"hit chance",evasion:"EP",evasion_points:"EP",attack_points:"AP",heat_tolerance:"heat resistance",cold_tolerance:"cold resistance",unarmed_power:"unarmed base dmg",armor_penetration:"armor pen",defense:"defense"},_l={kill:"kill",kill_any:"kill",clear:"clear"},Di={Medicine:"medicine",Gluttony:"food"},pl={medicine:"Medicine"};function Qa(e,t){return e[0]*(e[1]/e[0])**t}function Vi(e,t=3){return e=Number.parseFloat(e),e==0?0:e>=10**M.expo_threshold||e<.01?e.toExponential(t).replace(/[+-]/g,""):e>10?Math.round(e).toLocaleString():e>1?(Math.round(e*10)/10).toLocaleString():(Math.round(e*100)/100).toLocaleString()}function We(e){return e>19999?Math.ceil(e/1e3)*1e3:e>1999?Math.ceil(e/100)*100:e>199?Math.ceil(e/10)*10:Math.ceil(e)}function Mn(e){return e>=120?`${Math.floor(e/60)} hours`:e>=60?"1 hour":`${Math.round(e)} minutes`}function Ua(e){let t="",i=Math.floor(e/60),a=e%60;return i>0&&(i>1?t+=i+" hours":t+=i+" hour"),a>0&&(i>0&&(t+=" "),a>1?t+=a+" minutes":t+=a+" minute"),t}function ga(e,t){let i=e/(e+t);return i>=.8?i=.971+(i-.8)**1.4:i>=.7?i=.846+(i-.7)**.9:i>=.6?i=.688+(i-.6)**.8:i>=.5?i=.53+(i-.5)**.8:i>=.4?i=.331+(i-.4)**.7:i>=.3?i=.173+(i-.3)**.8:i>=.2?i=.073+(i-.2):i>=.1?i=.01+(i-.1)**1.2:i=0,i}function Ka(e,t){let i=e.replace("v","").split("."),a=t.replace("v","").split(".");i.length>a.length?a.push(...Array(i.length-a.length).fill("0")):a.length>i.length&&i.push(...Array(a.length-i.length).fill("0"));for(let s=0;s<i.length;s++){let n;if(Number.parseInt(i[s])&&Number.parseInt(a[s])?n=[Number.parseInt(i[s]),Number.parseInt(a[s])]:n=[i[s]||0,a[s]||0],n[0]!==n[1])return n[0]>n[1]?1:-1}return 0}function Qe(e,t){return Ka(e,t)<0}function Ja(e){return 32+Math.round(10*e*9/5)/10}function dl(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{}}function ml({r:e,g:t,b:i}){let l=[e,t,i].map(d=>(d/=255,d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4)));return l[0]*.2126+l[1]*.7152+l[2]*.0722}function hl(e,t){let i=ml(dl(e)),a=ml(dl(t)),s=Math.max(i,a),n=Math.min(i,a);return(s+.05)/(n+.05)}function fl(e){let t="outline_black",i="outline_white",a=hl(e,"#000000"),s=hl(e,"#ffffff");return a>s?t:i}var Q={},Oe="type_",Ls={},ze={Village:["Slums","Swamp"]},Rt=500,Kc=Rt-1,Jc=Math.round(Rt/9),wa=200,Xc=wa-1,Zc=Math.round(wa/9);Object.keys(ze).forEach(e=>{Q[e]={};for(let t=0;t<ze[e].length;t++)ze[ze[e][t]]?ze[ze[e][t]].includes(e)||ze[ze[e][t]].push(e):ze[ze[e][t]]=[e]});function gl(){Object.keys(Ls).forEach(e=>{Q[e]={}})}function Xa(e){Object.keys(e).forEach(t=>{Q[t]={},Object.keys(e[t]).forEach(i=>{Q[t][i]=[];for(let a=0;a<e[t][i].length;a++)if(e[t][i][a].sold<1e13)e[t][i][a].recovered==null&&(e[t][i][a].recovered=0),Q[t][i].push({...e[t][i][a]});else{let n=Math.min(1e3,Math.round(1e3*(e[t][i][a].recovered/e[t][i][a].sold)))??0;Q[t][i].push({sold:1e3,recovered:n}),console.warn(`Encountered a suspiciously large sold count of a trade group "${i}" at tier ${a} (${e[t][i][a].sold}). It has been reduced to a 1000, and it's recovered_count was lowered in proportion to it.`)}})})}function wl(e=1,t=0){Object.keys(Q).forEach(i=>{Object.keys(Q[i]).forEach(a=>{for(let s=0;s<Q[i][a].length;s++)Q[i][a][s].recovered+=Math.max(t*(Q[i][a][s].sold-Q[i][a][s].recovered),e),Q[i][a][s].recovered>Q[i][a][s].sold&&(Q[i][a][s].recovered=Q[i][a][s].sold)})})}function yl(e){let t={};Object.keys(ze).forEach(i=>{let a=ze[i].length;for(let s=0;s<a;s++){let n=ze[i][s];t[n]=t[n]||{},t[i]=t[i]||{},Object.keys(Q[i]||{}).forEach(o=>{t[n][o]=t[n][o]||[],t[i][o]=t[i][o]||[];for(let l=0;l<Q[i][o].length;l++){let d=Q[i][o][l].sold-Q[i][o][l].recovered,u=Math.floor(d*e);Q[i][o][l].sold-=u;let h=Math.floor(u/a);t[i][o][l]?t[i][o][l].sold-=u:t[i][o][l]={...Q[i][o][l]},t[n][o][l]||(Q[n]?.[o]?.[l]?t[n][o][l]={...Q[n][o][l]}:t[n][o][l]={sold:0,recovered:0}),t[n][o][l].sold+=h}})}}),Xa(t)}function Cs({is_group:e,value:t,how_many_sold:i}){let a=1,s,n;return e?(s=Xc,n=Zc):(s=Kc,n=Jc),i>=s?a=.1:i>0&&(a=a*n/(n+i)),Math.round(t*a)/t}function Bs({region:e,group_key:t,group_tier:i}){if(!Q[e][t])return 0;let a=[];for(let n=0;n<Q[e][t]?.length;n++)a[n]=Math.max(0,Q[e][t][n].sold-Q[e][t][n].recovered);let s=t.startsWith(Oe)?wa:Rt;return ya({sold_by_tier:a,target_tier:i,cap:s})}function ya({sold_by_tier:e,target_tier:t,cap:i}){if(!e)return 0;let a=0;for(let s=t-1;s>=0;s--)a+=Math.max(e[s]??0)*.1**(t-s);a=Math.min(i/8,a),a+=e[t]??0;for(let s=t+1;s<e.length;s++)a+=Math.max(e[s]??0);return a}function kl({value:e,start_count:t,how_many_to_trade:i,is_group:a,is_selling:s=!0,stop_multiplier_at:n}){let o=0;if(s)for(let l=0;l<i;l++)o+=We(e*Cs({value:e,how_many_sold:Math.min(t+n,l+t),is_group:a}));else for(let l=0;l>-i;l--)o+=We(e*Cs({value:e,how_many_sold:Math.min(t+n,Math.max(l+t,0)),is_group:a}));return o}function bl({value:e,group_key:t,group_tier:i,region:a}){let s=Bs({region:a,group_key:t,group_tier:i});return Math.max(1,We(e*Cs({value:e,how_many_sold:s,is_group:t.startsWith(Oe)})))}function vl({group_key:e,group_tier:t,count:i,region:a}){Q[a][e]||(Q[a][e]=new Array(t+1).fill().map(()=>({sold:0,recovered:0}))),Q[a][e][t]||Q[a][e].push(...new Array(t+1-Q[a][e].length).fill().map(()=>({sold:0,recovered:0}))),Q[a][e][t].sold+=i||1}function xl({group_key:e,group_tier:t,count:i,region:a}){!Q[a][e]||!Q[a][e][t]||(Q[a][e][t].sold=Math.max(Q[a][e][t].sold-(i||1),0),Q[a][e][t].recovered=Math.min(Q[a][e][t].recovered,Q[a][e][t].sold))}var Ii=class{constructor(){this.inventory={}}add_to_inventory(t){let i=!1;for(let a=0;a<t.length;a++){let s;if(t[a].item_key)s=t[a].item_key;else{let n;t[a].quality?n=be({...c[t[a].item_id],quality:t[a].quality}):n=be({...c[t[a].item_id]}),s=n.getInventoryKey()}if(s in this.inventory)if(t[a].count===void 0)this.inventory[s].count+=1;else if(typeof t[a].count=="number"&&!isNaN(t[a].count))this.inventory[s].count+=t[a].count;else throw new TypeError(`Tried to add "${t[a].count}" items, which is not a valid number!`);else{t[a].count||(t[a].count=1);let n=xe(s);this.inventory[s]={item:n,count:t[a].count},i=!0}}return i}remove_from_inventory(t){for(let i=0;i<t.length;i++)if(t[i].item_key in this.inventory){if(typeof t[i].item_count=="number"&&Number.isInteger(t[i].item_count)&&t[i].item_count>=1?this.inventory[t[i].item_key].count-=t[i].item_count:this.inventory[t[i].item_key].count-=1,this.inventory[t[i].item_key].count==0)delete this.inventory[t[i].item_key];else if(this.inventory[t[i].item_key].count<0||isNaN(this.inventory[t[i].item_key].count))throw new Error(`Item count for key "${t[i].item_key}" reached an illegal value of "${this.inventory[t[i].item_key].count}"`)}else throw new Error("Tried to remove item that was not present in inventory")}};var Z={items:{},components:{},equipment:{}},Te={items:{}},Qi={items:{}},Xe={items:{},components:{}},$i={items:{}},qe={items:{}},ct={items:{},components:{}};function Ei(e){return{components:Math.min(Math.round(100+2*K(e)),200),equipment:Math.min(Math.round(100+2.8*K(e)),250)}}var An=class{constructor({name:t,id:i,is_unlocked:a=!0,recipe_type:s,result:n,getResult:o,recipe_level:l=[1,1],recipe_skill:d}){this.name=t,this.id=i,this.is_unlocked=a,this.recipe_type=s,this.result=n,this.getResult=o||function(){return this.result},this.recipe_level=l,this.recipe_skill=d}},T=class extends An{constructor({name:t,id:i,materials:a=[],is_unlocked:s=!0,recipe_type:n,result:o,getResult:l,recipe_level:d,recipe_skill:u,success_chance:h=[1,1]}){super({name:t,id:i,is_unlocked:s,recipe_type:n,result:o,getResult:l,recipe_level:d,recipe_skill:u}),this.materials=a,this.success_chance=h,this.success_chance[0]==0&&(this.success_chance[0]=.1)}get_success_chance(t=1){let i=Math.min(this.recipe_level[1]-this.recipe_level[0]+1,Math.max(0,K(this.recipe_skill)-this.recipe_level[0]+1)),a=Math.min(1,(i+(t-1))/(this.recipe_level[1]-this.recipe_level[0]+1));return this.success_chance[0]*(this.success_chance[1]/this.success_chance[0])**a}get_availability(){let t=1/0,i=[];for(let a=0;a<this.materials.length;a++)if(this.materials[a].material_id){let s=c[this.materials[a].material_id].getInventoryKey();if(!r.inventory[s])return 0;t=Math.floor(Math.min(r.inventory[s].count/this.materials[a].count,t))}else if(this.materials[a].material_type){let s=[];if(Object.keys(r.inventory).forEach(n=>{r.inventory[n].item.material_type===this.materials[a].material_type&&r.inventory[n].count>=this.materials[a].count&&s.push(r.inventory[n])}),s.length==0)return 0;s=s.sort((n,o)=>n.item.getBaseValue()-o.item.getBaseValue()),t=Math.floor(Math.min(s[0].count/this.materials[a].count,t)),i.push(s[0].item.id)}return{available_ammount:t,materials:i}}},re=class extends T{constructor({name:t,id:i,materials:a=[],is_unlocked:s=!0,result:n,component_type:o,recipe_skill:l,item_type:d}){super({name:t,id:i,materials:a,is_unlocked:s,recipe_type:"component",result:n,recipe_level:[1,1],recipe_skill:l,getResult:null,success_rate:[1,1]}),this.component_type=o,this.item_type=d,this.getResult=function(u,h=1){let _=c[this.materials.filter(b=>b.material_id===u.id)[0].result_id],w=this.get_quality(h-_.component_tier||0);if(_.tags.clothing)return new N({...c[_.id],quality:w});if(_.tags["armor component"])return new X({...c[_.id],quality:w});if(_.tags["weapon component"])return new Y({...c[_.id],quality:w});if(_.tags["shield component"])return new Ce({...c[_.id],quality:w});throw new Error(`Component recipe ${this.name} does not produce a valid result!`)}}get_quality_range(t=0){let i=f[this.recipe_skill],a=(130+(3*K(this.recipe_skill)-i.max_level)+15*t)/100;return[Math.max(10,Math.min(this.get_quality_cap(),Math.round(25*(a-.15))*4)),Math.max(10,Math.min(this.get_quality_cap(),Math.round(25*(a+.1))*4))]}get_quality_cap(){return this.item_type==="Armor"?Ei(this.recipe_skill).equipment:Ei(this.recipe_skill).components}get_is_quality_capped(){return this.get_quality_range()[0]>=this.get_quality_cap()}get_quality(t=0){let i=this.get_quality_range(t);return Math.round(((i[1]-i[0])*Math.random()+i[0])/4)*4}},Ws=class extends T{constructor({name:t,id:i,materials:a=[],is_unlocked:s=!0,result:n,recipe_skill:o,item_type:l}){super({name:t,id:i,materials:a,is_unlocked:s,recipe_type:"componentless",result:n,recipe_level:[1,1],recipe_skill:o,getResult:null,success_rate:[1,1]}),this.item_type=l,this.getResult=function(d,u=1){let h=c[this.materials.filter(w=>w.material_id===d.id)[0].result_id],_=this.get_quality(u-h.item_tier||0);return new Ft({...c[h.id],quality:_})}}get_quality_range(t=0){let i=f[this.recipe_skill],a=(130+(3*K(this.recipe_skill)-i.max_level)+15*t)/100;return[Math.max(10,Math.min(this.get_quality_cap(),Math.round(25*(a-.15))*4)),Math.max(10,Math.min(this.get_quality_cap(),Math.round(25*(a+.1))*4))]}get_quality_cap(){return Ei(this.recipe_skill).equipment}get_is_quality_capped(){return this.get_quality_range()[0]>=this.get_quality_cap()}get_quality(t=0){let i=this.get_quality_range(t);return Math.round(((i[1]-i[0])*Math.random()+i[0])/4)*4}},ft=class extends An{constructor({name:t,id:i,components:a=[],is_unlocked:s=!0,result:n=null,recipe_skill:o="Crafting",item_type:l}){super({name:t,id:i,is_unlocked:s,recipe_type:"equipment",result:n,getResult:null,recipe_level:[1,1],recipe_skill:o,success_rate:[1,1]}),this.components=a,this.item_type=l,this.getResult=function(d,u,h=1){let _=this.get_component_quality_weighted(d,u),w=this.get_quality(_,h-Math.max(d.component_tier,u.component_tier)||0);if(this.item_type==="Weapon")return new Me({components:{head:d.id,handle:u.id},quality:w});if(this.item_type==="Armor")return new N({components:{internal:d.id,external:u.id},quality:w});if(this.item_type==="Shield")return new Ue({components:{shield_base:d.id,handle:u.id},quality:w});throw new Error(`Recipe "${this.name}" has an incorrect item_type provided ("${this.item_type}")`)}}get_quality_range(t,i=0){let a=f[this.recipe_skill],s=50+t+(3*K(this.recipe_skill)-a.max_level)+10*i;return[Math.max(10,Math.min(this.get_quality_cap(),Math.round(s-15))),Math.max(10,Math.min(this.get_quality_cap(),Math.round(s+15)))]}get_quality_cap(){return Ei(this.recipe_skill).equipment}get_quality(t,i=0){let a=this.get_quality_range(t,i);return Math.round(((a[1]-a[0])*Math.random()+a[0])/2)*2}get_component_quality_weighted(t,i){return(t.quality*t.component_tier+i.quality*i.component_tier)/(t.component_tier+i.component_tier)}};function It({category:e,subcategory:t,recipe_id:i,material_count:a,result_tier:s,selected_components:n,rarity_multiplier:o}){if(!e||!t||!i)throw new Error(`Tried to use a recipe but either category, subcategory, or recipe id was not passed: ${e} - ${t} - ${i}`);let l=4,d=G[e][t][i],u=f[d.recipe_skill].current_level;if(!d)throw new Error(`Tried to use a recipe that doesn't exist: ${e} -> ${t} -> ${i}`);if(t==="items")l=Math.max(l,1.5*d.recipe_level[1])**1.1,d.recipe_level[1]<u&&(l=Math.max(1,l*Math.max(0,Math.min(5,d.recipe_level[1]+6-u)/5)));else if(t==="components"||d.recipe_type==="component"||d.recipe_type==="componentless"){let h=8*s;l=Math.max(l**1.2,(s*4)**1.1*a),h>u*o**.5?l=Math.max(.5*a,l*o):l=Math.max(.5*a,l*o*Math.max(0,Math.min(5,h*o**.5+5-u))/5)}else{let h=8*Math.max(n[0].component_tier,n[1].component_tier);l=Math.max(l,(n[0].component_tier+n[1].component_tier)*4)**1.1,h>u*o**.5?l=Math.max(1,l*o):l=Math.max(1,l*o*Math.max(0,Math.min(5,h*o**.5+5-u))/5)}return Math.round(10*l)/10}Xe.components["Short blade"]=new re({name:"Short blade",materials:[{material_id:"Low quality iron ingot",count:2,result_id:"Cheap short iron blade"},{material_id:"Iron ingot",count:2,result_id:"Short iron blade"},{material_id:"Steel ingot",count:2,result_id:"Short steel blade"}],item_type:"Component",recipe_skill:"Forging"}),Xe.components["Long blade"]=new re({name:"Long blade",materials:[{material_id:"Low quality iron ingot",count:3,result_id:"Cheap long iron blade"},{material_id:"Iron ingot",count:3,result_id:"Long iron blade"},{material_id:"Steel ingot",count:3,result_id:"Long steel blade"}],item_type:"Component",recipe_skill:"Forging"}),Xe.components["Axe head"]=new re({name:"Axe head",materials:[{material_id:"Low quality iron ingot",count:4,result_id:"Cheap iron axe head"},{material_id:"Iron ingot",count:4,result_id:"Iron axe head"},{material_id:"Steel ingot",count:4,result_id:"Steel axe head"}],item_type:"Component",recipe_skill:"Forging"}),Xe.components["Hammer head"]=new re({name:"Hammer head",materials:[{material_id:"Low quality iron ingot",count:4,result_id:"Cheap iron hammer head"},{material_id:"Iron ingot",count:4,result_id:"Iron hammer head"},{material_id:"Steel ingot",count:4,result_id:"Steel hammer head"}],item_type:"Component",recipe_skill:"Forging"}),Xe.components["Short hilt"]=new re({name:"Short hilt",materials:[{material_id:"Low quality iron ingot",count:1,result_id:"Cheap short iron hilt"},{material_id:"Iron ingot",count:1,result_id:"Short iron hilt"},{material_id:"Steel ingot",count:1,result_id:"Short steel hilt"},{material_id:"Turtle shellplate",count:2,result_id:"Turtleshell hilt"}],item_type:"Component",recipe_skill:"Forging"}),Xe.components["Medium handle"]=new re({name:"Medium handle",materials:[{material_id:"Low quality iron ingot",count:2,result_id:"Cheap medium iron handle"},{material_id:"Iron ingot",count:2,result_id:"Medium iron handle"},{material_id:"Steel ingot",count:2,result_id:"Medium steel handle"},{material_id:"Turtle shellplate",count:4,result_id:"Turtleshell handle"}],item_type:"Component",recipe_skill:"Forging"}),Xe.components["Long shaft"]=new re({name:"Long shaft",materials:[{material_id:"Low quality iron ingot",count:4,result_id:"Cheap long iron shaft"},{material_id:"Iron ingot",count:4,result_id:"Long iron shaft"},{material_id:"Steel ingot",count:4,result_id:"Long steel shaft"},{material_id:"Turtle shellplate",count:8,result_id:"Turtleshell shaft"}],item_type:"Component",recipe_skill:"Forging"}),Z.components["Short hilt"]=new re({name:"Short hilt",materials:[{material_id:"Processed weak monster bone",count:1,result_id:"Short weak bone hilt"}],item_type:"Component",recipe_skill:"Crafting"}),Z.components["Medium handle"]=new re({name:"Medium handle",materials:[{material_id:"Processed weak monster bone",count:2,result_id:"Medium weak bone handle"}],item_type:"Component",recipe_skill:"Crafting"}),Z.components["Long shaft"]=new re({name:"Long shaft",materials:[{material_id:"Processed weak monster bone",count:4,result_id:"Long weak bone shaft"}],item_type:"Component",recipe_skill:"Crafting"}),ct.components["Short hilt"]=new re({name:"Short hilt",materials:[{material_id:"Processed rough wood",count:1,result_id:"Simple short wooden hilt"},{material_id:"Processed wood",count:1,result_id:"Short wooden hilt"},{material_id:"Processed ash wood",count:1,result_id:"Short ash wood hilt"},{material_id:"Processed hickory wood",count:1,result_id:"Short hickory wood hilt"},{material_id:"Alchemical Wood",count:1,result_id:"Short alchemical wood hilt"}],item_type:"Component",recipe_skill:"Woodworking"}),ct.components["Medium handle"]=new re({name:"Medium handle",materials:[{material_id:"Processed rough wood",count:2,result_id:"Simple medium wooden handle"},{material_id:"Processed wood",count:2,result_id:"Medium wooden handle"},{material_id:"Processed ash wood",count:2,result_id:"Medium ash wood handle"},{material_id:"Processed hickory wood",count:2,result_id:"Medium hickory wood handle"},{material_id:"Alchemical Wood",count:2,result_id:"Medium alchemical wood handle"}],item_type:"Component",recipe_skill:"Woodworking"}),ct.components["Long shaft"]=new re({name:"Long shaft",materials:[{material_id:"Processed rough wood",count:4,result_id:"Simple long wooden shaft"},{material_id:"Processed wood",count:4,result_id:"Long wooden shaft"},{material_id:"Processed ash wood",count:4,result_id:"Long ash wood shaft"},{material_id:"Processed hickory wood",count:4,result_id:"Long hickory wood shaft"},{material_id:"Alchemical Wood",count:4,result_id:"Long alchemical wood shaft"}],item_type:"Component",recipe_skill:"Woodworking"});ct.components["Shield base"]=new re({name:"Shield base",materials:[{material_id:"Processed rough wood",count:6,result_id:"Crude wooden shield base"},{material_id:"Processed wood",count:6,result_id:"Wooden shield base"},{material_id:"Processed ash wood",count:6,result_id:"Ash wood shield base"},{material_id:"Processed hickory wood",count:6,result_id:"Hickory wood shield base"},{material_id:"Alchemical Wood",count:6,result_id:"Alchemical wood shield base"}],item_type:"Component",recipe_skill:"Woodworking",component_type:"shield base"}),ct.components["Shield handle"]=new re({name:"Shield handle",materials:[{material_id:"Processed rough wood",count:4,result_id:"Basic shield handle"},{material_id:"Processed wood",count:4,result_id:"Wooden shield handle"},{material_id:"Processed ash wood",count:4,result_id:"Ash wood shield handle"},{material_id:"Processed hickory wood",count:4,result_id:"Hickory wood shield handle"},{material_id:"Alchemical Wood",count:4,result_id:"Alchemical wood shield handle"}],item_type:"Component",recipe_skill:"Woodworking",component_type:"shield handle"}),Xe.components["Shield base"]=new re({name:"Shield base",materials:[{material_id:"Low quality iron ingot",count:5,result_id:"Crude iron shield base"},{material_id:"Iron ingot",count:5,result_id:"Iron shield base"},{material_id:"Steel ingot",count:5,result_id:"Steel shield base"},{material_id:"Turtle shellplate",count:10,result_id:"Turtleshell shield base"}],item_type:"Component",recipe_skill:"Forging",component_type:"shield base"});Z.components["Helmet exterior"]=new re({name:"Helmet exterior",materials:[{material_id:"Piece of wolf leather",count:3,result_id:"Wolf leather helmet armor"},{material_id:"Piece of boar leather",count:3,result_id:"Boar leather helmet armor"},{material_id:"Piece of bear leather",count:3,result_id:"Bear leather helmet armor"},{material_id:"Piece of alligator leather",count:3,result_id:"Alligator leather helmet armor"}],item_type:"Component",recipe_skill:"Crafting",component_type:"helmet exterior"}),Xe.components["Helmet exterior"]=new re({name:"Helmet exterior",materials:[{material_id:"Iron chainmail",count:3,result_id:"Iron chainmail helmet armor"},{material_id:"Steel chainmail",count:3,result_id:"Steel chainmail helmet armor"},{material_id:"Turtle shellplate",count:6,result_id:"Turtleshell helmet armor"}],item_type:"Component",recipe_skill:"Forging",component_type:"helmet exterior"}),Z.components["Chestplate exterior"]=new re({name:"Chestplate exterior",materials:[{material_id:"Piece of wolf leather",count:5,result_id:"Wolf leather chestplate armor"},{material_id:"Piece of boar leather",count:5,result_id:"Boar leather chestplate armor"},{material_id:"Piece of bear leather",count:5,result_id:"Bear leather chestplate armor"},{material_id:"Piece of alligator leather",count:5,result_id:"Alligator leather chestplate armor"}],item_type:"Component",recipe_skill:"Crafting",component_type:"chestplate exterior"}),Xe.components["Chestplate exterior"]=new re({name:"Chestplate exterior",materials:[{material_id:"Iron chainmail",count:5,result_id:"Iron chainmail vest"},{material_id:"Steel chainmail",count:5,result_id:"Steel chainmail vest"},{material_id:"Turtle shellplate",count:10,result_id:"Turtleshell chestplate"}],item_type:"Component",recipe_skill:"Forging",component_type:"chestplate exterior"}),Z.components["Leg armor exterior"]=new re({name:"Leg armor exterior",materials:[{material_id:"Piece of wolf leather",count:4,result_id:"Wolf leather greaves"},{material_id:"Piece of boar leather",count:4,result_id:"Boar leather greaves"},{material_id:"Piece of bear leather",count:4,result_id:"Bear leather greaves"},{material_id:"Piece of alligator leather",count:4,result_id:"Alligator leather greaves"}],item_type:"Component",recipe_skill:"Crafting",component_type:"leg armor exterior"}),Xe.components["Leg armor exterior"]=new re({name:"Leg armor exterior",materials:[{material_id:"Iron chainmail",count:4,result_id:"Iron chainmail greaves"},{material_id:"Steel chainmail",count:4,result_id:"Steel chainmail greaves"},{material_id:"Turtle shellplate",count:8,result_id:"Turtleshell greaves"}],item_type:"Component",recipe_skill:"Forging",component_type:"leg armor exterior"}),Z.components["Glove exterior"]=new re({name:"Glove exterior",materials:[{material_id:"Piece of wolf leather",count:3,result_id:"Wolf leather glove armor"},{material_id:"Piece of boar leather",count:3,result_id:"Boar leather glove armor"},{material_id:"Piece of bear leather",count:3,result_id:"Bear leather glove armor"},{material_id:"Piece of alligator leather",count:3,result_id:"Alligator leather glove armor"}],item_type:"Component",recipe_skill:"Crafting",component_type:"glove exterior"}),Xe.components["Glove exterior"]=new re({name:"Glove exterior",materials:[{material_id:"Iron chainmail",count:3,result_id:"Iron chainmail glove"},{material_id:"Steel chainmail",count:3,result_id:"Steel chainmail glove"},{material_id:"Turtle shellplate",count:6,result_id:"Turtleshell glove"}],item_type:"Component",recipe_skill:"Forging",component_type:"Glove exterior"}),Z.components["Shoes exterior"]=new re({name:"Shoes exterior",materials:[{material_id:"Piece of wolf leather",count:3,result_id:"Wolf leather shoe armor"},{material_id:"Piece of boar leather",count:3,result_id:"Boar leather shoe armor"},{material_id:"Piece of bear leather",count:3,result_id:"Bear leather shoe armor"},{material_id:"Piece of alligator leather",count:3,result_id:"Alligator leather shoe armor"}],item_type:"Component",recipe_skill:"Crafting",component_type:"shoes exterior"}),Xe.components["Shoes exterior"]=new re({name:"Shoes exterior",materials:[{material_id:"Iron chainmail",count:3,result_id:"Iron chainmail shoes"},{material_id:"Steel chainmail",count:3,result_id:"Steel chainmail shoes"},{material_id:"Turtle shellplate",count:6,result_id:"Turtleshell shoes"}],item_type:"Component",recipe_skill:"Forging",component_type:"shoes exterior"});Z.equipment.Axe=new ft({name:"Axe",components:["axe head","medium handle"],item_type:"Weapon"}),Z.equipment.Dagger=new ft({name:"Dagger",components:["short blade","short handle"],item_type:"Weapon"}),Z.equipment.Hammer=new ft({name:"Hammer",components:["hammer head","medium handle"],item_type:"Weapon"}),Z.equipment.Spear=new ft({name:"Spear",components:["short blade","long handle"],item_type:"Weapon"}),Z.equipment.Sword=new ft({name:"Sword",components:["long blade","short handle"],item_type:"Weapon"}),Z.equipment.Shield=new ft({name:"Shield",components:["shield base","shield handle"],item_type:"Shield"}),Z.equipment.Helmet=new ft({name:"Helmet",components:["helmet interior","helmet exterior"],item_type:"Armor"}),Z.equipment.Chestplate=new ft({name:"Chestplate",components:["chestplate interior","chestplate exterior"],item_type:"Armor"}),Z.equipment["Leg armor"]=new ft({name:"Leg armor",components:["leg armor interior","leg armor exterior"],item_type:"Armor"}),Z.equipment.Gauntlets=new ft({name:"Gauntlets",components:["glove interior","glove exterior"],item_type:"Armor"}),Z.equipment["Armored shoes"]=new ft({name:"Armored shoes",components:["shoes interior","shoes exterior"],item_type:"Armor"});Z.equipment.Hat=new re({name:"Hat",materials:[{material_id:"Piece of wolf leather",count:3,result_id:"Leather hat"},{material_id:"Wool cloth",count:3,result_id:"Wool hat"},{material_id:"Wicker",count:3,result_id:"Sun hat"},{material_id:"Piece of goat leather",count:3,result_id:"Goat leather hat"},{material_id:"Linen cloth",count:3,result_id:"Linen bandanna"},{material_id:"Piece of frog leather",count:3,result_id:"Batrachian hat"},{material_id:"Piece of snakeskin leather",count:3,result_id:"Snakeskin hat"}],item_type:"Armor",component_type:"helmet interior",recipe_skill:"Crafting"}),Z.equipment.Shirt=new re({name:"Shirt",materials:[{material_id:"Piece of wolf rat leather",count:5,result_id:"Cheap leather vest"},{material_id:"Piece of wolf leather",count:5,result_id:"Leather vest"},{material_id:"Wool cloth",count:5,result_id:"Wool shirt"},{material_id:"Piece of goat leather",count:5,result_id:"Goat leather vest"},{material_id:"Linen cloth",count:5,result_id:"Linen vest"},{material_id:"Piece of frog leather",count:5,result_id:"Batrachian vest"},{material_id:"Piece of snakeskin leather",count:5,result_id:"Snakeskin vest"}],item_type:"Armor",component_type:"chestplate interior",recipe_skill:"Crafting"}),Z.equipment.Pants=new re({name:"Pants",materials:[{material_id:"Piece of wolf rat leather",count:3,result_id:"Cheap leather pants"},{material_id:"Piece of wolf leather",count:3,result_id:"Leather pants"},{material_id:"Wool cloth",count:3,result_id:"Wool pants"},{material_id:"Piece of goat leather",count:3,result_id:"Goat leather pants"},{material_id:"Linen cloth",count:3,result_id:"Linen leggings"},{material_id:"Piece of frog leather",count:3,result_id:"Batrachian pants"},{material_id:"Piece of snakeskin leather",count:3,result_id:"Snakeskin leggings"}],item_type:"Armor",component_type:"leg armor interior",recipe_skill:"Crafting"}),Z.equipment.Gloves=new re({name:"Gloves",materials:[{material_id:"Piece of wolf leather",count:2,result_id:"Leather gloves"},{material_id:"Wool cloth",count:2,result_id:"Wool gloves"},{material_id:"Piece of goat leather",count:2,result_id:"Goat leather gloves"},{material_id:"Linen cloth",count:2,result_id:"Linen gloves"},{material_id:"Piece of frog leather",count:2,result_id:"Batrachian gloves"},{material_id:"Piece of snakeskin leather",count:2,result_id:"Snakeskin gloves"}],item_type:"Armor",component_type:"glove interior",recipe_skill:"Crafting"}),Z.equipment.Shoes=new re({name:"Shoes",materials:[{material_id:"Piece of wolf rat leather",count:2,result_id:"Cheap leather shoes"},{material_id:"Piece of wolf leather",count:2,result_id:"Leather shoes"},{material_id:"Piece of goat leather",count:2,result_id:"Goat leather shoes"},{material_id:"Piece of frog leather",count:2,result_id:"Batrachian shoes"},{material_id:"Piece of snakeskin leather",count:2,result_id:"Snakeskin boots"}],item_type:"Armor",component_type:"shoes interior",recipe_skill:"Crafting"});Z.equipment.Cape=new Ws({name:"Cape",materials:[{material_id:"Processed rat pelt",count:12,result_id:"Rat pelt cape"},{material_id:"Processed wolf pelt",count:8,result_id:"Wolf pelt cape"},{material_id:"Processed boar hide",count:8,result_id:"Boar hide cape"},{material_id:"Processed goat hide",count:8,result_id:"Goat hide cape"},{material_id:"Processed bear hide",count:8,result_id:"Bear hide cape"},{material_id:"Piece of frog leather",count:8,result_id:"Batrachian cape"}],item_type:"Cape",recipe_skill:"Crafting"});(function(){qe.items["Piece of wolf rat leather"]=new T({name:"Piece of wolf rat leather",recipe_type:"material",materials:[{material_id:"Rat pelt",count:6}],result:{result_id:"Piece of wolf rat leather",count:1},success_chance:[.4,1],recipe_level:[1,5],recipe_skill:"Butchering"}),qe.items["Piece of wolf leather"]=new T({name:"Piece of wolf leather",recipe_type:"material",materials:[{material_id:"Wolf pelt",count:6}],result:{result_id:"Piece of wolf leather",count:1},success_chance:[.2,1],recipe_skill:"Butchering",recipe_level:[1,10]}),qe.items["Piece of boar leather"]=new T({name:"Piece of boar leather",recipe_type:"material",materials:[{material_id:"Boar hide",count:6}],result:{result_id:"Piece of boar leather",count:1},success_chance:[.2,1],recipe_skill:"Butchering",recipe_level:[5,15]}),qe.items["Piece of goat leather"]=new T({name:"Piece of goat leather",recipe_type:"material",materials:[{material_id:"Mountain goat hide",count:6}],result:{result_id:"Piece of goat leather",count:1},success_chance:[.2,1],recipe_skill:"Butchering",recipe_level:[5,15]}),qe.items["Piece of bear leather"]=new T({name:"Piece of bear leather",recipe_type:"material",materials:[{material_id:"Bear hide",count:6}],result:{result_id:"Piece of bear leather",count:1},success_chance:[.2,1],recipe_skill:"Butchering",recipe_level:[12,25]}),qe.items["Piece of frog leather"]=new T({name:"Piece of frog leather",recipe_type:"material",materials:[{material_id:"Frog hide",count:4},{material_id:"Belmart leaf",count:2}],result:{result_id:"Piece of frog leather",count:1},success_chance:[.2,1],recipe_level:[12,25],recipe_skill:"Butchering"}),qe.items["Piece of alligator leather"]=new T({name:"Piece of alligator leather",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Alligator skin",count:6}],result:{result_id:"Piece of alligator leather",count:1},success_chance:[.1,1],recipe_skill:"Butchering",recipe_level:[22,30]}),qe.items["Piece of snakeskin leather"]=new T({name:"Piece of snakeskin leather",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Giant snake skin",count:6}],result:{result_id:"Piece of snakeskin leather",count:1},success_chance:[.1,1],recipe_skill:"Butchering",recipe_level:[22,30]}),qe.items["Turtle shellplate"]=new T({name:"Turtle shellplate",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Turtle shell",count:10}],result:{result_id:"Turtle shellplate",count:1},success_chance:[.1,1],recipe_skill:"Butchering",recipe_level:[27,37]}),qe.items["Processed rat pelt"]=new T({name:"Processed rat pelt",recipe_type:"material",materials:[{material_id:"Rat pelt",count:6}],result:{result_id:"Processed rat pelt",count:1},success_chance:[.4,1],recipe_level:[1,5],recipe_skill:"Butchering"}),qe.items["Processed wolf pelt"]=new T({name:"Processed wolf pelt",recipe_type:"material",materials:[{material_id:"Wolf pelt",count:6}],result:{result_id:"Processed wolf pelt",count:1},success_chance:[.2,1],recipe_level:[1,10],recipe_skill:"Butchering"}),qe.items["Processed boar hide"]=new T({name:"Processed boar hide",recipe_type:"material",materials:[{material_id:"Boar hide",count:6}],result:{result_id:"Processed boar hide",count:1},success_chance:[.2,1],recipe_level:[5,15],recipe_skill:"Butchering"}),qe.items["Processed goat hide"]=new T({name:"Processed goat hide",recipe_type:"material",materials:[{material_id:"Mountain goat hide",count:6}],result:{result_id:"Processed goat hide",count:1},success_chance:[.2,1],recipe_level:[5,15],recipe_skill:"Butchering"}),qe.items["Processed bear hide"]=new T({name:"Processed bear hide",recipe_type:"material",materials:[{material_id:"Bear hide",count:6}],result:{result_id:"Processed bear hide",count:1},success_chance:[.2,1],recipe_level:[12,25],recipe_skill:"Butchering"}),Z.items["Wool cloth"]=new T({name:"Wool cloth",recipe_type:"material",materials:[{material_id:"Wool",count:5}],result:{result_id:"Wool cloth",count:1},success_chance:[.1,1],recipe_skill:"Crafting",recipe_level:[5,15]}),Z.items["Linen cloth"]=new T({name:"Linen cloth",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Flax",count:10}],result:{result_id:"Linen cloth",count:1},success_chance:[.1,1],recipe_skill:"Crafting",recipe_level:[22,30]}),Z.items["Glass phial"]=new T({name:"Glass phial",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Raw Glass",count:1}],result:{result_id:"Glass phial",count:1},success_chance:[.1,1],recipe_level:[15,25],recipe_skill:"Crafting"}),Z.items["Glass bottle"]=new T({name:"Glass bottle",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Raw Glass",count:3}],result:{result_id:"Glass bottle",count:1},success_chance:[.1,1],recipe_level:[15,25],recipe_skill:"Crafting"}),Xe.items["Iron chainmail"]=new T({name:"Iron chainmail",recipe_type:"material",materials:[{material_id:"Iron ingot",count:5}],result:{result_id:"Iron chainmail",count:1},success_chance:[.1,1],recipe_skill:"Forging",recipe_level:[5,15]}),Xe.items["Steel chainmail"]=new T({name:"Steel chainmail",recipe_type:"material",materials:[{material_id:"Steel ingot",count:5}],result:{result_id:"Steel chainmail",count:1},success_chance:[.1,1],recipe_skill:"Forging",recipe_level:[10,20]}),Xe.items["Metal fishing hook"]=new T({name:"Metal fishing hook",recipe_type:"material",materials:[{material_type:"metal",count:1}],result:{result_id:"Metal fishing hook",count:1},success_chance:[.1,1],recipe_skill:"Forging",recipe_level:[5,15]}),qe.items["Rat meat chunks"]=new T({name:"Rat meat chunks",recipe_type:"material",materials:[{material_id:"Rat tail",count:3}],result:{result_id:"Rat meat chunks",count:1},success_chance:[.4,1],recipe_level:[1,5],recipe_skill:"Butchering"}),qe.items["Fish fillet"]=new T({name:"Fish fillet",recipe_type:"material",materials:[{material_type:"large fish",count:1}],result:{result_id:"Fish fillet",count:3},success_chance:[.4,1],recipe_level:[10,15],recipe_skill:"Butchering"}),Qi.items["Low quality iron ingot"]=new T({name:"Low quality iron ingot",recipe_type:"material",materials:[{material_id:"Low quality iron ore",count:5},{material_type:"coal",count:1}],result:{result_id:"Low quality iron ingot",count:1},success_chance:[.6,1],recipe_level:[1,5],recipe_skill:"Smelting"}),Qi.items["Iron ingot"]=new T({name:"Iron ingot",recipe_type:"material",materials:[{material_id:"Iron ore",count:5},{material_type:"coal",count:1}],result:{result_id:"Iron ingot",count:1},success_chance:[.4,1],recipe_level:[5,15],recipe_skill:"Smelting"}),Qi.items["Steel ingot (inefficient)"]=new T({name:"Steel ingot (inefficient)",recipe_type:"material",materials:[{material_id:"Iron ore",count:5},{material_id:"Atratan ore",count:4},{material_type:"coal",count:2}],result:{result_id:"Steel ingot",count:1},success_chance:[.3,1],recipe_level:[10,20],recipe_skill:"Smelting",is_unlocked:!1}),Qi.items["Raw Glass"]=new T({name:"Raw Glass",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Silica Sand",count:2},{material_id:"Potash",count:1}],result:{result_id:"Raw Glass",count:1},success_chance:[.2,1],recipe_level:[10,20],recipe_skill:"Smelting"}),Qi.items["Alchemical Wood"]=new T({name:"Alchemical Wood",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Sulfur",count:5},{material_id:"Potash",count:5},{material_id:"Processed hickory wood",count:2}],result:{result_id:"Alchemical Wood",count:1},success_chance:[.2,1],recipe_level:[15,25],recipe_skill:"Smelting"}),ct.items["Processed rough wood"]=new T({name:"Processed rough wood",recipe_type:"material",materials:[{material_id:"Piece of rough wood",count:5}],result:{result_id:"Processed rough wood",count:1},success_chance:[.6,1],recipe_level:[1,5],recipe_skill:"Woodworking"}),ct.items["Processed wood"]=new T({name:"Processed wood",recipe_type:"material",materials:[{material_id:"Piece of wood",count:5}],result:{result_id:"Processed wood",count:1},success_chance:[.4,1],recipe_level:[5,15],recipe_skill:"Woodworking"}),ct.items["Processed ash wood"]=new T({name:"Processed ash wood",recipe_type:"material",materials:[{material_id:"Piece of ash wood",count:5}],result:{result_id:"Processed ash wood",count:1},success_chance:[.4,1],recipe_level:[10,20],recipe_skill:"Woodworking"}),ct.items.Wicker=new T({name:"Wicker",recipe_type:"material",materials:[{material_id:"Piece of willow wood",count:6}],result:{result_id:"Wicker",count:1},success_chance:[.2,1],recipe_level:[7,17],recipe_skill:"Woodworking"}),ct.items["Willow bark"]=new T({name:"Willow bark",recipe_type:"material",materials:[{material_id:"Piece of willow wood",count:2}],result:{result_id:"Willow bark",count:1},success_chance:[.1,1],recipe_level:[10,25],recipe_skill:"Woodworking"}),qe.items["Processed weak monster bone"]=new T({name:"Processed weak monster bone",recipe_type:"material",materials:[{material_id:"Weak monster bone",count:5}],result:{result_id:"Processed weak monster bone",count:1},success_chance:[.1,1],recipe_level:[10,20],recipe_skill:"Butchering"}),Qi.items.Charcoal=new T({name:"Charcoal",recipe_type:"material",materials:[{material_type:"raw wood",count:5}],result:{result_id:"Charcoal",count:1},success_chance:[.4,1],recipe_level:[1,10],recipe_skill:"Smelting"}),Te.items["Animal fat"]=new T({name:"Animal fat",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Boar meat",count:3}],result:{result_id:"Animal fat",count:1},success_chance:[.1,1],recipe_level:[7,20],recipe_skill:"Cooking"}),qe.items.Sinew=new T({name:"Sinew",recipe_type:"material",materials:[{material_type:"raw meat",count:2}],result:{result_id:"Sinew",count:1},success_chance:[.1,1],recipe_level:[10,20],recipe_skill:"Butchering"}),Z.items["Sinew string"]=new T({name:"Sinew string",recipe_type:"material",materials:[{material_id:"Sinew",count:5}],result:{result_id:"Sinew string",count:1},success_chance:[.2,1],recipe_level:[5,15],recipe_skill:"Crafting"}),qe.items["High quality wolf fang"]=new T({name:"High quality wolf fang",recipe_type:"material",materials:[{material_id:"Wolf fang",count:50}],result:{result_id:"High quality wolf fang",count:1},success_chance:[.5,1],recipe_level:[1,7],recipe_skill:"Butchering"}),qe.items["High quality boar tusk"]=new T({name:"High quality boar tusk",recipe_type:"material",materials:[{material_id:"Boar tusk",count:50}],result:{result_id:"High quality boar tusk",count:1},success_chance:[.5,1],recipe_level:[5,12],recipe_skill:"Butchering"}),qe.items["Pristine mountain goat horn"]=new T({name:"Pristine mountain goat horn",recipe_type:"material",materials:[{material_id:"Mountain goat horn",count:50}],result:{result_id:"Pristine mountain goat horn",count:1},success_chance:[.5,1],recipe_level:[10,17],recipe_skill:"Butchering"}),qe.items["Sharp bear claw"]=new T({name:"Sharp bear claw",recipe_type:"material",materials:[{material_id:"Bear claw",count:50}],result:{result_id:"Sharp bear claw",count:1},success_chance:[.5,1],recipe_level:[13,20],recipe_skill:"Butchering"}),qe.items["Giant crab claw"]=new T({name:"Giant crab claw",recipe_type:"material",materials:[{material_id:"Crab claw",count:50}],result:{result_id:"Giant crab claw",count:1},success_chance:[.3,1],recipe_level:[18,25],recipe_skill:"Butchering"}),$i.items.Potash=new T({name:"Potash",is_unlocked:!1,recipe_type:"material",materials:[{material_id:"Charcoal",count:8}],result:{result_id:"Potash",count:1},success_chance:[.5,1],recipe_level:[10,20],recipe_skill:"Alchemy"})})();(function(){Z.items.Bonemeal=new T({name:"Bonemeal",is_unlocked:!0,recipe_type:"material",materials:[{material_type:"animal tooth",count:20}],result:{result_id:"Bonemeal",count:1},success_chance:[.1,1],recipe_level:[1,12],recipe_skill:"Crafting"}),ct.items["Makeshift fishing pole"]=new T({name:"Makeshift fishing pole",recipe_type:"equipment",materials:[{material_id:"Processed rough wood",count:4},{material_id:"Wool",count:1}],result:{result_id:"Makeshift fishing pole",count:1},success_chance:[.1,1],recipe_level:[1,12],recipe_skill:"Woodworking"}),ct.items["Wooden fishing pole"]=new T({name:"Wooden fishing pole",recipe_type:"equipment",materials:[{material_id:"Processed wood",count:4},{material_id:"Sinew string",count:1},{material_id:"Metal fishing hook",count:1}],result:{result_id:"Wooden fishing pole",count:1},success_chance:[.1,1],recipe_level:[7,17],recipe_skill:"Woodworking"}),ct.items["Ash wood fishing pole"]=new T({name:"Ash wood fishing pole",recipe_type:"equipment",materials:[{material_id:"Processed ash wood",count:4},{material_id:"Sinew string",count:1},{material_id:"Metal fishing hook",count:1}],result:{result_id:"Ash wood fishing pole",count:1},success_chance:[.1,1],recipe_level:[12,22],recipe_skill:"Woodworking"})})();(function(){Te.items["Roasted rat meat"]=new T({name:"Roasted rat meat",recipe_type:"usable",materials:[{material_id:"Rat meat chunks",count:2}],result:{result_id:"Roasted rat meat",count:1},success_chance:[.7,1],recipe_level:[1,5],recipe_skill:"Cooking"}),Te.items["Roasted purified rat meat"]=new T({name:"Roasted purified rat meat",recipe_type:"usable",materials:[{material_id:"Rat meat chunks",count:2},{material_id:"Belmart leaf",count:1}],result:{result_id:"Roasted purified rat meat",count:1},success_chance:[.4,1],recipe_level:[1,10],recipe_skill:"Cooking"}),Te.items["Fried pork"]=new T({name:"Fried pork",recipe_type:"usable",materials:[{material_id:"Boar meat",count:2}],result:{result_id:"Fried pork",count:1},success_chance:[.5,1],recipe_level:[7,15],recipe_skill:"Cooking"}),Te.items["Fried goat meat"]=new T({name:"Fried goat meat",recipe_type:"usable",materials:[{material_id:"Goat meat",count:2}],result:{result_id:"Fried goat meat",count:1},success_chance:[.4,1],recipe_level:[10,15],recipe_skill:"Cooking"}),Te.items["Pork roast"]=new T({name:"Pork roast",recipe_type:"usable",materials:[{material_id:"Boar meat",count:2},{material_id:"Cooking herbs",count:3}],result:{result_id:"Pork roast",count:1},success_chance:[.5,1],recipe_level:[10,20],recipe_skill:"Cooking"}),Te.items["Goat stew"]=new T({name:"Goat stew",recipe_type:"usable",materials:[{material_id:"Goat meat",count:2},{material_id:"Cooking herbs",count:2}],result:{result_id:"Goat stew",count:1},success_chance:[.4,1],recipe_level:[15,25],recipe_skill:"Cooking"}),Te.items["Bread kwas"]=new T({name:"Bread kwas",recipe_type:"usable",materials:[{material_type:"bread",count:2},{material_id:"Glass bottle",count:1}],result:{result_id:"Bread kwas",count:1},success_chance:[.3,1],recipe_level:[10,15],recipe_skill:"Cooking"}),Te.items["Fish skewer"]=new T({name:"Fish skewer",recipe_type:"usable",materials:[{material_type:"small fish",count:5}],result:{result_id:"Fish skewer",count:1},success_chance:[.5,1],recipe_level:[1,10],recipe_skill:"Cooking"}),Te.items["Fried fish"]=new T({name:"Fried fish",recipe_type:"usable",materials:[{material_type:"medium fish",count:1}],result:{result_id:"Fried fish",count:1},success_chance:[.5,1],recipe_level:[7,15],recipe_skill:"Cooking"}),Te.items["Fish steak"]=new T({name:"Fish steak",recipe_type:"usable",materials:[{material_id:"Fish fillet",count:1},{material_id:"Cooking herbs",count:1}],result:{result_id:"Fish steak",count:1},success_chance:[.5,1],recipe_level:[7,15],recipe_skill:"Cooking"}),Te.items["Fried frog meat"]=new T({name:"Fried frog meat",recipe_type:"usable",materials:[{material_id:"Frog meat",count:2}],result:{result_id:"Fried frog meat",count:1},success_chance:[.4,1],recipe_level:[12,20],recipe_skill:"Cooking"}),Te.items["Kingsized frog legs"]=new T({name:"Kingsized frog legs",recipe_type:"usable",materials:[{material_id:"Frog meat",count:2},{material_id:"Cooking herbs",count:2}],result:{result_id:"Kingsized frog legs",count:1},success_chance:[.5,1],recipe_level:[15,25],recipe_skill:"Cooking"}),Te.items["Alligator jerky"]=new T({name:"Alligator jerky",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Alligator meat",count:2}],result:{result_id:"Alligator jerky",count:1},success_chance:[.3,1],recipe_level:[22,30],recipe_skill:"Cooking"}),Te.items["Snake jerky"]=new T({name:"Snake jerky",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Giant snake meat",count:2}],result:{result_id:"Snake jerky",count:1},success_chance:[.3,1],recipe_level:[22,30],recipe_skill:"Cooking"}),Te.items["Turtle jerky"]=new T({name:"Turtle jerky",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Turtle meat",count:2}],result:{result_id:"Turtle jerky",count:1},success_chance:[.3,1],recipe_level:[22,30],recipe_skill:"Cooking"}),Te.items["Swampland skewer"]=new T({name:"Swampland skewer",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Alligator meat",count:1},{material_id:"Giant snake meat",count:1},{material_id:"Turtle meat",count:1},{material_id:"Wild garlic",count:1},{material_id:"Wild onion",count:1},{material_id:"Cooking herbs",count:1}],result:{result_id:"Swampland skewer",count:1},success_chance:[.3,1],recipe_level:[27,37],recipe_skill:"Cooking"}),Te.items["Crab bisque"]=new T({name:"Crab bisque",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Crab meat",count:3},{material_id:"Cooking herbs",count:1},{material_id:"Wild potato",count:2},{material_id:"Wild onion",count:1},{material_id:"Glass bottle",count:1}],result:{result_id:"Crab bisque",count:1},success_chance:[.4,1],recipe_level:[22,30],recipe_skill:"Cooking"}),Te.items["Clam broth"]=new T({name:"Clam broth",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Clam",count:3},{material_id:"Cooking herbs",count:1},{material_id:"Wild garlic",count:1},{material_id:"Glass bottle",count:1}],result:{result_id:"Clam broth",count:1},success_chance:[.4,1],recipe_level:[22,30],recipe_skill:"Cooking"}),Te.items["Turtle soup"]=new T({name:"Turtle soup",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Turtle meat",count:1},{material_id:"Cooking herbs",count:1},{material_id:"Wild potato",count:1},{material_id:"Glass bottle",count:1}],result:{result_id:"Turtle soup",count:1},success_chance:[.4,1],recipe_level:[22,30],recipe_skill:"Cooking"}),Te.items["Basin gumbo"]=new T({name:"Basin gumbo",is_unlocked:!1,recipe_type:"usable",materials:[{material_id:"Alligator meat",count:3},{material_id:"Turtle meat",count:3},{material_id:"Crab meat",count:6},{material_id:"Clam",count:6},{material_id:"Wild potato",count:6},{material_id:"Wild garlic",count:4},{material_id:"Wild onion",count:4},{material_id:"Animal fat",count:3},{material_id:"Cooking herbs",count:3},{material_id:"Belmart leaf",count:2},{material_id:"Glass bottle",count:1}],result:{result_id:"Basin gumbo",count:1},success_chance:[.1,1],recipe_level:[35,60],recipe_skill:"Cooking"}),$i.items["Weak healing powder"]=new T({name:"Weak healing powder",recipe_type:"usable",is_unlocked:!1,materials:[{material_id:"Golmoon leaf",count:5}],result:{result_id:"Weak healing powder",count:1},success_chance:[.4,1],recipe_level:[1,10],recipe_skill:"Alchemy"}),$i.items["Healing powder"]=new T({name:"Healing powder",recipe_type:"usable",is_unlocked:!1,materials:[{material_id:"Golmoon leaf",count:3},{material_id:"Silver thistle",count:3}],result:{result_id:"Healing powder",count:1},success_chance:[.1,1],recipe_level:[5,15],recipe_skill:"Alchemy"}),$i.items["Oneberry juice"]=new T({name:"Oneberry juice",recipe_type:"usable",is_unlocked:!1,materials:[{material_id:"Oneberry",count:10},{material_id:"Glass phial",count:1}],result:{result_id:"Oneberry juice",count:1},success_chance:[.5,1],recipe_level:[2,12],recipe_skill:"Alchemy"}),$i.items["Healing potion"]=new T({name:"Healing potion",recipe_type:"usable",is_unlocked:!1,materials:[{material_id:"Oneberry",count:8},{material_id:"Silver thistle",count:4},{material_id:"Glass phial",count:1}],result:{result_id:"Healing potion",count:1},success_chance:[.1,1],recipe_level:[7,17],recipe_skill:"Alchemy"}),$i.items["Healing balm"]=new T({name:"Healing balm",recipe_type:"usable",is_unlocked:!1,materials:[{material_id:"Oneberry",count:10},{material_id:"Golmoon leaf",count:5},{material_id:"Animal fat",count:1}],result:{result_id:"Healing balm",count:1},success_chance:[.1,1],recipe_level:[7,15],recipe_skill:"Alchemy"}),$i.items.Sulfur=new T({name:"Sulfur",recipe_type:"material",is_unlocked:!1,materials:[{material_id:"Low quality iron ore",count:10}],result:{result_id:"Sulfur",count:1},success_chance:[.1,1],recipe_level:[10,20],recipe_skill:"Alchemy"})})();(function(){Z.items["Wolf trophy"]=new T({name:"Wolf trophy",recipe_type:"equipment",materials:[{material_id:"High quality wolf fang",count:4}],result:{result_id:"Wolf trophy",count:1},success_chance:[.5,1],recipe_level:[1,10],recipe_skill:"Crafting"}),Z.items["Boar trophy"]=new T({name:"Boar trophy",recipe_type:"equipment",materials:[{material_id:"High quality boar tusk",count:4}],result:{result_id:"Boar trophy",count:1},success_chance:[.5,1],recipe_level:[5,15],recipe_skill:"Crafting"}),Z.items["Mountain goat trophy"]=new T({name:"Mountain goat trophy",recipe_type:"equipment",materials:[{material_id:"Pristine mountain goat horn",count:4}],result:{result_id:"Mountain goat trophy",count:1},success_chance:[.5,1],recipe_level:[10,20],recipe_skill:"Crafting"}),Z.items["Bear trophy"]=new T({name:"Bear trophy",recipe_type:"equipment",materials:[{material_id:"Sharp bear claw",count:4}],result:{result_id:"Bear trophy",count:1},success_chance:[.3,1],recipe_level:[15,25],recipe_skill:"Crafting"}),Z.items["Crab trophy"]=new T({name:"Crab trophy",recipe_type:"equipment",materials:[{material_id:"Giant crab claw",count:4}],result:{result_id:"Crab trophy",count:1},success_chance:[.3,1],recipe_level:[22,30],recipe_skill:"Crafting"}),Z.items["Simple dream catcher"]=new T({name:"Simple dream catcher",recipe_type:"equipment",is_unlocked:!1,materials:[{material_id:"Piece of willow wood",count:1},{material_id:"Sinew string",count:1}],result:{result_id:"Simple dream catcher",count:1},success_chance:[.1,1],recipe_skill:"Crafting",recipe_level:[10,20]}),Z.items["Wool scarf"]=new T({name:"Wool scarf",recipe_type:"equipment",materials:[{material_id:"Wool cloth",count:5}],result:{result_id:"Wool scarf",count:1},success_chance:[.1,1],recipe_skill:"Crafting",recipe_level:[5,15]})})();var G={crafting:Z,cooking:Te,smelting:Qi,forging:Xe,alchemy:$i,butchering:qe,woodworking:ct};Object.keys(G).forEach(e=>{Object.keys(G[e]).forEach(t=>{Object.keys(G[e][t]).forEach(i=>{G[e][t][i].id=i})})});var f={},Ui={},Za={axe:"Axes",dagger:"Daggers",hammer:"Hammers",sword:"Swords",spear:"Spears",staff:"Staffs",wand:"Wands"},Ti="Crafting",Os=.1,Ps=.25,ql="?????",gt={},W=class{constructor({skill_id:t,names:i,description:a,flavour_text:s,max_level:n=60,max_level_coefficient:o=1,max_level_bonus:l=0,base_xp_cost:d=40,visibility_treshold:u=10,get_effect_description:h=()=>"",parent_skill:_=null,milestones:w={},xp_scaling:b=1.8,is_unlocked:g=!0,category:v,get_stat_modifiers:y=()=>({})}){if(t==="all"||t==="hero"||t==="all_skill")throw new Error(`Id "${t}" is not allowed for skills`);if(this.skill_id=t,this.names=i,this.description=a,this.flavour_text=s,this.current_level=0,this.max_level=n,this.max_level_coefficient=o,this.max_level_bonus=l,this.current_xp=0,this.total_xp=0,this.base_xp_cost=d,d<1/Os&&console.warn(`Skill "${this.skill_id}" has base xp cost lower than what would be needed due to skill xp gains cap!`),this.visibility_treshold=u<d?u:d,this.is_unlocked=g,this.xp_to_next_lvl=d,this.total_xp_to_next_lvl=d,this.get_effect_description=h,this.is_parent=!1,v?this.category=v:(console.warn(`Skill "${this.skill_id}" has no category defined and was defaulted to miscellaneous`),this.category="Miscellaneous"),Ui[this.category]=!0,_)if(f[_])this.parent_skill=_,f[_].is_parent=!0;else throw new Error(`Skill "${_}" doesn't exist, so it can't be set as a parent skill`);this.milestones=w,this.xp_scaling=b>1?b:1.6,this.get_stat_modifiers=y}name(){if(this.visibility_treshold>this.total_xp||!this.is_unlocked)return ql;let t=Object.keys(this.names);if(t.length==1)return this.names[t[0]];{let a;for(var i=0;i<=t.length&&this.current_level>=parseInt(t[i]);i++)a=this.names[t[i]];return a}}add_xp({xp_to_add:t=0}){if(t==0||!this.is_unlocked)return{};t=Math.round(t*100)/100;let i=this.name();if(this.total_xp=Math.round(100*(this.total_xp+t))/100,this.current_level<this.max_level)if(Math.round(100*(t+this.current_xp))/100<this.xp_to_next_lvl)this.current_xp=Math.round(100*(this.current_xp+t))/100;else{let a=0,s={skills:[],recipes:[],quests:[]};for(;this.total_xp>=this.total_xp_to_next_lvl;)a+=1,this.total_xp_to_next_lvl=Math.round(100*this.base_xp_cost*(1-this.xp_scaling**(a+1))/(1-this.xp_scaling))/100,this.milestones[a]?.unlocks?.skills&&s.skills.push(...this.milestones[a].unlocks.skills),this.milestones[a]?.unlocks?.recipes&&s.recipes.push(...this.milestones[a].unlocks.recipes),this.milestones[a]?.unlocks?.quests&&s.quests.push(...this.milestones[a].unlocks.quests);let n=Math.round(100*this.base_xp_cost*(1-this.xp_scaling**a)/(1-this.xp_scaling))/100;a==0&&console.warn(`Something went wrong, calculated level of skill "${this.skill_id}" after a levelup was 0.
xp_added: ${t};
previous level: ${this.current_level};
total xp: ${this.total_xp};
total xp for that level: ${n};
total xp for next level: ${this.total_xp_to_next_lvl}`);let o;a<this.max_level?(o=this.get_bonus_stats(a),this.xp_to_next_lvl=Math.round(100*(this.total_xp_to_next_lvl-n))/100,this.current_level=a,this.current_xp=Math.round(100*(this.total_xp-n))/100):(o=this.get_bonus_stats(this.max_level),this.current_level=this.max_level,this.total_xp_to_next_lvl="Already reached max lvl",this.current_xp="Max",this.xp_to_next_lvl="Max"),i=i===ql?this.name():i;let l=`${i} has reached level ${this.current_level}`;return(Object.keys(o.stats).length>0||Object.keys(o.xp_multipliers).length>0)&&(l+=`<br><br> Thanks to ${i} reaching new milestone, %HeroName% gained: `,o.stats&&Object.keys(o.stats).forEach(d=>{o.stats[d].flat&&(l+=`<br> +${o.stats[d].flat} ${Je[d].replace("_"," ")}`),o.stats[d].multiplier&&(l+=`<br> x${Math.round(100*o.stats[d].multiplier)/100} ${Je[d].replace("_"," ")}`)}),o.xp_multipliers&&Object.keys(o.xp_multipliers).forEach(d=>{let u;d!=="all"&&d!=="hero"&&d!=="all_skill"&&!d.includes("category_")?(u=f[d].name(),f[d]||console.warn(`Skill ${this.skill_id} tried to reward an xp multiplier for something that doesn't exist: ${d}. I could be a misspelled skill name`)):u=d.replace("_"," "),d.includes("category_")?l+=`<br> x${Math.round(100*o.xp_multipliers[d])/100} ${u.replace("category_","")} skills xp gain`:l+=`<br> x${Math.round(100*o.xp_multipliers[d])/100} ${u} xp gain`})),{message:l,gains:o,unlocks:s}}return{}}get_bonus_stats(t){let i={stats:{},xp_multipliers:{}},a,s;for(let n=this.current_level+1;n<=t;n++)this.milestones[n]&&(a=this.milestones[n].stats,s=this.milestones[n].xp_multipliers,a&&Object.keys(a).forEach(o=>{i.stats[o]||(i.stats[o]={}),a[o].flat&&(i.stats[o].flat=(i.stats[o].flat||0)+a[o].flat),a[o].multiplier&&(i.stats[o].multiplier=(i.stats[o].multiplier||1)*a[o].multiplier)}),s&&Object.keys(s).forEach(o=>{i.xp_multipliers[o]=(i.xp_multipliers[o]||1)*s[o],gt[o]?gt[o].includes(this.skill_id)||gt[o].push(this.skill_id):gt[o]=[this.skill_id]}));return Object.keys(i.stats).forEach(n=>{i.stats[n].multiplier&&(i.stats[n].multiplier=Math.round(100*i.stats[n].multiplier)/100)}),i}get_coefficient({scaling_type:t,skill_level:i}){switch(t){case"flat":return 1+Math.round((this.max_level_coefficient-1)*(i||this.current_level)/this.max_level*1e3)/1e3;case"multiplicative":return Math.round(Math.pow(this.max_level_coefficient,(i||this.current_level)/this.max_level)*1e3)/1e3;default:return Math.round(Math.pow(this.max_level_coefficient,(i||this.current_level)/this.max_level)*1e3)/1e3}}get_level_bonus(t){return this.max_level_bonus*(t||this.current_level)/this.max_level}get_parent_xp_multiplier(){return this.parent_skill?1.1**Math.max(0,f[this.parent_skill].current_level-this.current_level):1}};function js(e){let t="",i=f[e],a=Object.keys(i.milestones).filter(s=>s<=i.current_level);if(a.length>0){t=`lvl ${a[0]}: ${Sl(i.milestones[a[0]])}`;for(let s=1;s<a.length;s++)t+=`<br>

lvl ${a[s]}: ${Sl(i.milestones[a[s]])}`}else return"";return t}function Ns(e){return Object.keys(f[e].milestones).find(t=>t>f[e].current_level)}function Sl(e){let t="";if(e.stats){let i="";Object.keys(e.stats).forEach(a=>{e.stats[a].flat&&(t?t+=`, +${e.stats[a].flat} ${Je[a]}`:t=`+${e.stats[a].flat} ${Je[a]}`),e.stats[a].multiplier&&(i?i+=`, x${e.stats[a].multiplier} ${Je[a]}`:i=`x${e.stats[a].multiplier} ${Je[a]}`)}),t?i&&(t+=", "+i):t=i}if(e.xp_multipliers){let i=Object.keys(e.xp_multipliers),a;i[0]!=="all"&&i[0]!=="hero"&&i[0]!=="all_skill"?i[0].includes("category_")?a=i[0].replace("category_","")+" skills":a=f[i[0]].name():a=i[0].replace("_"," "),t?t+=`, x${e.xp_multipliers[i[0]]} ${a} xp gain`:t=`x${e.xp_multipliers[i[0]]} ${a} xp gain`;for(let s=1;s<i.length;s++){let n;i[s]!=="all"&&i[s]!=="hero"&&i[s]!=="all_skill"?i[s].includes("category_")?n=i[s].replace("category_","")+" skills":n=f[i[s]].name():n=i[s].replace("_"," "),t+=`, x${e.xp_multipliers[i[s]]} ${n} xp gain`}}if(e.unlocks){if(e.unlocks.skills){let i=e.unlocks.skills;t?t+=`, <br> Unlocked skill "${e.unlocks.skills[0]}"`:t=`Unlocked skill "${e.unlocks.skills[0]}"`;for(let a=1;a<i.length;a++)t+=`, "${e.unlocks.skills[a]}"`}if(e.unlocks.recipes){let i=e.unlocks.recipes.length>1?"new recipes":"a new recipe";t?t+=`, <br> Unlocked ${i}`:t=`Unlocked ${i}`}}return t}(function(){f.Combat=new W({names:{0:"Combat"},category:"Combat",description:"Overall combat ability",max_level_coefficient:2,base_xp_cost:60,get_effect_description:()=>`Multiplies AP by ${Math.round(R({skill_id:"Combat",scaling_type:"multiplicative"})*1e3)/1e3}`}),f["Pest killer"]=new W({names:{0:"Pest killer",15:"Pest slayer"},description:"Small enemies might not seem very dangerous, but it's not that easy to hit them!",max_level_coefficient:2,category:"Combat",base_xp_cost:100,get_effect_description:()=>`Multiplies AP against small-type enemies by ${Math.round(R({skill_id:"Pest killer",scaling_type:"multiplicative"})*1e3)/1e3}`,milestones:{1:{xp_multipliers:{Combat:1.05}},2:{xp_multipliers:{category_Combat:1.05}},3:{stats:{dexterity:{flat:1}}},5:{stats:{dexterity:{multiplier:1.05}},xp_multipliers:{Evasion:1.05,"Shield blocking":1.05}},7:{stats:{dexterity:{flat:1}},xp_multipliers:{Combat:1.05}},10:{stats:{dexterity:{multiplier:1.05}},xp_multipliers:{category_Combat:1.05,Perception:1.1}},12:{stats:{dexterity:{flat:2}},xp_multipliers:{Combat:1.05}}},get_stat_modifiers:()=>({modifier_to_hit_chance:R({scaling_type:"multiplicative",skill_id:"Pest killer"})})}),f["Giant slayer"]=new W({names:{0:"Giant killer",15:"Giant slayer"},description:"Large opponents might seem scary, but just don't get hit and you should be fine!",max_level_coefficient:2,category:"Combat",get_effect_description:()=>`Multiplies EP against large-type enemies by ${Math.round(R({skill_id:"Giant slayer",scaling_type:"multiplicative"})*1e3)/1e3}`,get_stat_modifiers:()=>({modifier_to_evasion:R({scaling_type:"multiplicative",skill_id:"Giant slayer"})})}),f.Evasion=new W({names:{0:"Evasion"},description:"Ability to evade attacks. You cannot do it while using a shield",max_level_coefficient:2,base_xp_cost:20,category:"Combat",get_effect_description:()=>`Multiplies EP by ${Math.round(R({skill_id:"Evasion",scaling_type:"multiplicative"})*1e3)/1e3}`,milestones:{1:{stats:{agility:{flat:1}}},3:{stats:{agility:{flat:1}},xp_multipliers:{Equilibrium:1.05}},5:{stats:{agility:{flat:1,multiplier:1.05}}},7:{stats:{agility:{flat:2}},xp_multipliers:{Equilibrium:1.05}},10:{stats:{agility:{flat:1,multiplier:1.05}}},12:{stats:{agility:{flat:2}},xp_multipliers:{Equilibrium:1.05}},15:{stats:{agility:{flat:5}}},20:{xp_multipliers:{Climbing:1.2,Swimming:1.2,Running:1.2}}}}),f["Shield blocking"]=new W({names:{0:"Shield blocking"},description:"Ability to block attacks with shield. You cannot evade while using one",max_level:30,max_level_bonus:.2,category:"Combat",get_effect_description:()=>`Increases block chance by flat ${Math.round($t("Shield blocking")*1e3)/10}%. Increases blocked damage by ${Math.round($t("Shield blocking")*5e3)/10}%, and blocks ${K("Shield blocking")}% of attack damage before other calculations.`}),f.Unarmed=new W({names:{0:"Unarmed",10:"Brawling",20:"Martial arts"},description:"It's definitely, unquestionably, undoubtedly better to just use a weapon instead of doing this. But sure, why not?",category:"Combat",get_effect_description:()=>`Multiplies damage dealt in unarmed combat by ${Math.round(R({skill_id:"Unarmed",scaling_type:"multiplicative"})*1e3)/1e3}. 
Multiplies attack speed, EP and AP in unarmed combat by ${Math.round(R({skill_id:"Unarmed",scaling_type:"multiplicative"})**.3333*1e3)/1e3}.
Adds ${f.Unarmed.current_level/10} base damage to unarmed attacks`,max_level_coefficient:64,milestones:{2:{stats:{strength:{flat:1}},xp_multipliers:{Weightlifting:1.05}},4:{stats:{strength:{flat:1},dexterity:{flat:1}}},6:{stats:{strength:{flat:1},dexterity:{flat:1},agility:{flat:1}},xp_multipliers:{Weightlifting:1.1}},8:{stats:{strength:{flat:1},dexterity:{flat:1},agility:{flat:1}}},10:{stats:{strength:{flat:2},dexterity:{flat:1},agility:{flat:1}},xp_multipliers:{Running:1.2}},12:{stats:{strength:{flat:2},dexterity:{flat:2},agility:{flat:2}}},15:{stats:{strength:{flat:5},dexterity:{flat:5},agility:{flat:5}}},20:{xp_multipliers:{Breathing:1.1,Equilibrium:1.1,Weightlifting:1.1,Running:1.1}}}})})();(function(){f["Stance mastery"]=new W({names:{0:"Stance proficiency",10:"Stance mastery"},description:"Knowledge on how to apply different stances in combat",base_xp_cost:60,category:"Stance",max_level:30,get_effect_description:()=>"Increases xp gains of all combat stance skills of level lower than this, x1.1 per level of difference"}),f["Quick steps"]=new W({names:{0:"Quick steps"},parent_skill:"Stance mastery",description:"A swift and precise technique that abandons strength in favor of greater speed",max_level_coefficient:2,base_xp_cost:60,category:"Stance",max_level:30,get_effect_description:()=>"Improves efficiency of the 'Quick Steps' stance"}),f["Heavy strike"]=new W({names:{0:"Crushing force"},parent_skill:"Stance mastery",description:"A powerful and dangerous technique that abandons speed in favor of overwhelmingly strong attacks",max_level_coefficient:2,base_xp_cost:60,category:"Stance",max_level:30,get_effect_description:()=>'Improves efficiency of the "Crushing force" stance'}),f["Wide swing"]=new W({names:{0:"Broad arc"},parent_skill:"Stance mastery",description:"A special technique that allows striking multiple enemies at once, although at a cost of lower overall efficiency. Slightly reduces xp and loot.",max_level_coefficient:2,base_xp_cost:60,category:"Stance",max_level:30,get_effect_description:()=>'Improves efficiency of the "Broad arc" stance'}),f["Defensive measures"]=new W({names:{0:"Defensive measures"},parent_skill:"Stance mastery",description:"A careful technique focused much more on defense than on attacking",max_level_coefficient:2,base_xp_cost:60,category:"Stance",max_level:30,get_effect_description:()=>"Improves efficiency of the 'Defensive Measures' stance"}),f["Berserker's stride"]=new W({names:{0:"Berserker's stride"},parent_skill:"Stance mastery",description:"A wild and dangerous technique that focuses on dealing as much damage as possible, while completely ignoring own defense",max_level_coefficient:2,base_xp_cost:60,category:"Stance",max_level:30,get_effect_description:()=>"Improves efficiency of the 'Berserker's Stride' stance"}),f["Flowing water"]=new W({names:{0:"Flowing water"},parent_skill:"Stance mastery",description:"A wild and dangerous technique that focuses on dealing as much damage as possible, while completely ignoring own defense",max_level_coefficient:2,base_xp_cost:60,category:"Stance",max_level:30,get_effect_description:()=>"Improves efficiency of the 'Flowing Water' stance"})})();(function(){f["Spatial awareness"]=new W({names:{0:"Spatial awareness"},description:"Understanding where you are in relation to other creatures and objects",get_effect_description:()=>"Reduces environmental penalty in open areas",category:"Environmental",milestones:{1:{xp_multipliers:{Evasion:1.1,"Shield blocking":1.1}},3:{xp_multipliers:{Combat:1.1}},5:{xp_multipliers:{category_Combat:1.1},stats:{intuition:{flat:1}}},8:{xp_multipliers:{all_skill:1.1}},10:{xp_multipliers:{Evasion:1.1,"Shield blocking":1.1,Combat:1.1,Perception:1.1},stats:{intuition:{flat:1}}},15:{xp_multipliers:{category_Combat:1.1},stats:{intuition:{flat:3}}},20:{xp_multipliers:{all_skill:1.2}}}}),f["Tight maneuvers"]=new W({names:{0:"Tight maneuvers"},description:"Learn how to fight in narrow environment, where there's not much space for dodging attacks",category:"Environmental",get_effect_description:()=>"Reduces environmental penalty in narrow areas",milestones:{3:{xp_multipliers:{Evasion:1.1,"Shield blocking":1.1}},5:{xp_multipliers:{Combat:1.1}},7:{xp_multipliers:{Evasion:1.1,"Shield blocking":1.1}},10:{xp_multipliers:{Evasion:1.1,"Shield blocking":1.1,Combat:1.1}},15:{xp_multipliers:{Equilibrium:1.1},stats:{agility:{flat:5}}},20:{xp_multipliers:{Evasion:1.2,"Shield blocking":1.2,Combat:1.2}}}}),f["Night vision"]=new W({names:{0:"Night vision"},description:"Ability to see in darkness",base_xp_cost:600,xp_scaling:1.9,max_level:10,category:"Environmental",get_effect_description:()=>"Reduces environmental penalty in dark areas (except for 'pure darkness')",milestones:{2:{stats:{intuition:{flat:1}}},3:{xp_multipliers:{Evasion:1.05,"Shield blocking":1.05}},5:{stats:{intuition:{flat:1}},xp_multipliers:{"Presence sensing":1.05,Perception:1.1}},7:{xp_multipliers:{Combat:1.1},stats:{intuition:{multiplier:1.05}}},8:{xp_multipliers:{"Presence sensing":1.1}},10:{xp_multipliers:{"Presence sensing":1.2,Evasion:1.05,"Shield blocking":1.05,Perception:1.1},stats:{intuition:{multiplier:1.05}}}}}),f["Presence sensing"]=new W({names:{0:"Presence sensing"},description:"Ability to sense a presence without using your eyes",base_xp_cost:60,xp_scaling:2,max_level:20,category:"Environmental",get_effect_description:()=>"Reduces environmental penalty in extremly dark areas",milestones:{1:{stats:{intuition:{flat:1}},xp_multipliers:{"Night vision":1.2}},2:{xp_multipliers:{Evasion:1.1,"Shield blocking":1.2}},4:{stats:{intuition:{flat:1}},xp_multipliers:{Combat:1.1,Perception:1.1}},5:{xp_multipliers:{all_skill:1.05,"Night vision":1.2},stats:{intuition:{multiplier:1.1}}},7:{stats:{intuition:{flat:2}},xp_multipliers:{hero:1.05,"Night vision":1.2,Perception:1.1}},10:{xp_multipliers:{all_skill:1.05,"Night vision":1.2,Perception:1.2}},12:{xp_multipliers:{all:1.05,Perception:1.1},stats:{intuition:{flat:5,multiplier:1.05}}},15:{xp_multipliers:{all_skill:1.05,"Night vision":1.2,Perception:1.1}},20:{xp_multipliers:{all:1.1,Perception:1.1,Combat:1.1,"Spatial awareness":1.1},stats:{intuition:{multiplier:1.1}}}}}),f["Strength of mind"]=new W({names:{0:"Strength of mind",15:"Iron will",30:"Heart of steel"},description:"Resist and reject the unnatural influence. Turn your psyche into an iron fortress",category:"Environmental",flavour_text:"Blessed is the mind too small for doubt.",base_xp_cost:400,max_level:40,xp_scaling:1.7,get_effect_description:()=>"Reduces eldritch effects",milestones:{1:{xp_multipliers:{all_skill:1.05}},2:{stats:{intuition:{flat:1}},xp_multipliers:{Literacy:1.05,Persistence:1.05,Fortitude:1.05,Perception:1.1}},3:{xp_multipliers:{hero:1.05}},5:{xp_multipliers:{all_skill:1.05}},7:{stats:{intuition:{flat:1}},xp_multipliers:{Literacy:1.05,Persistence:1.05,Fortitude:1.05}},8:{xp_multipliers:{hero:1.05}},10:{xp_multipliers:{all:1.05,Perception:1.1}},12:{stats:{intuition:{multiplier:1.05}},xp_multipliers:{Literacy:1.05,Persistence:1.05,Fortitude:1.05}},15:{stats:{intuition:{flat:5,multiplier:1.05}}},20:{stats:{intuition:{multiplier:1.1}},xp_multipliers:{all:1.1,Literacy:1.1,Persistence:1.1,Fortitude:1.1}}}}),f.Scrambling=new W({names:{0:"Scrambling"},description:"Ability to act quickly and with secure footing in rough, loose, or unstable ground",category:"Environmental",base_xp_cost:400,max_level:60,xp_scaling:1.7,get_effect_description:()=>"Reduces environmental penalty in rough terrain",milestones:{1:{stats:{dexterity:{flat:1},agility:{flat:1},max_stamina:{multiplier:1.1}}},3:{stats:{dexterity:{multiplier:1.05},agility:{multiplier:1.05}}},5:{stats:{dexterity:{flat:3},agility:{flat:3}},xp_multipliers:{Running:1.2}},8:{stats:{stamina_regeneration_flat:{flat:.2},stamina_efficiency:{multiplier:1.05}}},10:{stats:{attack_speed:{multiplier:1.01}}},13:{stats:{dexterity:{flat:2},agility:{flat:2},max_stamina:{multiplier:1.2}}},15:{stats:{dexterity:{multiplier:1.1},agility:{multiplier:1.1}}},18:{stats:{dexterity:{flat:4},agility:{flat:4}},xp_multipliers:{Scrambling:1.2}},20:{stats:{attack_speed:{multiplier:1.02},stamina_regeneration_flat:{flat:.3},stamina_efficiency:{multiplier:1.05}}}}}),f["Heat resistance"]=new W({names:{0:"Heat resistance"},description:"Ability to survive and function in high temperatures",base_xp_cost:100,max_level:40,category:"Environmental"}),f["Cold resistance"]=new W({names:{0:"Cold resistance"},description:"Ability to survive and function in low temperatures",base_xp_cost:200,xp_scaling:1.8,max_level:40,category:"Environmental",get_effect_description:()=>`Increases cold tolerance by ${f["Cold resistance"].current_level*.5}`}),f["Dazzle resistance"]=new W({names:{0:"Dazzle resistance"},description:"Don't look at the sun, it's bad for your eyes",base_xp_cost:60,max_level:30,category:"Environmental",get_effect_description:()=>"Reduces hit and evasion penalty in super bright areas",max_level_bonus:.5})})();(function(){f["Weapon mastery"]=new W({names:{0:"Weapon proficiency",15:"Weapon mastery"},description:"Knowledge of all weapons",category:"Weapon",get_effect_description:()=>"Increases xp gains of all weapon skills of level lower than this, x1.1 per level of difference"}),f.Swords=new W({parent_skill:"Weapon mastery",names:{0:"Swordsmanship"},category:"Weapon",description:"The noble art of swordsmanship",get_effect_description:()=>`Multiplies damage dealt with swords by ${Math.round(R({skill_id:"Swords",scaling_type:"multiplicative"})*1e3)/1e3}.
Multiplies AP with swords by ${Math.round(R({skill_id:"Swords",scaling_type:"multiplicative"})**.3333*1e3)/1e3}`,milestones:{1:{stats:{dexterity:{flat:1}}},3:{stats:{agility:{flat:1}}},5:{stats:{strength:{flat:1},crit_rate:{flat:.01}}},7:{stats:{dexterity:{flat:1}}},10:{stats:{agility:{flat:1},crit_multiplier:{flat:.1}}},12:{stats:{dexterity:{flat:2}}}},max_level_coefficient:8}),f.Axes=new W({parent_skill:"Weapon mastery",names:{0:"Axe combat"},category:"Weapon",description:"Ability to fight with axes",get_effect_description:()=>`Multiplies damage dealt with axes by ${Math.round(R({skill_id:"Axes",scaling_type:"multiplicative"})*1e3)/1e3}.
Multiplies AP with axes by ${Math.round(R({skill_id:"Axes",scaling_type:"multiplicative"})**.3333*1e3)/1e3}`,milestones:{1:{stats:{dexterity:{flat:1}}},3:{stats:{strength:{flat:1}}},5:{stats:{dexterity:{flat:1},strength:{flat:1}}},7:{stats:{dexterity:{flat:1}}},10:{stats:{strength:{multiplier:1.05}}},12:{stats:{dexterity:{flat:2}}}},max_level_coefficient:8}),f.Spears=new W({parent_skill:"Weapon mastery",names:{0:"Spearmanship"},category:"Weapon",description:"The ability to fight with the most deadly weapon in history",get_effect_description:()=>`Multiplies damage dealt with spears by ${Math.round(R({skill_id:"Spears",scaling_type:"multiplicative"})*1e3)/1e3}.
Multiplies AP with spears by ${Math.round(R({skill_id:"Spears",scaling_type:"multiplicative"})**.3333*1e3)/1e3}`,milestones:{1:{stats:{dexterity:{flat:1}}},3:{stats:{dexterity:{flat:1}}},5:{stats:{strength:{flat:1},crit_rate:{flat:.01}}},7:{stats:{dexterity:{flat:1}}},10:{stats:{strength:{flat:1},crit_multiplier:{flat:.1}}},12:{stats:{dexterity:{flat:2}}}},max_level_coefficient:8}),f.Hammers=new W({parent_skill:"Weapon mastery",names:{0:"Hammer combat"},category:"Weapon",description:"Ability to fight with battle hammers. Why bother trying to cut someone, when you can just crack all their bones?",get_effect_description:()=>`Multiplies damage dealt with battle hammers by ${Math.round(R({skill_id:"Hammers",scaling_type:"multiplicative"})*1e3)/1e3}.
Multiplies AP with hammers by ${Math.round(R({skill_id:"Hammers",scaling_type:"multiplicative"})**.3333*1e3)/1e3}`,milestones:{1:{stats:{strength:{flat:1}}},3:{stats:{strength:{flat:1}}},5:{stats:{strength:{flat:1},dexterity:{flat:1}}},7:{stats:{strength:{flat:1}}},10:{stats:{strength:{flat:1},dexterity:{flat:1}}},12:{stats:{dexterity:{flat:2}}}},max_level_coefficient:8}),f.Daggers=new W({parent_skill:"Weapon mastery",names:{0:"Dagger combat"},category:"Weapon",description:"The disdained art of fighting (and stabbing) with daggers",get_effect_description:()=>`Multiplies damage dealt with daggers by ${Math.round(R({skill_id:"Daggers",scaling_type:"multiplicative"})*1e3)/1e3}.
Multiplies AP with daggers by ${Math.round(R({skill_id:"Daggers",scaling_type:"multiplicative"})**.3333*1e3)/1e3}`,milestones:{1:{stats:{dexterity:{flat:1}}},3:{stats:{agility:{flat:1}}},5:{stats:{crit_multiplier:{flat:.1},crit_rate:{flat:.01}}},7:{stats:{dexterity:{flat:1}}},10:{stats:{crit_rate:{flat:.02},crit_multiplier:{flat:.1}}},12:{stats:{dexterity:{flat:2}}}},max_level_coefficient:8}),f.Wands=new W({parent_skill:"Weapon mastery",names:{0:"Wand casting"},category:"Weapon",description:"Ability to cast spells with magic wands, increases damage dealt",get_effect_description:()=>`Multiplies damage dealt with wands by ${Math.round(R({skill_id:"Wands",scaling_type:"multiplicative"})*1e3)/1e3}`,max_level_coefficient:8}),f.Staffs=new W({parent_skill:"Weapon mastery",names:{0:"Staff casting"},category:"Weapon",description:"Ability to cast spells with magic staffs, increases damage dealt",get_effect_description:()=>`Multiplies damage dealth with staffs by ${Math.round(R({skill_id:"Staffs",scaling_type:"multiplicative"})*1e3)/1e3}`,max_level_coefficient:8})})();(function(){f.Farming=new W({names:{0:"Farming"},description:"Even a simple action of plowing some fields, can be performed better with skills and experience",base_xp_cost:40,category:"Activity",max_level:10,xp_scaling:1.6,max_level_coefficient:2,milestones:{1:{stats:{max_stamina:{flat:2}}},2:{stats:{strength:{flat:1}}},3:{stats:{dexterity:{flat:1},max_stamina:{flat:2}}},4:{stats:{strength:{flat:1},max_stamina:{flat:2}}},5:{stats:{strength:{flat:1},max_stamina:{flat:2}},xp_multipliers:{Herbalism:1.05}},6:{stats:{strength:{flat:1}},xp_multipliers:{Weightlifting:1.1}},7:{stats:{dexterity:{flat:1},max_stamina:{flat:2}},xp_multipliers:{Unarmed:1.05}},8:{stats:{strength:{flat:1},max_stamina:{flat:2}}},9:{stats:{strength:{flat:1},dexterity:{flat:1}}},10:{stats:{max_stamina:{flat:4},strength:{multiplier:1.05},dexterity:{multiplier:1.05}},xp_multipliers:{Unarmed:1.1,Herbalism:1.1}}}})})();(function(){f.Sleeping=new W({names:{0:"Sleeping"},description:"Good, regular sleep is the basis of getting stronger and helps your body heal",get_effect_description:()=>`Multiplies health restored when sleeping by ${Math.round(100*(1+K("Sleeping")/f.Sleeping.max_level))/100}`,base_xp_cost:1e3,flavour_text:"One rat, two rats, three rats...",visibility_treshold:300,xp_scaling:2,category:"Activity",max_level:10,max_level_coefficient:2.5,milestones:{2:{stats:{max_health:{flat:10,multiplier:1.04}},xp_multipliers:{all:1.05}},4:{stats:{max_health:{flat:20,multiplier:1.04}},xp_multipliers:{all:1.05}},5:{unlocks:{skills:["Meditation"]}},6:{stats:{max_health:{flat:30,multiplier:1.04}},xp_multipliers:{all:1.05,Meditation:1.1}},8:{stats:{max_health:{flat:30,multiplier:1.04}},xp_multipliers:{all:1.05}},10:{stats:{max_health:{flat:40,multiplier:1.1}},xp_multipliers:{all:1.1,Meditation:1.2},unlocks:{recipes:[{category:"crafting",subcategory:"items",recipe_id:"Simple dream catcher"}]}}}}),f.Meditation=new W({names:{0:"Meditation"},description:"Focus your mind",base_xp_cost:200,category:"Activity",max_level:30,max_level_coefficient:2,is_unlocked:!1,visibility_treshold:0,milestones:{2:{stats:{intuition:{flat:1}},xp_multipliers:{all:1.05,"Presence sensing":1.05}},4:{stats:{intuition:{flat:1,multiplier:1.05}},xp_multipliers:{all:1.05,"Strength of mind":1.05}},5:{xp_multipliers:{Sleeping:1.1,Breathing:1.1,"Presence sensing":1.05}},6:{stats:{intuition:{flat:2}},xp_multipliers:{"Strength of mind":1.05}},8:{stats:{intuition:{multiplier:1.05}},xp_multipliers:{all:1.05,Sleeping:1.1,Breathing:1.1,"Presence sensing":1.05}},10:{stats:{intuition:{flat:2,multiplier:1.05}},xp_multipliers:{all:1.1,Sleeping:1.1,Breathing:1.1,"Presence sensing":1.1,"Strength of mind":1.1}},12:{stats:{intuition:{flat:2}},xp_multipliers:{all:1.05,"Presence sensing":1.1}},15:{xp_multipliers:{all:1.1}},20:{stats:{intuition:{multiplier:1.05}},xp_multipliers:{all_skill:1.1,"Presence sensing":1.2,Sleeping:1.2}}},get_effect_description:()=>{let e=R({skill_id:"Meditation",scaling_type:"multiplicative"});return`Multiplies intuition ${Math.round(e*100)/100}`}}),f.Running=new W({description:"Great way to improve the efficiency of the body",names:{0:"Running"},max_level:50,category:"Activity",max_level_coefficient:2,base_xp_cost:50,milestones:{1:{stats:{agility:{flat:1}}},3:{stats:{agility:{flat:1}},xp_multipliers:{Breathing:1.1}},5:{stats:{agility:{flat:1},max_stamina:{multiplier:1.05}}},7:{stats:{agility:{flat:1,multiplier:1.05}},xp_multipliers:{Breathing:1.05}},10:{stats:{agility:{flat:1,multiplier:1.05},max_stamina:{multiplier:1.05}},xp_multipliers:{Breathing:1.1}},12:{stats:{agility:{flat:2},max_stamina:{flat:5}},xp_multipliers:{Breathing:1.05},unlocks:{quests:["Swimming/climbing unlock","Swimming alternative unlock"]}},15:{stats:{agility:{flat:3},max_stamina:{flat:5}},xp_multipliers:{Breathing:1.1}},20:{stats:{agility:{multiplier:1.05},max_stamina:{multiplier:1.1}},xp_multipliers:{Breathing:1.2}}},get_effect_description:()=>{let e=R({skill_id:"Running",scaling_type:"multiplicative"});return`Multiplies stamina efficiency by ${Math.round(e*100)/100}`}}),f.Weightlifting=new W({description:"No better way to get stronger than by lifting heavy things",names:{0:"Weightlifting"},max_level:50,category:"Activity",max_level_coefficient:4,base_xp_cost:50,milestones:{1:{stats:{strength:{flat:1}}},3:{stats:{strength:{flat:1}},xp_multipliers:{Unarmed:1.05}},5:{stats:{strength:{flat:1,multiplier:1.05},max_stamina:{multiplier:1.05}}},7:{stats:{strength:{flat:1}},xp_multipliers:{Unarmed:1.1}},10:{stats:{strength:{flat:1,multiplier:1.05},max_stamina:{multiplier:1.05}}},12:{stats:{strength:{flat:2},max_stamina:{flat:5}},unlocks:{quests:["Swimming/climbing unlock","Swimming alternative unlock"]}},15:{stats:{strength:{flat:2},max_stamina:{flat:5}}},20:{stats:{strength:{flat:5,multiplier:1.05},max_stamina:{flat:20}}}},get_effect_description:()=>{let e=R({skill_id:"Weightlifting",scaling_type:"multiplicative"});return`Multiplies strength by ${Math.round(e*100)/100}`}}),f.Swimming=new W({description:"A nice, gentle, and relaxing exercise. Just remember to be careful",get_effect_description:()=>{let e=R({skill_id:"Swimming",scaling_type:"multiplicative"});return`Multiplies agility and stamina by ${Math.round(e*100)/100}. Reduces environmental penalty in aquatic areas.`},names:{0:"Swimming"},max_level:50,category:"Activity",max_level_coefficient:2,base_xp_cost:50,milestones:{1:{stats:{agility:{flat:1}}},3:{stats:{strength:{flat:1}},xp_multipliers:{Breathing:1.05}},5:{stats:{agility:{multiplier:1.05},max_stamina:{multiplier:1.05}}},7:{stats:{agility:{flat:1}},xp_multipliers:{Breathing:1.1}},10:{stats:{agility:{multiplier:1.05},max_stamina:{multiplier:1.05}}},12:{stats:{agility:{flat:2},max_stamina:{flat:10}}},15:{stats:{agility:{flat:2},max_stamina:{flat:10}},xp_multipliers:{Breathing:1.1}},20:{stats:{agility:{multiplier:1.05},stamina_efficiency:{multiplier:1.05}},xp_multipliers:{Breathing:1.2}}}}),f.Equilibrium=new W({description:"Nothing will throw you off your balance (at least the physical one)",names:{0:"Equilibrium"},category:"Activity",max_level:50,max_level_coefficient:4,base_xp_cost:50,milestones:{1:{stats:{agility:{flat:1}}},3:{stats:{intuition:{flat:1}}},5:{stats:{agility:{flat:1,multiplier:1.05},strength:{flat:1},max_stamina:{multiplier:1.05}},xp_multipliers:{Unarmed:1.1}},7:{stats:{intuition:{flat:1}}},9:{stats:{strength:{flat:1}}},10:{stats:{agility:{flat:1},intuition:{multiplier:1.05},max_stamina:{multiplier:1.05}}},12:{stats:{agility:{flat:1},strength:{flat:1}}},15:{stats:{agility:{flat:5},strength:{flat:5}}},20:{stats:{intuition:{multiplier:1.05}},xp_multipliers:{Unarmed:1.2}}},get_effect_description:()=>{let e=R({skill_id:"Equilibrium",scaling_type:"multiplicative"});return`Multiplies agility by ${Math.round(e*100)/100}`}}),f.Climbing=new W({description:"Intense and slightly dangerous form of training that involves majority of your muscles",names:{0:"Climbing"},max_level:50,category:"Activity",max_level_coefficient:2,base_xp_cost:50,milestones:{1:{stats:{agility:{flat:1}}},3:{stats:{strength:{flat:1}}},5:{stats:{agility:{multiplier:1.05},max_stamina:{multiplier:1.03}}},7:{stats:{strength:{flat:1}}},10:{stats:{strength:{multiplier:1.05},max_stamina:{multiplier:1.03}},xp_multipliers:{Perception:1.1}},12:{stats:{strength:{flat:2},agility:{flat:2}}},15:{stats:{agility:{multiplier:1.05},max_stamina:{multiplier:1.05}}},20:{stats:{strength:{multiplier:1.05},intuition:{flat:3}}}},get_effect_description:()=>{let e=R({skill_id:"Climbing",scaling_type:"multiplicative"});return`Multiplies strength, dexterity and agility by ${Math.round(e*100)/100}`}})})();(function(){f.Woodcutting=new W({names:{0:"Woodcutting"},description:"Get better with chopping the wood",category:"Gathering",base_xp_cost:10,visibility_treshold:4,xp_scaling:1.6}),f.Mining=new W({names:{0:"Mining"},description:"Get better with mining the ores",category:"Gathering",base_xp_cost:10,visibility_treshold:4,xp_scaling:1.6}),f.Digging=new W({names:{0:"Digging"},description:"Get better with swinging the shovel",category:"Gathering",base_xp_cost:10,visibility_treshold:4,xp_scaling:1.6}),f.Herbalism=new W({names:{0:"Herbalism"},description:"Knowledge of useful plants and mushrooms",category:"Gathering",base_xp_cost:10,visibility_treshold:4,xp_scaling:1.6}),f["Animal handling"]=new W({names:{0:"Animal handling"},description:"Knowledge and skills required to deal with a wide variety of animals",category:"Gathering",base_xp_cost:10,visibility_treshold:4,xp_scaling:1.6}),f.Fishing=new W({names:{0:"Fishing"},description:"Get better at luring all kinds of fish",category:"Gathering",base_xp_cost:10,visibility_treshold:4,xp_scaling:1.6,milestones:{1:{stats:{intuition:{flat:1}}},3:{stats:{intuition:{flat:1}},xp_multipliers:{Persistence:1.1}},5:{stats:{intuition:{multiplier:1.05},dexterity:{flat:1}},xp_multipliers:{Perception:1.1}},7:{stats:{intuition:{flat:2}}},9:{stats:{intuition:{flat:2}}},10:{stats:{intuition:{multiplier:1.05},dexterity:{flat:2}},xp_multipliers:{Perception:1.1,Meditation:1.1}},12:{stats:{intuition:{flat:4}},xp_multipliers:{"Presence sensing":1.2}},15:{stats:{intuition:{multiplier:1.05},dexterity:{flat:3}},xp_multipliers:{Perception:1.1,Swimming:1.05,"Animal handling":1.05}},18:{stats:{intuition:{flat:5}},xp_multipliers:{Perception:1.1,Persistence:1.1}},20:{stats:{intuition:{multiplier:1.1,flat:5},dexterity:{flat:5}},xp_multipliers:{all:1.05,"Presence sensing":1.2,Meditation:1.2}}}})})();(function(){f["Crafting mastery"]=new W({skill_id:"Crafting mastery",names:{0:"Crafting proficiency",15:"Crafting mastery"},description:"A mastery of the minor crafting branches like tinkering, woodworking, or butchering",category:Ti,base_xp_cost:40,xp_scaling:1.5,max_level:60,milestones:{5:{stats:{dexterity:{multiplier:1.05}}},10:{stats:{dexterity:{multiplier:1.05}}},15:{stats:{dexterity:{multiplier:1.05}}},20:{stats:{dexterity:{multiplier:1.05}}},25:{stats:{dexterity:{multiplier:1.05}}},30:{stats:{dexterity:{multiplier:1.05}}}}}),f.Crafting=new W({names:{0:"Tinkering"},description:"Turn smaller pieces into one bigger thing",category:Ti,parent_skill:"Crafting mastery",base_xp_cost:40,xp_scaling:1.5,max_level:60,get_effect_description:()=>`Quality cap: ${Ei("Crafting").components}% for comps, ${Ei("Crafting").equipment}% for eq`}),f.Smelting=new W({names:{0:"Smelting"},description:"Turning raw ore into raw metal",category:Ti,base_xp_cost:40,xp_scaling:1.5,max_level:60}),f.Forging=new W({names:{0:"Forging"},description:"Turning raw metal into something useful",category:Ti,base_xp_cost:40,xp_scaling:1.5,max_level:60,get_effect_description:()=>`Quality cap: ${Ei("Forging").components}% for components`,milestones:{10:{unlocks:{recipes:[{category:"smelting",subcategory:"items",recipe_id:"Steel ingot (inefficient)"}]}}}}),f.Cooking=new W({names:{0:"Cooking"},description:"Making the inedible edible",category:Ti,base_xp_cost:40,xp_scaling:1.5,max_level:60}),f.Alchemy=new W({names:{0:"Alchemy"},description:"Extracting and enhancing useful properties of the ingredients",category:Ti,base_xp_cost:40,xp_scaling:1.5,max_level:60}),f.Butchering=new W({skill_id:"Butchering",names:{0:"Butchering"},description:"Making the most of what you kill",category:Ti,parent_skill:"Crafting mastery",base_xp_cost:40,xp_scaling:1.5,max_level_coefficient:2,max_level:60,is_unlocked:!1,visibility_treshold:0,get_effect_description:()=>{let e=R({skill_id:"Butchering",scaling_type:"multiplicative"});return`Multiplies drop chances from Beasts by ${Math.round(e*100)/100}`}}),f.Woodworking=new W({skill_id:"Woodworking",names:{0:"Woodworking"},description:"Turning wood logs into something useful",category:Ti,parent_skill:"Crafting mastery",base_xp_cost:40,xp_scaling:1.5,max_level:60})})();(function(){f["Iron skin"]=new W({category:"Combat",names:{0:"Tough skin",10:"Wooden skin",20:"Stone skin",30:"Iron skin"},description:"Wearing no protective armor means that your skin keeps getting damaged in combat, which leads to it regenerating over and over to become tougher",base_xp_cost:400,xp_scaling:1.9,max_level:30,max_level_bonus:30,get_effect_description:()=>`Increases base defense by ${Math.round($t("Iron skin"))}`,milestones:{3:{stats:{max_health:{multiplier:1.01}}},5:{stats:{max_health:{multiplier:1.01},unarmed_power:{flat:.4}}},7:{stats:{max_health:{multiplier:1.02}},xp_multipliers:{Fortitude:1.05}},10:{stats:{max_health:{multiplier:1.02},unarmed_power:{flat:.6}}},12:{stats:{max_health:{multiplier:1.02}},xp_multipliers:{Fortitude:1.05}},15:{stats:{max_health:{multiplier:1.1},unarmed_power:{flat:1}}},20:{stats:{max_health:{multiplier:1.1}},xp_multipliers:{Fortitude:1.2,Persistence:1.2}}}}),f.Fortitude=new W({category:"Combat",names:{0:"Fortitude"},description:"Pretend the wounds are not there",base_xp_cost:200,xp_scaling:1.6,max_level:60,max_level_coefficient:4,get_effect_description:()=>`Multiplies max health by ${Math.round(100*R({scaling_type:"multiplicative",skill_id:"Fortitude"}))/100}`,milestones:{3:{stats:{max_health:{multiplier:1.01}}},5:{stats:{defense:{flat:1}},xp_multipliers:{"Iron skin":1.05}},7:{stats:{max_health:{multiplier:1.02}}},10:{stats:{defense:{flat:1}},xp_multipliers:{"Iron skin":1.05}},12:{stats:{max_health:{multiplier:1.02}}},15:{stats:{max_health:{multiplier:1.05}}},20:{stats:{max_health:{multiplier:1.02}},xp_multipliers:{"Iron skin":1.2,Persistence:1.2}}}})})();(function(){f.Persistence=new W({names:{0:"Persistence"},description:"Do not give up, no matter what",flavour_text:"Believe in me that believes in you!",base_xp_cost:60,category:"Character",max_level:30,get_effect_description:()=>`Increases low stamina stat multiplier to x${(50+Math.round($t("Persistence")*1e5)/1e3)/100} (originally x0.5)`,milestones:{2:{stats:{max_stamina:{flat:5}},xp_multipliers:{all_skill:1.05}},4:{stats:{max_stamina:{flat:5}},xp_multipliers:{hero:1.05}},6:{stats:{max_stamina:{flat:10},heat_tolerance:{flat:1},cold_tolerance:{flat:1}},xp_multipliers:{all:1.05,"Strength of mind":1.05}},8:{stats:{max_stamina:{flat:10}},xp_multipliers:{all:1.05}},10:{stats:{max_stamina:{multiplier:1.1}},xp_multipliers:{hero:1.05,"Strength of mind":1.05}},12:{stats:{max_stamina:{flat:10},heat_tolerance:{flat:1},cold_tolerance:{flat:1}},xp_multipliers:{hero:1.05}},15:{stats:{stamina_efficiency:{multiplier:1.1}},xp_multipliers:{all_skill:1.05,"Strength of mind":1.05}},20:{stats:{stamina_efficiency:{multiplier:1.1},max_stamina:{flat:10},heat_tolerance:{flat:1},cold_tolerance:{flat:1}},xp_multipliers:{all:1.1}}},max_level_bonus:.3}),f.Perception=new W({names:{0:"Perception"},description:"Better grasp on your senses allows you to notice small and hidden things, as well as to discern the true nature of what you observe",base_xp_cost:100,visibility_treshold:80,xp_scaling:1.8,max_level:40,category:"Character",get_effect_description:()=>`Increases critical hit chance by ${Math.min(f.Perception.max_level,K("Perception"))} points`,milestones:{1:{stats:{intuition:{flat:2},dexterity:{flat:2}},xp_multipliers:{all:1.05}},3:{stats:{intuition:{flat:2},dexterity:{flat:2},crit_multiplier:{flat:.1}}},5:{xp_multipliers:{Herbalism:1.1,Fishing:1.1}},7:{stats:{intuition:{flat:2},dexterity:{multiplier:1.1},crit_multiplier:{flat:.1}}},10:{xp_multipliers:{Herbalism:1.2,Fishing:1.2,hero:1.1}},15:{stats:{intuition:{flat:5},dexterity:{multiplier:1.1},crit_multiplier:{flat:.2}}},20:{xp_multipliers:{Herbalism:1.2,Fishing:1.2,hero:1.2},stats:{intuition:{flat:10},dexterity:{multiplier:1.1},crit_multiplier:{flat:.2}}}}}),f.Literacy=new W({names:{0:"Literacy"},description:"Ability to read and understand written text",category:"Character",base_xp_cost:120,max_level:10,xp_scaling:2,milestones:{1:{xp_multipliers:{hero:1.05,"Strength of mind":1.05}},2:{xp_multipliers:{all_skill:1.05}},3:{xp_multipliers:{all:1.05}},5:{xp_multipliers:{hero:1.05,"Strength of mind":1.05}}}}),f.Medicine=new W({names:{0:"Medicine"},description:"Create better medicaments and improve your skill at treating wounds",category:"Character",max_level:30,visibility_treshold:5,max_level_coefficient:2,get_effect_description:()=>{let e=R({skill_id:"Medicine",scaling_type:"multiplicative"});return`Multiplies additive effects of medicines by ${Math.round(e**2*100)/100} and multiplicative effects by ${Math.round(e*100)/100}`}}),f.Gluttony=new W({names:{0:"Gluttony"},description:"The more you eat the better you will be at digesting, right?",category:"Character",max_level:30,visibility_treshold:5,max_level_coefficient:2,get_effect_description:()=>{let e=R({skill_id:"Gluttony",scaling_type:"multiplicative"});return`Multiplies additive effects of foods by ${Math.round(e**2*100)/100} and multiplicative effects by ${Math.round(e*100)/100}`},milestones:{3:{xp_multipliers:{hero:1.05}},5:{stats:{max_health:{flat:20}},xp_multipliers:{Regeneration:1.1}},7:{stats:{health_regeneration_flat:{flat:.1}}},10:{stats:{stamina_regeneration_flat:{flat:.1},cold_tolerance:{flat:1}},xp_multipliers:{hero:1.05}},12:{stats:{health_regeneration_flat:{flat:.2}},xp_multipliers:{Regeneration:1.1}},15:{xp_multipliers:{Regeneration:1.1,Weightlifting:1.1,Running:1.1,Climbing:1.1,Swimming:1.1}},20:{stats:{stamina_regeneration_flat:{flat:.2},cold_tolerance:{flat:1}},xp_multipliers:{hero:1.1,Regeneration:1.2}}}}),f.Breathing=new W({names:{0:"Breathing"},description:"Oxygen is the most important resource for improving the performance of your body. Learn how to take it in more efficiently",flavour_text:"You are now breathing manually",base_xp_cost:400,visibility_treshold:390,xp_scaling:1.6,category:"Character",max_level_coefficient:2,max_level:40,milestones:{3:{xp_multipliers:{Running:1.1,Meditation:1.1},stats:{attack_speed:{multiplier:1.02}}},5:{stats:{agility:{multiplier:1.05},stamina_efficiency:{multiplier:1.05}}},7:{xp_multipliers:{Running:1.1,Meditation:1.1},stats:{stamina_regeneration_flat:{flat:.1}}},10:{stats:{strength:{multiplier:1.05},max_stamina:{multiplier:1.05},attack_speed:{multiplier:1.02}}},12:{stats:{strength:{flat:2},agility:{flat:2}},xp_multipliers:{Running:1.1,Meditation:1.1}},15:{xp_multipliers:{Running:1.1,Meditation:1.1},stats:{attack_speed:{multiplier:1.02},stamina_efficiency:{multiplier:1.05},stamina_regeneration_flat:{flat:.1}}},20:{xp_multipliers:{category_Activity:1.2},stats:{attack_speed:{multiplier:1.02},stamina_efficiency:{multiplier:1.05}}}},get_effect_description:()=>{let e=R({skill_id:"Breathing",scaling_type:"multiplicative"});return`Multiplies strength, agility and stamina by ${Math.round(e*100)/100}. Reduces thin air effects`}}),f.Regeneration=new W({names:{0:"Regeneration"},description:"As your body regenerates more and more, it slowly becomes more proficient in this task",get_effect_description:()=>`Multiplies health restored when resting or sleeping by ${Math.round(100*(1+3*K("Regeneration")/f.Regeneration.max_level))/100}`,base_xp_cost:1e3,visibility_treshold:500,xp_scaling:1.5,category:"Character",max_level:40,max_level_coefficient:2.5,milestones:{1:{stats:{max_health:{flat:10}}},3:{stats:{max_health:{flat:10}}},5:{stats:{health_regeneration_flat:{flat:.1}}},7:{stats:{max_health:{flat:20}}},10:{stats:{max_health:{flat:20},health_regeneration_flat:{flat:.2}}},12:{stats:{max_health:{flat:20}}},15:{stats:{health_regeneration_flat:{flat:.4},max_health:{flat:40}}},20:{stats:{max_health:{multiplier:1.1}},xp_multipliers:{"Iron skin":1.2,Fortitude:1.2}}}})})();(function(){f.Haggling=new W({names:{0:"Haggling"},description:"The art of the deal",category:"Character",base_xp_cost:100,max_level:25,get_effect_description:()=>`Lowers trader cost multiplier to ${Math.round((1-$t("Haggling"))*100)}% of original value`,max_level_bonus:.5,milestones:{2:{stats:{intuition:{flat:1}}},3:{xp_multipliers:{Literacy:1.05}},5:{stats:{intuition:{flat:2}},xp_multipliers:{Literacy:1.05,Persistence:1.05,Perception:1.05}},7:{stats:{intuition:{flat:2}}},10:{stats:{intuition:{flat:2}},xp_multipliers:{Literacy:1.05,Persistence:1.05,Perception:1.1}},15:{stats:{intuition:{flat:5}},xp_multipliers:{Literacy:1.1,Persistence:1.1,Perception:1.1}}}})})();Object.keys(f).forEach(e=>{f[e].skill_id=e});var F={},ka={},Ki=class extends Ii{constructor({name:t,display_name:i,trade_text:a,unlock_message:s=null,location_name:n,refresh_time:o=4,refresh_shift:l=0,inventory_template:d,profit_margin:u=3,is_unlocked:h=!0}){super(),this.name=t,this.display_name=i||t,this.trade_text=a||`Trade with ${this.display_name}`,this.unlock_message=s,this.location_name=n,this.last_refresh=-1,this.refresh_time=o,this.refresh_shift=l,this.inventory_template=d,this.profit_margin=u,this.is_unlocked=h,this.is_finished=!1}refresh(){return this.can_refresh()?(this.inventory=this.get_inventory_from_template(),this.last_refresh=E.day_count+1-E.day_count%this.refresh_time,!0):!1}can_refresh(){return this.last_refresh<0||E.day_count-(this.last_refresh+this.refresh_shift)>=this.refresh_time}get_inventory_from_template(){let t={},i=ka[this.inventory_template];for(let a=0;a<i.length;a++)if(i[a].chance>=Math.random()){let s=i[a].count.length==1?i[a].count[0]:Math.round(Math.random()*(i[a].count[1]-i[a].count[0])+i[a].count[0]);if(i[a].quality){let n=Math.round(Math.random()*(i[a].quality[1]-i[a].quality[0])+i[a].quality[0]),o=be({...c[i[a].item_name],quality:n});t[o.getInventoryKey()]={item:o,count:s}}else t[c[i[a].item_name].getInventoryKey()]={item:be(c[i[a].item_name]),count:s}}return t}getProfitMargin(t){let i=1-$t("Haggling"),a=1-Math.min(1e3,r.reputation[t])/2e3||1;return 1+(this.profit_margin-1)*i*a}},p=class{constructor({item_name:t,chance:i=1,count:a=[1],quality:s=null}){this.item_name=t,this.chance=i,this.count=a,this.quality=s}};(function(){F["village trader"]=new Ki({name:"village trader",inventory_template:"Basic",is_unlocked:!1,location_name:"Village",trade_text:"Trade on the village market",unlock_message:"You can now visit the village market"}),F["suspicious trader"]=new Ki({name:"suspicious trader",inventory_template:"Basic plus",is_unlocked:!0,location_name:"Slums",profit_margin:5}),F["suspicious trader 2"]=new Ki({name:"suspicious trader 2",display_name:"suspicious trader",inventory_template:"Intermediate",is_unlocked:!1,location_name:"Slums",profit_margin:4}),F["swampland trader"]=new Ki({name:"swampland trader",inventory_template:"Swamp",is_unlocked:!0,location_name:"Swampland tribe",profit_margin:7}),F["swampland trader 2"]=new Ki({name:"swampland trader",inventory_template:"Swamp plus",is_unlocked:!1,location_name:"Swampland tribe",profit_margin:5})})();(function(){ka.Basic=[new p({item_name:"Cheap iron spear",count:[1],quality:[40,90],chance:.8}),new p({item_name:"Cheap iron dagger",count:[1],quality:[40,90],chance:.8}),new p({item_name:"Cheap iron sword",count:[1],quality:[40,90],chance:.8}),new p({item_name:"Cheap iron axe",count:[1],quality:[40,90],chance:.8}),new p({item_name:"Cheap iron battle hammer",count:[1],quality:[40,90],chance:.8}),new p({item_name:"Cheap iron spear",count:[1],quality:[91,120],chance:.4}),new p({item_name:"Cheap iron dagger",count:[1],quality:[91,120],chance:.4}),new p({item_name:"Cheap iron sword",count:[1],quality:[91,120],chance:.4}),new p({item_name:"Cheap iron axe",count:[1],quality:[91,120],chance:.4}),new p({item_name:"Cheap iron battle hammer",count:[1],quality:[91,120],chance:.4}),new p({item_name:"Iron spear",count:[1],quality:[70,90],chance:.4}),new p({item_name:"Iron dagger",count:[1],quality:[70,90],chance:.4}),new p({item_name:"Iron sword",count:[1],quality:[70,90],chance:.4}),new p({item_name:"Iron axe",count:[1],quality:[70,90],chance:.4}),new p({item_name:"Iron battle hammer",count:[1],quality:[70,90],chance:.4}),new p({item_name:"Wooden training shield",count:[1],quality:[100,100]}),new p({item_name:"Cheap wooden shield",count:[1],quality:[40,90]}),new p({item_name:"Cheap wooden shield",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Crude wooden shield",count:[1],chance:.7,quality:[40,90]}),new p({item_name:"Crude wooden shield",count:[1],chance:.4,quality:[91,120]}),new p({item_name:"Cheap leather vest",count:[1],quality:[40,90]}),new p({item_name:"Cheap leather vest",count:[1],chance:.5,quality:[91,120]}),new p({item_name:"Cheap leather pants",count:[1],quality:[40,90]}),new p({item_name:"Cheap leather pants",count:[1],chance:.5,quality:[91,120]}),new p({item_name:"Cheap leather hat",count:[1],quality:[40,90]}),new p({item_name:"Cheap leather hat",count:[1],chance:.5,quality:[91,120]}),new p({item_name:"Cheap leather shoes",count:[1],chance:.5,quality:[91,120]}),new p({item_name:"Leather shoes",count:[1],chance:.4,quality:[91,120]}),new p({item_name:"Leather vest",count:[1],chance:.7,quality:[70,120]}),new p({item_name:"Leather pants",count:[1],chance:.7,quality:[70,120]}),new p({item_name:"Leather hat",count:[1],chance:.7,quality:[70,120]}),new p({item_name:"Leather gloves",count:[1],chance:.7,quality:[70,120]}),new p({item_name:"Work shoes",count:[1,2],chance:.6,quality:[100,100]}),new p({item_name:"Wolf leather armor",count:[1],chance:.3,quality:[60,120]}),new p({item_name:"Wolf leather armored pants",count:[1],chance:.3,quality:[60,120]}),new p({item_name:"Wolf leather helmet",count:[1],chance:.3,quality:[60,120]}),new p({item_name:"Rat pelt cape",count:[1,3],chance:1,quality:[70,120]}),new p({item_name:"Stale bread",count:[7,14]}),new p({item_name:"Bread kwas",count:[3,5],chance:.6}),new p({item_name:"Fresh bread",count:[4,7]}),new p({item_name:"Weak healing powder",count:[2,5]}),new p({item_name:"Cooking herbs",count:[2,4],chance:.5}),new p({item_name:"Coal",count:[5,20]}),new p({item_name:"ABC for kids",count:[1],chance:1}),new p({item_name:"Old combat manual",count:[1],chance:.5}),new p({item_name:"Butchering and you",count:[1],chance:.2}),new p({item_name:"Medicine for dummies",count:[1],chance:.2}),new p({item_name:"Ode to Whimsy, and other poems",count:[1],chance:.2}),new p({item_name:"A Glint On The Sand",count:[1],chance:.2}),new p({item_name:"Glass phial",count:[5,10],chance:1}),new p({item_name:"Glass bottle",count:[4,8],chance:1}),new p({item_name:"Camping supplies",count:[1,3],chance:1}),new p({item_name:"Coil of rope",count:[1,3],chance:1})],ka["Basic plus"]=[new p({item_name:"Iron spear",count:[1],quality:[70,90],chance:.8}),new p({item_name:"Iron dagger",count:[1],quality:[70,90],chance:.8}),new p({item_name:"Iron sword",count:[1],quality:[70,90],chance:.8}),new p({item_name:"Iron axe",count:[1],quality:[70,90],chance:.8}),new p({item_name:"Iron battle hammer",count:[1],quality:[40,80],chance:.8}),new p({item_name:"Iron spear",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Iron dagger",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Iron sword",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Iron axe",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Iron battle hammer",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Steel spear",count:[1],quality:[70,100],chance:.5}),new p({item_name:"Steel dagger",count:[1],quality:[70,100],chance:.5}),new p({item_name:"Steel sword",count:[1],quality:[70,100],chance:.5}),new p({item_name:"Steel axe",count:[1],quality:[70,100],chance:.5}),new p({item_name:"Steel battle hammer",count:[1],quality:[70,100],chance:.5}),new p({item_name:"Steel spear",count:[1],quality:[81,120],chance:.4}),new p({item_name:"Steel dagger",count:[1],quality:[81,120],chance:.4}),new p({item_name:"Steel sword",count:[1],quality:[81,120],chance:.4}),new p({item_name:"Steel axe",count:[1],quality:[81,120],chance:.4}),new p({item_name:"Steel battle hammer",count:[1],quality:[81,120],chance:.4}),new p({item_name:"Wooden shield",count:[1],quality:[40,80]}),new p({item_name:"Wooden shield",count:[1],chance:.8,quality:[81,120]}),new p({item_name:"Crude iron shield",count:[1],quality:[40,80]}),new p({item_name:"Crude iron shield",count:[1],chance:.8,quality:[81,120]}),new p({item_name:"Iron shield",count:[1],chance:.6,quality:[40,80]}),new p({item_name:"Iron shield",count:[1],chance:.4,quality:[81,120]}),new p({item_name:"Steel shield",count:[1],chance:.3,quality:[81,100]}),new p({item_name:"Ash wood shield",count:[1],chance:.3,quality:[81,100]}),new p({item_name:"Leather vest",count:[1],chance:.9,quality:[81,120]}),new p({item_name:"Leather pants",count:[1],chance:.9,quality:[81,120]}),new p({item_name:"Leather hat",count:[1],chance:.9,quality:[81,120]}),new p({item_name:"Leather shoes",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Leather gloves",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Work shoes",count:[2,3],chance:.6,quality:[100,100]}),new p({item_name:"Wolf leather armor",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Wolf leather armored pants",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Wolf leather helmet",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Rat pelt cape",count:[1,2],chance:.6,quality:[70,120]}),new p({item_name:"Wolf pelt cape",count:[1],chance:.9,quality:[70,120]}),new p({item_name:"Iron chainmail armor",count:[1],chance:.8,quality:[40,80]}),new p({item_name:"Iron chainmail armor",count:[1],chance:.6,quality:[81,120]}),new p({item_name:"Iron chainmail pants",count:[1],chance:.8,quality:[40,80]}),new p({item_name:"Iron chainmail pants",count:[1],chance:.6,quality:[81,120]}),new p({item_name:"Iron chainmail helmet",count:[1],chance:.8,quality:[40,80]}),new p({item_name:"Iron chainmail helmet",count:[1],chance:.6,quality:[81,120]}),new p({item_name:"Stale bread",count:[4,10]}),new p({item_name:"Fresh bread",count:[2,5]}),new p({item_name:"Bread kwas",count:[1,3]}),new p({item_name:"Weak healing powder",count:[2,5]}),new p({item_name:"Oneberry juice",count:[2,5]}),new p({item_name:"Cooking herbs",count:[1,4],chance:.6}),new p({item_name:"Coal",count:[20,50]}),new p({item_name:"Twist liek a snek",count:[1],chance:.8}),new p({item_name:"Butchering and you",count:[1],chance:.6}),new p({item_name:"Medicine for dummies",count:[1],chance:.6}),new p({item_name:"Ode to Whimsy, and other poems",count:[1],chance:.4}),new p({item_name:"A Glint On The Sand",count:[1],chance:.4}),new p({item_name:"Glass phial",count:[5,10],chance:1}),new p({item_name:"Glass bottle",count:[4,8],chance:1}),new p({item_name:"Camping supplies",count:[1],chance:1}),new p({item_name:"Coil of rope",count:[1],chance:1}),new p({item_name:"Iron sickle",count:[1],chance:.8}),new p({item_name:"Iron pickaxe",count:[1],chance:.8}),new p({item_name:"Iron chopping axe",count:[1],chance:.8}),new p({item_name:"Iron shovel",count:[1],chance:.8})],ka.Intermediate=[new p({item_name:"Iron spear",count:[1],quality:[100,120],chance:.8}),new p({item_name:"Iron dagger",count:[1],quality:[100,120],chance:.8}),new p({item_name:"Iron sword",count:[1],quality:[100,120],chance:.8}),new p({item_name:"Iron axe",count:[1],quality:[100,120],chance:.8}),new p({item_name:"Iron battle hammer",count:[1],quality:[100,120],chance:.8}),new p({item_name:"Steel spear",count:[1],quality:[80,100],chance:.8}),new p({item_name:"Steel dagger",count:[1],quality:[80,100],chance:.8}),new p({item_name:"Steel sword",count:[1],quality:[80,100],chance:.8}),new p({item_name:"Steel axe",count:[1],quality:[80,100],chance:.8}),new p({item_name:"Steel battle hammer",count:[1],quality:[80,100],chance:.8}),new p({item_name:"Steel spear",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Steel dagger",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Steel sword",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Steel axe",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Steel battle hammer",count:[1],quality:[81,120],chance:.8}),new p({item_name:"Wooden shield",count:[1],quality:[40,80]}),new p({item_name:"Wooden shield",count:[1],chance:.8,quality:[81,120]}),new p({item_name:"Crude iron shield",count:[1],quality:[40,80]}),new p({item_name:"Crude iron shield",count:[1],chance:.8,quality:[81,120]}),new p({item_name:"Iron shield",count:[1],chance:.6,quality:[40,80]}),new p({item_name:"Iron shield",count:[1],chance:.4,quality:[81,120]}),new p({item_name:"Steel shield",count:[1],chance:.4,quality:[81,120]}),new p({item_name:"Ash wood shield",count:[1],chance:.4,quality:[81,120]}),new p({item_name:"Leather vest",count:[1],chance:.9,quality:[81,120]}),new p({item_name:"Leather pants",count:[1],chance:.9,quality:[81,120]}),new p({item_name:"Leather hat",count:[1],chance:.9,quality:[81,120]}),new p({item_name:"Leather shoes",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Leather gloves",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Work shoes",count:[2,3],chance:.6,quality:[100,100]}),new p({item_name:"Goat leather vest",count:[1],chance:.5,quality:[81,120]}),new p({item_name:"Goat leather pants",count:[1],chance:.5,quality:[81,120]}),new p({item_name:"Goat leather hat",count:[1],chance:.5,quality:[81,120]}),new p({item_name:"Goat leather shoes",count:[1],chance:.5,quality:[81,120]}),new p({item_name:"Goat leather gloves",count:[1],chance:.5,quality:[81,120]}),new p({item_name:"Wolf leather armor",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Wolf leather armored pants",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Wolf leather helmet",count:[1],chance:.8,quality:[91,120]}),new p({item_name:"Iron chainmail armor",count:[1],chance:.8,quality:[81,120]}),new p({item_name:"Iron chainmail pants",count:[1],chance:.8,quality:[81,120]}),new p({item_name:"Iron chainmail helmet",count:[1],chance:.8,quality:[81,120]}),new p({item_name:"Steel chainmail armor",count:[1],chance:.6,quality:[81,120]}),new p({item_name:"Steel chainmail pants",count:[1],chance:.6,quality:[81,120]}),new p({item_name:"Steel chainmail helmet",count:[1],chance:.6,quality:[81,120]}),new p({item_name:"Wolf pelt cape",count:[1],chance:.9,quality:[70,120]}),new p({item_name:"Boar hide cape",count:[1],chance:.9,quality:[70,120]}),new p({item_name:"Goat hide cape",count:[1],chance:.9,quality:[70,120]}),new p({item_name:"Bear hide cape",count:[1],chance:.5,quality:[70,120]}),new p({item_name:"Fresh bread",count:[4,10]}),new p({item_name:"Bread kwas",count:[2,5]}),new p({item_name:"Weak healing powder",count:[2,5]}),new p({item_name:"Oneberry juice",count:[2,5]}),new p({item_name:"Healing powder",count:[2,5]}),new p({item_name:"Healing potion",count:[2,5]}),new p({item_name:"Cooking herbs",count:[2,5],chance:.8}),new p({item_name:"Coal",count:[20,50]}),new p({item_name:"Twist liek a snek",count:[1],chance:1}),new p({item_name:"Butchering and you",count:[1],chance:1}),new p({item_name:"Medicine for dummies",count:[1],chance:1}),new p({item_name:"Ode to Whimsy, and other poems",count:[1],chance:.4}),new p({item_name:"A Glint On The Sand",count:[1],chance:.4}),new p({item_name:"Wood for Witches",count:[1],chance:.2}),new p({item_name:"Glass phial",count:[10,16],chance:1}),new p({item_name:"Glass bottle",count:[6,12],chance:1}),new p({item_name:"Camping supplies",count:[1],chance:1}),new p({item_name:"Coil of rope",count:[1],chance:1}),new p({item_name:"Iron sickle",count:[1],chance:1}),new p({item_name:"Iron pickaxe",count:[1],chance:1}),new p({item_name:"Iron chopping axe",count:[1],chance:1}),new p({item_name:"Iron shovel",count:[1],chance:1})],ka.Swamp=[new p({item_name:"Alligator jerky",count:[1,2]}),new p({item_name:"Snake jerky",count:[1,2]}),new p({item_name:"Turtle jerky",count:[1,2]}),new p({item_name:"Cooking herbs",count:[1,3]}),new p({item_name:"Wild onion",count:[1,3]}),new p({item_name:"Wild garlic",count:[1,3]}),new p({item_name:"Wild potato",count:[1,3]})],ka["Swamp plus"]=[new p({item_name:"Alligator jerky",count:[2,5]}),new p({item_name:"Snake jerky",count:[2,5]}),new p({item_name:"Turtle jerky",count:[2,5]}),new p({item_name:"Cooking herbs",count:[3,6]}),new p({item_name:"Wild onion",count:[3,6]}),new p({item_name:"Wild garlic",count:[3,6]}),new p({item_name:"Wild potato",count:[5,9]}),new p({item_name:"Alligator armor",count:[1],quality:[70,100],chance:.05}),new p({item_name:"Alligator helmet",count:[1],quality:[70,100],chance:.05}),new p({item_name:"Alligator armored pants",count:[1],quality:[70,100],chance:.05}),new p({item_name:"Turtleshell platemail armor",count:[1],quality:[70,100],chance:.01}),new p({item_name:"Turtleshell platemail helmet",count:[1],quality:[70,100],chance:.01}),new p({item_name:"Turtleshell platemail pants",count:[1],quality:[70,100],chance:.01}),new p({item_name:"Turtleshell shield",count:[1],quality:[70,100],chance:.01}),new p({item_name:"Shellfish desires",count:[1],chance:.5}),new p({item_name:"Healing balm",count:[1,2],chance:.15}),new p({item_name:"Healing powder",count:[1,3],chance:.2}),new p({item_name:"Healing potion",count:[1,3],chance:.25}),new p({item_name:"Oneberry",count:[1,4],chance:.1}),new p({item_name:"Silver thistle",count:[1,3],chance:.1}),new p({item_name:"Golmoon leaf",count:[1,3],chance:.1}),new p({item_name:"Belmart leaf",count:[1,3],chance:.1})]})();var Ye=null,P={value:0,items:[],groups:{}},L={value:0,items:[],groups:{}},Cn=class{constructor(t){this.count=new Array(t+1).fill(0),this.needs_resort=!1,this.unsorted=[],this.sorted=[],this.group_value=0}};function $l(e){F[e].refresh(),Ye=e,Wl(),ve()}function El(){L.items=[],L.groups={},L.value=0,P.items=[],P.groups={},P.value=0,ve(),Kt()}function Tl(){let e;if(P.items.length==0&&L.items.length==0?e=r.money:e=r.money+P.value-L.value,e<0)throw new Error("Trying to make a trade that can't be afforded");{r.money=e;let t=[],i=[];for(;L.items.length>0;){let a=L.items.pop();a.item_count=a.count,i.push(a),t.push({item_key:a.item_key,count:a.count});let s=xe(a.item_key),{group_key:n,group_tier:o}=s.getMarketSaturationGroup();s.saturates_market&&xl({group_key:n,group_tier:o,count:a.count,region:x.market_region})}if(i.length>0){et(t),eu(Ye,i);for(let a=0;a<t.length;a++)ve({item_key:t[a].item_key})}for(t=[],i=[];P.items.length>0;){let a=P.items.pop();a.item_count=a.count,i.push(a),t.push({item_key:a.item_key,count:a.count});let s=xe(a.item_key),{group_key:n,group_tier:o}=s.getMarketSaturationGroup();s.saturates_market&&vl({group_key:n,group_tier:o,count:a.count,region:x.market_region})}if(i.length>0){Fs(Ye,t),wt(i);for(let a=0;a<t.length;a++)Kt({item_key:t[a].item_key})}}ee({skill:f.Haggling,xp_to_add:(P.value+L.value)/10,cap_gained_xp:!1}),L.value=0,L.groups={},P.value=0,P.groups={},ve({is_trade:!0}),Kt(),ba()}function Ml(){Ye=null,L.items=[],L.groups={},L.value=0,P.items=[],P.groups={},P.value=0,Ol(),ve()}function Al(e){let t=xe(e.item_key),{group_key:i,group_tier:a}=t.getMarketSaturationGroup(),s=L.items.find(l=>l.item_key===e.item_key),n=e.count,o=F[Ye].inventory[e.item_key].count;return s?(o-s.count<e.count?(n=o-s.count,s.count=o):s.count+=n,L.groups[i].count[a]+=n,L.groups[i].unsorted.find(l=>e.item_key===l.item_key).count+=n):(o<e.count&&(e.count=o),L.groups[i]?L.groups[i].count.length<a+1&&L.groups[i].count.push(...new Array(a+1-L.groups[i].count.length).fill(0)):L.groups[i]=new Cn(a),L.items.push(e),L.groups[i].unsorted.push({...e}),L.groups[i].count[a]+=e.count,L.groups[i].needs_resort=!0),Ln()}function Cl(e){let t=xe(e.item_key),{group_key:i,group_tier:a}=t.getMarketSaturationGroup(),s=e.count,n=L.items.find(o=>o.item_key===e.item_key);if(n?.count<s&&(s=n.count),!L.groups[i]||L.groups[i].count.length<a+1)throw new Error(`Tried to remove an item of trade group '${i}:${a}' from the buying list, but nothing of such group was present in it!`);if(L.groups[i].count[a]<s)throw new Error(`Tried to remove an item of trade group '${i}:${a}' from the buying list, but provided count of '${s}' would lead to a negative number!`);return n?.count>e.count?(n.count-=s,L.groups[i].unsorted.find(o=>e.item_key===o.item_key).count-=s):(s=n.count,n.count=0,L.items.splice(L.items.indexOf(n),1),L.groups[i].unsorted=L.groups[i].unsorted.filter(o=>e.item_key!==o.item_key),L.groups[i].sorted=L.groups[i].sorted.filter(o=>e.item_key!==o.item_key)),L.groups[i].count[a]-=s,Ln()}function Rs(){return!!Ye}function Ll(e){let t=xe(e.item_key),{group_key:i,group_tier:a}=t.getMarketSaturationGroup(),s=P.items.find(o=>o.item_key===e.item_key),n=r.inventory[e.item_key].count;return s?(n-s.count<e.count?(e.count=n-s.count,s.count=n):s.count+=e.count,P.groups[i].count[a]+=e.count,P.groups[i].unsorted.find(o=>e.item_key===o.item_key).count+=e.count):(n<e.count&&(e.count=n),P.groups[i]?P.groups[i].count.length<a+1&&P.groups[i].count.push(...new Array(a+1-P.groups[i].count.length).fill(0)):P.groups[i]=new Cn(a),P.items.push(e),P.groups[i].unsorted.push({...e}),P.groups[i].count[a]+=e.count,P.groups[i].needs_resort=!0),Ln()}function Bl(e){let t=xe(e.item_key),{group_key:i,group_tier:a}=t.getMarketSaturationGroup(),s=e.count,n=P.items.find(o=>o.item_key===e.item_key);if(n?.count<s&&(s=n.count),!P.groups[i]||P.groups[i].count.length<a+1)throw new Error(`Tried to remove an item of trade group '${i}:${a}' from the selling list, but nothing of such group was present in it!`);if(P.groups[i].count[a]<s)throw new Error(`Tried to remove an item of trade group '${i}:${a}' from the selling list, but provided count of '${s}' would lead to a negative number!`);return n?.count>e.count?(n.count-=s,P.groups[i].unsorted.find(o=>e.item_key===o.item_key).count-=s):(s=n.count,n.count=0,P.items.splice(P.items.indexOf(n),1),P.groups[i].unsorted=P.groups[i].unsorted.filter(o=>e.item_key!==o.item_key),P.groups[i].sorted=P.groups[i].sorted.filter(o=>e.item_key!==o.item_key)),P.groups[i].count[a]-=s,Ln()}function Fs(e,t){F[e].add_to_inventory(t),Ye===e&&Kt()}function eu(e,t){F[e].remove_from_inventory(t),Ye===e&&Kt()}function Ln(){let e={buying_precalculated:{},selling:{},buying:{}};return L.value=0,P.value=0,Object.keys(L.groups).forEach(t=>{e.buying_precalculated[t]||(e.buying_precalculated[t]=[]);for(let i=0;i<L.groups[t].sorted.length;i++){let a=xe(L.groups[t].sorted[i].item_key),{group_tier:s}=a.getMarketSaturationGroup();e.buying_precalculated[t].length<s+1&&e.buying_precalculated[t].push(...new Array(s+1-e.buying_precalculated[t].length).fill(0)),e.buying_precalculated[t][s]+=L.groups[t].sorted[i].count}}),Object.keys(P.groups).forEach(t=>{P.groups[t].group_value=0,e.selling[t]=[],P.groups[t].needs_resort&&(P.groups[t].sorted=P.groups[t].unsorted.sort((i,a)=>Il(i,a)),P.groups[t].needs_resort=!1);for(let i=0;i<P.groups[t].sorted.length;i++){let a=xe(P.groups[t].sorted[i].item_key),{group_tier:s,group_key:n}=a.getMarketSaturationGroup(),o;n.startsWith(Oe)?o=wa:o=Rt;let l=ya({sold_by_tier:e.selling[t],target_tier:s,cap:o}),d=ya({sold_by_tier:e.buying_precalculated[t],target_tier:s,cap:o});P.groups[t].group_value+=a.getValueOfMultiple({additional_traded_count:l,stop_multiplier_at:Math.max(0,l-d+P.groups[t].sorted[i].count),count:P.groups[t].sorted[i].count,region:x.market_region}),e.selling[t].length<s+1&&e.selling[t].push(...new Array(s+1-e.selling[t].length).fill(0)),e.selling[t][s]+=P.groups[t].sorted[i].count}P.value+=P.groups[t].group_value}),Object.keys(L.groups).forEach(t=>{L.groups[t].group_value=0,e.buying[t]=[],L.groups[t].needs_resort&&(L.groups[t].sorted=L.groups[t].unsorted.sort((i,a)=>Il(i,a)),L.groups[t].needs_resort=!1);for(let i=0;i<L.groups[t].sorted.length;i++){let a=xe(L.groups[t].sorted[i].item_key),{group_tier:s,group_key:n}=a.getMarketSaturationGroup(),o;n.startsWith(Oe)?o=wa:o=Rt;let l=ya({sold_by_tier:e.selling[t],target_tier:s,cap:o}),d=ya({sold_by_tier:e.buying[t],target_tier:s,cap:o});L.groups[n].group_value+=a.getValueOfMultiple({additional_traded_count:-d,stop_multiplier_at:Math.max(0,l-d-L.groups[t].sorted[i].count),count:L.groups[t].sorted[i].count,region:x.market_region,price_multiplier:F[Ye].getProfitMargin(x.market_region),is_selling:!1}),e.buying[t].length<s+1&&e.buying[t].push(...new Array(s+1-e.buying[t].length).fill(0)),e.buying[t][s]+=L.groups[t].sorted[i].count}L.value+=L.groups[t].group_value}),P.value-L.value}function Il(e,t){let i=xe(e.item_key),a=xe(t.item_key),s=i.getMarketSaturationGroup().group_tier,n=a.getMarketSaturationGroup().group_tier;return s!=n?n-s:a.getBaseValue()-i.getBaseValue()}var Ji=(e,t)=>{let i=1;if(e.length==0)return 1;if(e[0].money&&t.money<e[0].money)return i=0,i;if(e[1]?.money&&e[1].money>e[0].money&&t.money<e[1].money&&(i*=(1+t.money-e[0].money)/(e[1].money-e[0].money)),!i)return i;if(e[0].skills&&Object.keys(e[0].skills).forEach(a=>{K(a)<e[0].skills[a]?i=0:e[1]?.skills&&e[1].skills[a]>e[0].skills[a]&&K(a)<e[1].skills[a]&&(i*=(1+K(a)-e[0].skills[a])/(e[1].skills[a]-e[0].skills[a]))}),e[0].hero_level){if(t.xp.current_level<e[0].hero_level)return i=0,i;e[1]?.hero_level&&e[1].hero_level>t.xp.current_level&&(i*=(1+t.xp.current_level-e[0].hero_level)/(e[1].hero_level-e[0].hero_level))}if(!i||(e[0].items_by_id&&Object.keys(e[0].items_by_id).forEach(a=>{let s=!1;Object.keys(t.inventory).forEach(n=>{if(s)return;let{id:o}=JSON.parse(n);o===a&&t.inventory[n].count>=e[0].items_by_id[a].count&&(s=!0)}),s||(i=0)}),!i))return i;if(e[0].stats&&Object.keys(e[0].stats).forEach(a=>{t.stats.full[a]<e[0].stats[a]?i=0:e[1]?.stats&&e[1].stats[a]>e[0].stats[a]&&t.stats.full[a]<e[1].stats[a]&&(i*=(t.stats.full[a]-e[0].stats[a])/(e[1].stats[a]-e[0].stats[a]))}),e[0].season&&(e[0].season.yes?E.getSeason()!==e[0].season.yes&&(i=0):e[0].season.not&&E.getSeason()===e[0].season.not&&(i=0)),e[0].tools_by_slot){for(let a=0;a<e[0].tools_by_slot.length;a++)if(!t.equipment[e[0].tools_by_slot[a]]){i=0;break}}if(e[0].reputation&&Object.keys(e[0].reputation).forEach(a=>{if(t.reputation[a]<e[0].reputation[a])return i=0,i;e[1]?.reputation&&e[1].reputation[a]>e[0].reputation[a]&&t.reputation[a]<e[1].reputation[a]&&(i*=(1+t.reputation[a]-e[0].reputation[a])/(e[1].reputation[a]-e[0].reputation[a]))}),e[0].flags){for(let a=0;a<e[0].flags.length;a++)if(!Ie[e[0].flags[a]]){i=0;break}}return i};var ce=class{constructor({starting_text:t,action_id:i,action_name:a,description:s,action_text:n,success_text:o,failure_texts:l={},required:d={},display_conditions:u={},conditions:h=[],rewards:_={},attempt_duration:w=0,success_chances:b=[1,1],keep_progress:g=!1,is_unlocked:v=!1,repeatable:y=!1,check_conditions_on_finish:I=!0,unlock_text:$}){if(this.starting_text=t,this.action_name=a||t,this.action_id=i,this.description=s,this.action_text=n,this.failure_texts=l,this.failure_texts.conditional_loss||(this.failure_texts.conditional_loss=[]),this.failure_texts.random_loss||(this.failure_texts.random_loss=[]),this.failure_texts.unable_to_begin||(this.failure_texts.unable_to_begin=[]),this.success_text=o,this.required=d,h.length>2)throw new Error("LocationAction cannot have more than 2 sets of conditions!");this.conditions=h,this.display_conditions=u,this.check_conditions_on_finish=I,this.rewards=_,this.attempt_duration=w,this.success_chances=b,this.keep_progress=g,this.accumulated_progress=0,this.is_unlocked=v,this.is_finished=!1,this.repeatable=y,this.completion_count=0,this.unlock_text=$}get_conditions_status(t){return Ji(this.conditions,t)}can_be_started(t){return Ji([this.required],t)}can_be_displayed(t){return Ji([this.display_conditions],t)}};var q={},nt=class{constructor({name:t,getName:i=()=>this.name,id:a,starting_text:s=`Talk to the ${t}`,getStartingText:n=()=>this.starting_text,ending_text:o="Go back",is_unlocked:l=!0,is_finished:d=!1,textlines:u={},actions:h={},description:_="",getDescription:w=()=>this.description,location_name:b}){this.name=t,this.getName=i,this.id=a||this.name,this.starting_text=s,this.getStartingText=n,this.ending_text=o,this.is_unlocked=l,this.is_finished=d,this.textlines=u,this.actions=h,this.description=_,this.getDescription=w,this.location_name=b}},k=class{constructor({name:t,text:i,getText:a,is_unlocked:s=!0,is_finished:n=!1,is_branch_only:o=!1,rewards:l={textlines:[],locations:[],dialogues:[],traders:[],stances:[],flags:[],items:[],locks:{textlines:{}}},branches_into:d=[],locks_lines:u=[],otherUnlocks:h,required_flags:_,display_conditions:w=[]}){this.name=t,this.text=i,this.getText=a||function(){return this.text},this.otherUnlocks=h||function(){},this.is_unlocked=s,this.is_finished=n,this.is_branch_only=o,this.rewards=l||{},this.branches_into=d,this.rewards.textlines=l.textlines||[],this.rewards.locations=l.locations||[],this.rewards.dialogues=l.dialogues||[],this.rewards.traders=l.traders||[],this.rewards.stances=l.stances||[],this.rewards.flags=l.flags||[],this.rewards.items=l.items||[],this.display_conditions=[w],this.required_flags=_,this.locks_lines=u,this.rewards.locks=l.locks||{},this.rewards.locks.textlines||(this.rewards.locks.textlines={})}},Et=class extends ce{constructor(t){super(t),this.giveup_text=t.giveup_text,this.floating_click_effects=t.floating_click_effects}};(function(){q["village elder"]=new nt({name:"village elder",textlines:{hello:new k({name:"elder hello",text:"elder hello answ",rewards:{textlines:[{dialogue:"village elder",lines:["what happened","where am i","dont remember","about"]}]},locks_lines:["hello"]}),"what happened":new k({name:"elder head hurts",text:"elder head hurts answ",is_unlocked:!1,locks_lines:["what happened","where am i","dont remember"],rewards:{textlines:[{dialogue:"village elder",lines:["ask to leave 1"]}],quest_progress:[{quest_id:"Lost memory",task_index:0}]}}),"where am i":new k({name:"elder where",text:"elder where answ",is_unlocked:!1,locks_lines:["what happened","where am i","dont remember"],rewards:{textlines:[{dialogue:"village elder",lines:["ask to leave 1"]}],quest_progress:[{quest_id:"Lost memory",task_index:0}]}}),"dont remember":new k({name:"elder remember",text:"elder remember answ",is_unlocked:!1,locks_lines:["what happened","where am i","dont remember"],rewards:{textlines:[{dialogue:"village elder",lines:["ask to leave 1"]}],quest_progress:[{quest_id:"Lost memory",task_index:0}]}}),about:new k({name:"elder who",text:"elder who answ",is_unlocked:!1,locks_lines:["about"]}),"ask to leave 1":new k({name:"elder leave 1",text:"elder leave 1 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"village elder",lines:["need to"]}]},locks_lines:["ask to leave 1"]}),"need to":new k({name:"elder need to",text:"elder need to answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"village elder",lines:["rats","ask to leave 2","equipment"]}],locations:[{location:"Infested field"}],activities:[{location:"Village",activity:"weightlifting"},{location:"Village",activity:"running"}],quest_progress:[{quest_id:"Lost memory",task_index:1}]},locks_lines:["need to"]}),equipment:new k({name:"elder eq",text:"elder eq answ",is_unlocked:!1,locks_lines:["equipment"],rewards:{textlines:[{dialogue:"village elder",lines:["money"]}],traders:[{trader:"village trader"}]}}),money:new k({name:"elder money",text:"elder money answ",is_unlocked:!1,locks_lines:["money"],rewards:{activities:[{location:"Village",activity:"fieldwork"}]}}),"ask to leave 2":new k({name:"elder leave 2",text:"elder leave 2 answ",is_unlocked:!1,rewards:{}}),rats:new k({name:"elder rats",text:"elder rats answ",is_unlocked:!1}),"cleared field":new k({name:"elder cleared 1",text:"elder cleared 1 answ",is_unlocked:!1,rewards:{locations:[{location:"Nearby cave"},{location:"Infested field"},{location:"Shack"}],textlines:[{dialogue:"village elder",lines:["ask to leave 3"]}],dialogues:["old craftsman"]},locks_lines:["ask to leave 2","cleared field"]}),"ask to leave 3":new k({name:"elder leave 3",text:"elder leave 3 answ",rewards:{locations:[{location:"Nearby cave"},{location:"Infested field"}],dialogues:["old craftsman"]},is_unlocked:!1}),"cleared room":new k({name:"elder room clear",text:"elder room clear answ",is_unlocked:!1,rewards:{locations:[{location:"Eastern mill"}],quests:["It won't mill itself"]},locks_lines:["cleared room"]}),"cleared cave":new k({name:"elder cave clear",text:"elder cave clear answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"village elder",lines:["ask to leave 4","crab rumors"]}],locations:[{location:"Forest road"},{location:"Infested field"},{location:"Nearby cave"}],dialogues:["village guard"],quest_progress:[{quest_id:"Lost memory",task_index:2}]},locks_lines:["ask to leave 3","rats","cleared cave"]}),"ask to leave 4":new k({name:"elder leave 4",text:"elder leave 4 answ",is_unlocked:!1,rewards:{locations:[{location:"Forest road"},{location:"Infested field"},{location:"Nearby cave"}],dialogues:["village guard","old craftsman"],textlines:[{dialogue:"village elder",lines:["about guard"]}]}}),"about guard":new k({name:"elder about guard",text:"elder about guard answ",is_unlocked:!1,required_flags:{yes:["is_guard_met"]},locks_lines:["about guard"]}),"new tunnel":new k({name:"elder tunnel",text:"elder tunnel answ",is_unlocked:!1,locks_lines:["new tunnel"]}),"crab rumors":new k({name:"elder crab rumors",text:"elder crab rumors answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"village elder",lines:["crab where"]}]},display_conditions:{hero_level:25},locks_lines:["crab rumors"]}),"crab where":new k({name:"elder crab where",text:"elder crab where answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"village elder",lines:["crab hunt"]}]},locks_lines:["crab where"]}),"crab hunt":new k({name:"elder crab hunt",text:"elder crab hunt answ",is_unlocked:!1,rewards:{actions:[{location:"Village",action:"hike down river"}],quests:["Giant Enemy Crab"]},locks_lines:["crab hunt"]}),"more training":new k({name:"elder training",getText:e=>e?.season==="Winter"?"elder training answ 2":"elder training answ 1",is_unlocked:!1,locks_lines:["more training"],rewards:{global_activities:["swimming","climbing"],actions:[{location:"Nearby cave",action:"climb the mountain"}],locks:{quests:["Swimming alternative unlock"]}}})},description:"elder description"}),q["old craftsman"]=new nt({name:"old craftsman",is_unlocked:!1,textlines:{hello:new k({name:"craftsman hello",text:"craftsman hello answ",rewards:{textlines:[{dialogue:"old craftsman",lines:["learn","leave","about guard"]}]},locks_lines:["hello"]}),learn:new k({name:"craftsman learn",text:"craftsman learn answ",rewards:{textlines:[{dialogue:"old craftsman",lines:["remind1","remind2","remind3","remind4"]}],items:["Old pickaxe","Old axe","Old sickle","Old shovel"],flags:["is_gathering_unlocked","is_crafting_unlocked"]},locks_lines:["learn","leave"],is_unlocked:!1}),leave:new k({name:"craftsman leave",text:"craftsman leave answ",is_unlocked:!1}),remind1:new k({name:"craftsman remind 1",text:"craftsman remind 1 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"old craftsman",lines:["remind4"]}]}}),remind2:new k({name:"craftsman remind 2",text:"craftsman remind 2 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"old craftsman",lines:["remind4"]}]}}),remind3:new k({name:"craftsman remind 3",text:"craftsman remind 3 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"old craftsman",lines:["remind4"]}]}}),remind4:new k({name:"craftsman remind 4",text:"craftsman remind 4 answ",is_unlocked:!1}),"about guard":new k({name:"craftsman about guard",text:"craftsman about guard answ",is_unlocked:!1,required_flags:{yes:["is_guard_met"]},locks_lines:["about guard"]})},description:"craftsman description"}),q["village guard"]=new nt({name:"village guard",is_unlocked:!1,textlines:{hello:new k({name:"guard hello",text:"guard hello answ",rewards:{textlines:[{dialogue:"village guard",lines:["tips","job","hi"]}],flags:["is_guard_met"]},locks_lines:["hello"]}),job:new k({name:"guard job",is_unlocked:!1,text:"guard job answ",rewards:{activities:[{location:"Village",activity:"patrolling"}]},locks_lines:["job"]}),tips:new k({name:"guard tips",is_unlocked:!1,text:"guard tips answ",rewards:{textlines:[{dialogue:"village guard",lines:["teach"]}]}}),hi:new k({name:"guard hi",is_unlocked:!1,text:"guard hi answ",display_conditions:{reputation:{Village:200}},rewards:{actions:[{dialogue:"village guard",action:"ask for pats"},{dialogue:"village guard",action:"try to pat"}]},locks_lines:["hi"]}),teach:new k({name:"guard teach",is_unlocked:!1,text:"guard teach answ",rewards:{locations:[{location:"Sparring with the village guard (quick)"},{location:"Sparring with the village guard (heavy)"}]},locks_lines:["teach"]}),quick:new k({name:"guard quick",is_unlocked:!1,text:"guard quick answ",otherUnlocks:()=>{q["village guard"].textlines.heavy.is_finished&&(q["village guard"].textlines.wide.is_unlocked=!0)},locks_lines:["quick"],rewards:{stances:["quick"],skill_xp:{Combat:100}}}),heavy:new k({name:"guard heavy",is_unlocked:!1,text:"guard heavy answ",otherUnlocks:()=>{q["village guard"].textlines.quick.is_finished&&(q["village guard"].textlines.wide.is_unlocked=!0)},locks_lines:["heavy"],rewards:{stances:["heavy"],skill_xp:{Combat:100}}}),wide:new k({name:"guard wide",is_unlocked:!1,text:"guard wide answ",locks_lines:["wide"],rewards:{stances:["wide"],textlines:[{dialogue:"village guard",lines:["serious","hi","tips 2","teach more"]}],skill_xp:{Combat:100}}}),"teach more":new k({name:"guard teach more",is_unlocked:!1,text:"guard teach more answ",locks_lines:["teach more"]}),serious:new k({name:"guard serious",is_unlocked:!1,text:"guard serious answ",locks_lines:["serious"]}),"tips 2":new k({name:"guard tips 2",is_unlocked:!1,text:"guard tips 2 answ",rewards:{textlines:[{dialogue:"village guard",lines:["scars"]}]}}),scars:new k({name:"guard scars",is_unlocked:!1,text:"guard scars answ",locks_lines:["scars"]})},actions:{"ask for pats":new Et({action_id:"ask for pats",is_unlocked:!1,repeatable:!0,starting_text:"guard pats",floating_click_effects:["(\u30CE= \u2A4A = )\u30CE","( \xB4\uFF65\uFF65)\uFF89"],description:"",action_text:"",success_text:"guard pats answ",attempt_duration:0,success_chances:[1]}),"try to pat":new Et({action_id:"try to pat",is_unlocked:!1,repeatable:!0,starting_text:"guard try",floating_click_effects:["(\u30CE= \u2A4A = )\u30CE","( \xB4\uFF65\uFF65)\uFF89"],description:"",action_text:"",success_text:"guard try answ",attempt_duration:0,success_chances:[1]})},description:"guard description"}),q["village millers"]=new nt({name:"village millers",textlines:{hello:new k({name:"millers hello",text:"millers hello answ",rewards:{textlines:[{dialogue:"village millers",lines:["how","young","about guard"]}]},locks_lines:["hello"]}),how:new k({is_unlocked:!1,name:"millers how",text:"millers how answ",rewards:{textlines:[{dialogue:"village millers",lines:["sure"]}]},locks_lines:["how"]}),sure:new k({is_unlocked:!1,name:"millers sure",text:"millers sure answ",rewards:{quest_progress:[{quest_id:"It won't mill itself",task_index:0}],locations:[{location:"Eastern storehouse"}]},locks_lines:["sure"]}),young:new k({is_unlocked:!1,name:"millers young",text:"millers young answ",locks_lines:["young"]}),"cleared storage":new k({is_unlocked:!1,name:"millers cleared",text:"millers cleared answ",locks_lines:["cleared storage"],rewards:{quest_progress:[{quest_id:"It won't mill itself",task_index:1}],actions:[{location:"Village",action:"search for delivery"}]}}),delivered:new k({is_unlocked:!1,name:"millers delivered",text:"millers delivered answ",locks_lines:["delivered"],rewards:{textlines:[{dialogue:"village millers",lines:["kiss"]}],quest_progress:[{quest_id:"It won't mill itself",task_index:2}],actions:[{location:"Village",action:"search for delivery"}]}}),kiss:new k({is_unlocked:!1,name:"millers kiss",text:"millers kiss answ",branches_into:["kiss both","kiss cat","kiss mouse","reject nice","reject mean"]}),"kiss both":new k({is_branch_only:!0,name:"millers kiss both",text:"millers kiss both answ",locks_lines:["kiss"],rewards:{textlines:[{dialogue:"village millers",lines:["kiss more","how2"]}]}}),"kiss cat":new k({is_branch_only:!0,name:"millers kiss cat",text:"millers kiss cat answ",locks_lines:["kiss"],rewards:{textlines:[{dialogue:"village millers",lines:["kiss more","how2"]}]}}),"kiss mouse":new k({is_branch_only:!0,name:"millers kiss mouse",text:"millers kiss mouse answ",locks_lines:["kiss"],rewards:{textlines:[{dialogue:"village millers",lines:["kiss more","how2"]}]}}),"reject nice":new k({is_branch_only:!0,name:"millers reject nice",text:"millers reject nice answ",locks_lines:["kiss"],rewards:{textlines:[{dialogue:"village millers",lines:["how2"]}]}}),"reject mean":new k({is_branch_only:!0,name:"millers reject mean",text:"millers reject mean answ",locks_lines:["kiss"],rewards:{textlines:[{dialogue:"village millers",lines:["how2"]}]}}),"kiss more":new k({is_unlocked:!1,name:"millers kiss more",text:"millers kiss more answ",locks_lines:["kiss more"]}),how2:new k({is_unlocked:!1,name:"millers how2",text:"millers how2 answ"}),"about guard":new k({name:"millers about guard",text:"millers about guard answ",is_unlocked:!1,required_flags:{yes:["is_guard_met"]},locks_lines:["about guard"]})},description:"millers description"}),q["gate guard"]=new nt({name:"gate guard",textlines:{enter:new k({name:"g guard hello",text:"g guard hello answ"})},description:"g guard description"}),q["suspicious man"]=new nt({name:"suspicious man",getName:e=>q["suspicious man"].actions.headpat.is_unlocked?e.is_mofu_mofu_enabled?"puppy":"no-longer-suspicious guy":q["suspicious man"].name,getStartingText:e=>`Talk to the ${q["suspicious man"].getName(e)}`,textlines:{hello:new k({name:"sus hello",text:"sus hello answ",rewards:{locations:[{location:"Fight off the assailant"}]},locks_lines:["hello"]}),defeated:new k({name:"sus defeated",is_unlocked:!1,text:"sus defeated answ",locks_lines:["defeated"],rewards:{textlines:[{dialogue:"suspicious man",lines:["behave","situation"]}],quest_progress:[{quest_id:"Lost memory",task_index:3}]}}),behave:new k({name:"sus behave",is_unlocked:!1,text:"sus behave answ",locks_lines:["defeated"],rewards:{textlines:[{dialogue:"suspicious man",lines:["situation","boss"]}]}}),boss:new k({name:"sus boss",is_unlocked:!1,text:"sus boss answ",locks_lines:["boss"]}),situation:new k({name:"sus situation",is_unlocked:!1,text:"sus situation answ",locks_lines:["situation"],rewards:{textlines:[{dialogue:"suspicious man",lines:["gang","boss"]}]}}),gang:new k({name:"sus gang",is_unlocked:!1,text:"sus gang answ",locks_lines:["gang","behave"],rewards:{textlines:[{dialogue:"suspicious man",lines:["gang","behave 2"]}],locations:[{location:"Gang hideout"}],quest_progress:[{quest_id:"Light in the darkness",task_index:0}]}}),"defeated gang":new k({name:"sus gang defeated",is_unlocked:!1,text:"sus gang defeated answ",locks_lines:["defeated gang"],rewards:{textlines:[{dialogue:"suspicious man",lines:["tricks","behave 3"]}],dialogues:["old woman of the slums"]}}),"behave 2":new k({name:"sus behave 2",is_unlocked:!1,text:"sus behave 2 answ"}),"behave 3":new k({name:"sus behave 3",is_unlocked:!1,text:"sus behave 3 answ",rewards:{textlines:[{dialogue:"suspicious man",lines:["tricks"]}],dialogues:["old woman of the slums"],actions:[{dialogue:"suspicious man",action:"headpat"}]}}),tricks:new k({name:"sus tricks",is_unlocked:!1,text:"sus tricks answ",rewards:{stances:["defensive"]},locks_lines:["tricks"]})},getDescription:()=>q["suspicious man"].textlines["defeated gang"].is_finished?"sus description 2":"sus description 1",actions:{headpat:new Et({action_id:"headpat",is_unlocked:!1,repeatable:!0,starting_text:"sus headpat",floating_click_effects:["(* ^ \u03C9 ^)	","<(\uFFE3\uFE36\uFFE3)>	","(*\u2267\u03C9\u2266*)	","(\u15D2\u2A4A\u15D5)","(= \u2A4A =)"],description:"",action_text:"",success_text:"sus headpat answ",display_conditions:{flags:["is_mofu_mofu_enabled"]},attempt_duration:0,success_chances:[1]})}}),q["old woman of the slums"]=new nt({name:"old woman of the slums",is_unlocked:!1,textlines:{hello:new k({name:"old hello",text:"old hello answ",locks_lines:["hello"],rewards:{textlines:[{dialogue:"old woman of the slums",lines:["dinner"]}]}}),dinner:new k({name:"old dinner",is_unlocked:!1,text:"old dinner answ",locks_lines:["dinner"],rewards:{textlines:[{dialogue:"old woman of the slums",lines:["ingredients"]}]}}),ingredients:new k({name:"old ingredients",is_unlocked:!1,text:"old ingredients answ",locks_lines:["ingredients"],rewards:{activities:[{location:"Town outskirts",activity:"herbalism"}]}})},getDescription:()=>q["old woman of the slums"].textlines.hello.is_finished?"old description 2":"old description 1"}),q["farm supervisor"]=new nt({name:"farm supervisor",textlines:{hello:new k({name:"sup hello",text:"sup hello answ",rewards:{textlines:[{dialogue:"farm supervisor",lines:["things","work","animals","fight","fight0","anything"]}]},locks_lines:["hello"]}),work:new k({name:"sup work",is_unlocked:!1,text:"sup work answ",rewards:{activities:[{location:"Town farms",activity:"fieldwork"}]},locks_lines:["work"]}),anything:new k({name:"sup anything",is_unlocked:!1,text:"sup anything answ",rewards:{actions:[{dialogue:"farm supervisor",action:"bonemeal1"}],quests:["Bonemeal delivery"]},locks_lines:["anything"]}),"more bonemeal":new k({name:"sup bonemeal",is_unlocked:!1,text:"sup bonemeal answ",rewards:{actions:[{dialogue:"farm supervisor",action:"bonemeal2"}]},locks_lines:["more bonemeal"]}),animals:new k({name:"sup animals",is_unlocked:!1,text:"sup animals answ",required_flags:{yes:["is_gathering_unlocked"]},rewards:{activities:[{location:"Town farms",activity:"animal care"}]},locks_lines:["animals"]}),fight0:new k({name:"sup fight0",is_unlocked:!1,text:"sup fight0 answ",required_flags:{no:["is_strength_proved"]},rewards:{quests:["Ploughs to swords"]}}),fight:new k({name:"sup fight",is_unlocked:!1,text:"sup fight answ",required_flags:{yes:["is_strength_proved"]},rewards:{actions:[{location:"Forest road",action:"search for boars"}],quests:["Ploughs to swords"],quest_progress:[{quest_id:"Ploughs to swords",task_index:0}]},locks_lines:["fight"]}),things:new k({is_unlocked:!1,name:"sup things",text:"sup things answ",rewards:{textlines:[{dialogue:"farm supervisor",lines:["animals","fight","fight0","anything"]}]}}),"defeated boars":new k({is_unlocked:!1,name:"sup defeated boars",text:"sup defeated boars answ",locks_lines:["defeated boars"],rewards:{money:4e3,quest_progress:[{quest_id:"Ploughs to swords",task_index:1}],textlines:[{dialogue:"farm supervisor",lines:["troubled"]}]}}),troubled:new k({is_unlocked:!1,name:"sup troubled",text:"sup troubled answ",locks_lines:["troubled"],display_conditions:{season:{not:"Winter"}},rewards:{quest_progress:[{quest_id:"Ploughs to swords",task_index:2}],actions:[{location:"Town farms",action:"dig for ants 1"}]}}),"eliminated ants":new k({is_unlocked:!1,name:"sup eliminated",text:"sup eliminated answ",locks_lines:["eliminated ants"],rewards:{quest_progress:[{quest_id:"Ploughs to swords",task_index:3}]}})},actions:{bonemeal1:new Et({action_id:"bonemeal1",starting_text:"sup deliver",description:"",action_text:"",success_text:"sup deliver answ",failure_texts:{unable_to_begin:["sup deliver not"]},required:{items_by_id:{Bonemeal:{count:50,remove_on_success:!0}}},attempt_duration:0,success_chances:[1],rewards:{quest_progress:[{quest_id:"Bonemeal delivery",task_index:0}],textlines:[{dialogue:"farm supervisor",lines:["more bonemeal"]}]}}),bonemeal2:new Et({action_id:"bonemeal2",starting_text:"sup deliver 2",description:"",action_text:"",success_text:"sup deliver 2 answ",repeatable:!0,failure_texts:{unable_to_begin:["sup deliver 2 not"]},required:{items_by_id:{Bonemeal:{count:50,remove_on_success:!0}}},attempt_duration:0,success_chances:[1],rewards:{money:2e3}})},description:"sup description"}),q["swampland chief"]=new nt({name:"swampland chief",textlines:{"swampchief meet":new k({name:"swampchief meet",text:"swampchief meet answ",is_unlocked:!0,rewards:{textlines:[{dialogue:"swampland chief",lines:["swampchief explain"]}]},locks_lines:["swampchief meet"]}),"swampchief explain":new k({name:"swampchief explain",text:"swampchief explain answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland chief",lines:["swampchief help"]}]},locks_lines:["swampchief explain"]}),"swampchief help":new k({name:"swampchief help",text:"swampchief help answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland chief",lines:["swampchief mid help"]}],dialogues:["swampland cook"],quest_progress:[{quest_id:"In Times of Need",task_index:0}]},locks_lines:["swampchief help"]}),"swampchief mid help":new k({name:"swampchief mid help",text:"swampchief mid help answ",is_unlocked:!1}),"swampchief report":new k({name:"swampchief report",text:"swampchief report answ",is_unlocked:!1,display_conditions:{reputation:{Village:50}},rewards:{textlines:[{dialogue:"swampland chief",lines:["swampchief confirm"]}]},locks_lines:["swampchief report","swampchief mid help"]}),"swampchief confirm":new k({name:"swampchief confirm",text:"swampchief confirm answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland chief",lines:["swampchief accept"]}]},locks_lines:["swampchief confirm"]}),"swampchief accept":new k({name:"swampchief accept",text:"swampchief accept answ",is_unlocked:!1,rewards:{quest_progress:[{quest_id:"In Times of Need",task_index:10}],textlines:[{dialogue:"swampland chief",lines:["swampchief generic"]}],locations:[{location:"Longhouse"}],items:["Snake fang ring"],traders:[{trader:"swampland trader 2"}],crafting:["Swampland tribe"],locks:{traders:["swampland trader"]}},locks_lines:["swampchief accept"]}),"swampchief generic":new k({name:"swampchief generic",text:"swampchief generic answ",is_unlocked:!1})},getDescription:()=>q["swampland chief"].textlines["swampchief confirm"].is_finished?"swampchief description 3":q["swampland chief"].textlines["swampchief help"].is_finished?"swampchief description 2":"swampchief description 1"}),q["swampland cook"]=new nt({name:"swampland cook",is_unlocked:!1,textlines:{"swampcook greeting1":new k({name:"swampcook greeting1",text:"swampcook greeting1 answ",is_unlocked:!0,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook greeting2","swampcook obaru"]}]},locks_lines:["swampcook greeting1"]}),"swampcook greeting2":new k({name:"swampcook greeting2",text:"swampcook greeting2 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook help"]}]},locks_lines:["swampcook greeting2"]}),"swampcook help":new k({name:"swampcook help",text:"swampcook help answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook sosso"]}],actions:[{dialogue:"swampland cook",action:"swampcook deliver"}],quest_progress:[{quest_id:"In Times of Need",task_index:1}]},locks_lines:["swampcook help"]}),"swampcook know":new k({name:"swampcook know",text:"swampcook know answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook yeslore","swampcook nolore"]}]},locks_lines:["swampcook know"]}),"swampcook yeslore":new k({name:"swampcook yeslore",text:"swampcook yeslore answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook history","swampcook surround","swampcook chief","swampcook people"]}],recipes:[{category:"cooking",subcategory:"items",recipe_id:"Alligator jerky"},{category:"cooking",subcategory:"items",recipe_id:"Turtle jerky"},{category:"cooking",subcategory:"items",recipe_id:"Snake jerky"},{category:"cooking",subcategory:"items",recipe_id:"Swampland skewer"}]},locks_lines:["swampcook yeslore","swampcook nolore"]}),"swampcook history":new k({name:"swampcook history",text:"swampcook history answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook history1","swampcook historyend"]}]},locks_lines:["swampcook history"]}),"swampcook history1":new k({name:"swampcook history1",text:"swampcook history1 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook history2"]}]},locks_lines:["swampcook history1"]}),"swampcook history2":new k({name:"swampcook history2",text:"swampcook history2 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook history3"]}]},locks_lines:["swampcook history2"]}),"swampcook history3":new k({name:"swampcook history3",text:"swampcook history3 answ",is_unlocked:!1,locks_lines:["swampcook history3"]}),"swampcook historyend":new k({name:"swampcook historyend",text:"swampcook historyend answ",is_unlocked:!1,locks_lines:["swampcook history1","swampcook history2","swampcook history3","swampcook historyend"]}),"swampcook surround":new k({name:"swampcook surround",text:"swampcook surround answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook surround1","swampcook surround2","swampcook surround3","swampcook surround4","swampcook surroundend"]}]},locks_lines:["swampcook surround"]}),"swampcook surround1":new k({name:"swampcook surround1",text:"swampcook surround1 answ",is_unlocked:!1,locks_lines:["swampcook surround1"]}),"swampcook surround2":new k({name:"swampcook surround2",text:"swampcook surround2 answ",is_unlocked:!1,locks_lines:["swampcook surround2"]}),"swampcook surround3":new k({name:"swampcook surround3",text:"swampcook surround3 answ",is_unlocked:!1,locks_lines:["swampcook surround3"]}),"swampcook surround4":new k({name:"swampcook surround4",text:"swampcook surround4 answ",is_unlocked:!1,locks_lines:["swampcook surround4"]}),"swampcook surroundend":new k({name:"swampcook surroundend",text:"swampcook surroundend answ",is_unlocked:!1,locks_lines:["swampcook surround1","swampcook surround2","swampcook surround3","swampcook surround4","swampcook surroundend"]}),"swampcook chief":new k({name:"swampcook chief",text:"swampcook chief answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook chief1","swampcook chiefend"]}]},locks_lines:["swampcook chief"]}),"swampcook chief1":new k({name:"swampcook chief1",text:"swampcook chief1 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook chief2"]}]},locks_lines:["swampcook chief1"]}),"swampcook chief2":new k({name:"swampcook chief2",text:"swampcook chief2 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook chief3"]}]},locks_lines:["swampcook chief2"]}),"swampcook chief3":new k({name:"swampcook chief3",text:"swampcook chief3 answ",is_unlocked:!1,locks_lines:["swampcook chief3"]}),"swampcook chiefend":new k({name:"swampcook chiefend",text:"swampcook chiefend answ",is_unlocked:!1,locks_lines:["swampcook chief1","swampcook chief2","swampcook chief3","swampcook chiefend"]}),"swampcook people":new k({name:"swampcook people",text:"swampcook people answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook cook","swampcook trader","swampcook fangs"]}]},locks_lines:["swampcook people"]}),"swampcook cook":new k({name:"swampcook cook",text:"swampcook cook answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook cook2"]}]},locks_lines:["swampcook cook"]}),"swampcook cook2":new k({name:"swampcook cook2",text:"swampcook cook2 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook zalgo"]}]},locks_lines:["swampcook cook2"]}),"swampcook trader":new k({name:"swampcook trader",text:"swampcook trader answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook trader1","swampcook traderend"]}]},locks_lines:["swampcook trader"]}),"swampcook trader1":new k({name:"swampcook trader1",text:"swampcook trader1 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook trader2"]}]},locks_lines:["swampcook trader1"]}),"swampcook trader2":new k({name:"swampcook trader2",text:"swampcook trader2 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook trader3"]}]},locks_lines:["swampcook trader2"]}),"swampcook trader3":new k({name:"swampcook trader3",text:"swampcook trader3 answ",is_unlocked:!1,locks_lines:["swampcook trader3"]}),"swampcook traderend":new k({name:"swampcook traderend",text:"swampcook traderend answ",is_unlocked:!1,locks_lines:["swampcook trader1","swampcook trader2","swampcook trader3","swampcook traderend"]}),"swampcook fangs":new k({name:"swampcook fangs",text:"swampcook fangs answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook tailor","swampcook tanner","swampcook peopleend"]}]},locks_lines:["swampcook fangs"]}),"swampcook tailor":new k({name:"swampcook tailor",text:"swampcook tailor answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook tailor1","swampcook tailorend"]}]},locks_lines:["swampcook tailor"]}),"swampcook tailor1":new k({name:"swampcook tailor1",text:"swampcook tailor1 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook tailor2"]}]},locks_lines:["swampcook tailor1"]}),"swampcook tailor2":new k({name:"swampcook tailor2",text:"swampcook tailor2 answ",is_unlocked:!1,locks_lines:["swampcook tailor2"]}),"swampcook tailorend":new k({name:"swampcook tailorend",text:"swampcook tailorend answ",is_unlocked:!1,locks_lines:["swampcook tailor1","swampcook tailor2","swampcook tailorend"]}),"swampcook tanner":new k({name:"swampcook tanner",text:"swampcook tanner answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook tanner1","swampcook tannerend"]}]},locks_lines:["swampcook tanner"]}),"swampcook tanner1":new k({name:"swampcook tanner1",text:"swampcook tanner1 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook tanner2"]}]},locks_lines:["swampcook tanner1"]}),"swampcook tanner2":new k({name:"swampcook tanner2",text:"swampcook tanner2 answ",is_unlocked:!1,locks_lines:["swampcook tanner2"]}),"swampcook tannerend":new k({name:"swampcook tannerend",text:"swampcook tannerend answ",is_unlocked:!1,locks_lines:["swampcook tanner1","swampcook tanner2","swampcook tannerend"]}),"swampcook peopleend":new k({name:"swampcook peopleend",text:"swampcook peopleend answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook whycrab","swampcook tumana"]}],dialogues:["swampland tailor"],quest_progress:[{quest_id:"In Times of Need",task_index:3}]},locks_lines:["swampcook history","swampcook history1","swampcook history2","swampcook history3","swampcook historyend","swampcook surround","swampcook surround1","swampcook surround2","swampcook surround3","swampcook surround4","swampcook surroundend","swampcook chief","swampcook chief1","swampcook chief2","swampcook chief3","swampcook chiefend","swampcook people","swampcook cook","swampcook cook2","swampcook trader","swampcook trader1","swampcook trader2","swampcook trader3","swampcook traderend","swampcook tailor","swampcook tailor1","swampcook tailor2","swampcook tailorend","swampcook tanner","swampcook tanner1","swampcook tanner2","swampcook tannerend","swampcook peopleend"]}),"swampcook whycrab":new k({name:"swampcook whycrab",text:"swampcook whycrab answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook whycrabpress","swampcook whycrabdrop"]}]},locks_lines:["swampcook whycrab"]}),"swampcook whycrabpress":new k({name:"swampcook whycrabpress",text:"swampcook whycrabpress answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook liked"]}]},locks_lines:["swampcook whycrabpress","swampcook whycrabdrop"]}),"swampcook whycrabdrop":new k({name:"swampcook whycrabdrop",text:"swampcook whycrabdrop answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook liked"]}]},locks_lines:["swampcook whycrabpress","swampcook whycrabdrop"]}),"swampcook nolore":new k({name:"swampcook nolore",text:"swampcook nolore answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook liked","swampcook tumana","swampcook noloreteach"]}],dialogues:["swampland tailor"],quest_progress:[{quest_id:"In Times of Need",task_index:3}]},locks_lines:["swampcook yeslore","swampcook nolore"]}),"swampcook liked":new k({name:"swampcook liked",text:"swampcook liked answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland cook",lines:["swampcook menaka"]}]}}),"swampcook noloreteach":new k({name:"swampcook noloreteach",text:"swampcook noloreteach answ",is_unlocked:!1,rewards:{recipes:[{category:"cooking",subcategory:"items",recipe_id:"Alligator jerky"},{category:"cooking",subcategory:"items",recipe_id:"Turtle jerky"},{category:"cooking",subcategory:"items",recipe_id:"Snake jerky"},{category:"cooking",subcategory:"items",recipe_id:"Swampland skewer"}]},locks_lines:["swampcook noloreteach"]}),"swampcook obaru":new k({name:"swampcook obaru",text:"swampcook obaru answ",is_unlocked:!1,locks_lines:["swampcook obaru"]}),"swampcook kazoku":new k({name:"swampcook kazoku",text:"swampcook kazoku answ",is_unlocked:!1,locks_lines:["swampcook kazoku"]}),"swampcook sosso":new k({name:"swampcook sosso",text:"swampcook sosso answ",is_unlocked:!1,locks_lines:["swampcook sosso"]}),"swampcook zalgo":new k({name:"swampcook zalgo",text:"swampcook zalgo answ",is_unlocked:!1,locks_lines:["swampcook zalgo"]}),"swampcook menaka":new k({name:"swampcook menaka",text:"swampcook menaka answ",is_unlocked:!1}),"swampcook tumana":new k({name:"swampcook tumana",text:"swampcook tumana answ",is_unlocked:!1,locks_lines:["swampcook tumana"]})},actions:{"swampcook deliver":new Et({action_id:"swampcook deliver",starting_text:"swampcook deliver",description:"",action_text:"",success_text:"swampcook deliver answ",repeatable:!1,failure_texts:{unable_to_begin:["swampcook deliver not"]},required:{items_by_id:{"Crab meat":{count:60,remove_on_success:!0}}},attempt_duration:0,success_chances:[1],rewards:{quest_progress:[{quest_id:"In Times of Need",task_index:2}],textlines:[{dialogue:"swampland cook",lines:["swampcook know","swampcook kazoku"]}],locks:{textlines:{"swampland chief":["swampchief mid help"]}}},locks_lines:["swampcook deliver","swampcook obaru"]})},getDescription:()=>q["swampland cook"].actions["swampcook deliver"].is_finished?"swampcook description 3":q["swampland cook"].textlines["swampcook help"].is_finished?"swampcook description 2":"swampcook description 1"}),q["swampland tailor"]=new nt({name:"swampland tailor",is_unlocked:!1,textlines:{"swamptailor interrupt":new k({name:"swamptailor interrupt",text:"swamptailor interrupt answ",is_unlocked:!0,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor cookword"]}]},locks_lines:["swamptailor interrupt","swamptailor listen1","swamptailor listen2","swamptailor listen3","swamptailor listen4","swamptailor listen5","swamptailor listen6","swamptailor listen7","swamptailor listen8"]}),"swamptailor listen1":new k({name:"swamptailor listen1",text:"swamptailor listen1 answ",is_unlocked:!0,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor listen2"]}]},locks_lines:["swamptailor listen1"]}),"swamptailor listen2":new k({name:"swamptailor listen2",text:"swamptailor listen2 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor listen3"]}]},locks_lines:["swamptailor listen2"]}),"swamptailor listen3":new k({name:"swamptailor listen3",text:"swamptailor listen3 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor listen4"]}]},locks_lines:["swamptailor listen3"]}),"swamptailor listen4":new k({name:"swamptailor listen4",text:"swamptailor listen4 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor listen5"]}]},locks_lines:["swamptailor listen4"]}),"swamptailor listen5":new k({name:"swamptailor listen5",text:"swamptailor listen5 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor listen6"]}]},locks_lines:["swamptailor listen5"]}),"swamptailor listen6":new k({name:"swamptailor listen6",text:"swamptailor listen6 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor listen7"]}]},locks_lines:["swamptailor listen6"]}),"swamptailor listen7":new k({name:"swamptailor listen7",text:"swamptailor listen7 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor listen8"]}]},locks_lines:["swamptailor listen7"]}),"swamptailor listen8":new k({name:"swamptailor listen8",text:"swamptailor listen8 answ",is_unlocked:!1,locks_lines:["swamptailor listen8"]}),"swamptailor cookword":new k({name:"swamptailor cookword",text:"swamptailor cookword answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor help"]}]},locks_lines:["swamptailor cookword"]}),"swamptailor help":new k({name:"swamptailor help",text:"swamptailor help answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland tailor",lines:["swamptailor flax"]}]},locks_lines:["swamptailor help"]}),"swamptailor flax":new k({name:"swamptailor flax",text:"swamptailor flax answ",is_unlocked:!1,rewards:{actions:[{dialogue:"swampland tailor",action:"swamptailor deliver"}],activities:[{location:"Riverbank",activity:"herbalism"}],quest_progress:[{quest_id:"In Times of Need",task_index:4}]},locks_lines:["swamptailor flax"]}),"swamptailor liked":new k({name:"swamptailor liked",text:"swamptailor liked answ",is_unlocked:!1})},actions:{"swamptailor deliver":new Et({action_id:"swamptailor deliver",starting_text:"swamptailor deliver",description:"",action_text:"",success_text:"swamptailor deliver answ",repeatable:!1,failure_texts:{unable_to_begin:["swamptailor deliver not"]},required:{items_by_id:{Flax:{count:200,remove_on_success:!0}}},attempt_duration:0,success_chances:[1],rewards:{quest_progress:[{quest_id:"In Times of Need",task_index:5}],textlines:[{dialogue:"swampland tailor",lines:["swamptailor liked"]}],recipes:[{category:"crafting",subcategory:"items",recipe_id:"Linen cloth"}],dialogues:["swampland tanner"]},locks_lines:["swamptailor deliver"]})},getDescription:()=>q["swampland tailor"].actions["swamptailor deliver"].is_finished?"swamptailor description 3":q["swampland tailor"].textlines["swamptailor interrupt"].is_finished?"swamptailor description 2":"swamptailor description 1"}),q["swampland tanner"]=new nt({name:"swampland tanner",is_unlocked:!1,textlines:{"swamptanner unknown":new k({name:"swamptanner unknown",text:"swamptanner unknown answ",is_unlocked:!0,rewards:{textlines:[{dialogue:"swampland tanner",lines:["swamptanner help"]}]},locks_lines:["swamptanner unknown"]}),"swamptanner help":new k({name:"swamptanner help",text:"swamptanner help answ",is_unlocked:!1,rewards:{quest_progress:[{quest_id:"In Times of Need",task_index:6}],actions:[{dialogue:"swampland tanner",action:["swamptanner deliver 1"]}]},locks_lines:["swamptanner help"]}),"swamptanner known":new k({name:"swamptanner known",text:"swamptanner known answ",is_unlocked:!1,rewards:{quest_progress:[{quest_id:"In Times of Need",task_index:8}],actions:[{dialogue:"swampland tanner",action:["swamptanner deliver 2"]}]},locks_lines:["swamptanner known"]}),"swamptanner liked":new k({name:"swamptanner liked",text:"swamptanner liked answ",is_unlocked:!1})},actions:{"swamptanner deliver 1":new Et({action_id:"swamptanner deliver 1",starting_text:"swamptanner deliver 1",description:"",action_text:"",success_text:"swamptanner deliver 1 answ",repeatable:!1,failure_texts:{unable_to_begin:["swamptanner deliver 1 not"]},required:{items_by_id:{"Alligator skin":{count:60,remove_on_success:!0}}},attempt_duration:0,success_chances:[1],rewards:{quest_progress:[{quest_id:"In Times of Need",task_index:7}],textlines:[{dialogue:"swampland tanner",lines:["swamptanner known"]}]},locks_lines:["swamptanner deliver 1"]}),"swamptanner deliver 2":new Et({action_id:"swamptanner deliver 2",starting_text:"swamptanner deliver 2",description:"",action_text:"",success_text:"swamptanner deliver 2 answ",repeatable:!1,failure_texts:{unable_to_begin:["swamptanner deliver 2 not"]},required:{items_by_id:{"Giant snake skin":{count:60,remove_on_success:!0}}},attempt_duration:0,success_chances:[1],rewards:{quest_progress:[{quest_id:"In Times of Need",task_index:9}],textlines:[{dialogue:"swampland tanner",lines:["swamptanner liked"]},{dialogue:"swampland chief",lines:["swampchief report"]}],recipes:[{category:"butchering",subcategory:"items",recipe_id:"Piece of alligator leather"},{category:"butchering",subcategory:"items",recipe_id:"Piece of snakeskin leather"},{category:"butchering",subcategory:"items",recipe_id:"Turtle shellplate"}],locks:{textlines:{"swampland chief":["swampchief mid help"]}}},locks_lines:["swamptanner deliver 2"]})},getDescription:()=>q["swampland tanner"].actions["swamptanner deliver 2"].is_finished?"swamptanner description 3":q["swampland tanner"].actions["swamptanner deliver 1"].is_finished?"swamptanner description 2":"swamptanner description 1"}),q["swampland scout"]=new nt({name:"swampland scout",textlines:{"swampscout meet":new k({name:"swampscout meet",text:"swampscout meet answ",is_unlocked:!0,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout lore1"]}]},locks_lines:["swampscout meet"]}),"swampscout lore1":new k({name:"swampscout lore1",text:"swampscout lore1 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout lore2"]}]},locks_lines:["swampscout lore1"]}),"swampscout lore2":new k({name:"swampscout lore2",text:"swampscout lore2 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout lore3"]}]},locks_lines:["swampscout lore2"]}),"swampscout lore3":new k({name:"swampscout lore3",text:"swampscout lore3 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout lore4"]}]},locks_lines:["swampscout lore3"]}),"swampscout lore4":new k({name:"swampscout lore4",text:"swampscout lore4 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout lore5"]}]},locks_lines:["swampscout lore4"]}),"swampscout lore5":new k({name:"swampscout lore5",text:"swampscout lore5 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout lore6"]}]},locks_lines:["swampscout lore5"]}),"swampscout lore6":new k({name:"swampscout lore6",text:"swampscout lore6 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout lore7"]}]},locks_lines:["swampscout lore6"]}),"swampscout lore7":new k({name:"swampscout lore7",text:"swampscout lore7 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout lore8"]}]},locks_lines:["swampscout lore7"]}),"swampscout lore8":new k({name:"swampscout lore8",text:"swampscout lore8 answ",is_unlocked:!1,rewards:{textlines:[{dialogue:"swampland scout",lines:["swampscout generic"]},{dialogue:"swampland scout",lines:["swampscout foraging"]}]},locks_lines:["swampscout lore8"]}),"swampscout generic":new k({name:"swampscout generic",text:"swampscout generic answ",is_unlocked:!1,rewards:{actions:[{dialogue:"swampland scout",action:["swampscout help"]}]}}),"swampscout foraging":new k({name:"swampscout foraging",text:"swampscout foraging answ",is_unlocked:!1,rewards:{actions:[{location:"Longhouse",action:"learn forage"}]},locks_lines:["swampscout foraging"]})},actions:{"swampscout help":new Et({action_id:"swampscout help",starting_text:"swampscout help",description:"",action_text:"",success_text:"swampscout help answ",repeatable:!1,failure_texts:{unable_to_begin:["swampscout help not"]},required:{items_by_id:{"Healing potion":{count:1,remove_on_success:!0}}},attempt_duration:0,success_chances:[1]})},getDescription:()=>q["swampland scout"].actions["swampscout help"].is_finished?"swampscout description 4":q["swampland scout"].textlines["swampscout foraging"].is_finished?"swampscout description 3":q["swampland scout"].textlines["swampscout meet"].is_finished?"swampscout description 2":"swampscout description 1"})})();Object.keys(q).forEach(e=>{let t=q[e];q[e].id=e,q[e].getName()||(q[e].name=e),Object.keys(t.textlines).forEach(i=>{let a=t.textlines[i];a.locks_lines&&(a.rewards.locks.textlines[e]||(a.rewards.locks.textlines[e]=[]),a.rewards.locks.textlines[e].push(...a.locks_lines))})});var A={},Bn=class{constructor({name:t,description:i,action_text:a,base_skills_names:s,is_unlocked:n=!1,getBackgroundNoises:o}){this.name=t,this.description=i,this.action_text=a,this.base_skills_names=s,this.tags=[],this.is_unlocked=n,this.getBackgroundNoises=o||function(){return[]}}},Wn=class extends Bn{constructor(t){super(t),this.type="JOB",this.payment_type=t.payment_type}},Jt=class extends Bn{constructor(t){super(t),this.type="TRAINING"}},Mi=class extends Jt{constructor({name:t,description:i,action_text:a,base_skills_names:s,is_unlocked:n=!1,required_tool_type:o,getBackgroundNoises:l=null}){super({name:t,description:i,action_text:a,base_skills_names:s,is_unlocked:n,getBackgroundNoises:l}),this.type="GATHERING",this.tags.gathering=!0,this.required_tool_type=o}};(function(){A.fieldwork=new Wn({name:"fieldwork",action_text:"Working on the fields",description:"It's tiring and doesn't pay much, but it's better than doing nothing",base_skills_names:["Farming"],is_unlocked:!0}),A.patrolling=new Wn({name:"patrolling",action_text:"Patrolling",description:"Nothing ever happens",base_skills_names:["Spatial awareness"],is_unlocked:!0})})();(function(){A.running=new Jt({name:"running",action_text:"Just running around",description:"One of the most basic exercises",base_skills_names:["Running"],is_unlocked:!0}),A.weightlifting=new Jt({name:"weightlifting",action_text:"Carrying heavy things",description:"One of the most basic exercises",base_skills_names:["Weightlifting"],is_unlocked:!0}),A.balancing=new Jt({name:"balancing",action_text:"Trying to keep your balance",description:"One of the most basic exercises",base_skills_names:["Equilibrium"],is_unlocked:!0}),A.swimming=new Jt({name:"swimming",action_text:"Splish, splash, splosh",description:"A rather basic, although somewhat risky exercise",base_skills_names:["Swimming"],is_unlocked:!1}),A.meditating=new Jt({name:"meditating",action_text:"Focusing your mind",description:"A somewhat basic exercise",base_skills_names:["Meditation"],is_unlocked:!0}),A.climbing=new Jt({name:"climbing",action_text:"Looking for next grip to hold to",description:"An advanced exercise that uses majority of muscles in the body",base_skills_names:["Climbing"],is_unlocked:!1}),A.enduring=new Jt({name:"enduring",action_text:"Withstanding the elements",description:"An advanced technique that hardens your resolve more than your body",base_skills_names:["Persistence"],is_unlocked:!0})})();(function(){A.mining=new Mi({name:"mining",action_text:"Swinging the pickaxe",description:"Swing you pickaxe against the hard rock",base_skills_names:["Mining"],is_unlocked:!0,required_tool_type:"pickaxe",getBackgroundNoises:()=>["clang clang","clink clink","tink tink","crunch","*Your pickaxe strikes the heart of the rock*"]}),A.digging=new Mi({name:"digging",action_text:"Swinging the shovel",description:"Dig up useful materials with a shovel",base_skills_names:["Digging"],is_unlocked:!0,required_tool_type:"shovel",getBackgroundNoises:()=>["plap plap","plop plop","crunch","thwack","scrape","squelch"]}),A.woodcutting=new Mi({name:"woodcutting",action_text:"Gathering wood",description:"Chop chop",base_skills_names:["Woodcutting"],is_unlocked:!0,required_tool_type:"axe",getBackgroundNoises:()=>["chop","CHOP chop","chop CHOP","chop chop","creeeak","Sap oozes from the gash","*Splinters burst from under your axe*","*A pinecone falls on you*","*A squirrel is upset with you*"]}),A.herbalism=new Mi({name:"herbalism",action_text:"Searching for herbs",description:"Look for any useful plants and mushrooms",base_skills_names:["Herbalism"],is_unlocked:!0,required_tool_type:"sickle",getBackgroundNoises:()=>["*rustle*","A frog is watching you work","You find a particularly impressive snail under a leaf"]}),A["animal care"]=new Mi({name:"animal care",action_text:"Tending to animals",description:"Take care of animals",base_skills_names:["Animal handling"],is_unlocked:!0}),A.fishing=new Mi({name:"fishing",action_text:"Waiting for a bite",description:"Try to catch some fish",base_skills_names:["Fishing"],is_unlocked:!0,required_tool_type:"fishing_pole",getBackgroundNoises:()=>["*Nothing bites*","*You feel a light tug, but no bite*","*The fish escapes before you can reel it in*","*The fish steals your bait*","*Your catch gets swiped by a bigger fish*","*Your catch gets swiped by a passing bird*","*Your catch flies away*"]})})();var U={},Xt={},he={SMALL:"small",MEDIUM:"medium",LARGE:"large"},On={beast:"Butchering"},Gt={small:["Pest killer"],large:["Giant slayer"]},Pn={};Object.keys(On).forEach(e=>{Pn[On[e]]=e});var ne=class{constructor({name:t,id:i,description:a,xp_value:s=1,stats:n,rank:o,loot_list:l=[],size:d="small",add_to_bestiary:u=!0,tags:h=[],on_hit:_=g=>{},on_damaged:w=g=>{},on_death:b=g=>{}}){if(this.name=t,this.id=i,this.rank=o,this.description=a,this.xp_value=s,this.stats=n,this.stats.max_health=n.health,this.loot_list=l,this.tags={},h.length)for(let g=0;g<h.length;g++)this.tags[h[g]]=!0;else Object.keys(h).length&&Object.keys(h).forEach(g=>{this.tags[g]=!0});if(this.tags[d]=!0,this.add_to_bestiary=u,d!==he.SMALL&&d!==he.MEDIUM&&d!==he.LARGE)throw new Error(`No such enemy size option as "${d}"!`);this.size=d,this.on_hit=_,this.on_damaged=w,this.on_death=b}get_loot({drop_chance_modifier:t=1}={}){let i=[],a;for(let s=0;s<this.loot_list.length;s++)if(a=this.loot_list[s],a.chance*this.get_droprate_modifier(t)>=Math.random()){let n=1;"count"in a&&(n=Math.round(Math.random()*(a.count.max-a.count.min)+a.count.min)),i.push({item_id:a.item_name,count:n})}return i}get_droprate_modifier(t=1){let i=1*t;return Object.keys(this.tags).forEach(a=>{On[a]&&(i*=R({skill_id:On[a],scaling_type:"multiplicative"}))}),i}},Gs={bufotoxin(e){let t=["Irritation","Confusion","Hallucinations","Weak necrotizing venom","Mild necrotizing venom","Paralysing poison","Infected lungs","Convulsive poison"];ci(t[Math.floor(Math.random()*t.length)],e)}};(function(){U["Starving wolf rat"]=new ne({name:"Starving wolf rat",description:"Rat with size of a dog, starved and weakened",xp_value:1,rank:1,size:"small",tags:["living","beast","wolf rat"],stats:{health:20,attack:4,agility:5,dexterity:4,magic:0,intuition:5,attack_speed:.8,defense:1},loot_list:[{item_name:"Rat tail",chance:.04},{item_name:"Rat fang",chance:.04},{item_name:"Rat pelt",chance:.01}]}),U["Wolf rat"]=new ne({name:"Wolf rat",description:"Rat with size of a dog",xp_value:1,rank:1,size:"small",tags:["living","beast","wolf rat"],stats:{health:30,attack:6,agility:6,dexterity:5,intuition:6,magic:0,attack_speed:1,defense:2},loot_list:[{item_name:"Rat tail",chance:.04},{item_name:"Rat fang",chance:.04},{item_name:"Rat pelt",chance:.01}]}),U["Elite wolf rat"]=new ne({name:"Elite wolf rat",description:"Rat with size of a dog, much more ferocious than its relatives",xp_value:4,rank:2,size:he.SMALL,tags:["living","beast","wolf rat"],stats:{health:80,attack:32,agility:30,dexterity:24,intuition:24,magic:0,attack_speed:1.5,defense:8},loot_list:[{item_name:"Rat tail",chance:.04},{item_name:"Rat fang",chance:.04},{item_name:"Rat pelt",chance:.02}]}),U["Elite wolf rat guardian"]=new ne({name:"Elite wolf rat guardian",description:"It's no longer dog-sized, but rather around the size of an average wolf, with thicker skin, longer claws and pure insanity in the eyes",xp_value:15,rank:4,size:he.MEDIUM,tags:["living","beast","wolf rat","monster"],stats:{health:600,attack:60,agility:50,dexterity:50,intuition:50,magic:0,attack_speed:1.2,defense:30},loot_list:[{item_name:"Rat tail",chance:.04},{item_name:"Rat fang",chance:.04},{item_name:"Rat pelt",chance:.02},{item_name:"Weak monster bone",chance:.005}]}),U["Wall rat"]=new ne({name:"Wall rat",description:"They don't live in the walls, they ARE the walls. Insane writhing masses of teeth, fangs, and tails, that make no logical sense. An abomination that cannot exist, and yet it does",xp_value:50,rank:8,size:he.LARGE,tags:["living","beast","wolf rat","monster","eldritch"],stats:{health:4e3,attack:100,agility:2,dexterity:120,intuition:200,magic:0,attack_speed:2,attack_count:4,defense:20},loot_list:[{item_name:"Rat tail",chance:.08},{item_name:"Rat fang",chance:.08}]}),U["Starving wolf"]=new ne({name:"Starving wolf",description:"A big, wild and hungry canine",xp_value:5,rank:2,tags:["living","beast"],stats:{health:200,attack:22,agility:34,dexterity:34,intuition:32,magic:0,attack_speed:1,defense:12},loot_list:[{item_name:"Wolf fang",chance:.03},{item_name:"Wolf pelt",chance:.01}],size:he.MEDIUM}),U["Young wolf"]=new ne({name:"Young wolf",description:"A small, wild canine",xp_value:5,rank:2,tags:["living","beast"],stats:{health:150,attack:25,agility:34,dexterity:30,intuition:24,magic:0,attack_speed:1.4,defense:6},loot_list:[{item_name:"Wolf fang",chance:.03},{item_name:"Wolf pelt",chance:.01}],size:he.SMALL}),U.Wolf=new ne({name:"Wolf",description:"A large, wild canine",xp_value:8,rank:3,tags:["living","beast"],stats:{health:250,attack:40,agility:50,dexterity:50,intuition:40,magic:0,attack_speed:1.3,defense:20},loot_list:[{item_name:"Wolf fang",chance:.04},{item_name:"Wolf pelt",chance:.02},{item_name:"High quality wolf fang",chance:5e-4}],size:he.MEDIUM}),U.Direwolf=new ne({name:"Direwolf",description:"A powerful wild wolf variant of unmatched ferocity",xp_value:20,rank:7,tags:["living","beast"],stats:{health:1e3,attack:160,agility:160,dexterity:70,intuition:70,magic:0,attack_speed:1.4,defense:30},loot_list:[{item_name:"Wolf fang",chance:.08},{item_name:"Wolf pelt",chance:.04},{item_name:"High quality wolf fang",chance:.001},{item_name:"Weak monster bone",chance:.02}],size:he.MEDIUM}),U["Direwolf hunter"]=new ne({name:"Direwolf hunter",description:"A powerful wild wolf variant of unmatched ferocity, the strongest and heaviest out of all direwolves",xp_value:30,rank:7,tags:["living","beast"],stats:{health:2e3,attack:240,agility:130,dexterity:80,intuition:90,magic:0,attack_speed:1.1,defense:40},loot_list:[{item_name:"Wolf fang",chance:.12},{item_name:"Wolf pelt",chance:.06},{item_name:"Weak monster bone",chance:.02},{item_name:"High quality wolf fang",chance:.0015}],size:he.MEDIUM}),U.Boar=new ne({name:"Boar",description:"A big wild creature, with thick skin and large tusks",xp_value:10,rank:4,tags:["living","beast"],stats:{health:600,attack:50,agility:30,dexterity:50,intuition:60,magic:0,attack_speed:1,defense:35},loot_list:[{item_name:"Boar hide",chance:.04},{item_name:"Boar meat",chance:.02},{item_name:"Boar tusk",chance:.02},{item_name:"High quality boar tusk",chance:5e-4}],size:he.MEDIUM}),U.Warthog=new ne({name:"Warthog",description:"A large, aggressive porcine creature with a tough hide and large tusks",xp_value:30,rank:5,tags:["living","beast"],stats:{health:12e3,attack:600,agility:80,dexterity:800,intuition:100,magic:0,attack_speed:.6,defense:600},loot_list:[{item_name:"Boar hide",chance:.08},{item_name:"Boar meat",chance:.1},{item_name:"Boar tusk",chance:.05},{item_name:"High quality boar tusk",chance:.005}],size:he.LARGE}),U["Angry mountain goat"]=new ne({name:"Angry mountain goat",description:"It's a mountain goat and it's angry",xp_value:15,rank:6,tags:["living","beast"],size:he.MEDIUM,stats:{health:600,attack:120,agility:100,dexterity:60,magic:0,intuition:60,attack_speed:.5,defense:50},loot_list:[{item_name:"Mountain goat hide",chance:.04},{item_name:"Goat meat",chance:.02},{item_name:"Mountain goat horn",chance:.02},{item_name:"Pristine mountain goat horn",chance:5e-4}]}),U["Forest bear"]=new ne({name:"Forest bear",description:"A mighty and dangerous predator with thick skin, sharp teeth, and dangerous claws",xp_value:60,rank:8,tags:["living","beast"],stats:{health:6e3,attack:600,agility:160,dexterity:200,intuition:200,magic:0,attack_speed:.8,defense:500},loot_list:[{item_name:"Bear hide",chance:.05},{item_name:"Bear claw",chance:.1},{item_name:"Sharp bear claw",chance:.002}],size:he.LARGE}),U.Frog=new ne({name:"Frog",description:"A huge beast with muscular legs and a mouth large enough to swallow a direwolf whole",xp_value:80,rank:8,tags:["living","beast"],stats:{health:12e3,attack:500,agility:250,dexterity:300,intuition:100,magic:0,attack_speed:.8,defense:400},loot_list:[{item_name:"Frog meat",chance:.08},{item_name:"Frog hide",chance:.05},{item_name:"Weak monster bone",chance:.05}],size:he.LARGE,on_hit:e=>{let t=Math.random();t<.1?(C("The frog's long tongue leaves you covered in sticky saliva!","hero_attacked"),ci("Sticky",30)):t<.2&&(C("The frog's attack leaves some of its toxins on you!","hero_attacked"),Gs.bufotoxin(10))},on_damaged:e=>{let t=Math.random();e.equipment.weapon==null&&t<.1?(C("Touching the frog with your bare hands leaves them covered in toxins!","hero_attacked"),Gs.bufotoxin(10)):e.equipment.weapon!=null&&t<.05&&(C("Striking the frog causes some toxins to splash on you!","hero_attacked"),Gs.bufotoxin(10))}}),U["Red ant swarm"]=new ne({name:"Red ant swarm",description:"A swarm of angry red ants, each the size of a regular rat",xp_value:20,rank:7,tags:["living","insect"],stats:{health:600,attack:4,agility:100,dexterity:200,intuition:100,magic:0,attack_speed:1.5,attack_count:30,defense:10},size:he.SMALL,loot_list:[{item_name:"Oneberry",chance:.005},{item_name:"Golmoon leaf",chance:.005},{item_name:"Belmart leaf",chance:.005},{item_name:"Piece of wood",chance:.005}]}),U["Red ant queen"]=new ne({name:"Red ant queen",description:"A red ant queen, despite her decent size she's not much of a fighter",xp_value:10,rank:5,tags:["living","insect"],stats:{health:200,attack:20,agility:50,dexterity:200,intuition:100,magic:0,attack_speed:.5,defense:20},size:he.SMALL}),U["Slums thug"]=new ne({name:"Slums thug",description:"A nasty thug with shabby equipment",xp_value:10,rank:5,tags:["living","human"],size:he.MEDIUM,stats:{health:500,attack:60,agility:60,dexterity:60,magic:0,intuition:60,attack_speed:1.7,defense:45}}),U["River crab"]=new ne({name:"River crab",description:"A crab the size of a small boulder",xp_value:30,rank:7,size:he.SMALL,tags:["living","beast","aquatic"],stats:{health:2e3,attack:75,agility:120,dexterity:90,intuition:50,magic:0,attack_speed:1.3,attack_count:2,defense:145},loot_list:[{item_name:"Crab meat",chance:.02}]}),U["Stone crab"]=new ne({name:"Stone crab",description:"A crab the size of a large boulder, and about as hard to crack open",xp_value:50,rank:8,size:he.MEDIUM,tags:["living","beast","aquatic"],stats:{health:7e3,attack:160,agility:180,dexterity:160,intuition:120,magic:0,attack_speed:1.7,attack_count:2,defense:700},loot_list:[{item_name:"Crab meat",chance:.05},{item_name:"Crab claw",chance:.01},{item_name:"Giant crab claw",chance:.005}]}),U.Alligator=new ne({name:"Alligator",description:"An alligator in it's natural habitat is one of the deadliest predators in nature",xp_value:150,rank:9,size:he.LARGE,tags:["living","beast","aquatic"],stats:{health:16750,attack:830,agility:250,dexterity:350,intuition:120,magic:0,attack_speed:1.6,defense:545},loot_list:[{item_name:"Alligator meat",chance:.02},{item_name:"Alligator skin",chance:.01}]}),U["Snapping turtle"]=new ne({name:"Snapping turtle",description:"A large turtle with an incredibly dense shell",xp_value:250,rank:10,size:he.MEDIUM,tags:["living","beast","aquatic"],stats:{health:22e3,attack:525,agility:230,dexterity:220,intuition:130,magic:0,attack_speed:.9,defense:1e3},loot_list:[{item_name:"Turtle meat",chance:.02},{item_name:"Turtle shell",chance:.005}]}),U["Giant snake"]=new ne({name:"Giant snake",description:"This large snake is fast enough to catch even the most cautious warriors by surprise",xp_value:300,rank:10,size:he.LARGE,tags:["living","beast"],stats:{health:12500,attack:440,agility:260,dexterity:460,intuition:150,magic:0,attack_speed:2.7,defense:385},loot_list:[{item_name:"Giant snake meat",chance:.02},{item_name:"Giant snake skin",chance:.01}]})})();(function(){U["Village guard (heavy)"]=new ne({name:"Village guard (heavy)",description:"",add_to_bestiary:!1,xp_value:1,rank:4,tags:["living","human"],size:he.MEDIUM,stats:{health:300,attack:50,agility:20,dexterity:80,magic:0,intuition:20,attack_speed:.2,defense:30}}),U["Village guard (quick)"]=new ne({name:"Village guard (quick)",description:"",add_to_bestiary:!1,xp_value:1,rank:4,tags:["living","human"],size:he.MEDIUM,stats:{health:300,attack:20,agility:20,dexterity:50,magic:0,intuition:20,attack_speed:2,defense:10}}),U["Suspicious wall"]=new ne({name:"Suspicious wall",description:"",add_to_bestiary:!1,xp_value:1,rank:1,tags:["inanimate"],size:he.LARGE,stats:{health:1e4,attack:0,agility:0,dexterity:0,magic:0,intuition:0,attack_speed:1e-6,defense:100}}),U["Suspicious man"]=new ne({name:"Suspicious man",description:"",add_to_bestiary:!1,xp_value:1,rank:5,tags:["living","human"],size:he.MEDIUM,stats:{health:400,attack:60,agility:60,dexterity:60,magic:0,intuition:60,attack_speed:2,defense:30}}),U["Angry-looking mountain goat"]=new ne({name:"Angry-looking mountain goat",description:"It's a mountain goat and it's angry",add_to_bestiary:!1,xp_value:1,rank:6,tags:["living","beast"],size:he.MEDIUM,stats:{health:1200,attack:150,agility:100,dexterity:70,magic:0,intuition:60,attack_speed:.5,defense:60}}),U["Giant crab"]=new ne({name:"Giant crab",description:"This was the biggest crab you had ever seen. It's also the smallest crab you had ever seen",add_to_bestiary:!1,xp_value:1,rank:11,size:he.LARGE,tags:["living","beast","aquatic"],stats:{health:3e4,attack:250,agility:600,dexterity:1e3,intuition:70,magic:0,attack_speed:1.3,attack_count:2,defense:4e3}}),U["Enraged giant crab"]=new ne({name:"Enraged giant crab",description:"Graa~! Crab battle!",add_to_bestiary:!1,xp_value:1,rank:11,size:he.LARGE,tags:["living","beast","aquatic"],stats:{health:22e3,attack:400,agility:450,dexterity:700,intuition:100,magic:0,attack_speed:1.6,attack_count:2,defense:2e3},loot_list:[{item_name:"Giant crab claw",chance:1}]})})();Object.keys(U).forEach(e=>{U[e].id=e});var m={},$e={},ut={},ye=class{constructor({name:t,id:i,description:a,connected_locations:s=[],is_unlocked:n=!0,is_finished:o=!1,dialogues:l=[],traders:d=[],market_region:u=null,types:h=[],housing:_={},light_level:w="normal",getDescription:b,background_noises:g=[],getBackgroundNoises:v,crafting:y=null,tags:I={},is_temperature_static:$=!1,static_temperature:_e=null,reverse_day_night_temperatures:Le=!1,temperature_range_modifier:Ve=1,temperature_modifier:Ge=0,is_under_roof:He=!1,entrance_rewards:oi}){this.name=t,this.id=i,this.description=a,this.getDescription=b||function(){return a},this.background_noises=g,this.getBackgroundNoises=v||function(){return g},this.connected_locations=s,this.is_unlocked=n,this.is_finished=o,this.dialogues=l,this.traders=d,this.market_region=u,u&&(Ls[u]=!0),this.activities={},this.actions={},this.types=h,this.housing=_,this.light_level=w,this.crafting=y,this.tags=I,this.tags.safe_zone=!0,this.entrance_rewards=oi,this.is_temperature_static=$,this.static_temperature=_e,this.reverse_day_night_temperatures=Le,this.temperature_range_modifier=Ve,this.temperature_modifier=Ge,this.is_under_roof=He}},ke=class{constructor({name:t,id:i,description:a,getDescription:s,is_unlocked:n=!0,is_finished:o=!1,types:l=[],enemy_groups_list:d=[],is_enemy_groups_list_random:u=!0,predefined_lineup_on_nth_group:h=1,enemies_list:_=[],enemy_group_size:w=[1,1],enemy_count:b=30,enemy_stat_variation:g=0,parent_location:v,leave_text:y,first_reward:I={},repeatable_reward:$={},rewards_with_clear_requirement:_e=[],otherUnlocks:Le,unlock_text:Ve,is_challenge:Ge=!1,tags:He={},is_temperature_static:oi=!1,static_temperature:li=null,reverse_day_night_temperatures:lt=!1,temperature_range_modifier:St=1,temperature_modifier:J=0,is_under_roof:Be=!1}){if(this.name=t,this.id=i,this.unlock_text=Ve,this.description=a,this.getDescription=s||function(){return a},this.otherUnlocks=Le||function(){},this.is_unlocked=n,this.is_finished=o,this.types=l,this.enemy_groups_list=d,this.is_enemy_groups_list_random=u,this.predefined_lineup_on_nth_group=h,this.enemies_list=_,this.enemy_group_size=w,this.enemy_groups_list||(this.enemy_group_size[0]<1&&(this.enemy_group_size[0]=1,console.error(`Minimum enemy group size in zone "${this.name}" is set to unallowed value of ${this.enemy_group_size[0]} and was corrected to lowest value possible of 1`)),this.enemy_group_size[0]>8&&(this.enemy_group_size[0]=8,console.error(`Minimum enemy group size in zone "${this.name}" is set to unallowed value of ${this.enemy_group_size[0]} and was corrected to highest value possible of 8`)),this.enemy_group_size[1]<1&&(this.enemy_group_size[1]=1,console.error(`Maximum enemy group size in zone "${this.name}" is set to unallowed value of ${this.enemy_group_size[1]} and was corrected to lowest value possible of 1`)),this.enemy_group_size[1]>8&&(this.enemy_group_size[1]=8,console.error(`Maximum enemy group size in zone "${this.name}" is set to unallowed value of ${this.enemy_group_size[1]} and was corrected to highest value possible of 8`))),this.enemy_count=b,this.enemy_groups_list.length==0&&this.enemies_list.length==0)throw new Error(`No enemies provided for zone "${this.name}"`);this.enemy_groups_killed=0,this.enemy_stat_variation=g,this.enemy_stat_variation<0&&(this.enemy_stat_variation=0,console.error(`Stat variation for enemies in zone "${this.name}" is set to unallowed value and was corrected to a default 0`)),this.parent_location=v,this.leave_text=y,this.first_reward=I,this.repeatable_reward=$,this.rewards_with_clear_requirement=_e,this.is_challenge=Ge,this.gained_skills=this.types?.map(fe=>({skill:f[$e[fe.type].stages[fe.stage||1].related_skill],xp:fe.xp_gain})).filter(fe=>fe.skill);let rt=this.types.map(fe=>fe.type);rt.includes("bright")?this.light_level="bright":rt.includes("dark")?this.light_level="dark":this.light_level="normal",this.tags=He,this.tags["Combat zone"]=!0,this.is_temperature_static=oi,this.static_temperature=li,this.reverse_day_night_temperatures=lt,this.temperature_range_modifier=St,this.temperature_modifier=J,this.is_under_roof=Be}get_next_enemies(){let t=[],i=[];if(this.enemy_groups_list.length>0&&this.enemy_groups_killed%this.predefined_lineup_on_nth_group==0&&(this.enemy_groups_killed>0||this.predefined_lineup_on_nth_group==0))if(this.is_enemy_groups_list_random){let a=Math.floor(Math.random()*this.enemy_groups_list.length);i=this.enemy_groups_list[a].enemies}else{let a=this.enemy_groups_killed%this.enemy_groups_list.length;i=this.enemy_groups_list[a].enemies}else{let a=this.enemy_group_size[0]+Math.round(Math.random()*(this.enemy_group_size[1]-this.enemy_group_size[0]));for(let s=0;s<a;s++)i.push(this.enemies_list[Math.floor(Math.random()*this.enemies_list.length)])}for(let a=0;a<i.length;a++){let s=U[i[a]],n;if(this.enemy_stat_variation!=0){let o=Math.random()*this.enemy_stat_variation,l=1+o,d=2*o;n=new ne({...s,stats:{health:Math.round(s.stats.health*(l-Math.random()*d)),attack:Math.round(s.stats.attack*(l-Math.random()*d)),agility:Math.round(s.stats.agility*(l-Math.random()*d)),dexterity:Math.round(s.stats.dexterity*(l-Math.random()*d)),magic:Math.round(s.stats.magic*(l-Math.random()*d)),intuition:Math.round(s.stats.intuition*(l-Math.random()*d)),attack_speed:Math.round(s.stats.attack_speed*(l-Math.random()*d)*100)/100,attack_count:Math.round((s.stats.attack_count||1)*(l-Math.random()*d)),defense:Math.round(s.stats.defense*(l-Math.random()*d))}})}else n=new ne({...s,stats:{...s.stats,attack_count:s.stats.attack_count||1}});n.is_alive=!0,t.push(n)}return t}get_total_effect(){let t={multipliers:{},flats:{}},i={multipliers:{},flats:{}};for(let a=0;a<this.types.length;a++){let s=$e[this.types[a].type].stages[this.types[a].stage];!s.related_skill||!s.effects||Object.keys(s.effects).forEach(n=>{s.effects[n].multiplier&&(t.multipliers[n]=(t.multipliers[n]||1)*s.effects[n].multiplier,i.multipliers[n]=(i.multipliers[n]||1)*en(this.types[a].type,this.types[a].stage,n,"multiplier")),s.effects[n].flat&&(t.flats[n]=(t.flats[n]||0)+s.effects[n].flat,i.flats[n]=(i.flats[n]||0)+en(this.types[a].type,this.types[a].stage,n,"flat"))})}return{base_penalty:t,hero_penalty:i}}},zt=class extends ke{constructor(t){super({...t,enemy_stat_variation:0,is_challenge:!0})}},D=class{constructor({activity_name:t,starting_text:i,get_payment:a=()=>1,is_unlocked:s=!0,working_period:n=1,infinite:o=!0,availability_time:l,availability_seasons:d,skill_names:u=null,skill_xp_per_tick:h=1,unlock_text:_,gained_resources:w,require_tool:b=!1,applied_effects:g=[]}){Va(this,"getActivityEfficiency",function(){let t=this.working_period,i=[];if(!this.gained_resources)return{gathering_time_needed:t,gained_resources:i};let a=1;if(this.gained_resources.skill_required&&this.gained_resources.skill_required.length==2){let s=0;for(let n=0;n<A[this.activity_name].base_skills_names?.length;n++)s+=Pl(A[this.activity_name].base_skills_names[n],this.gained_resources.skill_required);a=s/(A[this.activity_name].base_skills_names?.length||1)}t=Math.floor(Qa(this.gained_resources.time_period,a));for(let s=0;s<this.gained_resources.resources.length;s++){let n=Qa(this.gained_resources.resources[s].chance,a),o=Math.round(Qa([this.gained_resources.resources[s].ammount[0][0],this.gained_resources.resources[s].ammount[1][0]],a)),l=Math.round(Qa([this.gained_resources.resources[s].ammount[0][1],this.gained_resources.resources[s].ammount[1][1]],a));i.push({name:this.gained_resources.resources[s].name,count:[o,l],chance:n})}return{gathering_time_needed:t,gained_resources:i}});this.activity_name=t,this.starting_text=i,this.get_payment=a,this.is_unlocked=s,this.unlock_text=_,this.working_period=n,this.infinite=o,l&&d&&(this.infinite=!1),this.infinite?(l||d)&&(this.infinite=!1):d||l||console.error("Activity is set to limited availability, but has neither availability_seasons nor availability_time provided for it"),this.availability_time=l,this.availability_seasons=d,this.skill_names=u,this.skill_xp_per_tick=h.length?h:[h],this.require_tool=b,this.applied_effects=g,this.gained_resources=w;for(let v=0;v<this.gained_resources?.resources.length;v++)this.gained_resources.resources[v].ammount||(this.gained_resources.resources[v].ammount=[[1,1],[1,1]])}},Ht=class{constructor({name:t,related_skill:i,scaling_lvl:a,stages:s={}}){if(this.name=t,this.scaling_lvl=a,i)if(f[i])this.related_skill=i;else throw new Error(`No such skill as "${i}"`);this.stages=s}};function en(e,t,i,a){let s=f[$e[e].stages[t].related_skill],n=$e[e].stages[t].scaling_lvl||s.max_level;if(a==="multiplier")return $e[e].stages[t].effects[i].multiplier**(1-Math.min(n,K(s.skill_id))/n);if(a==="flat")return $e[e].stages[t].effects[i].flat*(1-Math.min(n,K(s.skill_id))/n)**.66667;throw new Error(`Unsupported category of stat effects "${a}", should be either "flat" or "multiplier"!`)}(function(){$e.bright=new Ht({name:"bright",stages:{1:{description:"A place that's always lit, no matter the time of the day"},2:{description:"An extremely bright place, excessive light makes it hard to keep eyes open",related_skill:"Dazzle resistance",effects:{attack_points:{multiplier:.5},evasion_points:{multiplier:.5}}},3:{description:"A place with so much light that an average person would go blind in an instant",related_skill:"Dazzle resistance",effects:{attack_points:{multiplier:.1},evasion_points:{multiplier:.1}}}}}),$e.dark=new Ht({name:"dark",stages:{1:{description:"It's dark here, comparable to a bright night",related_skill:"Night vision"},2:{description:"An extremely dark place, darker than most of the nights",related_skill:"Night vision",effects:{attack_points:{multiplier:.8},evasion_points:{multiplier:.8}}},3:{description:"Pure darkness with not even a tiniest flicker of light",related_skill:"Presence sensing",effects:{attack_points:{multiplier:.15},evasion_points:{multiplier:.15}}}}}),$e.narrow=new Ht({name:"narrow",stages:{1:{description:"A narrow area where there's not much place for maneuvering",related_skill:"Tight maneuvers",scaling_lvl:20,effects:{evasion_points:{multiplier:.5}}},2:{description:"A very tight and narrow area where there's not much place for maneuvering",related_skill:"Tight maneuvers",effects:{evasion_points:{multiplier:.333}},scaling_lvl:40},3:{description:"An area so cramped that it's a miracle you can even move",related_skill:"Tight maneuvers",effects:{evasion_points:{multiplier:.1},dexterity:{multiplier:.5}}},4:{description:"Are you trying to die? One step the wrong way and you fall to your death!",related_skill:"Tight maneuvers",effects:{evasion_points:{multiplier:.05},dexterity:{multiplier:.5}},scaling_lvl:50}}}),$e.open=new Ht({name:"open",stages:{1:{description:"A completely open area where attacks can come from any direction",related_skill:"Spatial awareness",scaling_lvl:30,effects:{evasion_points:{multiplier:.75}}},2:{description:"An area that's completely open and simultanously obstructs your view, making it hard to predict where an attack will come from",related_skill:"Spatial awareness",effects:{evasion_points:{multiplier:.5}}}}}),$e["thin air"]=new Ht({name:"thin air",stages:{1:{description:"Place with thinner air, which negatively impacts your body",related_skill:"Breathing",scaling_lvl:25,effects:{stamina_efficiency:{multiplier:.5},agility:{multiplier:.8},strength:{multiplier:.8},dexterity:{multiplier:.8},intuition:{multiplier:.8}}},2:{description:"Place with very thin air, heavily affecting your body",related_skill:"Breathing",effects:{stamina_efficiency:{multiplier:.1},agility:{multiplier:.5},strength:{multiplier:.5},dexterity:{multiplier:.5},intuition:{multiplier:.5}}}}}),$e.eldritch=new Ht({name:"eldritch",stages:{1:{description:"This place brings a strong sense of unease",related_skill:"Strength of mind",scaling_lvl:30,effects:{agility:{multiplier:.8},dexterity:{multiplier:.8},intuition:{multiplier:.5},stamina_efficiency:{multiplier:.75},health_loss_flat:{flat:-5}}},2:{description:"This place goes against the laws of the world",related_skill:"Strength of mind",effects:{agility:{multiplier:.3},dexterity:{multiplier:.3},intuition:{multiplier:.2},stamina_efficiency:{multiplier:.5},health_loss_flat:{flat:-50}}}}}),$e.rough=new Ht({name:"rough",stages:{1:{description:"The loose sand and jagged rocks make it harder to fight effectively",related_skill:"Scrambling",scaling_lvl:20,effects:{agility:{multiplier:.5},dexterity:{multiplier:.5},attack_points:{multiplier:.5},evasion_points:{multiplier:.5},attack_speed:{multiplier:.7}}},2:{description:"A boggy marshland is a terrible location to fight for your life in",related_skill:"Scrambling",scaling_lvl:30,effects:{agility:{multiplier:.2},dexterity:{multiplier:.2},attack_points:{multiplier:.2},evasion_points:{multiplier:.2},attack_speed:{multiplier:.4}}},3:{description:"The muck somehow causes you to slip even while holding you firmly in place",related_skill:"Scrambling",scaling_lvl:60,effects:{agility:{multiplier:.08},dexterity:{multiplier:.08},attack_points:{multiplier:.08},evasion_points:{multiplier:.08},attack_speed:{multiplier:.15}}}}}),$e.wet=new Ht({name:"wet",stages:{1:{description:"Attempting to stay dry in conditions like this is impossible",applied_effects:[{effect:"Wet",duration:30}]}}}),$e.aquatic=new Ht({name:"aquatic",stages:{1:{description:"Wading in water up to your knees restrict your movement",related_skill:"Swimming",scaling_lvl:30,effects:{agility:{multiplier:.75},dexterity:{multiplier:.75},stamina_efficiency:{multiplier:.75}},applied_effects:[{effect:"Wet",duration:30}]},2:{description:"With most of your body submerged, it's hard to move",related_skill:"Swimming",scaling_lvl:40,effects:{agility:{multiplier:.5},dexterity:{multiplier:.5},attack_speed:{multiplier:.5},stamina_efficiency:{multiplier:.5}},applied_effects:[{effect:"Wet",duration:30}]},3:{description:"Fully underwater and with no ground under your feet, the moves you learned on land will help you little",related_skill:"Swimming",effects:{agility:{multiplier:.1},dexterity:{multiplier:.1},attack_speed:{multiplier:.25},stamina_efficiency:{multiplier:.25}},applied_effects:[{effect:"Wet",duration:30}]},4:{description:"Crushed by the immense pressure of the oceanic abyss",related_skill:"Swimming",effects:{agility:{multiplier:.01},dexterity:{multiplier:.01},attack_speed:{multiplier:.1},stamina_efficiency:{multiplier:.1},health_loss_flat:{flat:-1e3}},applied_effects:[{effect:"Wet",duration:30}]}}})})();(function(){m.Village=new ye({getDescription:function(){return m["Infested field"].enemy_groups_killed>=5*m["Infested field"].enemy_count?"Medium-sized village, built next to a small and calm river at the foot of the mountains. It's surrounded by many fields, a few of them infested by huge rats, which, while an annoyance, don't seem possible to fully eradicate. Other than that, there's nothing interesting around":m["Infested field"].enemy_groups_killed>=2*m["Infested field"].enemy_count?"Medium-sized village, built next to a small and calm river at the foot of the mountains. It's surrounded by many fields, many of them infested by huge rats. Other than that, there's nothing interesting around":"Medium-sized village, built next to a small and calm river at the foot of the mountains. It's surrounded by many fields, most of them infested by huge rats. Other than that, there's nothing interesting around"},getBackgroundNoises:function(){let e=["*You hear some rustling*"];return E.hour>4&&E.hour<=20&&(e.push("Anyone seen my cow?","Mooooo!","Tomorrow I'm gonna fix the roof","Look, a bird!"),m["Infested field"].enemy_groups_killed<=3?(e.push("These nasty rats almost ate my cat!"),Ai()&&e.push("These nasty rats almost ate my rat!","These nasty rats almost ate my rat!","These nasty rats almost ate my rat!")):Ai()&&e.push("These nasty rats almost ate my rat!")),E.hour>3&&E.hour<10?e.push("\u266B\u266B Heigh ho, heigh ho, it's off to work I go~ \u266B\u266B","Cock-a-doodle-doo!"):E.hour>18&&E.hour<22&&e.push("\u266B\u266B Heigh ho, heigh ho, it's home from work I go~ \u266B\u266B"),E.hour>8&&E.hour<10?e.push("Did you hear about what that fisherman saw?","I just don't believe you can find one that big"):E.hour>16&&E.hour<18&&e.push("Saw a river crab the other day, horrible creatures"),e},dialogues:["village elder","village guard","old craftsman"],traders:["village trader"],market_region:"Village",name:"Village",crafting:{is_unlocked:!0,use_text:"Try to craft something",tiers:{crafting:1,forging:1,smelting:1,cooking:1,alchemy:1,butchering:1,woodworking:1}}}),m.Shack=new ye({connected_locations:[{location:m.Village,custom_text:"Go outside to [Village]",travel_time:10}],description:"This small shack was the only spare building in the village. It's surprisingly tidy",name:"Shack",is_unlocked:!1,housing:{is_unlocked:!0,text_to_sleep:"Take a nap",sleeping_xp_per_tick:1},temperature_range_modifier:.4,is_under_roof:!0}),m.Village.connected_locations.push({location:m.Shack,travel_time:10}),m["Eastern mill"]=new ye({name:"Eastern mill",is_unlocked:!1,connected_locations:[{location:m.Village,travel_time:30,custom_text:"Go outside to [Village]"}],description:"Local mill, run by a young duo. It's somewhat tidy, with occasional flour dust in corners",getBackgroundNoises:function(){let e=["*Creaking*","*A small cloud of flour dust rises in the air*","*Crunch*","*You hear a steady crunching sounds as stones crush grain*","Shhh, not now, we're not alone...","I have a fun idea for later~"];return Ai()&&e.push("Shhh, don't move, there's a rat on your shoulder"),Ie.is_mofu_mofu_enabled&&e.push("*Their tails brush against each other and the duo blushes*","*A tail brushes against your leg* oh my, sorry for that~"),E.hour>20?e.push("It's getting late","Time for a break","Can't wait to... hehe...~"):E.hour<4&&e.push("Why are we even working at this hour...","I wanna sleep..."),e},dialogues:["village millers"]}),m.Village.connected_locations.push({location:m["Eastern mill"],travel_time:30}),m["Eastern storehouse"]=new ke({name:"Eastern storehouse",is_unlocked:!1,description:"",enemies_list:["Wolf rat"],types:[{type:"narrow",stage:1,xp_gain:3},{type:"dark",stage:1,xp_gain:2}],enemy_count:25,enemy_group_size:[3,5],enemy_stat_variation:.2,parent_location:m["Eastern mill"],first_reward:{xp:40},repeatable_reward:{textlines:[{dialogue:"village millers",lines:["cleared storage"]}],locks:{locations:["Eastern storehouse"]},move_to:{location:"Eastern mill"}},temperature_range_modifier:.8,is_under_roof:!0}),m["Eastern mill"].connected_locations.push({location:m["Eastern storehouse"],travel_time:10}),m["Infested field"]=new ke({description:"Field infested with wolf rats. You can see the grain stalks move as these creatures scurry around",enemy_count:15,enemies_list:["Starving wolf rat","Wolf rat"],types:[{type:"open",stage:1,xp_gain:1}],enemy_stat_variation:.1,is_unlocked:!1,name:"Infested field",parent_location:m.Village,first_reward:{xp:10,reputation:{Village:20}},repeatable_reward:{textlines:[{dialogue:"village elder",lines:["cleared field"]}],xp:5},rewards_with_clear_requirement:[{required_clear_count:2,reputation:{Village:10}},{required_clear_count:4,reputation:{Village:30}},{required_clear_count:10,reputation:{Village:50}}]}),m.Village.connected_locations.push({location:m["Infested field"],travel_time:15}),m["Nearby cave"]=new ye({connected_locations:[{location:m.Village,custom_text:"Go outside and to the [Village]",travel_time:60}],getDescription:function(){return m["Pitch black tunnel"].enemy_groups_killed>=m["Pitch black tunnel"].enemy_count?"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the cave walls, providing a dim light. Your efforts have secured a decent space and many of the tunnels. It seems like you almost reached the deepest part":m["Hidden tunnel"].enemy_groups_killed>=m["Hidden tunnel"].enemy_count?"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the walls, providing a dim light. Your efforts have secured a major space and some tunnels, but there are still more places left to clear out":m["Cave depths"].enemy_groups_killed>=m["Cave depths"].enemy_count?"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the walls, providing a dim light. Your efforts have secured a decent space and even a few tunnels, yet somehow you can still hear the sounds of the wolf rats":m["Cave room"].enemy_groups_killed>=m["Cave room"].enemy_count?"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the walls, providing a dim light. Your efforts have secured some space, but you can hear more wolf rats in some deeper tunnels":"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the walls, providing a dim light. You can hear sounds of wolf rats from the nearby room"},getBackgroundNoises:function(){return["*You hear rocks rumbling somewhere*","Squeak!"]},temperature_range_modifier:.8,name:"Nearby cave",is_unlocked:!1,is_under_roof:!0}),m.Village.connected_locations.push({location:m["Nearby cave"],travel_time:60}),m["Cave room"]=new ke({description:"It's full of rats. At least the glowing mushrooms provide some light",enemy_count:25,types:[{type:"narrow",stage:1,xp_gain:3},{type:"bright",stage:1}],enemies_list:["Wolf rat"],enemy_group_size:[2,3],enemy_stat_variation:.2,is_unlocked:!0,name:"Cave room",leave_text:"Go back to entrance",parent_location:m["Nearby cave"],temperature_range_modifier:.7,is_under_roof:!0,first_reward:{xp:30},repeatable_reward:{textlines:[{dialogue:"village elder",lines:["cleared room"]}],locations:[{location:"Cave depths"}],xp:15,activities:[{location:"Nearby cave",activity:"weightlifting"},{location:"Nearby cave",activity:"mining"},{location:"Village",activity:"balancing"}]},rewards_with_clear_requirement:[{required_clear_count:1,reputation:{Village:10}},{required_clear_count:4,reputation:{Village:20}}]}),m["Nearby cave"].connected_locations.push({location:m["Cave room"],travel_time:5}),m["Cave depths"]=new ke({description:"It's dark. And full of rats",enemy_count:40,types:[{type:"narrow",stage:1,xp_gain:3},{type:"dark",stage:2,xp_gain:3}],enemies_list:["Wolf rat"],enemy_group_size:[5,8],enemy_stat_variation:.2,is_unlocked:!1,name:"Cave depths",leave_text:"Climb out",parent_location:m["Nearby cave"],first_reward:{xp:100},repeatable_reward:{textlines:[{dialogue:"village elder",lines:["cleared cave"]}],xp:50},rewards_with_clear_requirement:[{required_clear_count:4,locations:[{location:"Suspicious wall"}],reputation:{Village:40}}],temperature_range_modifier:.6,is_under_roof:!0}),m["Hidden tunnel"]=new ke({description:"There is, in fact, even more rats here",enemy_count:50,types:[{type:"narrow",stage:1,xp_gain:3},{type:"dark",stage:3,xp_gain:1}],enemies_list:["Elite wolf rat"],enemy_group_size:[1,2],enemy_stat_variation:.2,is_unlocked:!1,name:"Hidden tunnel",leave_text:"Retreat for now",parent_location:m["Nearby cave"],first_reward:{xp:120},repeatable_reward:{locations:[{location:"Pitch black tunnel"}],xp:60,activities:[{location:"Nearby cave",activity:"mining2"}]},is_temperature_static:!1,temperature_range_modifier:.5,is_under_roof:!0,unlock_text:"As the wall falls apart, you find yourself in front of a new tunnel, leading even deeper. And of course, it's full of wolf rats."}),m["Pitch black tunnel"]=new ke({description:"There is no light here. Only rats",enemy_count:50,types:[{type:"narrow",stage:1,xp_gain:6},{type:"dark",stage:3,xp_gain:3}],enemies_list:["Elite wolf rat"],enemy_group_size:[6,8],enemy_stat_variation:.2,is_unlocked:!1,name:"Pitch black tunnel",leave_text:"Retreat for now",parent_location:m["Nearby cave"],first_reward:{xp:520,messages:["As you descend deeper and deeper, a sudden thought strikes you - what if you instead tried going up?"]},repeatable_reward:{xp:260,global_activities:["climbing"],actions:[{location:"Nearby cave",action:"climb the mountain"}]},rewards_with_clear_requirement:[{required_clear_count:4,locations:[{location:"Mysterious gate"}]}],is_temperature_static:!0,static_temperature:16,is_under_roof:!0,unlock_text:"As you keep going deeper, you barely notice a pitch black hole. Not even a tiniest speck of light reaches it"}),m["Mysterious gate"]=new ke({description:"It's dark. And full of rats.",enemy_count:50,types:[{type:"dark",stage:3,xp_gain:5}],enemies_list:["Elite wolf rat guardian"],enemy_group_size:[6,8],enemy_stat_variation:.2,is_unlocked:!1,name:"Mysterious gate",leave_text:"Get away",parent_location:m["Nearby cave"],first_reward:{xp:2e3},repeatable_reward:{xp:1e3,activities:[{location:"Nearby cave",activity:"meditating"},{location:"Nearby cave",activity:"mining3"}],actions:[{action:"open the gate",location:"Nearby cave"}],quest_progress:[{quest_id:"The Infinite Rat Saga",task_index:0}],flags:["is_strength_proved"]},is_temperature_static:!0,static_temperature:18,is_under_roof:!0,unlock_text:"After a long and ardous fight, you reach a chamber that ends with a massive stone gate. You can feel it's guarded by some kind of wolf rats, but much bigger than the ones you fought until now"}),m["Nearby cave"].connected_locations.push({location:m["Cave depths"],travel_time:20},{location:m["Hidden tunnel"],custom_text:"Enter the [Hidden tunnel]",travel_time:40},{location:m["Pitch black tunnel"],custom_text:"Go into the [Pitch black tunnel]",travel_time:60},{location:m["Mysterious gate"],custom_text:"Go to the [Mysterious gate]",travel_time:90}),m["Writhing tunnel"]=new ke({description:"The walls are moving...",enemy_count:50,types:[{type:"dark",stage:3,xp_gain:5},{type:"narrow",stage:2,xp_gain:5},{type:"eldritch",stage:1,xp_gain:1}],enemies_list:["Wall rat"],enemy_group_size:[4,4],enemy_stat_variation:.2,is_unlocked:!1,name:"Writhing tunnel",leave_text:"Run away...",parent_location:m["Nearby cave"],first_reward:{xp:4e3},repeatable_reward:{xp:2e3,locations:[{location:"Mysterious depths"}],quest_progress:[{quest_id:"The Infinite Rat Saga",task_index:2}]},is_temperature_static:!0,static_temperature:20,is_under_roof:!0,unlock_text:"You see something. You struggle to comprehend it. When you finally understand, you regret it instantly. It might have been better to be born blind."}),m["Nearby cave"].connected_locations.push({location:m["Writhing tunnel"],travel_time:100}),m["Mysterious depths"]=new ye({connected_locations:[{location:m["Nearby cave"],custom_text:"Climb back up to the main level of [Nearby cave]",travel_time:100}],getDescription:function(){return`You find yourself in a large chamber with smooth walls and vaulted ceiling. The floor is covered in square tiles in the center, yet you cannot help but notice that all these squares make a circle, in some impossible to understand way.
There's another gate on the wall in front of you, but you have a strange feeling that you won't be able to open it with brute strength.`},getBackgroundNoises:function(){return["*You hear rocks rumbling somewhere*","Squeak!","*Air vibrates in an impossible to describe manner*","*You feel an immense sense of something being wrong*",'"All these squares make a circle... All these squares make a circle..."']},name:"Mysterious depths",is_unlocked:!1,unlock_text:"You manage to find a way to another chamber.",is_temperature_static:!0,static_temperature:20,is_under_roof:!0}),m["Nearby cave"].connected_locations.push({location:m["Mysterious depths"],custom_text:"Climb down to [Mysterious depths]",travel_time:120}),m["Forest road"]=new ye({connected_locations:[{location:m.Village,travel_time:240}],description:"Old trodden road leading through a dark forest, the only path connecting the village to the town. You can hear some animals from the surrounding woods",name:"Forest road",getBackgroundNoises:function(){return["*You hear some rustling*","Roar!","*You almost tripped on some roots*","*You hear some animal running away*"]},is_unlocked:!1}),m.Village.connected_locations.push({location:m["Forest road"],custom_text:"Leave the village towards [Forest road]",travel_time:240}),m.Forest=new ke({description:"Forest surrounding the village, a dangerous place",enemies_list:["Starving wolf","Young wolf"],types:[{type:"narrow",stage:1,xp_gain:1}],enemy_count:30,enemy_stat_variation:.2,name:"Forest",parent_location:m["Forest road"],first_reward:{xp:60},repeatable_reward:{xp:30,locations:[{location:"Deep forest"}],activities:[{location:"Forest road",activity:"herbalism"}]}}),m["Forest road"].connected_locations.push({location:m.Forest,custom_text:"Leave the safe path and walk into the [Forest]",travel_time:30}),m["Deep forest"]=new ke({description:"Deeper part of the forest, a dangerous place",enemies_list:["Wolf","Starving wolf","Young wolf"],types:[{type:"narrow",stage:1,xp_gain:2}],enemy_count:50,enemy_group_size:[2,3],enemy_stat_variation:.2,is_unlocked:!1,name:"Deep forest",parent_location:m["Forest road"],first_reward:{xp:300},repeatable_reward:{xp:150,flags:["is_strength_proved"],activities:[{location:"Forest road",activity:"woodcutting"}]},rewards_with_clear_requirement:[{required_clear_count:4,actions:[{action:"follow the trail",location:"Forest road"}]}]}),m["Forest road"].connected_locations.push({location:m["Deep forest"],custom_text:"Venture into the [Deep forest]",travel_time:60}),m["Forest clearing"]=new ke({description:"A surprisingly big clearing hidden in the northern part of the forest, covered with very tall grass and filled with a mass of wild boars",enemies_list:["Boar"],enemy_count:50,enemy_group_size:[4,7],is_unlocked:!1,enemy_stat_variation:.2,name:"Forest clearing",types:[{type:"open",stage:2,xp_gain:3}],parent_location:m["Forest road"],first_reward:{xp:1e3},repeatable_reward:{xp:500,textlines:[{dialogue:"farm supervisor",lines:["defeated boars"]}],activities:[{location:"Forest road",activity:"woodcutting2"}]},rewards_with_clear_requirement:[{required_clear_count:5,actions:[{action:"What was that noise?",location:"Forest road"}]}]}),m["Forest road"].connected_locations.push({location:m["Forest clearing"],custom_text:"Go towards the [Forest clearing] in the north",travel_time:60}),m["Carya Canyon"]=new ye({connected_locations:[{location:m["Forest road"],travel_time:300}],description:"The forest ends abruptly, giving way to a deep canyon past which you see some really nice trees",name:"Carya Canyon",getBackgroundNoises:function(){return["*The wind howls through the canyon*","*Don't fall in now*","*A pebble clatters in the depths*"]},is_unlocked:!1}),m["Forest road"].connected_locations.push({location:m["Carya Canyon"],custom_text:"Hike to [Carya Canyon]",travel_time:120}),m["Precarious tree bridge"]=new zt({description:"A warthog heard the commotion and is guarding the way across.",enemy_count:1,types:[],enemies_list:["Warthog"],enemy_group_size:[1,1],enemy_stat_variation:0,is_unlocked:!1,name:"Warthog",leave_text:"Looks dangerous",parent_location:m["Carya Canyon"],repeatable_reward:{activities:[{location:"Carya Canyon",activity:"woodcutting"}]},unlock_text:"You made it across!",is_under_roof:!1,temperature_range_modifier:1}),m["Carya Canyon"].connected_locations.push({location:m["Precarious tree bridge"],custom_text:"To to cross the [Precarious tree bridge]",travel_time:30}),m["Forest den"]=new ke({description:"A relatively large cave in the depths of the forest, filled with hordes of direwolves",enemies_list:["Direwolf"],enemy_count:50,enemy_group_size:[2,3],enemy_groups_list:[{enemies:["Direwolf hunter"]}],predefined_lineup_on_nth_group:4,is_unlocked:!1,enemy_stat_variation:.2,name:"Forest den",types:[{type:"narrow",stage:2,xp_gain:5},{type:"dark",stage:2,xp_gain:5}],parent_location:m["Forest road"],first_reward:{xp:1e3,items:["Warrior's necklace"]},repeatable_reward:{xp:500},rewards_with_clear_requirement:[{required_clear_count:2,actions:[{action:"search predator",location:"Forest road"}]},{required_clear_count:4,messages:["In a moment of quiet between fights, you can make out a faint sound of rushing water in the distance"],locations:[{location:"Forest den traversal"}]}],temperature_range_modifier:.8,is_under_roof:!0}),m["Forest road"].connected_locations.push({location:m["Forest den"],custom_text:"Enter the [Forest den]",travel_time:90}),m["Bears' den"]=new ke({description:"A dark, smelly cave in the heart of the forest, with massive bones spread around the entrance",enemies_list:["Forest bear"],enemy_count:20,is_unlocked:!1,enemy_stat_variation:.2,name:"Bears' den",types:[{type:"narrow",stage:2,xp_gain:10},{type:"dark",stage:2,xp_gain:10}],parent_location:m["Forest road"],first_reward:{xp:500},repeatable_reward:{xp:250},temperature_range_modifier:.8,is_under_roof:!0}),m["Forest road"].connected_locations.push({location:m["Bears' den"],custom_text:"Enter the [Bears' den]",travel_time:180}),m["Forest lake"]=new ye({connected_locations:[{location:m["Forest road"],travel_time:120}],description:"Far away from civilization, the forest opens up to an unspoiled lake. Nestled between a small cliff where it receives water from a rocky waterfall, and a dense canopy leading to what must be the forest's heart, it serves as a respite for the local animals - and now, yourself",name:"Forest lake",getBackgroundNoises:()=>["*Mosquitoes buzzing*","*Frogs croaking*","*something splashes in the water*","*an animal comes out to drink*","Quack","Quack!"],is_unlocked:!1}),m["Forest road"].connected_locations.push({location:m["Forest lake"],travel_time:120}),m.Frogs=new ke({description:"Battling at the lake's edge",enemies_list:["Frog"],enemy_count:50,is_unlocked:!1,enemy_stat_variation:.2,name:"Water's edge",types:[{type:"aquatic",stage:1,xp_gain:3},{type:"open",stage:1,xp_gain:5}],parent_location:m["Forest lake"],first_reward:{xp:1600},repeatable_reward:{xp:800,actions:[]},temperature_range_modifier:.8,is_under_roof:!1}),m["Forest lake"].connected_locations.push({location:m.Frogs,custom_text:"Challenge the apex predator"}),m["Forest ant nest"]=new ke({description:"A labyrinthine nest of red ants",enemies_list:["Red ant swarm"],enemy_groups_list:[{enemies:["Red ant queen","Red ant swarm","Red ant swarm","Red ant swarm","Red ant swarm","Red ant swarm","Red ant swarm","Red ant swarm"]}],predefined_lineup_on_nth_group:99,types:[{type:"narrow",stage:3,xp_gain:10},{type:"dark",stage:2,xp_gain:7}],enemy_count:100,is_unlocked:!1,enemy_group_size:[8,8],enemy_stat_variation:.1,id:"Forest ant nest",name:"Red ant nest",parent_location:m["Forest road"],first_reward:{xp:6e3},repeatable_reward:{xp:3e3},temperature_range_modifier:.7,is_under_roof:!0}),m["Forest road"].connected_locations.push({location:m["Forest ant nest"],custom_text:"Enter the [Red ant nest]",travel_time:120}),m["Town outskirts"]=new ye({connected_locations:[{location:m["Forest road"],custom_text:"Return to the [Forest road]",travel_time:240}],description:"The town is surrounded by a tall stone wall. The only gate seems to be closed, with a lone guard outside. You can see farms to the north and slums to the south",name:"Town outskirts",is_unlocked:!0,dialogues:["gate guard"]}),m["Forest road"].connected_locations.push({location:m["Town outskirts"],custom_text:"Go towards the [Town outskirts]",travel_time:240}),m.Slums=new ye({connected_locations:[{location:m["Town outskirts"],travel_time:60}],getDescription:function(){return m["Gang hideout"].is_finished?"A wild settlement next to city walls, filled with decaying buildings, poverty, and occasional thieves":"A wild settlement next to city walls, filled with decaying buildings, poverty, and violent criminals"},name:"Slums",is_unlocked:!0,dialogues:["suspicious man","old woman of the slums"],traders:["suspicious trader","suspicious trader 2"],market_region:"Slums",entrance_rewards:{quests:["Light in the darkness"]},temperature_range_modifier:.9,getBackgroundNoises:function(){let e=["Cough cough","Cough cough cough","*You hear someone sobbing*","*You see someone sleeping in an alleyway.*","I'm so hungry...","Even rotten food is better than nothing"];return E.hour>4&&E.hour<=20?e.push("Please, do you have a coin to spare?"):m["Gang hideout"].is_finished||e.push("*Sounds of someone getting repeatedly stabbed*","Scammed some fools for money today, time to get drunk!","Damn, I need a new dagger"),m["Gang hideout"].is_finished?e.push("You're the one who took out that gang, aren't you? Thank you so much.","Things got a lot better since those thugs left...","The crime isn't as bad as it used to be"):e.push("*You hear a terrified scream.*"),e}}),m["Town farms"]=new ye({connected_locations:[{location:m["Town outskirts"],travel_time:60}],description:"Semi-private farms under jurisdiction of the city council. Full of life and sounds of heavy work",name:"Town farms",is_unlocked:!0,dialogues:["farm supervisor"],getBackgroundNoises:function(){let e=[];return E.hour>4&&E.hour<=20?e.push("Mooooo!","Look, a bird!","Bark bark!","*You notice a goat staring at you menacingly*","Neigh!","Oink oink"):e.push("*You can hear some rustling*","*You can hear snoring workers*"),E.hour>3&&E.hour<10?e.push("\u266B\u266B Heigh ho, heigh ho, it's off to work I go~ \u266B\u266B","Cock-a-doodle-doo!"):E.hour>18&&E.hour<22&&e.push("\u266B\u266B Heigh ho, heigh ho, it's home from work I go~ \u266B\u266B"),e}}),m["Red ant nest 1"]=new ke({description:"A labyrinthine nest of red ants",enemies_list:["Red ant swarm"],enemy_groups_list:[{enemies:["Red ant queen"]}],predefined_lineup_on_nth_group:99,types:[{type:"narrow",stage:3,xp_gain:10},{type:"dark",stage:2,xp_gain:7}],enemy_count:100,is_unlocked:!1,enemy_group_size:[5,6],enemy_stat_variation:.1,id:"Red ant nest 1",name:"Red ant nest",parent_location:m["Town farms"],first_reward:{xp:4e3},repeatable_reward:{locks:{locations:["Red ant nest 1"]},move_to:{location:"Town farms"},actions:[{location:"Town farms",action:"dig for ants 2"}]},temperature_range_modifier:.7,is_under_roof:!0}),m["Red ant nest 2"]=new ke({description:"A labyrinthine nest of red ants",enemies_list:["Red ant swarm"],enemy_groups_list:[{enemies:["Red ant queen"]}],predefined_lineup_on_nth_group:99,types:[{type:"narrow",stage:3,xp_gain:10},{type:"dark",stage:2,xp_gain:7}],enemy_count:100,is_unlocked:!1,enemy_group_size:[5,6],enemy_stat_variation:.1,id:"Red ant nest 2",name:"Red ant nest",parent_location:m["Town farms"],first_reward:{xp:4e3},repeatable_reward:{locks:{locations:["Red ant nest 2"]},move_to:{location:"Town farms"},actions:[{location:"Town farms",action:"dig for ants 3"}]},temperature_range_modifier:.7,is_under_roof:!0}),m["Red ant nest 3"]=new ke({description:"A labyrinthine nest of red ants",enemies_list:["Red ant swarm"],enemy_groups_list:[{enemies:["Red ant queen"]}],predefined_lineup_on_nth_group:99,types:[{type:"narrow",stage:3,xp_gain:10},{type:"dark",stage:2,xp_gain:7}],enemy_count:100,is_unlocked:!1,enemy_group_size:[5,6],enemy_stat_variation:.1,id:"Red ant nest 3",name:"Red ant nest",parent_location:m["Town farms"],first_reward:{xp:4e3},repeatable_reward:{locks:{locations:["Red ant nest 3"]},move_to:{location:"Town farms"},actions:[{location:"Town farms",action:"follow ant trail"}],textlines:[{dialogue:"farm supervisor",lines:["eliminated ants"]}]},temperature_range_modifier:.7,is_under_roof:!0}),m["Town farms"].connected_locations.push({location:m["Red ant nest 1"],custom_text:"Enter the [Red ant nest]",travel_time:10},{location:m["Red ant nest 2"],custom_text:"Enter the [Red ant nest]",travel_time:10},{location:m["Red ant nest 3"],custom_text:"Enter the [Red ant nest]",travel_time:10}),m["Gang hideout"]=new ke({description:"Hideout of a local gang. Old building with a labirynth of narrow corridors",enemies_list:["Slums thug"],types:[{type:"narrow",stage:2,xp_gain:3},{type:"dark",stage:1,xp_gain:3}],enemy_count:30,is_unlocked:!1,enemy_group_size:[4,5],enemy_stat_variation:.1,name:"Gang hideout",parent_location:m.Slums,first_reward:{xp:1e3,reputation:{Slums:200,Town:50},money:1840},repeatable_reward:{traders:[{trader:"suspicious trader 2",skip_message:!0}],textlines:[{dialogue:"suspicious man",lines:["defeated gang"]}],locks:{traders:["suspicious trader"],locations:["Gang hideout"],textlines:{"suspicious man":["behave 2"]}},move_to:{location:"Slums"},quest_progress:[{quest_id:"Light in the darkness",task_index:1}]},temperature_range_modifier:.6,is_under_roof:!0}),m.Slums.connected_locations.push({location:m["Gang hideout"],travel_time:10}),m["Town square"]=new ye({connected_locations:[{location:m["Town outskirts"],travel_time:40}],description:"The town's center of life, connected to all the markets, guilds, and other important places",name:"Town square",is_unlocked:!1,getBackgroundNoises:function(){return[]}}),m["Town outskirts"].connected_locations.push({location:m["Town farms"],travel_time:60},{location:m.Slums,travel_time:60},{location:m["Town square"],travel_time:40}),m["Cat cafe"]=new ye({connected_locations:[{location:m["Town square"],travel_time:4}],description:`A cat caf\xE9 in the center of town. There are multiple kitties of all kinds, but two females especially catch your eyes
 - a chubby mackerel tabby with a white belly and neck, and a slender tortoishell that seems blind on the right eye. There's a single worker in the caf\xE9, a person of ambiguous gender with with long ponytail and glasses.`,name:"Cat caf\xE9",is_unlocked:!0,getBackgroundNoises:function(){return["Meow","Nya","Mrrr","Mrrrp meow","*A cat jumps on your lap*","*A cat brushes on your leg*"]},is_under_roof:!0,is_temperature_static:!0,static_temperature:20}),m["Town square"].connected_locations.push({location:m["Cat cafe"],travel_time:4}),m["Mountain path"]=new ye({connected_locations:[{location:m["Nearby cave"],custom_text:"Climb down to [Nearby Cave]",travel_time:20,travel_time_skills:["Climbing"]}],description:"A treacherous path high above the village",name:"Mountain path",is_unlocked:!1,getBackgroundNoises:function(){return["You hear a rock tumble and fall down. It takes a very long time to hit the ground...","Strong wind whooshes past you"]},temperature_modifier:-2,unlock_text:"Thanks to your hard effort, you reached a narrow safe spot where you can rest a bit"}),m["Nearby cave"].connected_locations.push({location:m["Mountain path"],custom_text:"Climb up to [Mountain path]",travel_time:60,travel_time_skills:["Climbing"]}),m["Small flat area in mountains"]=new ye({connected_locations:[{location:m["Mountain path"],travel_time:120}],description:"A piece of flatland somewhere in the mountains, very high above the village. It's not that big, but more than enough for a camp",name:"Small flat area in mountains",is_unlocked:!1,getBackgroundNoises:function(){return["You hear a rock tumble and fall down. It takes a very long time to hit the ground...","Strong wind whooshes past you","A pair of birds flies right above you"]},temperature_modifier:-2,unlock_text:"You finally got to a place where a camp can be established"}),m["Mountain path"].connected_locations.push({location:m["Small flat area in mountains"],travel_time:120}),m["Mountain camp"]=new ye({connected_locations:[{location:m["Nearby cave"],custom_text:"Climb down to [Nearby cave]",travel_time:140,travel_time_skills:["Climbing","Running"]}],description:"A nice safe camp with a crackling fire and a rainproof tent, created by you to be a perfect base for further exploration",name:"Mountain camp",housing:{is_unlocked:!0,sleeping_xp_per_tick:8,text_to_sleep:"Take a nap on the bedroll"},is_unlocked:!1,getBackgroundNoises:function(){return["You hear a rock tumble and fall down. It takes a very long time to hit the ground...","Strong wind whooshes past you","A pair of birds flies right above you"]},temperature_range_modifier:.5,is_under_roof:!0}),m["Nearby cave"].connected_locations.push({location:m["Mountain camp"],travel_time:140,travel_time_skills:["Climbing","Running"]}),m["Mountain path"].connected_locations.push({location:m["Mountain camp"],travel_time:120}),m["Gentle mountain slope"]=new ke({description:"A surprisingly gentle clearing, with a herd of angry goats protecting it",enemies_list:["Angry mountain goat"],enemy_count:50,enemy_group_size:[3,4],is_unlocked:!1,enemy_stat_variation:.2,name:"Gentle mountain slope",types:[{type:"open",stage:1,xp_gain:5},{type:"thin air",stage:1,xp_gain:3}],parent_location:m["Mountain camp"],first_reward:{xp:1e3,flags:["is_strength_proved"]},repeatable_reward:{xp:500},temperature_modifier:-2}),m["Mountain camp"].connected_locations.push({location:m["Gentle mountain slope"],travel_time:120}),m["Downstream from the village"]=new ye({connected_locations:[{location:m.Village,custom_text:"Make the long hike back to the [Village]",travel_time:2160}],description:"The chittering clicks of crabs tell you that you're headed in the right direction. As you make your way closer to the riverbank's shore, you stumble across what you think at first is a boulder the size of a small building blocking your path. That is, until you notice it start to move...",getBackgroundNoises:function(){return["*You hear the waves crashing along the shoreline*","*Splash*","*You hear the chittering clicks of dozens of crabs*"]},temperature_modifier:.5,name:"Downstream from the village",is_unlocked:!1}),m.Village.connected_locations.push({location:m["Downstream from the village"],custom_text:"Hike down the river",travel_time:2160}),m.Riverbank=new ye({connected_locations:[{location:m.Village,custom_text:"Make the long hike back to the [Village]",travel_time:2160}],getDescription:function(){return m["Riverbank shore"].enemy_groups_killed>=10*m["Riverbank shore"].enemy_count?"While there are still an abundance of crabs on the river's shore, they don't appear to be interested in climbing any higher onto the riverbank. It shouldn't be difficult to move past them at this point":m["Riverbank shore"].enemy_groups_killed>=5*m["Riverbank shore"].enemy_count?"There is an abundance of crabs on the river's shore, but you should be able to get around them and further down the riverbank with a little bit of effort":"You manage to deal a wounding crack to the giant crab's shell, driving it into a rage as it flees through the forest. With a moment of peace, you take stock of your surroundings. And if the amount of crabs on the river's shore are any indication, this might be the enormous crab nest you had heard about. You can't even tell where the shore meets the riverbank with the amount of crabs around here. The giant crab's trail is easy to spot, but it's just not possible to follow it without getting attacked by the smaller crabs. You will likely need to get through  multiple groups of them on your way"},getBackgroundNoises:function(){return["*You hear the waves crashing along the shoreline*","*Splash*","*You hear the chittering clicks of dozens of crabs*"]},temperature_modifier:1,name:"Riverbank",is_unlocked:!1}),m.Village.connected_locations.push({location:m.Riverbank,custom_text:"Hike down the river",travel_time:2160}),m["Downstream from the village"].connected_locations.push({location:m.Riverbank,custom_text:"Move down to the [Riverbank]",travel_time:30}),m["Riverbank shore"]=new ke({description:"As your eyes scan the shoreline, you see nothing but crabs across the horizon",enemy_count:50,types:[{type:"open",stage:1,xp_gain:2},{type:"rough",stage:1,xp_gain:1}],enemies_list:["River crab"],enemy_group_size:[2,4],enemy_stat_variation:.2,is_unlocked:!0,name:"Riverbank shore",leave_text:"Climb off the beach and back to safety",parent_location:m.Riverbank,temperature_range_modifier:.5,first_reward:{xp:1800},repeatable_reward:{xp:900},rewards_with_clear_requirement:[{required_clear_count:5,locations:[{location:"Further downstream"}]}]}),m.Riverbank.connected_locations.push({location:m["Riverbank shore"],custom_text:"Climb down to the [Riverbank shore]",travel_time:15}),m["Further downstream"]=new ye({connected_locations:[{location:m.Riverbank,custom_text:"Go back along the path you've made to the [Riverbank]",travel_time:240}],description:"While it wasn't hard to spot the giant crab's trail, following after it proved to be a different story. You made your way through the thick forest bush until the woods gave way to a moderately large lake overlooking a great basin, where you finally spotted the crab in a frenzy at it's nest. You consider going back and telling the guards, but by the time they'd arrive, the crab might have chosen a new nesting ground -- and you decide you have to end it now. Despite the cracks you've caused in it's shell, it seems more dangerous than when you fought it earlier, and the loose sand is only going to make this fight harder...",getBackgroundNoises:function(){let e=[];return E.hour>4&&E.hour<=20?e.push("*You hear the roar of rushing water in the distance*","*The hum of insects buzz in your ear*","*Birds are singing, flowers are blooming...*"):e.push("*You hear the roar of rushing water in the distance*","*The hum of insects buzz in your ear*"),e},temperature_range_modifier:.8,name:"Further downstream",is_unlocked:!1}),m.Riverbank.connected_locations.push({location:m["Further downstream"],custom_text:"Follow the giant crab's trail",travel_time:240}),m["Lake beach"]=new ye({connected_locations:[{location:m.Riverbank,custom_text:"Go back along the path you've made to the [Riverbank]",travel_time:180,travel_time_skills:["Scrambling"]}],getBackgroundNoises:function(){let e=[];return E.hour>4&&E.hour<=20?e.push("*You hear the roar of rushing water nearby*","*The hum of insects buzz in your ear*","*Birds are singing, flowers are blooming...*"):(m["Lake beach"].housing.is_unlocked&&e.push("*The fire crackles in the middle of your camp*"),e.push("*You hear the roar of rushing water nearby*","*The hum of insects buzz in your ear*")),e},getDescription:()=>m["Lake beach"].housing.is_unlocked?"The winding river lead to a peaceful lake on the edge of the forest overlooking a great basin. The surface of the lake ripples from the current of the river feeding into it. Animals occasionally come up and lap at the edge of the lake before running back off into the woods. On the far end, the lake feeds into a waterfall. In the remains of the giant crab's nest, you have a pleasant little encampment. With a crackling firepit and comfortable cot, it was created by you to be the perfect lakeside rest and relaxation spot":"The winding river lead to a peaceful lake on the edge of the forest overlooking a great basin. The surface of the lake ripples from the current of the river feeding into it. Animals occasionally come up and lap at the edge of the lake before running back off into the woods. On the far end, the lake feeds into a waterfall",housing:{is_unlocked:!1,sleeping_xp_per_tick:8,text_to_sleep:"Take a nap on the cot"},temperature_modifier:1.5,unlock_text:"It's just a shame no one will ever believe you caught one ~this~ big",name:"Lake beach",is_unlocked:!1}),m.Riverbank.connected_locations.push({location:m["Lake beach"],custom_text:"Go to the [Lake beach]",travel_time:180,travel_time_skills:["Scrambling"]}),m["Further downstream"].connected_locations.push({location:m["Lake beach"],custom_text:"Go to the [Lake beach]",travel_time:240}),m["Waterfall basin"]=new ye({connected_locations:[{location:m["Lake beach"],custom_text:"Climb up the cliffside and return to the [Lake beach]",travel_time:80,travel_time_skills:["Climbing"]}],getDescription:function(){return m["Crab spawning grounds"].enemy_groups_killed>=6*m["Crab spawning grounds"].enemy_count?"The waterfall at the bottom of the lake. Cool rushing waters and a sense of serene harmony make the area ideal for training your mind and body. Large crabs almost indistinguishable from the stone can be found along the shore of the basin. Off in the distance, you can just barely make out the overgrown remains of a old trail leading off into a swampy field":m["Crab spawning grounds"].enemy_groups_killed>=3*m["Crab spawning grounds"].enemy_count?"The waterfall at the bottom of the lake. Large crabs almost indistinguishable from the stone inhabit the shore. The sound of roaring water echoing through the rock shelters provides a calming noise that you figure would make it easier to focus your mind":"The waterfall at the bottom of the lake. Large crabs almost indistinguishable from the stone inhabit the shore and nearby rock shelters. You consider that the cool rushing waters from overhead might be an good way to train your body to endure tougher situations"},getBackgroundNoises:function(){return["*You hear the roar of thousands of gallons of water crashing down*"]},temperature_modifier:2,name:"Waterfall basin",is_unlocked:!1}),m["Lake beach"].connected_locations.push({location:m["Waterfall basin"],custom_text:"Rappel down to the [Waterfall basin]",travel_time:40,travel_time_skills:["Climbing"]}),m["Crab spawning grounds"]=new ke({description:"First an enormous crab nest, then an enormous crab's nest, and now this??",enemy_count:50,types:[{type:"open",stage:2,xp_gain:10},{type:"rough",stage:1,xp_gain:3},{type:"wet",stage:1}],enemies_list:["Stone crab"],enemy_group_size:[3,5],enemy_stat_variation:.2,is_unlocked:!0,name:"Crab spawning grounds",leave_text:"Leave the crab spawning grounds",parent_location:m["Waterfall basin"],temperature_modifier:1,first_reward:{xp:4e3},repeatable_reward:{xp:2e3},rewards_with_clear_requirement:[{required_clear_count:3,activities:[{location:"Waterfall basin",activity:"meditating"}]},{required_clear_count:6,locations:[{location:"Swampland fields"}]}]}),m["Waterfall basin"].connected_locations.push({location:m["Crab spawning grounds"],travel_time:20}),m["Swampland fields"]=new ye({connected_locations:[{location:m["Waterfall basin"],custom_text:"Crawl through the muck and brush and return to the [Waterfall basin]",travel_time:45,travel_time_skills:["Scrambling"]}],getDescription:function(){return m["The swamplands"].enemy_groups_killed>=100*m["The swamplands"].enemy_count?"The swamplands are filled with everpresent danger. Only an experienced warrior such as yourself is capable of withstanding the threats that lie within its boggy depths":m["The swamplands"].enemy_groups_killed>=10*m["The swamplands"].enemy_count?"The swamplands are difficult to navigate and dangerous to traverse, but after scouting it for what feels like a few months, you begin to find that the bog feels smaller and emptier":m["The swamplands"].enemy_groups_killed>=3*m["The swamplands"].enemy_count?"The swamplands are difficult to navigate and dangerous to traverse, but after travelling across it for what feels like a few weeks, you managed to find an actual solid pathway leading to a small settlement. It seems that somehow, some folks have managed to find a way to survive out here":"A disgusting boggy marsh lies before you. Most of the ground, or at least what you can make out through the reeds, is covered in filthy water halfway up to your knees, and what isn't submerged has rotted into compost or is the nest of some unknown creature. You think you see something out of the corner of your eye, but as you turn to look, all you catch is a ripple in the reeds"},getBackgroundNoises:function(){return["*Gnats and mosquitos pick at your exposed skin*","*fwoosh* *thump*","*You hear something moving around you, but you can't see it*","*The buzz of insects throb in your ears*","*gurgle gurgle*","*You feel something moving next you, but you can't see it*","*snap* *crunch*","*You hear the rythmic swish-swash of something swimming nearby*","*hssssssssssss*","*slither*"]},temperature_range_modifier:.5,temperature_modifier:3,unlock_text:"You can just barely make out the overgrown remains of a old trail leading off into a swampy field as an ill omen passes over you",name:"Swampland fields",is_unlocked:!1}),m["Waterfall basin"].connected_locations.push({location:m["Swampland fields"],custom_text:"Crawl through the muck and brush to the [Swampland fields]",travel_time:45,travel_time_skills:["Scrambling"]}),m["The swamplands"]=new ke({description:"The swamplands are hot, wet, and smell of rot. Water impedes your every movement, and vicious predators lie beneath it's surface",enemy_count:100,types:[{type:"rough",stage:2,xp_gain:7},{type:"wet",stage:1}],enemies_list:["Alligator","Snapping turtle","Giant snake"],enemy_stat_variation:.2,is_unlocked:!0,name:"The swamplands",leave_text:"Slink away to some higher, dryer ground",parent_location:m["Swampland fields"],temperature_modifier:5.5,temperature_range_modifier:.5,first_reward:{xp:8e3},repeatable_reward:{xp:4e3},rewards_with_clear_requirement:[{required_clear_count:3,locations:[{location:"Swampland tribe"}]}]}),m["Swampland fields"].connected_locations.push({location:m["The swamplands"],custom_text:"Wander randomly in the swamplands",travel_time:45}),m["Swampland tribe"]=new ye({connected_locations:[{location:m["Swampland fields"],custom_text:"Leave the safety of the settlement and return to the [Swampland fields]",travel_time:90,travel_time_skills:["Scrambling","Running"]}],getDescription:function(){return"Very small fortified settlement, built on a stretch of dry, stable ground. There are a few small huts and a single building built into the back of the encampment. As small as the settlement is, the fortifications surrounding it suggest that it once was larger"},getBackgroundNoises:function(){return["*You hear some rustling*","*The hum of insects buzz in your ear*","*Gnats and mosquitos pick at your exposed skin*","*fwoosh* *thump*","*gurgle gurgle*","*snap* *crunch*","*You hear the rythmic swish-swash of something swimming nearby*"]},temperature_modifier:2,temperature_range_modifier:.5,dialogues:["swampland chief","swampland cook","swampland tailor","swampland tanner"],traders:["swampland trader","swampland trader 2"],market_region:"Swamp",name:"Swampland tribe",is_unlocked:!1,crafting:{is_unlocked:!1,use_text:"Use the tribe's workhuts to craft something",tiers:{crafting:2,forging:1,smelting:1,cooking:2,alchemy:2,butchering:2,woodworking:2}},entrance_rewards:{quests:["In Times of Need"]}}),m["Swampland fields"].connected_locations.push({location:m["Swampland tribe"],travel_time:90,travel_time_skills:["Scrambling","Running"]}),m.Longhouse=new ye({connected_locations:[{location:m["Swampland tribe"],custom_text:"Go back out to the [Swampland tribe]",travel_time:5}],description:"A communal building that members of the settlement rest, eat, and recover in. The only other person in here right now is a wounded young woman, lying in a cot next to the door. The air smells faintly of rot and you can't help but notice there's far more cots than needed",name:"Longhouse",is_unlocked:!1,housing:{is_unlocked:!0,text_to_sleep:"Lie down on an open cot",sleeping_xp_per_tick:3},temperature_modifier:1.5,temperature_range_modifier:.5,dialogues:["swampland scout"],is_under_roof:!0}),m["Swampland tribe"].connected_locations.push({location:m.Longhouse,travel_time:5})})();(function(){m["Sparring with the village guard (heavy)"]=new zt({description:"She's showing you a technique that makes her attacks slow but deadly",enemy_count:1,enemies_list:["Village guard (heavy)"],enemy_group_size:[1,1],is_unlocked:!1,name:"Sparring with the village guard (heavy)",leave_text:"Give up",parent_location:m.Village,first_reward:{xp:30,reputation:{Village:10}},repeatable_reward:{textlines:[{dialogue:"village guard",lines:["heavy"]}]},unlock_text:"You can now spar with the guard (heavy stance) in the Village"}),m["Sparring with the village guard (quick)"]=new zt({description:"She's showing you a technique that makes her attacks fast but weaker",enemy_count:1,enemies_list:["Village guard (quick)"],enemy_group_size:[1,1],is_unlocked:!1,name:"Sparring with the village guard (quick)",leave_text:"Give up",parent_location:m.Village,first_reward:{xp:30,reputation:{Village:10}},repeatable_reward:{textlines:[{dialogue:"village guard",lines:["quick"]}]},unlock_text:"You can now spar with the guard (quick stance) in the Village"}),m.Village.connected_locations.push({location:m["Sparring with the village guard (heavy)"],custom_text:"Spar with the guard [heavy]",travel_time:0},{location:m["Sparring with the village guard (quick)"],custom_text:"Spar with the guard [quick]",travel_time:0}),m["Suspicious wall"]=new zt({description:"It can be broken with enough force, you can feel it",enemy_count:1,types:[],enemies_list:["Suspicious wall"],enemy_group_size:[1,1],enemy_stat_variation:0,is_unlocked:!1,name:"Suspicious wall",leave_text:"Leave it for now",parent_location:m["Nearby cave"],repeatable_reward:{locations:[{location:"Hidden tunnel"}],textlines:[{dialogue:"village elder",lines:["new tunnel"]}],xp:20,quests:["The Infinite Rat Saga"]},unlock_text:"At some point, one of wolf rats tries to escape through a previously unnoticed hole in a nearby wall. There might be another tunnel behind it!",is_under_roof:!0,temperature_range_modifier:.8}),m["Nearby cave"].connected_locations.push({location:m["Suspicious wall"],custom_text:"Try to break the suspicious wall",travel_time:0}),m["Fight off the assailant"]=new zt({description:"He attacked you out of nowhere",enemy_count:1,types:[],enemies_list:["Suspicious man"],enemy_group_size:[1,1],enemy_stat_variation:0,is_unlocked:!1,name:"Fight off the assailant",leave_text:"Run away for now",parent_location:m.Slums,repeatable_reward:{textlines:[{dialogue:"suspicious man",lines:["defeated"]}],xp:40},unlock_text:"Defend yourself!"}),m.Slums.connected_locations.push({location:m["Fight off the assailant"],custom_text:"Fight off the suspicious man",travel_time:0}),m["Fight the angry mountain goat"]=new zt({description:"It won't let you pass...",enemy_count:1,types:[{type:"narrow",stage:1,xp_gain:1},{type:"thin air",stage:1,xp_gain:3}],enemies_list:["Angry-looking mountain goat"],enemy_group_size:[1,1],enemy_stat_variation:0,is_unlocked:!1,name:"Fight the angry mountain goat",leave_text:"Run away and hope it won't follow",parent_location:m["Mountain path"],repeatable_reward:{locations:[{location:"Small flat area in mountains"}],xp:500},unlock_text:"A very angry goat blocks your way!",temperature_modifier:-2}),m["Mountain path"].connected_locations.push({location:m["Fight the angry mountain goat"],custom_text:"Fight the angry goat",travel_time:0}),m["Fight the giant crab"]=new zt({description:"The village elder told you to be cautious...",enemy_count:1,types:[{type:"open",stage:1,xp_gain:2}],enemies_list:["Giant crab"],enemy_stat_variation:0,is_unlocked:!0,name:"Fight the giant crab",leave_text:"Scramble away and hide!",parent_location:m["Downstream from the village"],repeatable_reward:{locations:[{location:"Riverbank"}],xp:2e3,move_to:{location:"Riverbank"},quest_progress:[{quest_id:"Giant Enemy Crab",task_index:0}],locks:{locations:["Downstream from the village"]}},unlock_text:"Is this what the village elder meant when he said an enormous crab nest??",temperature_modifier:.6}),m["Downstream from the village"].connected_locations.push({location:m["Fight the giant crab"],custom_text:"Fight the giant crab",travel_time:5}),m["Fight the giant crab again"]=new zt({description:"This time, you can't let it get away",enemy_count:1,types:[{type:"open",stage:2,xp_gain:5},{type:"rough",stage:1,xp_gain:3}],enemies_list:["Enraged giant crab"],enemy_stat_variation:0,is_unlocked:!0,name:"Fight the giant crab again!",leave_text:"Scramble away and hide!",parent_location:m["Further downstream"],repeatable_reward:{locations:[{location:"Lake beach"}],xp:5e3,move_to:{location:"Lake beach"},quest_progress:[{quest_id:"Giant Enemy Crab",task_index:1}],locks:{locations:["Further downstream"]}},unlock_text:"It's wounded, but in spite of that it looks more dangerous than before",temperature_modifier:1}),m["Further downstream"].connected_locations.push({location:m["Fight the giant crab again"],custom_text:"Fight the giant crab again",travel_time:5}),m["Forest den traversal"]=new zt({description:"A relatively large cave in the depths of the forest, filled with hordes of direwolves. You are trying to find out what's on the other side",enemies_list:["Direwolf"],enemy_count:50,enemy_group_size:[2,3],enemy_groups_list:[{enemies:["Direwolf hunter"]}],predefined_lineup_on_nth_group:4,is_unlocked:!1,enemy_stat_variation:.2,name:"Forest den traversal",types:[{type:"narrow",stage:2,xp_gain:5},{type:"dark",stage:2,xp_gain:5}],parent_location:m["Forest road"],repeatable_reward:{xp:1e3,messages:["You reach a wall of water and push through"],locations:[{location:"Forest lake"}],move_to:{location:"Forest lake"}},temperature_range_modifier:.8,is_under_roof:!0}),m["Forest road"].connected_locations.push({location:m["Forest den traversal"],custom_text:"Try to get to the other side of the [Forest den]",travel_time:90})})();(function(){m.Village.activities={fieldwork:new D({activity_name:"fieldwork",starting_text:"Work on the fields",get_payment:()=>15+Math.round(25*K("Farming")/f.Farming.max_level),is_unlocked:!1,working_period:60*2,availability_time:{start:6,end:20},availability_seasons:["Spring","Summer","Autumn"],skill_xp_per_tick:1}),running:new D({activity_name:"running",starting_text:"Go for a run around the village",skill_xp_per_tick:1,is_unlocked:!1}),weightlifting:new D({activity_name:"weightlifting",starting_text:"Try to carry some bags of grain",skill_xp_per_tick:1,is_unlocked:!1}),swimming:new D({activity_name:"swimming",starting_text:"Swim in the river",infinite:!1,availability_seasons:["Spring","Summer","Autumn"],skill_xp_per_tick:1,is_unlocked:!0,applied_effects:[{effect:"Wet",duration:30}]}),balancing:new D({activity_name:"balancing",starting_text:"Try to keep your balance on rocks in the river",unlock_text:"All this fighting while surrounded by stone and rocks gives you a new idea",skill_xp_per_tick:1,is_unlocked:!1}),meditating:new D({activity_name:"meditating",starting_text:"Sit down and meditate",skill_xp_per_tick:1,is_unlocked:!0}),patrolling:new D({activity_name:"patrolling",starting_text:"Go on a patrol around the village.",get_payment:()=>50,is_unlocked:!1,working_period:60*2,skill_xp_per_tick:1}),woodcutting:new D({activity_name:"woodcutting",starting_text:"Gather wood on the outskirts",skill_xp_per_tick:1,is_unlocked:!0,gained_resources:{resources:[{name:"Piece of rough wood",ammount:[[1,1],[1,3]],chance:[.5,1]}],time_period:[20,10],skill_required:[0,10]},require_tool:!0}),sand:new D({activity_id:"sand",activity_name:"digging",starting_text:"Dredge up some sand from the riverbed",skill_xp_per_tick:1,is_unlocked:!1,gained_resources:{resources:[{name:"Silica Sand",ammount:[[1,1],[1,3]],chance:[.4,1]}],time_period:[120,60],skill_required:[0,10]},require_tool:!0,unlock_text:"You realize that the river near the village might contain the type of sand you need"}),fishing:new D({activity_name:"fishing",starting_text:"Try fishing in the river",availability_seasons:["Spring","Summer","Autumn"],skill_xp_per_tick:1,is_unlocked:!0,gained_resources:{resources:[{name:"Ratfish",chance:[.3,.5]},{name:"Minnow",chance:[.1,.5]},{name:"Trout",chance:[.01,.2]},{name:"Mackerel shark",chance:[.001,.05]}],time_period:[120,30],skill_required:[0,10]},require_tool:!0})},m["Nearby cave"].activities={weightlifting:new D({activity_name:"weightlifting",starting_text:"Try lifting some of the rocks",skill_xp_per_tick:4,is_unlocked:!1,unlock_text:"After the fight, you realize there's quite a lot of rocks of different sizes that could be used for exercises"}),climbing:new D({activity_name:"climbing",starting_text:"Attempt climbing the mountain walls outside",skill_xp_per_tick:1,is_unlocked:!0}),meditating:new D({activity_name:"meditating",starting_text:"Sit down and meditate in front of the gate",skill_xp_per_tick:4,is_unlocked:!1,unlock_text:"As you finish fighting your enemies and it becomes quiet, you feel a strange sense of tranquility. This spot in front of the mysterious gate, surrounded by calm and darkness, seems perfect to sit down and focus your mind."}),mining:new D({activity_name:"mining",starting_text:"Mine the strange looking iron vein",skill_xp_per_tick:1,is_unlocked:!1,gained_resources:{resources:[{name:"Low quality iron ore",ammount:[[1,1],[1,3]],chance:[.4,.8]}],time_period:[60,30],skill_required:[0,10]},unlock_text:"As you clear the area of wolf rats, you notice a vein of an iron ore"}),mining2:new D({activity_name:"mining",starting_text:"Mine the deeper iron vein",skill_xp_per_tick:5,is_unlocked:!1,gained_resources:{resources:[{name:"Iron ore",ammount:[[1,1],[1,3]],chance:[.3,.7]}],time_period:[90,40],skill_required:[7,17]},unlock_text:"Going deeper, you find a vein of an iron ore that seems to be of much higher quality"}),mining3:new D({activity_name:"mining",starting_text:"Mine the atratan vein",skill_xp_per_tick:12,is_unlocked:!1,gained_resources:{resources:[{name:"Atratan ore",ammount:[[1,1],[1,3]],chance:[.3,.7]}],time_period:[120,60],skill_required:[12,25]},unlock_text:"As you finish the fight and get a time to look around, you notice a metal vein of different color than iron. You recall another ore called Atratan, this must be it."})},m["Forest road"].activities={running:new D({activity_name:"running",starting_text:"Go for a run through the forest",skill_xp_per_tick:4}),woodcutting:new D({activity_name:"woodcutting",starting_text:"Gather wood from nearby trees",skill_xp_per_tick:5,is_unlocked:!1,gained_resources:{resources:[{name:"Piece of wood",ammount:[[1,1],[1,3]],chance:[.3,1]}],time_period:[90,40],skill_required:[7,17]}}),woodcutting2:new D({activity_name:"woodcutting",starting_text:"Gather wood from sturdy trees",skill_xp_per_tick:12,is_unlocked:!1,gained_resources:{resources:[{name:"Piece of ash wood",ammount:[[1,1],[1,3]],chance:[.3,1]}],time_period:[120,60],skill_required:[12,25]},unlock_text:"Finishing your fight, you notice that the trees on the side of the clearing look really healthy and sturdy, they could be a useful material."}),herbalism:new D({activity_name:"herbalism",starting_text:"Gather useful herbs throughout the forest",skill_xp_per_tick:2,is_unlocked:!1,gained_resources:{resources:[{name:"Oneberry",chance:[.1,.5]},{name:"Golmoon leaf",chance:[.1,.7]},{name:"Belmart leaf",chance:[.1,.7]}],time_period:[120,45],skill_required:[0,10]},require_tool:!0})},m["Carya Canyon"].activities={woodcutting:new D({activity_name:"woodcutting",starting_text:"Gather wood from the resilient trees",skill_xp_per_tick:16,is_unlocked:!1,gained_resources:{resources:[{name:"Piece of hickory wood",ammount:[[1,1],[1,3]],chance:[.3,1]}],time_period:[120,60],skill_required:[20,30],scales_with_skill:!0},unlock_text:"Crossing the canyon, you discover that the trees on the other side are extremely tough."})},m["Town outskirts"].activities={herbalism:new D({activity_name:"herbalism",starting_text:"Search for useful herbs by the roadside",skill_xp_per_tick:4,is_unlocked:!1,gained_resources:{resources:[{name:"Cooking herbs",ammount:[[1,1],[2,4]],chance:[.1,1]}],time_period:[120,30],skill_required:[5,20]},require_tool:!0,unlock_text:"You learned that some useful herbs can be found right under your nose"})},m["Town farms"].activities={fieldwork:new D({activity_name:"fieldwork",starting_text:"Work on the fields",get_payment:()=>30+Math.round(30*K("Farming")/f.Farming.max_level),is_unlocked:!1,working_period:60*2,availability_time:{start:6,end:20},availability_seasons:["Spring","Summer","Autumn"],skill_xp_per_tick:2}),"animal care":new D({activity_name:"animal care",starting_text:"Take care of local sheep in exchange for some wool",skill_xp_per_tick:3,is_unlocked:!1,gained_resources:{resources:[{name:"Wool",ammount:[[1,1],[1,3]],chance:[.1,1]}],time_period:[120,60],skill_required:[0,10]}})},m["Mountain path"].activities={balancing:new D({activity_name:"balancing",starting_text:"Stupidly risk your life by trying to balance on some stones on the very edge of the cliff",skill_xp_per_tick:4,is_unlocked:!0})},m["Mountain camp"].activities={herbalism:new D({activity_name:"herbalism",starting_text:"Search for useful herbs on the mountainside",skill_xp_per_tick:6,is_unlocked:!1,gained_resources:{resources:[{name:"Silver thistle",chance:[.1,.5]}],time_period:[120,60],skill_required:[7,17]},require_tool:!0}),balancing:new D({activity_name:"balancing",starting_text:"Stupidly risk your life by trying to balance on some stones on the very edge of the cliff",skill_xp_per_tick:4,is_unlocked:!0}),climbing:new D({activity_name:"climbing",starting_text:"Take a lesson from the goats and try to climb a wall near the camp",skill_xp_per_tick:4,is_unlocked:!0})},m.Riverbank.activities={herbalism:new D({activity_name:"herbalism",starting_text:"Harvest flax from around the riverbank",skill_xp_per_tick:9,is_unlocked:!1,gained_resources:{resources:[{name:"Flax",ammount:[[1,1],[1,3]],chance:[.4,.8]}],time_period:[120,60],skill_required:[14,21]},require_tool:!0})},m["Lake beach"].activities={swimming:new D({activity_name:"swimming",starting_text:"Swim against the current",infinite:!1,availability_seasons:["Spring","Summer","Autumn"],skill_xp_per_tick:7,is_unlocked:!1,applied_effects:[{effect:"Wet",duration:30}]}),sand:new D({activity_id:"sand",activity_name:"digging",starting_text:"Dig for clams around the lake beach",skill_xp_per_tick:10,is_unlocked:!1,gained_resources:{resources:[{name:"Clam",ammount:[[1,3],[1,3]],chance:[.34,1]}],time_period:[60,30],skill_required:[10,20]},require_tool:!0}),climbing:new D({activity_name:"climbing",starting_text:"Practice rappelling down the cliff face",skill_xp_per_tick:10,is_unlocked:!1}),weightlifting:new D({activity_name:"weightlifting",starting_text:"Sled pull a boulder",skill_xp_per_tick:10,is_unlocked:!1}),running:new D({activity_name:"running",starting_text:"Run along the shore",skill_xp_per_tick:10,is_unlocked:!0})},m["Forest lake"].activities={swimming:new D({activity_name:"swimming",starting_text:"Go diving in the lake waters",skill_xp_per_tick:4,is_unlocked:!0,infinite:!1,availability_seasons:["Spring","Summer","Autumn"],applied_effects:[{effect:"Wet",duration:30}]}),balancing:new D({activity_name:"balancing",starting_text:"Try to keep your balance on top of the waterfall as water rushes around your feet",skill_xp_per_tick:7,is_unlocked:!0,applied_effects:[{effect:"Wet",duration:30}]}),woodcutting:new D({activity_name:"woodcutting",starting_text:"Harvest wood from the weeping willows",skill_xp_per_tick:10,is_unlocked:!0,gained_resources:{resources:[{name:"Piece of willow wood",ammount:[[1,1],[2,5]],chance:[.3,1]}],time_period:[20,10],skill_required:[12,25]}}),mining:new D({activity_name:"mining",starting_text:"Mine the the shiny underwater vein",skill_xp_per_tick:1,is_unlocked:!1,gained_resources:{resources:[{name:"Silver ore",ammount:[[1,1],[1,3]],chance:[.3,.7]}],time_period:[100,50],skill_required:[10,20]},unlock_text:"You discover a vein of silver at the bottom of the lake!"}),fishing:new D({activity_name:"fishing",starting_text:"Try fishing in the lake",skill_xp_per_tick:4,is_unlocked:!0,gained_resources:{resources:[{name:"Ratfish",chance:[.2,.8]},{name:"Carp",chance:[.1,.5]},{name:"Mackerel shark",chance:[.05,.2]},{name:"Catfish",chance:[.01,.1]}],time_period:[120,30],skill_required:[10,20]},require_tool:!0})},m["Waterfall basin"].activities={enduring:new D({activity_name:"enduring",starting_text:"Harden your resolve by sitting underneath the waterfall",skill_xp_per_tick:2,applied_effects:[{effect:"Wet",duration:30}],infinite:!1,availability_seasons:["Spring","Summer","Autumn"]}),meditating:new D({activity_name:"meditating",starting_text:"Sit in the rock shelter behind the waterfall and focus your mind",skill_xp_per_tick:8,is_unlocked:!1,unlock_text:"As you finish driving the stone crabs from the rock shelter behind the waterfall, you feel a strange sense of serenity from the sounds bouncing off the rocks. This spot, surrounded by soft noise and solid stone, seems perfect to sit down and focus your mind"})},m["Swampland tribe"].activities={herbalism:new D({activity_name:"herbalism",starting_text:"Forage for wild herbs and vegetables in the swamplands",skill_xp_per_tick:14,is_unlocked:!1,gained_resources:{resources:[{name:"Wild onion",chance:[.2,.65]},{name:"Wild garlic",chance:[.2,.65]},{name:"Wild potato",ammount:[[1,1],[1,2]],chance:[.3,.6]},{name:"Cooking herbs",ammount:[[1,1],[1,2]],chance:[.3,.6]}],time_period:[90,45],skill_required:[21,28]}})}})();(function(){m.Village.actions={"search for delivery":new ce({action_id:"search for delivery",starting_text:"Search the village for the missing grain delivery",description:"It might take some time, but it has to be somewhere",action_text:"Searching the village",success_text:"There it is! You see a cart loaded with grain bags, an annoyed driver, and a horse ignoring everything and calmly munching on grass",failure_texts:{random_loss:["You look around for some time, but end up with nothing. Keep searching!"],conditional_loss:["You are not perceptive enough for this..."]},conditions:[{skills:{Perception:1}},{skills:{Perception:5}}],attempt_duration:15,success_chances:[.5,1],rewards:{actions:[{location:"Village",action:"carry grain"},{location:"Village",action:"pull cart"},{location:"Village",action:"convince horse"}],skill_xp:{Perception:100}}}),"carry grain":new ce({action_id:"carry grain",starting_text:"Try to carry the grain bags yourself",description:"It won't be quick...",action_text:"Carrying bags",success_text:"After a few hours of slow and heavy work, you place the final bag in front of the storehouse. You should let that mischievous duo know that the task is done.",failure_texts:{unable_to_begin:["You try for a bit, but you quickly realize you are not fit enough for this task."]},check_conditions_on_finish:!1,attempt_duration:480,success_chances:[1],keep_progress:!0,required:{stats:{strength:20,max_stamina:80}},rewards:{move_to:{location:"Eastern mill"},skill_xp:{Weightlifting:300},textlines:[{dialogue:"village millers",lines:["delivered"]}],locks:{actions:[{location:"Village",action:"pull cart"},{location:"Village",action:"convince horse"}]}}}),"pull cart":new ce({action_id:"pull cart",starting_text:"Attempt to pull the cart by yourself",description:"It own't be easy, but at least will be somewhat quick",action_text:"Pulling the cart",success_text:"Lo and behold, the cart begins moving as you pull it. Slow but steady, after some time you reach the storehouse. You should let that mischievous duo know that the task is done.",failure_texts:{unable_to_begin:["You try and try, but it won't budge"]},check_conditions_on_finish:!1,attempt_duration:60,success_chances:[1],keep_progress:!0,required:{stats:{strength:45}},rewards:{move_to:{location:"Eastern mill"},skill_xp:{Weightlifting:300},textlines:[{dialogue:"village millers",lines:["delivered"]}],locks:{actions:[{location:"Village",action:"carry grain"},{location:"Village",action:"convince horse"}]}}}),"convince horse":new ce({action_id:"convince horse",starting_text:"Try to convince the horse to go back to its work",description:"Getting that animal back to work is the fastest way to be done",action_text:"Being nice",success_text:"The horse seems to understand you, as it abandons its snack and obediently pulls the cart towards the storehouse. You should let that mischievous duo know that the task is done.",failure_texts:{conditional_loss:["No matter what you try, the horse does not care. Maybe if you had some actual experience with animals..."]},attempt_duration:10,success_chances:[1],conditions:[{skills:{"Animal handling":8}}],rewards:{move_to:{location:"Eastern mill"},skill_xp:{"Animal handling":300},textlines:[{dialogue:"village millers",lines:["delivered"]}],locks:{actions:[{location:"Village",action:"pull cart"},{location:"Village",action:"carry grain"}]}}}),"hike down river":new ce({action_id:"hike down river",starting_text:"Attempt to hike through the wilderness alongside the riverbank",description:"It might take a really long time, but it's the only way you're going to find those enormous crabs' nest. Or was it that enormous crab's nest?",action_text:"Hiking through the wilderness, attempting to follow the river",success_text:"After hiking for well over a day, you finally come across a relatively clear point on the river with recognizable landmarks and signs of crabs. It feels like a long way off from the village, but you're confident that you can get back here again, and faster too",attempt_duration:2160,success_chances:[1],rewards:{locations:[{location:"Downstream from the village"}],move_to:{location:"Downstream from the village"}}})},m["Nearby cave"].actions={"open the gate":new ce({action_id:"open the gate",starting_text:"Try to push the mysterious gate open",description:"It's an ancient massive gate, but maybe with enough strength and training you could actually manage to push it at least a tiny bit to create enough space to walk through.",action_text:"Huffing and puffing",success_text:"When you are almost ready to give up, you hear the ancient hinges creak, as the gate slowly moves. Finally, you can continue deeper!",failure_texts:{conditional_loss:["Despite trying your best, you can feel that you are just too weak for it. You should get stronger first."]},conditions:[{stats:{strength:200}}],attempt_duration:10,success_chances:[1],rewards:{locations:[{location:"Writhing tunnel"}],quest_progress:[{quest_id:"The Infinite Rat Saga",task_index:1}]}}),"climb the mountain":new ce({action_id:"climb the mountain",starting_text:"Try to climb up the mountain",description:"It is an ardous task that will require some good long rope and actual skill in climbing, together with good physical abilities. It will take some time, so you need to make sure you won't run out of energy halfway through.",action_text:"Climbing up",success_text:"Somehow you did it, you climbed all the way up! Thanks to the rope you tied on your way, further trips up and down will be much easier.",failure_texts:{conditional_loss:["Despite trying your best, you can feel that you won't manage to do it without more training"],random_loss:["You almost had it, but at some point you grabbed a rock that turned out to be unstable. Be more careful next time!","You were really close, but a gust of wind at a bad moment knocked you off balance.","You failed to notice a falling rock and got knocked down."],unable_to_begin:["While seemingly prepared, you realize you're missing an important accessory - some nice long rope is gonna be a necessity for this, especially if you want to go back down at some point."]},required:{items_by_id:{"Coil of rope":{count:1,remove_on_success:!0}}},conditions:[{skills:{Climbing:7},stats:{strength:50,agility:50,max_stamina:50}},{skills:{Climbing:12},stats:{strength:120,agility:120,max_stamina:50}}],attempt_duration:60,success_chances:[.3,1],rewards:{locations:[{location:"Mountain path"}],move_to:{location:"Mountain path"},skill_xp:{Climbing:1e3}}})},m["Mountain path"].actions={explore:new ce({action_id:"explore",starting_text:"Explore the area",description:"Now that you are here, it's time to find if there's anything worthy of your time. Too bad you couldn't do it beforehand.",action_text:"Looking around",success_text:"The good news: you noticed a nice little piece of flat land that would be perfect for a camp. The bad news: there's a very angry-looking mountain goat blocking your way.",failure_texts:{random_loss:["You looked under rocks and between the bushes, but you found nothing. Keep looking!","You looked and looked, but you couldn't find anything. Rest a bit and go back to it!"]},conditions:[],is_unlocked:!0,attempt_duration:60,success_chances:[.6],rewards:{locations:[{location:"Fight the angry mountain goat"}]}})},m["Small flat area in mountains"].actions={"create camp":new ce({action_id:"create camp",starting_text:"Establish a camp here",description:"Prepare a tent, a fireplace, and a storage here to create a new base. It will be necessary before exploring further up the mountains.",action_text:"Working",success_text:"After a few hours of hard work, your camp is ready. You can rest here before venturing further in the mountains",conditions:[{items_by_id:{"Camping supplies":{count:1,remove:!0}}}],is_unlocked:!0,check_conditions_on_finish:!1,failure_texts:{conditional_loss:["You lack camping supplies!"]},attempt_duration:180,success_chances:[1],rewards:{locations:[{location:"Mountain camp"}],move_to:{location:"Mountain camp"},locks:{locations:["Mountain path","Small flat area in mountains"]}}})},m["Mountain camp"].actions={explore1:new ce({action_id:"explore1",starting_text:"Explore the area further",description:"With the camp created, it's time to keep exploring",action_text:"Looking around",success_text:"You find a reasonably gentle mountain slope with green grass and... more angry goats. At least they seem slightly smaller.",failure_texts:{random_loss:["You looked under rocks and between the bushes, but you found nothing. Keep looking!","You looked and looked, but you couldn't find anything. Rest a bit and go back to it!"]},conditions:[],is_unlocked:!0,attempt_duration:60,success_chances:[.6],rewards:{locations:[{location:"Gentle mountain slope"}],actions:[{location:"Mountain camp",action:"explore2"}]}}),explore2:new ce({action_id:"explore2",starting_text:"Keep exploring",description:"You have a feeling that there must be something more of value than just goats.",action_text:"Looking around",success_text:"You notice some plants, that you soon recognize as a potent healing ingredient that was mentioned to you by that old craftsman. It's gonna be useful if you know proper recipes.",failure_texts:{random_loss:["You looked under rocks and between the bushes, but you found nothing. Keep looking!","You looked and looked, but you couldn't find anything. Rest a bit and go back to it!"],conditional_loss:["You spot a lot of curious plants. You have a hunch that at least some of them must be useful for something, but you fail to recognize any of them. If only you knew more about herbs..."]},conditions:[{skills:{Herbalism:6}},{skills:{Herbalism:10}}],is_unlocked:!1,attempt_duration:60,success_chances:[.5],rewards:{activities:[{location:"Mountain camp",activity:"herbalism"}]}})},m["Forest road"].actions={"search for boars":new ce({action_id:"search for boars",starting_text:"Search forest for the clearing with boars",description:"It might take some time and a few attempts, but you are sure you can manage",action_text:"Searching the forest",success_text:"There they are! You see a clearing with tall grass and hear unmistakeable grunts and squeals",failure_texts:{random_loss:["You search for some time, but end up with nothing. Next time you will try a slightly different direction"],conditional_loss:["You are not perceptive enough for this..."]},conditions:[{skills:{Perception:1}},{skills:{Perception:8}}],attempt_duration:90,success_chances:[.5,1],rewards:{locations:[{location:"Forest clearing"}],skill_xp:{Perception:100}}}),"follow the trail":new ce({action_id:"follow the trail",starting_text:"Follow the mysterious trail deeper into the forest...",description:"It doesn't seem to be a smart thing to do",action_text:"Following the trail",success_text:"The trail leads you to a large cave. There are some broken bones lying around the entrance",failure_texts:{random_loss:["At some point you got distracted and lost your way"]},attempt_duration:180,success_chances:[.7],rewards:{locations:[{location:"Forest den"}]},unlock_text:"At some point during your fights, you notice a path trodden by animals. There's a lot of footprints that look like wolf's, except much larger..."}),"What was that noise?":new ce({action_id:"What was that noise?",starting_text:"What was that noise you heard while fighting boars?",description:"Time to investigate",action_text:"Following the sounds",success_text:"The sound was the wind howling through a canyon.",failure_texts:{random_loss:["Oh look a squirrel!"],conditional_loss:["After wandering around for a while, you fail to perceive the source of the sound..."]},conditions:[{skills:{Perception:15}}],attempt_duration:180,success_chances:[.7],rewards:{locations:[{location:"Carya Canyon"}]},unlock_text:"While fighting the boars, you heard a strange noise from the north. What could it be?"}),"search predator":new ce({action_id:"search predator",starting_text:"Search for the predator that hunts direwolves",description:"It's a terrible idea",action_text:"Searching for the predator",success_text:"You end up finding another large cave. There's a lot of bones around the entrance, some belonging to direwolves and boars",failure_texts:{random_loss:["At some point you got distracted and lost your way"],conditional_loss:["You are not perceptive enough for this..."]},attempt_duration:180,success_chances:[.4,1],conditions:[{skills:{Perception:1}},{skills:{Perception:10}}],rewards:{locations:[{location:"Bears' den"}],skill_xp:{Perception:200}},unlock_text:"At some point during your fights you notice a direwolf with terrible scars, clearly inflicted by an even larger predator. What could have it been?"})},m["Carya Canyon"].actions={"Make a bridge":new ce({action_id:"Make a bridge",starting_text:"Cut down a tall tree to cross the canyon",description:"Nothing could possibly go wrong",action_text:"Chop chop",success_text:"The tree creaks and groans, then crashes down on the other side",is_unlocked:!0,failure_texts:{random_loss:["The tree was too small and falls right in. Try again with a bigger one."],conditional_loss:["The tree falls the wrong way and vanishes into the depths, better improve your chopping skills."]},conditions:[{skills:{Woodcutting:20}}],attempt_duration:240,success_chances:[.7],rewards:{locations:[{location:"Precarious tree bridge"}]}})},m["Town farms"].actions={"dig for ants 1":new ce({action_id:"dig for ants 1",action_name:"Search for ant nests",starting_text:"Dig in search of red ant nests",description:"They live somewhere down there",action_text:"Digging",success_text:"You find an ant tunnel, just barely wide enough for you to enter",attempt_duration:180,success_chances:[1],rewards:{locations:[{location:"Red ant nest 1"}],skill_xp:{Digging:20}}}),"dig for ants 2":new ce({action_id:"dig for ants 2",action_name:"Search for second ant nest",starting_text:"Dig in search of red ant nests",description:"They live somewhere down there",action_text:"Digging",success_text:"You find an ant tunnel, just barely wide enough for you to enter",attempt_duration:240,success_chances:[1],rewards:{locations:[{location:"Red ant nest 2"}],skill_xp:{Digging:30}}}),"dig for ants 3":new ce({action_id:"dig for ants 3",action_name:"Search for third ant nests",starting_text:"Dig in search of red ant nests",description:"They live somewhere down there",action_text:"Digging",success_text:"You find an ant tunnel, just barely wide enough for you to enter",attempt_duration:300,success_chances:[1],rewards:{locations:[{location:"Red ant nest 3"}],skill_xp:{Digging:40}}}),"follow ant trail":new ce({action_id:"follow ant trail",action_name:"Follow ant trail towards the forest",starting_text:"Follow ant trail towards the forest",description:"There must be other nests out there",action_text:"Searching",success_text:"You find a massive complex of ant tunnels, just barely wide enough for you to enter",attempt_duration:600,success_chances:[1],failure_texts:{unable_to_begin:["You can't do that without a shovel!"]},required:{tools_by_slot:["shovel"]},rewards:{locations:[{location:"Forest ant nest"}],move_to:{location:"Forest road"},skill_xp:{Digging:50}},unlock_text:"While your task is finished, it seems that you might be able to find more ants away from the farms"})},m["Lake beach"].actions={"create lake camp":new ce({action_id:"create lake camp",starting_text:"Establish a camp on top of the giant crab's nest",description:"Set a cot, fire pit, and storage chest here to establish a new camp site. It will be necessary both for resting in this area and for further exploration",action_text:"Building a camp",success_text:"After a few hours of hard work, your beachside camp is ready. You can rest here instead of returning back to the village",conditions:[{items_by_id:{"Camping supplies":{count:1,remove:!0}}}],is_unlocked:!0,check_conditions_on_finish:!1,failure_texts:{conditional_loss:["It's going to be hard to make a camp without camping supplies!"]},attempt_duration:120,success_chances:[1],rewards:{housing:["Lake beach"],activities:[{location:"Lake beach",activity:"swimming"},{location:"Lake beach",activity:"sand"}],actions:[{location:"Lake beach",action:"rappel waterfall"},{location:"Lake beach",action:"create lake climbing"},{location:"Lake beach",action:"create lake weightlifting"}]}}),"rappel waterfall":new ce({action_id:"rappel waterfall",starting_text:"Try to rappel down the cliffside next to the waterfall",description:"It doesn't look that difficult, but it's still a strenuous task that will require some good long rope and proficiency in climbing, together with a fit physique. It will take a great deal of time, so make sure to prepare yourself for the task ahead",action_text:"Rappelling down the cliff",success_text:"It was slow, methodical work, but you've managed to secure a safe and stable pathway across the cliff face. That should make subsequent trips back up and down significantly faster in the future",failure_texts:{conditional_loss:["Despite telling yourself that scaling down the cliff would be easy, you realize that the path is far more dangerous that you initially expected. Perhaps a more experienced mountain climber would be able to manage the hazards"],random_loss:["The routing looked easier from up top, but the slick rock wall and poor footing put you on a path to failure shortly after beginning"],unable_to_begin:["While mentally prepared, you realize you're missing an important accessory -- the rope! Rope is kind of a necessity for this, especially if you want to survive the landing!"]},required:{items_by_id:{"Coil of rope":{count:1,remove_on_success:!0}}},conditions:[{skills:{Climbing:17},stats:{strength:400,agility:350,max_stamina:1e3}},{skills:{Climbing:25},stats:{strength:600,agility:1e3,max_stamina:1500}}],is_unlocked:!1,attempt_duration:180,success_chances:[.45,1],rewards:{locations:[{location:"Waterfall basin"}],move_to:{location:"Waterfall basin"},skill_xp:{Climbing:5e4}}}),"create lake climbing":new ce({action_id:"create lake climbing",starting_text:"Prepare a rappel practice point",description:"The cliff face here would make a good place to practice advance climbing techniques such as rappelling",action_text:"Searching for a safe rappel point",success_text:"After an hour, you manage to safely secure some rope over a shallow underhang close to the edge of the cliff. You can practice here before trying to make your way down the entire cliffside",conditions:[{items_by_id:{"Coil of rope":{count:1,remove:!0}}}],is_unlocked:!1,check_conditions_on_finish:!1,failure_texts:{conditional_loss:["It's going to be hard to rappel without a rope!"]},attempt_duration:60,success_chances:[1],rewards:{activities:[{location:"Lake beach",activity:"climbing"}]}}),"create lake weightlifting":new ce({action_id:"create lake weightlifting",starting_text:"Wrap a boulder for sled pull training",description:"Looking at the large boulders nearby, you consider that dragging or pulling one around the beach with rope might be good strength training",action_text:"Wrapping a boulder",success_text:"After about an hour, you manage to securely wrap a boulder with some rope. Grabbing the end and pulling with all your might, the boulder inches forward with you",conditions:[{items_by_id:{"Coil of rope":{count:1,remove:!0}}}],is_unlocked:!1,check_conditions_on_finish:!1,failure_texts:{conditional_loss:["You're going to need some rope before you wrap anything!"]},attempt_duration:60,success_chances:[1],rewards:{activities:[{location:"Lake beach",activity:"weightlifting"}]}})},m["Forest lake"].actions={search1:new ce({action_id:"search1",action_name:"Dive to the bottom of the lake",starting_text:"Dive to the bottom of the lake",description:"See what you can discover down there",action_text:"Exploring",success_text:"You captured the attention of the lake's true apex predator. It follows you back to the shore",failure_texts:{conditional_loss:["You need to get more used to water and have lung capacity to go that deep"],random_loss:["You run out of breath before you can reach the bottom","Nothing catches your attention this time"]},conditions:[{skills:{Swimming:10,Breathing:10,Perception:1}},{skills:{Swimming:25,Breathing:25,Perception:10}}],is_unlocked:!0,attempt_duration:120,success_chances:[.2,1],rewards:{locations:[{location:"Frogs"}],skill_xp:{Swimming:500,Breathing:500,Perception:500}}}),search2:new ce({action_id:"search2",action_name:"Finish exploring the bottom of the lake",starting_text:"Finish exploring the bottom of the lake",description:"See what alse you can discover down there",action_text:"Exploring",success_text:"You spot something shining on the lake's bed",failure_texts:{conditional_loss:["You need to get more used to water and have lung capacity to go that deep"],random_loss:["You run out of breath before you can reach the bottom","Nothing catches your attention this time"]},conditions:[{skills:{Swimming:10,Breathing:10,Perception:2}},{skills:{Swimming:25,Breathing:25,Perception:10}}],is_unlocked:!1,attempt_duration:60,success_chances:[.2,1],rewards:{action:[{location:"Forest lake",action:"mining"}],skill_xp:{Swimming:800,Breathing:800,Perception:800}}}),gaze:new ce({action_id:"gaze",action_name:"Follow where the river leads",starting_text:"Follow where the river leads",description:"...into the darker forest...",action_text:"Exploring",success_text:"[TBD]",failure_texts:{conditional_loss:["You need to get more used to water and have lung capacity to go that deep"],random_loss:[`You may have felt like you can already brave anything this forest can throw at you. But the part stretching before you is more imposing than anything you've seen so far.<br><br>
The river coming from the lake vanishes in darkness as the foliage is too dense to let in light. The trees there are growing larger, denser... More ancient.<br><br>
You try to make make out the details of what looks like a bird flying in the distance. It has four legs... [tbc]`]},is_unlocked:!0,success_chances:[0,0]})},m.Longhouse.actions={"learn forage":new ce({action_id:"learn forage",starting_text:"Ask the scout to teach you about local herbs and vegetables",description:"The scout had mentioned interesting local plants, maybe she can teach you about them",action_text:"Learning how to forage from the scout",success_text:"The scout explains the local herbs, root vegetables and tubers that grow in the outlying swamplands. You feel confident that you could find them yourself at this point",failure_texts:{conditional_loss:["The scout tries to explain the look and uses of local flora, but you're having a hard time understanding what she's talking about. Maybe if you were a better herbalist, it would be easier"],random_loss:["The scout tries to explain the look and uses of local flora, but you just can't really internalize what she's telling you","The scout tries to explain the look and uses of local flora, but throughout the hour, your mind wanders to everything she's told you recently, and you have difficulty focusing on what she's trying to teach you","The scout tries to explain the look and uses of local flora, but her pain is too great to properly teach you anything right now","The scout tries to explain the look and uses of local flora, but nothing she tells you is very helpful","The scout tries to explain the look and uses of local flora, but she's just telling you things you've already learned","The scout tries to explain the look and uses of local flora, but you two get distracted and spend the hour talking about something else. It was nice"]},conditions:[{skills:{Herbalism:20}},{skills:{Herbalism:25}}],attempt_duration:60,success_chances:[.45,1],rewards:{activities:[{location:"Swampland tribe",activity:"herbalism"}]}})}})();(function(){Object.keys(m).forEach(e=>{Object.keys(m[e].activities||{}).forEach(t=>{m[e].activities[t].activity_id=t}),m[e].id=e})})();gl();var z={},te=class{constructor({name:t,id:i,description:a=null,duration:s,effects:n,tags:o,potency:l,group_tags:d,affected_by_travel:u=!0}){this.name=t,this.id=i,this.description=a,this.duration=s??0,this.effects=n,this.effects.bonus_skill_levels||(this.effects.bonus_skill_levels={}),this.effects.stats||(this.effects.stats={}),this.affected_by_travel=u,this.tags=o||{},this.group_tags=d||{},this.tags.effect=!0,this.potency=l||0}};z.Wet=new te({name:"Wet",effects:{stats:{cold_tolerance:{flat:-5}}}}),z.Cold=new te({name:"Cold",effects:{stats:{stamina_efficiency:{multiplier:.8},strength:{multiplier:.9}}},group_tags:{cold:1}}),z["Very cold"]=new te({name:"Very cold",effects:{stats:{stamina_efficiency:{multiplier:.6},dexterity:{multiplier:.8},agility:{multiplier:.8},strength:{multiplier:.8}}},group_tags:{cold:2}}),z.Freezing=new te({name:"Freezing",effects:{stats:{stamina_efficiency:{multiplier:.3},dexterity:{multiplier:.6},agility:{multiplier:.6},strength:{multiplier:.6},health_regeneration_flat:{multiplier:.6},health_regeneration_percent:{multiplier:.6}},xp_multipliers:{all:.6}},group_tags:{cold:3}}),z.Hypothermia=new te({name:"Hypothermia",effects:{stats:{stamina_efficiency:{multiplier:.1},dexterity:{multiplier:.3},agility:{multiplier:.3},strength:{multiplier:.4},health_regeneration_flat:{multiplier:.2},health_regeneration_percent:{multiplier:.2}},xp_multipliers:{all:.3}},group_tags:{cold:4}});z["Basic meal"]=new te({name:"Basic meal",effects:{stats:{stamina_regeneration_flat:{flat:.5}}},tags:{buff:!0,food:!0}}),z["Well hydrated"]=new te({name:"Well hydrated",effects:{stats:{stamina_regeneration_flat:{flat:1}}},tags:{buff:!0,food:!0}}),z["Weak healing powder"]=new te({name:"Weak healing powder",effects:{stats:{health_regeneration_flat:{flat:2}}},tags:{buff:!0,medicine:!0}}),z["Healing powder"]=new te({name:"Healing powder",effects:{stats:{health_regeneration_flat:{flat:5}}},tags:{buff:!0,medicine:!0}}),z["Weak healing potion"]=new te({name:"Weak healing potion",effects:{stats:{health_regeneration_flat:{flat:8},health_regeneration_percent:{flat:1}}},tags:{buff:!0,medicine:!0}}),z["Healing potion"]=new te({name:"Healing potion",effects:{stats:{health_regeneration_flat:{flat:20},health_regeneration_percent:{flat:2}}},tags:{buff:!0,medicine:!0}}),z["Weak healing balm"]=new te({name:"Weak healing balm",effects:{stats:{health_regeneration_flat:{flat:5},health_regeneration_percent:{flat:.5}}},tags:{buff:!0,medicine:!0}}),z["Cheap meat meal"]=new te({name:"Cheap meat meal",effects:{stats:{stamina_regeneration_flat:{flat:1}}},tags:{buff:!0,food:!0}}),z["Simple meat meal"]=new te({name:"Simple meat meal",effects:{stats:{stamina_regeneration_flat:{flat:1},health_regeneration_flat:{flat:1}}},tags:{buff:!0,food:!0}}),z["Decent meat meal"]=new te({name:"Decent meat meal",effects:{stats:{stamina_regeneration_flat:{flat:2},health_regeneration_flat:{flat:2}}},tags:{buff:!0,food:!0}}),z["Hot meal"]=new te({name:"Hot meal",effects:{stats:{cold_tolerance:{flat:3}}},tags:{buff:!0,food:!0}}),z["Slight food poisoning"]=new te({name:"Slight food poisoning",effects:{stats:{health_loss_flat:{flat:-.5}}},tags:{debuff:!0,poison:!0}}),z["Tough meat meal"]=new te({name:"Tough meat meal",effects:{stats:{stamina_regeneration_flat:{flat:.5},health_regeneration_flat:{flat:.1}}},tags:{buff:!0,food:!0}}),z["Simple seafood soup"]=new te({name:"Simple seafood soup",effects:{stats:{stamina_regeneration_flat:{flat:1.5},health_regeneration_flat:{flat:.5}}},tags:{buff:!0,food:!0}}),z["Varied meat meal"]=new te({name:"Varied meat meal",effects:{stats:{stamina_regeneration_flat:{flat:2},health_regeneration_flat:{flat:1}}},tags:{buff:!0,food:!0}}),z["Varied seafood meal"]=new te({name:"Varied seafood meal",effects:{xp_multipliers:{all:1.25}},tags:{buff:!0,food:!0}});z.Irritation=new te({name:"Irritation",description:"Sensations caused by a foreign substance are making it difficult to concentrate",effects:{stats:{intuition:{multiplier:.75}}},tags:{debuff:!0,poison:!0},group_tags:{psychedelic:1}}),z.Confusion=new te({name:"Confusion",description:"An intoxicating substance is making you unable to think clearly",effects:{stats:{intuition:{multiplier:.5}}},tags:{debuff:!0,poison:!0},group_tags:{psychedelic:2}}),z.Hallucinations=new te({name:"Hallucinations",description:"A psychedelic substance is making it hard to tell what's real",effects:{stats:{intuition:{multiplier:.25}}},tags:{debuff:!0,poison:!0},group_tags:{psychedelic:3}}),z.Sticky=new te({name:"Sticky",description:"Covered in a sticky substance that restricts your movements",effects:{stats:{dexterity:{multiplier:.75},agility:{multiplier:.75},attack_speed:{multiplier:.75}}},tags:{debuff:!0}}),z["Weak necrotizing venom"]=new te({name:"Weak necrotizing venom",effects:{stats:{health_loss_flat:{flat:-5}}},tags:{debuff:!0,poison:!0}}),z["Mild necrotizing venom"]=new te({name:"Mild necrotizing venom",effects:{stats:{health_loss_flat:{flat:-15}}},tags:{debuff:!0,poison:!0}}),z["Paralysing poison"]=new te({name:"Paralysing poison",effects:{stats:{attack_speed:{multiplier:.5}}},tags:{debuff:!0,poison:!0}}),z["Infected lungs"]=new te({name:"Infected lungs",effects:{stats:{stamina_efficiency:{multiplier:.5}}},tags:{debuff:!0,poison:!0}}),z["Convulsive poison"]=new te({name:"Convulsive poison",description:"Hands are trembling, making it hard to strike with precision",effects:{stats:{dexterity:{multiplier:.5},crit_rate:{multiplier:.5}}},tags:{debuff:!0,poison:!0}});z.Recovering=new te({name:"Recovering",effects:{xp_multipliers:{all:.2}},tags:{debuff:!0},affected_by_travel:!1});z["Spark of Inspiration"]=new te({name:"Spark of Inspiration",effects:{xp_multipliers:{all:1.5}},tags:{buff:!0},affected_by_travel:!1});Object.keys(z).forEach(e=>{z[e].id=e});var dt=new Ii,Hs=!1;function tu(e){dt.add_to_inventory(e),jn()}function iu(e){dt.remove_from_inventory(e),jn()}function jl(e){jn(e),Hs=!0}function Nl(e){Hl(e),Hs=!1}function Rl(e){let t=Math.min(e.count,r.inventory[e.item_key].count);wt([{...e,item_count:t}]),tu([{...e,count:t}])}function Fl(e){let t=Math.min(e.count,dt.inventory[e.item_key].count);et([{...e,count:t}]),iu([{...e,item_count:t}])}function Gl(){return Hs}var O={},st={},ie=class{constructor({task_description:t="",task_condition:i={},task_rewards:a={},is_hidden:s=!1,is_finished:n=!1}){this.task_description=t,this.task_condition=i,this.task_rewards=a,this.is_hidden=s,this.is_finished=n,Object.keys(this.task_condition).forEach(o=>{Object.keys(this.task_condition[o]).forEach(l=>{Object.keys(this.task_condition[o][l]).forEach(d=>{this.task_condition[o][l][d].current=0})})})}},yt=class{constructor({quest_name:t,quest_id:i,quest_description:a,questline:s,quest_tasks:n=[],quest_condition:o,quest_rewards:l,display_priority:d=1/0,is_hidden:u=!1,is_finished:h=!1,is_repeatable:_=!1,getQuestName:w=()=>this.quest_name,getQuestDescription:b=()=>this.quest_description}){this.quest_name=t,this.quest_id=i,this.questline=s,this.quest_tasks=n,this.quest_description=a,this.quest_rewards=l||{},this.display_priority=d,this.is_hidden=u,this.is_finished=h,this.is_repeatable=_,this.quest_condition=o,this.getQuestName=w,this.getQuestDescription=b}getCompletedTaskCount(){return this.quest_tasks.length==0?0:this.quest_tasks.filter(t=>t.is_finished).length}},ge={startQuest({quest_id:e,should_inform:t=!0}){let i=O[e];(!i.is_finished||i.is_repeatable)&&!this.isQuestActive(e)&&(st[e]=new yt(O[e])),i.is_hidden||(zl(e),t&&C(`Started a new quest: ${O[e].getQuestName()}`))},isQuestActive(e){return e in st},isQuestFinished(e){return O[e].is_finished},finishQuest({quest_id:e,only_unlocks:t,is_from_loading:i,skip_rewards:a}){if(this.isQuestActive(e)){let s=O[e];s.is_repeatable||(s.is_finished=!0),delete st[e],O[e].is_hidden||(tn(e),i||C(`Finished a quest: "${O[e].getQuestName()}"`)),a||Pe({rewards:O[e].quest_rewards,source_type:"Quest",source_name:O[e].getQuestName(),only_unlocks:t,is_from_loading:i})}},finishQuestTask({quest_id:e,task_index:t,only_unlocks:i,skip_warning:a=!1,allowed_to_finish_quest:s=!0,skip_message:n=!1}){if(this.isQuestActive(e)){let o=O[e];o.quest_tasks[t].is_finished=!0,O[e].is_hidden||(tn(e),n||(O[e].quest_tasks[t].is_hidden?C(`Made some progress in quest: "${O[e].getQuestName()}"`):C(`Finished a task for a quest: "${O[e].getQuestName()}"`))),Pe({rewards:o.quest_tasks[t].task_rewards,source_type:"Quest",source_name:O[e].getQuestName(),only_unlocks:i});let l=st[e].quest_tasks.filter(d=>!d.is_finished);s&&l.length==0&&this.finishQuest({quest_id:e})}else a||console.warn(`Cannot finish task at index ${t} for quest "${e}", as it's not a currently active quest!`)},catchQuestEvent({quest_event_type:e,quest_event_target:t,quest_event_count:i,additional_quest_tags:a={}}){Object.keys(st).forEach(s=>{if(!(s in st))return;let n=st[s].quest_tasks.findIndex(h=>!h.is_finished),o=st[s].quest_tasks[n];if(!("any"in o.task_condition)&&!("all"in o.task_condition))return;let l=!1,d=!0;Object.keys(o.task_condition).forEach(h=>{Object.keys(o.task_condition[h]).forEach(_=>{Object.keys(o.task_condition[h][_]).forEach(w=>{if(o.task_condition[h][_][w].current||(o.task_condition[h][_][w].current=0),e===_&&t===w){let b=!0,g=o.task_condition[h][_][w].requirements;if(Object.keys(g||{}).forEach(v=>{(!a[v]||a[v]!=g[v])&&(b=!1)}),b){let v=o.task_condition[h][_][w].restrictions;Object.keys(v||{}).forEach(y=>{a[y]&&a[y]===v[y]&&(b=!1)})}if(!b){d=!1;return}_==="reach_skill"?o.task_condition[h][_][w].current=i:o.task_condition[h][_][w].current+=i}h==="any"&&o.task_condition[h][_][w].current>=o.task_condition[h][_][w].target?l=!0:h==="all"&&o.task_condition[h][_][w].current<o.task_condition[h][_][w].target&&(d=!1)})})}),(l||!("any"in o.task_condition))&&(d||!("all"in o.task_condition))?this.finishQuestTask({quest_id:s,task_index:n,allowed_to_finish_quest:!1}):!st[s].is_hidden&&!st[s].quest_tasks[n.is_hidden]&&Yl(s,n),st[s].quest_tasks.filter(h=>!h.is_finished).length==0&&this.finishQuest({quest_id:s})})}};O["Lost memory"]=new yt({quest_name:"Lost memory",display_priority:0,getQuestDescription:()=>{let e=O["Lost memory"].getCompletedTaskCount();if(e==0)return"You woke up in some village and you have no idea how you got here or who you are. Just what could have happened?";if(e==1)return"You lost your memories after being attacked by unknown assailants and were rescued by local villagers. You need to find out who, why, and if possible, how to recover them."},questline:"Lost memory",quest_tasks:[new ie({task_description:"Find out what happened"}),new ie({is_hidden:!0}),new ie({task_description:"Help with the wolf rat infestation"}),new ie({task_description:"Continue your search"}),new ie({task_description:"Get into the town (tbc)"})]}),O["The Infinite Rat Saga"]=new yt({quest_name:"The Infinite Rat Saga",display_priority:0,getQuestDescription:()=>"You found more rats in the caves. You might as well try getting to the bottom of that issue.",questline:"The Infinite Rat Saga",quest_tasks:[new ie({task_description:"Go deeper"}),new ie({task_description:"Open the mysterious gate"}),new ie({task_description:"Get through the corrupted tunnel"}),new ie({task_description:"Go even deeper (tbc)"})]});O["It won't mill itself"]=new yt({quest_name:"It won't mill itself",display_priority:1,getQuestDescription:()=>O["It won't mill itself"].quest_tasks[0].is_finished?"Boys running the eastern mill could use your help":'Village elder asked you to check how the "kids" running the eastern mill are doing',quest_tasks:[new ie({task_description:"Check on the eastern mill"}),new ie({task_description:"Clear the infested storehouse"}),new ie({task_description:"Find the missing grain delivery and bring it to the mill"})],quest_rewards:{money:500,xp:250,reputation:{Village:100}}}),O["Bonemeal delivery"]=new yt({quest_name:"Bonemeal delivery",quest_description:"The farm supervisor is in a dire need of 50 packs of bonemeal, and he needs the entire order delivered in one go.",quest_tasks:[new ie({task_description:"Bring 50 packs of bonemeal"})],quest_rewards:{money:6e3,xp:5e3,reputation:{Town:40}}}),O["Light in the darkness"]=new yt({quest_name:"Light in the darkness",display_priority:1,getQuestDescription:()=>"People of the slums live in suffering and fear. Maybe you could improve their situation at least a bit?",quest_tasks:[new ie({is_hidden:!0}),new ie({task_description:"Deal with the gang"}),new ie({task_description:"[To be continued]"})]}),O["Ploughs to swords"]=new yt({quest_name:"Ploughs to swords",display_priority:1,getQuestDescription:()=>O["Ploughs to swords"].quest_tasks[1].is_finished?"Supervisor of the town's farms has a need for a capable fighter":"Supervisor of the town's farms seems to have some interesting tasks, but first requires you to be strong enough for it.",quest_tasks:[new ie({task_description:"Prove your strength"}),new ie({task_description:"Deal with the boars and then report back"}),new ie({is_hidden:!0}),new ie({task_description:"Exterminate the multiple red ants under the farm and then report back"})],quest_rewards:{money:5e3,xp:5e4,reputation:{Town:60}}});O["Swimming/climbing unlock"]=new yt({is_hidden:!0,quest_tasks:[new ie({task_condition:{all:{reach_skill:{Running:{target:12},Weightlifting:{target:12}}}}})],quest_rewards:{textlines:[{dialogue:"village elder",lines:["more training"],skip_message:!0}]}}),O["Swimming alternative unlock"]=new yt({is_hidden:!0,quest_rewards:{global_activities:["swimming"],messages:["With all the training you have done so far, the idea of submerging yourself in the river passing by the village is really tempting"]},quest_tasks:[new ie({task_condition:{all:{reach_skill:{Running:{target:15},Weightlifting:{target:15}}}}}),new ie({task_condition:{all:{enter_location:{Village:{target:1,restrictions:{season:"Winter"}}}}}})]});O["Giant Enemy Crab"]=new yt({quest_name:"Giant Enemy Crab",display_priority:9,getQuestDescription:()=>O["Giant Enemy Crab"].quest_tasks[1].is_finished?"You slew the giant crab nesting at the lake beach. With your task completed, you might as well explore the region further.":O["Giant Enemy Crab"].quest_tasks[0].is_finished?"You managed to chase the giant crab away, but if you don't finish it off soon, it'll just nest somewhere else and be a problem for somebody else later. And even if someone did find it, would they be strong enough to defeat it? Better just to take care of it yourself now":"The elder gave you his blessing to investigate the rumors of enormous crab nests somewhere down river. Or was it an enormous crab's nest? Or was it some enormous crabs' nest? Either way, he reminded you to prepare for the journey ahead",questline:"Giant Enemy Crab",quest_tasks:[new ie({task_description:"Investigate down the river"}),new ie({task_description:"Track down the giant crab"})]}),O["In Times of Need"]=new yt({quest_name:"In Times of Need",display_priority:9,getQuestDescription:()=>O["In Times of Need"].quest_tasks[O["In Times of Need"].quest_tasks.length-1].is_finished?"You helped the snakefang tribe in their time of need":O["In Times of Need"].quest_tasks[0].is_finished?`You accepted the chief's "request" to ask around and see how you could assist the tribe`:"You should introduce yourself to whomever is in charge",questline:"In Times of Need",quest_tasks:[new ie({is_hidden:!0}),new ie({task_description:"Ask around and see how you can help"}),new ie({task_description:"Bring the cook 60 pieces of fresh crab meat"}),new ie({is_hidden:!0}),new ie({task_description:"Speak to the tailor and see how you can help"}),new ie({task_description:"Bring the tailor 200 bundles of fresh flax"}),new ie({task_description:"Speak to the tanner and see how you can help"}),new ie({task_description:"Bring the tanner 60 pieces of alligator skin"}),new ie({is_hidden:!0}),new ie({task_description:"Bring the tanner 60 pieces of giant snake skin"}),new ie({task_description:"Report to the chief"})]});Object.keys(O).forEach(e=>{O[e].quest_id=e});var au=20,va,nu={Winter:-20,Spring:-5,Summer:0,Autumn:-8},su={Plus:3,Minus:-8},ou={0:0,1:-1,2:0,3:-2,4:3,5:6,6:1,7:-2,8:0,9:-5,10:-1},Dl={0:0,1:0,2:0,3:0,4:-1,5:-2,6:-2,7:-2,8:0,9:0,10:0,11:-1,12:0};function lu(e){return e.hour>=14||e.hour<5?"Plus":"Minus"}function Nn(e){return nu[e.getSeason()]+su[lu(e)]+ou[e.day_count%11]+Dl[e.day_count%13]}function Rn(){if(!x)return 0;va||(va=Nn(E));let e,t,i;if(E.hour>=14?(t={hours:5,days:1},e={hour:14},i=900,va=Nn(E)):E.hour<5?(t={hours:5,days:0},e={hour:14},i=900):E.hour>=5&&(t={hours:14,days:0},e={hour:5},i=540,va=Nn(E)),x.is_temperature_static)return x.static_temperature;let a;E.hour<e.hour?a=60*(24-e.hour+E.hour)+E.minute:a=60*(E.hour-e.hour)+E.minute;let s=a/i,n=Nn(new Tn({year:E.year,month:E.month,day:E.day+t.days,hour:t.hours,minute:0,day_count:E.day_count+t.days})),o=x.temperature_range_modifier;if(isNaN(o))throw new Error(`Temperature modifier for "${x.name}" is not a number!`);return Math.round(10*(au+(x.temperature_modifier||0)+o*(va+s*(n-va))))/10}function Fn(){return Dl[E.day_count%13]<0}var an=class{constructor({canvas:t,size:i}){this.x=Math.random()*(t.width-i-1)+i+1,this.starting_x=this.x,this.distance=Math.random()*50+1,this.opacity=Math.random()*.5+.5,this.radians=Math.random()*Math.PI*2,this.y=Math.random()*(t.height-i-1)+i+1}},Gn=class extends an{constructor({canvas:t}){let i=Math.random()*2+2;super({canvas:t,size:i}),this.size=i,this.fall_speed=10,this.context=t.getContext("2d"),this.draw=()=>{this.y>t.height+this.size?this.y=-this.size:this.y+=this.fall_speed,this.x=this.starting_x+this.distance,this.context.fillStyle=`rgba(128,128,255, ${this.opacity})`,this.context.fillRect(this.x,this.y,this.size,this.size)}}},Hn=class extends an{constructor({canvas:t}){let i=Math.random()*2+2;super({canvas:t,size:i}),this.size=i,this.fall_speed=Math.random()*1.5+.5,this.context=t.getContext("2d"),this.draw=()=>{this.y>t.height+this.size?this.y=-this.size:this.y+=this.fall_speed,this.radians+=.02,this.x=this.starting_x+this.distance*Math.sin(this.radians),this.context.fillStyle=`rgba(255,255,255,${this.opacity})`,this.context.fillRect(this.x,this.y,this.size,this.size)}}};var zn=class extends an{constructor({canvas:t}){let i=Math.random()*6+6;super({canvas:t,size:i}),this.size=i,this.context=t.getContext("2d");let a=45;this.draw=()=>{this.radians+=.01,this.tempSize=Math.max(4,this.size*Math.abs(Math.sin(this.radians))),this.tempX=this.x-this.tempSize/2,this.tempY=this.y-this.tempSize/2,this.context.save(),this.context.fillStyle=`rgba(255,255,100,${this.opacity})`,this.context.fillRect(this.tempX,this.tempY,this.tempSize,this.tempSize),this.context.translate(this.tempX+this.tempSize/2,this.tempY+this.tempSize/2),this.context.rotate(a*Math.PI/180),this.context.fillStyle=`rgba(255,255,100,${this.opacity})`,this.context.fillRect(-this.tempSize/2,-this.tempSize/2,this.tempSize,this.tempSize),this.context.restore()}}};var zs="v0.5.1.10";function Yn(){return zs}var nn={getText:(e,t)=>(ui[e]?.[t]||(e.startsWith("mofu")&&ui[e.replace("mofu_","")]?.[t]?e=e.replace("mofu_",""):e="english"),ui[e][t]?ui[e][t]:"text not found, id: "+t)},ui={english:{"elder description":"You see an older man with white hair, but with a still strong posture as if still ready to fight if need be. He eyes you with curiosity.","elder hello":"Hello?","elder hello answ":"Hello. Glad to see you got better","elder head hurts":"My head hurts.. What happened?","elder head hurts answ":"Some of our people found you unconscious in the forest, wounded and with nothing but pants and an old sword, so they brought you to our village. It would seem you were on your way to a nearby town when someone attacked you and hit you really hard in the head.","elder where":"Where am I?","elder where answ":"Some of our people found you unconscious in the forest, wounded and with nothing but pants and an old sword, so they brought you to our village. It would seem you were on your way to a nearby town when someone attacked you and hit you really hard in the head.","elder remember":"I don't remember how I got here, what happened?","elder remember answ":"Some of our people found you unconscious in the forest, wounded and with nothing but pants and an old sword, so they brought you to our village. It would seem you were on your way to a nearby town when someone attacked you and hit you really hard in the head.","elder who":"Who are you?","elder who answ":"I'm the unofficial leader of this village. If you have any questions, come to me","elder leave 1":"Great... Thank you for help, but I think I should go there then. Maybe it will help me remember more.","elder leave 1 answ":"Nearby lands are dangerous and you are still too weak to leave. Do you plan on getting ambushed again?","elder need to":"But I want to leave","elder need to answ":"You first need to recover, to get some rest and maybe also training, as you seem rather frail... Well, you know what? Killing a few wolf rats could be a good exercise. You could help us clear some field of them, how about that?","elder eq":"Is there any way I could get a weapon and proper clothes?","elder eq answ":"We don't have anything to spare, but you can check out our market. Just go over there *[points a direction]*, then turn right. It's nowhere near what you can find in a town, but people always have some gear, food, and other useful stuff to sell. If you need money, try selling some rat remains there. Fangs, tails or pelts, people will buy them all. I have no idea what they do with this stuff...","elder leave 2":"Can I leave the village?","elder leave 2 answ":"We talked about this, you are still too weak","elder money":"Are there other ways to make money?","elder money answ":"You could help us with some fieldwork. I'm afraid it won't pay too well.","elder rats":"Are wolf rats a big issue?","elder rats answ":"Oh yes, quite a big one. Not literally, no, though they are much larger than normal rats... They are a nasty vermin that's really hard to get rid of. And with their numbers they can be seriously life-threatening. Only in a group though, single wolf rat is not much of a threat","elder cleared 1":"I cleared the field, just as you asked me to","elder cleared 1 answ":"You did? That's good. How about a stronger target? Nearby cave is just full of this vermin. Try yourself against whatever occupies the frontal room, and then also the deeper parts. Before that, maybe get some sleep? Some folks prepared that shack over there for you. It's clean, it's dry, and it will give you some privacy. Oh, and before I forget, our old craftsman wanted to talk to you.","elder leave 3":"Can I leave the village?","elder leave 3 answ":"You still need to get stronger.","elder room clear":"I dealt with some rats in the cave, but is there anything else to help with?","elder room clear answ":"Ahh, good to hear you are making progress. Let me think... Could you check on the eastern mill? I'm a bit worried if the two kids running it can manage everything by themselves.","elder cave clear":"I cleared the cave. Most of it, at least","elder cave clear answ":`Then I can't call you "too weak" anymore, can I? You are free to leave whenever you want, but still, be careful. You might also want to ask the guard for some tips about the outside. She used to be an adventurer.`,"elder leave 4":"Can I leave the village?","elder leave 4 answ":"You are strong enough, you can leave and come whenever you want.","elder about guard":"So what's the story of that village guard girl?","elder about guard answ":"Mhm... She left the village as but a kid, looking to become a famous adventurer. She returned over a decade later, covered in scars and unwilling to speak of what she went through. It's a pity that she never gained the fame she dreamt of, but at least she became strong enough to keep her home safe.","elder tunnel":"I found an even deeper tunnel in the cave","elder tunnel answ":"The what? I have a very bad feeling about this... You better avoid it until you get better equipment and some solid shield, I can bet it's gonna be a lot more dangerous.","elder training":"I think I went far enough with basic training, do you have any other suggestions?","elder training answ 1":"You did? Well, let me think... You could try swimming in the river nearby if you haven't done that yet, just remember not to do it in cold weather. Or you could try some wall climbing, but be sure to start with low heights to be safe.","elder training answ 2":"You did? Well, let me think... Swimming in the river nearby would be a good exercise, but it's mostly frozen now in winter. You could try some wall climbing though, but be sure to start with low heights to be safe.","elder crab rumors":"I had overheard some villagers talking about an enormous crab nest.","elder crab rumors answ":"That seems to have become the rumor of the week. Somebody found a fisherman unconscious in the forest a few weeks ago. He's recovering even now. His wounds weren't too severe, but they must have gotten infected, because he's been in a fever ever since we found him. In his delirium, he was murmuring something about enormous crab nests. We haven't seen anything nearby, but... This isn't the first I've heard of crab infestations along the river. Every few decades, their population undergoes a great boom, only to recede the following year.","elder crab where":"The fisherman was found in the forest?","elder crab where answ":"The river that you see flowing through our village spans a great deal of the forest, and some of the fishermen swear they have better catches out in the woods where it's quieter. As I understand it, the fisherman was found by a farmhand taking one of the horses out for a ride in the woods. The farmhand didn't mention seeing any rivers nearby, so we don't know if that's where he was injured.","elder crab hunt":"I want to search for this enormous crab nest, they could be a danger to the village.","elder crab hunt answ":`The guards can handle any crabs that get near the village. And beside, you... 
*[The village elder trails off while looking you over, silently staring for a moment before speaking]*
 It's clear you are much stronger than when you were first brought to recover under my care. I will not try to convince you otherwise, I can see the determination in your eyes. You have my blessing. But know this: there are dangers in the wilderness that no training can ready you for. If your current weapon, armor, or method of attack isn't working, it's much better to run away, reassess, and recover your strength instead of unnecessarily risking your life. Please, be cautious. And consider checking with the village market to get some medicine and supplies. There's no telling how long your journey will take, or what challenges you will face on it. No matter how far you go, just remember that you always have a home in this village.`,"craftsman description":"You see an old man who clearly experienced a lot in life. He's wearing some handmade accessories. Despite his age, his fingers seem exceptionally nimble.","craftsman hello":"Hello, I heard you wanted to talk to me?","craftsman hello answ":"Ahh, good to see you traveler. I just thought of a little something that could be of help for someone like you. See, young people this days don't care about the good old art of crafting and prefer to buy everything from the store, but I have a feeling that you just might be different. Would you like a quick lesson?","craftsman learn":"Sure, I'm in no hurry.","craftsman learn answ":`Ahh, that's great. Well then... 
*[Old man spends some time explaining all the important basics of crafting and providing you with tips]*
Ahh, and before I forget, here, take these. They will be helpful for gathering necessary materials.`,"craftsman leave":"I'm not interested.","craftsman leave answ":"Ahh, I see. Maybe some other time then, when you change your mind, hmm?","craftsman remind 1":"Could you remind me how to create equipment for myself?","craftsman remind 1 answ":"Ahh, of course. Unless you are talking about something simple like basic clothing, then you will first need to create components that can then be assembled together. For weapons, you generally need a part that you use to hit an enemy and a part that you hold in your hand. For armor, you will need some actual armor and then something softer to wear underneath, which would mostly mean some clothes.","craftsman remind 2":"Could you remind me how to improve my creations?","craftsman remind 2 answ":"Ahh, that's simple, you just need more experience. This alone will be a great boon to your efforts. For equipment, you might also want to start with better components. After all, even with the most perfect assembling you can't turn a bent blade into a legendary sword.","craftsman remind 3":"Could you remind me how to get crafting materials?","craftsman remind 3 answ":"Ahh, there's multiple ways of that. You can gain them from fallen foes, you can gather them around, or you can even buy them if you have some spare coin.","craftsman remind 4":"How do I get better at crafting?","craftsman remind 4 answ":"Ahh, there aren't any secrets, you just need to keep practicing it. Just don't spend your entire life working with the same lousy materials, try to work on stronger stuff when you feel confident. There's a limit to how much you can learn by working with rat leather, isn't there?","craftsman about guard":"So what's the story of that village guard girl?","craftsman about guard answ":"Ahhh, our little warrioress... She once wanted to be an adventurer, but I believe it didn't work out for her. Hard work is not enough when talent is lacking nor can it allow one to conquer fate, I'm afraid. Still, she's a good girl and keeps us safe now.","guard description":"You see a woman in a light armor, with a spear in her hand and two daggers on her belt. There's a scar across her face.","guard hello":"Hello?","guard hello answ":"Hello. I see you are finally leaving, huh?","guard job":"Do you maybe have any jobs for me?","guard job answ":"You are somewhat combat capable now, so how about you help me and the boys on patrolling? Not much happens, but it pays better than working on fields","guard tips":"Can you give me any tips for the journey?","guard tips answ":"First and foremost, don't rush. It's fine to spend some more time here, to better prepare yourself. There's a lot of dangerous animals out there, much stronger than those annoying rats, and in worst case you might even run into some bandits. If you see something that is too dangerous to fight, try to run away. There's no shame in staying alive to fight on another day, when chances of survival become better, and it would be a pity if someone with your looks were to die~","guard teach":"Could you maybe teach me something that would be of use?","guard teach answ":`Lemme take a look... Yes, it looks like you know some basics. Do you know any proper techniques? No? I thought so. I could teach you the most standard three. They might be more tiring than fighting the "normal" way, but if used in a proper situation, they will be a lot more effective. Two can be easily presented through some sparring, so let's start with it. The third I'll just have to explain. How about that?`,"guard quick":"So about the quick stance...","guard quick answ":`It's usually called "quick steps". As you have seen, it's about being quick on your feet. While power of your attacks will suffer, it's very fast, making it perfect against more fragile enemies`,"guard heavy":"So about the heavy stance...","guard heavy answ":`It's usually called "crushing force". As you have seen, it's about putting all your strength in attacks. It will make your attacks noticeably slower, but it's a perfect solution if you face an enemy that's too tough for normal attacks`,"guard wide":"What's the third technique?","guard wide answ":`It's usually called "broad arc". Instead of focusing on a single target, you make a wide swing to hit as many as possible. It might work great against groups of weaker enemies, but it will also significantly reduce the power of your attacks and will be even more tiring than the other two stances.`,"guard hi":"Hi again, how's it going?","guard hi answ":`Hey there. I heard you've been helping around a lot, good job cutie~
 *[As she says that, she bends forward and pats your head a few times with a surprisingly gentle touch]*`,"guard tips 2":"Can you give me any training tips?","guard tips 2 answ":"It's not always best to focus on singular skill, you might learn more if you come back to training after getting more experienced in other aspects and finding new insights. There are also some unconventional training styles that I heard of, like fighting with no weapons or with no armor whatsoever, but I wouldn't recommend it to you, cutie. It's enough that one of us is covered in ugly scars.","guard scars":"I don't think your scar is ugly","guard scars answ":"*[She doesn't answer you, just looks away. You can see in her facial expression that she appreciates your words, but doesn't really believe them]*","guard serious":"Can we try a more serious fight?","guard serious answ":"Ohhh, someone wants to impress the cute guard lady? Sorry, but I'm way too strong for you~","guard pats":"[Ask for more headpats]","guard pats answ":"[She smiles and pats your head a few more times]","guard try":"[Try to pat her head]","guard try answ":"[Nuh uh. She pats your head instead~~~]","guard teach more":"Can you teach me something more?","guard teach more answ":"I'm sorry, but no, that will have to be enough. Trust me, I'm generally a terrible teacher, I know that from experience. It will be better for you to not get any bad habits because of me.","millers description":"You see two teenagers with mischievous looks on their faces. It's only with great deal of effort that you manage to recognize them both as males. One of them has red hair, the other gray.","millers hello":"Hello there","millers hello answ":`[Red] Hi~! 
 [Gray]: Hello`,"millers how":"Are you doing alright? Elder asked me to check on you.","millers how answ":`[Gray] We are fine, mostly. 
 [Red] Except for rats in the storehouse, especially since we are about to have grain delivery. 
 [Gray] The big rats, like on the fields... 
 [Red] So if you could help us with them, it would be great!`,"millers young":"Aren't you two a bit too young to have a job?","millers young answ":`Nope, we are both adults, even if barely, but we will take that as a compliment~ 
 *[They both smirk as they say that, apparently happy with their looks]*`,"millers sure":"Sure, I can deal with them.","millers sure answ":`[Red] Ehehe, thank you~ 
 [Gray] We will get you some reward for it later. 
 [Red] A bit of money, and maybe a kiss or two~`,"millers cleared":"I cleared out your storehouse","millers cleared answ":`[Red] Nice job! 
[Gray] Now where is that grain? 
 [Red] Oh right, it was supposed to be delivered by now. 
[Gray] Could you search the village for a cart loaded with bags of grain that's 'supposed' to be heading our way?`,"millers delivered":"Your delivery has arrived.","millers delivered answ":`[Red] Thanks 
[Gray] Thank you! 
[Red] And here's your reward.`,"millers kiss":"So about that kiss you promised...","millers kiss answ":"[Red] Yes? Which one of us do you want it from?","millers kiss mouse":"How about... your gray-haired friend?","millers kiss mouse answ":"*[Gray-haired teen slowly approaches you from the side and gives you a gentle smooch on your cheek, then steps back with a slightly shy smile]*","millers kiss cat":"How about... you?","millers kiss cat answ":"*[Red-haired teen slowly approaches you from the side and gives a gentle smooch on your cheek, then steps back with a smirk]*","millers kiss both":"How about... both of you?","millers kiss both answ":"*[The two slowly approach you from both sides and you receive two simultanous gentle smooches, one of each of your cheek, after which they take a step back]*","millers reject nice":"I appreciate the offer, but I'm not interested in that kind of thing","millers reject nice answ":"[Red] Oh well, that's a pity~","millers reject mean":"Ewww, no, I want you to forget about that whole idea","millers reject mean answ":"[Red] Whatever you say~","millers kiss more":"Can I get one more kiss?","millers kiss more answ":`[Red] Hmmm... should we? 
[Gray] Maybe some other time. 
[Red] You heard him~`,"millers how2":"So, how's it going?","millers how2 answ":`[Red] Kinda boring, but at least company is good. 
[Gray] What he said.`,"millers about guard":"Do you know anything about that girl who guards the village?","millers about guard answ":`[Red] Nope, nothing. She just happens to have same name and looks, as far as oral descriptions go, as one the continent's top ten adventurers who retired just before she returned. 
[Gray] Obviously it's a total coincidence, right? *[The two exchange amused looks]* 
[Red] Jokes aside, no one here besides us managed to make that connection, that's just sooo stupid~ 
[Gray] When they hear how there was a powerful adventurer who happens to match her perfectly, they all just assume that it's a pure coincidence and a completely different person. 
[Red] She doesn't seem to care much about it, probably prefers peace and quiet. Let her have them, I'm sure she went through a lot, and with her here we can feel safer than ever.`,"g guard description":"You see a massive man in a steel chainmail, with a spear in his hand and a sword on his belt.","g guard hello":"Hello, can I get in?","g guard hello answ":"The town is currently closed to everyone who isn't a citizen or a merchant guild's member. No exceptions.","sus description 1":"You see a young man in shabby clothes and with messy hair, who keeps looking around. He appears to have some nervous ticks, or maybe he's just really stressed. He notices you and stares.","sus description 2":"You see a young man in shabby clothes and with messy hair, who keeps calmly looking around. The moment he notices you, he appears to get calmer.","sus hello":"Hello? Why are you looking at me like that?","sus hello answ":"Y-you! You should be dead! *the man pulls out a dagger*","sus defeated":"What was that about?","sus defeated answ":"I... We... It was my group that robbed you. I thought you came back from your grave for revenge... Please, I don't know anything. If you want answers, ask my ex-boss. He's somewhere in the town.","sus behave":"Are you behaving yourself?","sus behave answ":"Y-yes, boss! Please don't beat me again!","sus boss":"Stop calling me 'boss'","sus boss answ":"Yes, boss! Sorry, boss!","sus situation":"By the way, how are things in this slum?","sus situation answ":"A-as you can see and hear boss, it's pretty b-bad, but it can't be helped without taking out the g-gang...","sus gang":"What gang?","sus gang answ":"It's j-just a gang, they don't have any name, boss. Their hideout is over t-there, you should stay away from it. Almost every k-killer and thug around t-the slum is a part of their group...","sus gang defeated":"That gang you mentioned? I dealt with them.","sus gang defeated answ":`I know boss, we all heard the commotion! You're the best! I think the local trader already pulled out some gear he was hiding from them, you should check it out! 
*[Pauses for a moment]* I wish I had shown you my defensive tricks before that, it might have made your job easier...`,"sus behave 2":"Are you behaving yourself?","sus behave 2 answ":"Y-yes, I didn't do anything bad since the last time, boss!","sus behave 3":"Are you behaving yourself?","sus behave 3 answ":"Of course boss!","sus tricks":"You said something about defensive tricks? Show me","sus tricks answ":"Sure, boss! So, it's really about focusing on your legs to either jump away faster or to better brace the shield, and... *[He continues explaining for a while]*","sus headpat":"[Pat his head]","sus headpat answ":"[He smiles like a little puppy]","old description 1":"With some safety returned to the area, more folk are now out on the streets. One of them, an elderly lady, is looking at you.","old description 2":"You see a gentle elderly lady with warm look in her eyes","old hello":"[Let her approach you.]","old hello answ":"Hello young warrior. I understand it is you who we have to thank for freeing us from those thugs. Few these days have the gumption, and even fewer the strength to take them on. Well done! Such heroism deserves a reward, and while none of us have much to offer as you can see, but the least I can do is make sure our hero doesn't go hungry. Would you care to join me for dinner?","old dinner":"[Accept the offer.]","old dinner answ":"[You join the woman in her shack for a humble, yet satisfying meal. While the main ingredients are simple, they are well flavoured and garnished with herbs.]","old ingredients":"[Compliment the food and ask where she gets ingredients.]","old ingredients answ":"Surprised? Live here long enough, and you learn how to get by without a lot of pricey things. No, I'm not talking about stealing - I may be poor, but I still have my pride! No, I'm talking about the plants that grow all around. Most people pass them by, without realizing how useful they can be. Ha! Maybe there IS another way I can reward you! I can teach you what to look for, if you're interested.","sup hello":"Hello","sup hello answ":"Hello stranger","sup work":"Do you have any work with decent pay?","sup work answ":"We sure could use more hands. Feel free to help my boys on the fields whenever you have time!","sup anything":"Is there anything I can help you with?","sup anything answ":"I don't think so, nothing aside from normal work... Actually there is one thing. We're in a dire need of 50 packs of bonemeal and lost our supplier on top of that, so I'm willing to pay you a triple price. Bad news is, you will have to bring all 50 in a single delivery.","sup bonemeal":"More bonemeal, you say?","sup bonemeal answ":"Absolutely! I know the lower price might not be the most appealing, but at least it's stable, unlike the market, and at times might be a lot better than what any trader would pay you for it.","sup animals":"Do you sell anything?","sup animals answ":"Sorry, I'm not allowed to. However if you were to help us produce something, I could let you take part of it. It just so happens our sheep need shearing, if you're interested in some free wool.","sup fight0":"Do you have any task that requires some good old violence?","sup fight0 answ":"I kinda do, but you don't seem strong enough for that. I'm sorry.","sup fight":"Do you have any task that requires some good old violence?","sup fight answ":"Actually yes. There's that annoying group of boars that keep destroying our fields. They don't do enough damage to cause any serious problems, but I would certainly be calmer if someone took care of them. Go to the forest and search for a clearing in north, that's where they usually roam when they aren't busy eating our crops. I will of course pay you for that. 4 silver coins is most I can offer, I'm running on a strict budget here.","sup things":"How are things around here?","sup things answ":"Nothing to complain about. Trouble is rare, pay is good, and the soil is as fertile as my wife!","sup defeated boars":"I took care of those boars","sup defeated boars answ":"Really? That's great! Here, this is for you.","sup troubled":"You look troubled","sup troubled answ":"Troubled? I'm fuming, I'm going insane here! Those damn accursed ants, they keep destroying crops by eating their roots over and over again! If I could, I would drop everything, grab a sword and a shovel and go find their damn nests, and then slaughter every last one of them! Not just soldiers and workers, but queens and larvae too! Destroy their nests for me and you will have my gratitude, I will even pay you out of my own pocket!... Oh, and you can borrow a shovel from the farm if you don't have your own.","sup eliminated":"The ants are gone, though there are some trails leading to the forest","sup eliminated answ":"That's just... thank you, thank you so much! Here, take this, you earned it! As for the forest, I don't really care, as long as they don't come back.","sup deliver":"[Deliver the bonemeal]","sup deliver answ":"Thank you very much, here's your money! If you ever want to make more deliveries of this size, we will gladly take them, although it will have to be for the regular price","sup deliver not":"I'm sorry, but that's not enough","sup deliver 2":"[Deliver the bonemeal]","sup deliver 2 answ":"Thank you very much, here's your money! We will gladly take more, whenever you have it!","sup deliver 2 not":"I'm sorry, but that's not enough","sup description":"You see a well dressed man with a notebook on his belt and a hat on his head. Despite seeming more like a scribe, he's buff and tanned.","swampchief description 1":"Looking around the encampment, you see a large hut framed by banners and lit torches. You approach the hut, calling out in greeting, but getting no response. As you step closer, you see a large man in thick scaly armor wielding a great trident emerge. He points the trident at you as he takes a firm stance.","swampchief description 2":"The chief stands outside his hut, watching you as you move about the encampment with an inscrutable gaze.","swampchief description 3":"The chief stands outside his hut. He nods at you as your eyes meet.","swampchief meet":"Hel-","swampchief meet answ":"Intruder! How bold of you to walk so brashly through our grounds! Bold and foolish! To so bluntly insult the honor of the chief of the Snake Fang Tribe! Raise your blade! There is no sport in killing an unarmed foe!","swampchief explain":"Wait! I'm not your enemy! I was passing through the swamp and saw the fortifications!","swampchief explain answ":`*[The chief holds for a moment, before relaxing his stance and raising his trident away]*

A fool in shoddy garb. You aren't even worth bloodying my spear for. Begone from my sight. We have nothing to offer you, no quarter to give, and no supply to barter. Leave us, and do not return.`,"swampchief help":"Perhaps you don't have anything to offer, but maybe I can offer to help your people?","swampchief help answ":"And for what would we need the help of a stranger from the beyond the bog? Feh! If you wish to pay fealty to our strength, we'll take your tribute. Now begone from my sight.","swampchief mid help":"I'm going to ask around and see how I can-","swampchief mid help answ":"I did not ask, stranger. Be gone from my sight before I change my mind.","swampchief report":"I've been helping out around the tribe.","swampchief report answ":"Yes. I've been watching you run about. I have heard nothing but high praises of your efforts, even from my more cantankerous charges.","swampchief confirm":"Times are hard, and this land is dangerous. I've just been trying to give what help I can.","swampchief confirm answ":`Ever the fool, you are.

*[The chief smiles at you]*

But fools seem to be in high supply right now, and rarely have I seen one as capable as you. I should know. I'm reminded every time I... 

*[The chief breaks his gaze, before taking a ring off and presenting it to you]*

You have given tribute to the Snake Fang Tribe, graciously and beyond all reason. I would be the greatest of fools to disrespect that. Please, accept this as token of my heartfelt gratitude, and with it, my friendship.`,"swampchief accept":"You honor me with your gift.","swampchief accept answ":"Perhaps if we had allies such as you... I would be humbled if you would become one of our den kin -- that is, consider yourself among my charges. I will send word that our artisans are to share their workhuts with you, if you wish to avail yourself to them. You are welcome to rest in our longhouse. I would only ask that you be mindful of the young woman resting within.","swampchief generic":"How are things among the tribe?","swampchief generic answ":"Challenging, honored friend, in these harsh and dangerous times. But maybe we can make it through if we all band together.","swampcook description 1":"As you get closer to the cook's workhut, you're met with a distinctive tune bellowed loudly and an acrid smell emanating from inside. Bracing your nose, you approach to find a short fellow nearly obscured by hanging meats, moving between a rack larger than he is housing thin cuts suspended between grated slats and a large cauldron build into a workbench covered in large slabs of rough leather in various stages of processing. You're surprised to find that he was the source of the singing. Noticing your approach, he stops his song and turns to address you with a smile on his face.","swampcook description 2":"You approach the cooks's workhut, finding him standing outside next to a small smokehouse in between splitting logs. As before, you can both smell the leather the cook is processing and hear the song that he is singing long before you see him.","swampcook description 3":"As you approach the workhut, you absentmindedly sing along to the cook's song. He notices your singing before turning to you and giving a big nod with a toothy grin before resuming his work.","swampcook greeting1":"Hello. I'm trying to find ways to... pay tribute?","swampcook greeting1 answ":"A-ha~! Tribute! Ha-ha~! Very funny, obaru! There is no need to pay tribute to a snake's fangs!","swampcook greeting2":"Not tribute, then. I'm just looking for ways to help out around here.","swampcook greeting2 answ":"Ahh, help? A-ha~! Snake's fangs are slow to sharpen! But if obaru wants to help, then I will be happy to judge! Now what would I ask of you...! Oh, a-ha~! Yes! Rock meat!","swampcook help":"Rock meat...? Are you sure you need meat? It looks like you have plenty already.","swampcook help answ":"Sosso! Obaru has eyes but no ears! I need different meat! You have seen those large walking rocks near the falling water, yes? Crack those rocks and bring me the meat from inside! A-ha~! If I am right, I will need no less than three score rock meat! Bring them to me! And I shall help you to sharpen the snake's fangs!","swampcook deliver":"I've got 60 of those, um, 'rock meats' you wanted.","swampcook deliver answ":"A-ha~! Good job! If kazoku could do this, maybe kazoku can sharpen the snake's fangs! But first, you must know the snake! Only then can you sharpen it's fangs!","swampcook deliver not":"A-ha~! Sosso obaru! I think you may want to check again!","swampcook know":"Know the snake? Sharpen it's fangs? Are you saying that if I am to help out, I need to know more about who I'm helping?","swampcook know answ":"Ha-ha~! There are two who could stand to be sharpened! But before kazoku can know of a part, we must talk of the whole! Come, grab a piece of meat! We shall work while we talk! You may even learn something!","swampcook yeslore":"What can you tell me about, uh, the `whole of the snake?`","swampcook yeslore answ":"Ah~! It's heart! It's soul! It's head! It's body! What would you like to know?!","swampcook history":"Tell me about the... heart of the snake?","swampcook history answ":"Haa~! Heart of the snake lies in it's first head! A strong man! Fierce man! It is said he wore the head of snakes on his fist! It is why we are the snake's fangs!","swampcook history1":"Okay... so what?","swampcook history1 answ":"Ahh~! That heart! That drove the next head! And the next! More strong! More fierce! Snake must be bigger! Must be stronger!","swampcook history2":"So what happened?","swampcook history2 answ":"The snake grew big, as did it's fangs! But! The prey didn't! The prey grew smaller, until all that was left was snakes! And now!? The zalgo bite at our soul.","swampcook history3":"I still don't understand what you're trying to say.","swampcook history3 answ":"Ah~?! Tribe grew too big! Swamp too dangerous now! Now tribe grows small! And danger only stronger!","swampcook historyend":"I've learned all I think I'm going to about the history of the Snake Fang tribe.","swampcook historyend answ":"A-ha~! Lesson to be learned! What else would you like to know?!","swampcook surround":"Tell me about... the soul of the snake?","swampcook surround answ":"Ahh~! The lands! They are the soul! But it used to be larger! The mountain! The plains! The woods! The bay! All used to be with the snake's soul!","swampcook surround1":"Oh, I actually came from the mountains.","swampcook surround1 answ":"Ha-ha~! Then you know already! Northwest, where the walking rocks and falling water are!","swampcook surround2":"There are plains around here?","swampcook surround2 answ":"Ahh~! Yes! Southeast! The snake would hunt! But the snake split! And now no snakes go to the plains!","swampcook surround3":"You're going to have to be a ~lot~ more specific about what woods you're referring to.","swampcook surround3 answ":"Ha~! You are right! South of the falling water! The wet woods! That was where we gathered! But now?! It is just home of the walking rocks!","swampcook surround4":"What do you mean, `the bay`?","swampcook surround4 answ":"A-ha~! Far to the north! Many spice and meat and metal and leather come from there! From very far away! It good place to go! To leave!","swampcook surroundend":"I've learned enough about the ares surrounding the swamplands.","swampcook surroundend answ":"A-ha~! Maybe you will see those lands some day!","swampcook chief":"What can you tell me about the head of the snake?","swampcook chief answ":"A-ha~! Very strong! Very agressive! Quick to bite!","swampcook chief1":"Are you ~just~ telling me about snakes?","swampcook chief1 answ":"Ha~! Silly kazoku! No! Snake's head used to be calmer! But now a new head!","swampcook chief2":"A... new head? What happened to the `old` head, then?","swampcook chief2 answ":"Ha-ha~! The same thing that happens to every head! But the snake laid no eggs! The kin becomes the head!","swampcook chief3":"So the old, less aggressive chief died? And because they had no children, a sibiling became the new chief?","swampcook chief3 answ":"Haa~! Kazoku has ears! Yes! And old problems are new again! But the head of the snake just bites back!","swampcook chiefend":"Okay. I've learned all I think I can understand about the tribe's chief","swampcook chiefend answ":"Ha~! A dramatic tragedy! But that is life!","swampcook people":"What can you tell me about the body of the snake...?","swampcook people answ":"A-ha~! That is me! You! All of us! Maybe you have already seen our bartermaster?! Or would you rather just learn of the unsharpened fange?!","swampcook cook":"Tell me about yourself.","swampcook cook answ":"A-ha~! I am an open book! But you've already helped me! It would be better to learn of someone else!","swampcook cook2":"Can you at least tell me where you get your meat from?","swampcook cook2 answ":`We kill zalgo! Turtle when we can! Alligator when we must! We do not seek snake! We kill that zalgo that comes! They always do...!

*[The cook abruptly stops talking, then clears his throat and hums questioningly at you]*`,"swampcook trader":"What can you tell me about the... bartermaster?","swampcook trader answ":"Ahh, she runs the stall near the front of the camp! I give her many meat to barter with! And in return she gives me the local wild to use!","swampcook trader1":"Most people would just call that a merchant or trader, especially if they're just selling what they were given.","swampcook trader1 answ":"Ah~, no! Her son gets the wild! Her son didn't have an eye for it! But anyone can learn! He gives some to me! They sell the rest!","swampcook trader2":"But why, though? It seems to me that you're getting a bad deal. What do you get for giving her so much free meat?","swampcook trader2 answ":"Ha~! Because we are kazoku! And oh-! When she finds something special! For my eyes first, she says!","swampcook trader3":"What? How often does the trader find anything special?","swampcook trader3 answ":"Sometimes! Ha~!","swampcook traderend":"Thanks... I guess I've learned enough about the trader.","swampcook traderend answ":"A-ha~! What else can I tell you of?!","swampcook fangs":"Who are the unsharpened fangs you keep referring to?","swampcook fangs answ":"Ahh, one would be the leatherworker next door! But first! Across the hutfield is our clothier! He is the first one you should sharpen! The old woman is more likely to break than sharpen, a-ha~!","swampcook tailor":"What do I need to know about the clothier?","swampcook tailor answ":"Ha~! Very stressed man! He makes the cloth!","swampcook tailor1":"Okay, so you just mean a tailor.","swampcook tailor1 answ":"Ahh, making cloth is very hard! And he is more than that! He mends, too!","swampcook tailor2":"I... see. Is there anything more you think I should know, for some reason?","swampcook tailor2 answ":"He has been many things! Very skilled man! He scouted for years! Then used what he learned to make the cloth! But now?! Too much to do! Not enough hands anymore! Not since he taught his family to leave!","swampcook tailorend":"I think that's helpful? Maybe? I probably know enough about the tailor, at any rate.","swampcook tailorend answ":"Ahh?! Maybe I am not telling right?!","swampcook tanner":"You had said there's things I should know about the leatherworker?","swampcook tanner answ":"Ah~! Old woman works skin to leather!","swampcook tanner1":"I would have just called her a tanner, but okay. What about her?","swampcook tanner1 answ":"She is hurt! Worn! Breaking! Inside and out! Heart and hands! Age has been cruel! In many ways!","swampcook tanner2":"That's rough, buddy. Is that why you help process leather for her?","swampcook tanner2 answ":"Ha~! Yes! Every piece of bad leather makes her feel bad! I can help! But only so much!","swampcook tannerend":"Alright. I think I might have an idea of how I can help the tanner.","swampcook tannerend answ":"A-ha~! Good kazoku! But remember! Help the clothier first!","swampcook peopleend":"I think I've learned all I need to about the people of the Snake Fang tribe.","swampcook peopleend answ":"Ha~! If you are sure! Then I shall tell you no more! Go across the hutfield! Speak to the clothier! Tell him `tumana`! He should listen then! I will talk to the leatherworker! For you!","swampcook whycrab":"There's just one thing I don't understand, though. How does crab-erm, rock meat help you? There's plenty of cured meats around already.","swampcook whycrab answ":"A-ha~! A man must have some secrets! A-ha-ha~!","swampcook whycrabpress":"Oh, knock it off with the fake laughter! Be honest with me, for once! Tell me what's going on!","swampcook whycrabpress answ":`*[The cook stops smiling and lowers his voice]*

I do not lie. Not with laughter. Not with help. I choose to be here. Now. Living. Helping. If I run away, I am not living. If I am not laughing, I am not living. If I am not helping, I am not living. And if I die here? Die helping? Die laughing? Then I die living. So now you be honest? Not to me. To you. What do you live for? What do you laugh for? What will you die for? I wonder. Will you run away? Or will you smile?`,"swampcook whycrabdrop":"Fine. I doubt I'd understand what you were saying anyway.","swampcook whycrabdrop answ":"A-ha~?!","swampcook nolore":"I really don't think I want to know about whatever it is you're talking about. Can you please just tell me who I can help next?","swampcook nolore answ":"Sosso! Sad kazoku! But okay! The first is the clothier across the hutfield! Tell them `tumana`! After helping, go to the leatherworker in the hut next door!","swampcook liked":"How are things going for you?","swampcook liked answ":"Menaka kazoku! I am good! For you sharpen the snake's fangs! That is all I need!","swampcook noloreteach":"Do you think you could teach me how to make the cured meats I've seen hanging around the workhut?","swampcook noloreteach answ":`A-ha~! Happily, kazoku! Grab a piece! And do as I do!

*[The cook's odd phrases, loud voice, bizarre cadence, and constant singing make it hard to understand what he's saying, but by following along with his actions, you pick up on how to make jerkies from the meats of the swampland cratures.]*`,"swampcook obaru":"Uh... obaru? What is obaru?","swampcook obaru answ":"Ha~! You are obaru! Silly obaru!","swampcook kazoku":"Okay, what is kazoku?","swampcook kazoku answ":"A-ha~! We are kazoku! Silly kazoku!","swampcook sosso":"Are you just going to keep saying words at me I don't understand? What does sosso mean?","swampcook sosso answ":"Ha~! Okay! In your tongue, sosso means...! Fool?! Yes! Fool! You are being the fool!","swampcook zalgo":"Are the `zalgo` usually a threat?","swampcook zalgo answ":"Ahh~, yes! That is what zalgo means! A threat! We must always be ready! But it's harder now! Not that it was ever easy! Ha-ha~!","swampcook menaka":"Should I even bother trying to ask what menaka means?","swampcook menaka answ":"A-ha-ha~! Is good thing!","swampcook tumana":"And just what, pray tell, is tumana?","swampcook tumana answ":"Tumana! Yes! Tell it to the clothier!","swamptailor description 1":"Approaching the tailor's workhut, you glance inside to see an fidgety man quickly moving between multple tasks. He seems to be talking to somebody in hushed tones, but as you get closer, you realize there's nobody else around.","swamptailor description 2":"As you approach the tailor's workhut, you see he's already putting down whatever task he was working on and moving outside to meet with you.","swamptailor description 3":"You approach the tailor's workhut, knocking loudly at the door to get his attention over his relentless fretting about the place.","swamptailor interrupt":"*[knock on the workhut door]*","swamptailor interrupt answ":`-and how am I- 

*[Upon realising you're there, the tailor drops what they were doing and dives behind a nearby table, knocking it's contents to the floor. They slowly scramble to their feet while reaching futilely for some sort of weapon]*

What? Who are you! Why are you here! How did you get here!`,"swamptailor listen1":"*[Wait for the tailor to notice you]*","swamptailor listen1 answ":`-boil the linen, he says, as if that'll- 

*[The tailor puts down some sewing tools and moves to futz with a bubbling pot near the fireplace]*`,"swamptailor listen2":"*[Wait for the tailor to notice you]*","swamptailor listen2 answ":"-if she think's it's so easy why doesn't she-","swamptailor listen3":"*[Wait for the tailor to notice you]*","swamptailor listen3 answ":`-I'm a tailor, not a doctor, for-

*[The tailor moves away from the pot and to a table where they begin stripping old cloth]*`,"swamptailor listen4":"*[Wait for the tailor to notice you]*","swamptailor listen4 answ":"-not my fault that they-","swamptailor listen5":"*[Wait for the tailor to notice you]*","swamptailor listen5 answ":`-if they had better-

*[The tailor stops mid-cut to paw through a bundle of plants before turning back around to the pot near the fireplace]*`,"swamptailor listen6":"*[Wait for the tailor to notice you]*","swamptailor listen6 answ":"-think I can just fix-","swamptailor listen7":"*[Wait for the tailor to notice you]*","swamptailor listen7 answ":`-the others made sure she got-

*[The tailor turns away from the pot, grabbing some loose nearly strips of cloth and a needle and thread begins trying to stitch them together]*`,"swamptailor listen8":"*[Wait for the tailor to notice you]*","swamptailor listen8 answ":"-need some fresh cloth, or else-","swamptailor cookword":"Sorry! The cook sent me! He told me to tell you `tumana`!","swamptailor cookword answ":`Well did he also tell you to scare me half to death!? 

*[The tailor stops flailing and warily steps out from behind the knocked over table]*

A strange ken, dressed strange, smells strange. Just who even are you!? Are you a ken of the cook's?`,"swamptailor help":"His... ken? Not at all. Honestly, it was hard to even understand anything he was telling me half the time, but he said that you'd listen to me if I said that.","swamptailor help answ":"*[The tailor exhales a deep sigh]*\n\nOh course he had to do it like this... I have no reason to trust you, but `tumana` means fertile grounds in his tongue, and even if you knew that, there's no reason you'd say that to me. So if I had to guess, I'd think he was trying use that to tell me in his own way that not only has he vetted you and found you at least passingly capable, but that you're going to be the one getting flax for me. Two hundred bundles should be enough to get started on the bare minimum of what I need. Now go on, off with you now, shoo, time is bleeding out.","swamptailor flax":"Wait a second! What is flax, and why am I getting it for you?","swamptailor flax answ":`*[The tailor exhales another deep sigh]*

You break my concentration, put me in a panic, make a mess of my workspace, and now you're saying you don't even know one of the most valuable naturally-growing plants on the upper side of the great river basin? Of course. Why would I expect ~competent~ help. Especially from an outsider like you. Look- 

*[The tailor bends down and picks up a long thin plant with blue flowers]*

-THIS is flax. Go up in the mountains, find more, and bring it to me. Two hundred bundles. Thank you goodbye.`,"swamptailor deliver":"I've managed to collect all 200 bundles of flax plants that you wanted.","swamptailor deliver answ":`You did? I... I'm sorry, it was unkind of me, the way I spoke to you before. Please understand, these plants are going to be used to make fresh bandages, and without them... I'm not sure I would have been able to do much of anything trying to reuse fraying rags. I can only hope you were quick enough. I know it's untoward of me to even consider asking this of you after you've already done the hardest part, but could you spare some additional time and help me begin to process these into usable linen cloth? Even if you don't know what do to, which I'm fairly certain you don't, an extra pair of hands makes all the difference in the world, and you might be able to make linen yourself afterwards too. 

*[The tailor teaches you how to process flax into linen cloth]*`,"swamptailor deliver not":"You did? Where are they, then? Please, I ~need~ those plants. Every hour counts.","swamptailor liked":"Is there anything I can do to help you out today?","swamptailor liked answ":"No, friend, although I appreciate your patience and your concern. As full as my hands are, as full as they always are, I know your time and skills are better spent elsewhere.","swamptanner description 1":"You approach the tanner's workhut to find the old woman with a scowl on her face standing next to a rack stretching drying leather. Her hands are visibly shaking, an apparent sign of wear and old age, as she goes about her work.","swamptanner description 2":"You approach the tanner's workhut, finding her with meticulously fleshing the alligator skins you brought her earlier. In spite of her clear and deliberate effort, her unsteady hands make deep gouges in the hide like that of an amateur first learning how to clean the skin.","swamptanner description 3":"You approach the tanner's workhut. The old woman is sitting down, rubbing her knuckles with a grimace on her face. Piles of partially-processed skins litter the hut, rotting untreated in the heat. As she looks up at you, her expression softens, as if trying to hide her pain.","swamptanner unknown":"Excuse me, are you the leatherworker? I was told that I should come see you.","swamptanner unknown answ":"Yes. That would be me. And I know of you -- but I do not know you, nor do I want your help. I need not the blood of the young on my conscience.","swamptanner help":"I'm sure I can handle whatever tasks you need of me.","swamptanner help answ":"Were the young always so eager to die? Fine. If you shan't be wary, then be the fool. Skin five dozen alligators, or feed the bog trying.","swamptanner deliver 1":"I've got the 60 alligator skins you requested.","swamptanner deliver 1 answ":`You did!? Ah... 

*[The old woman stands up, and with shaky yet strong hands, takes the alligator skins from you, staring at you as she does]*

My eyes are not as good as they used to be. But now that I see you... You have a strength within. A courageous spirit burning bright; a warrior's heart beating strong. She does too.`,"swamptanner deliver 1 not":"My eyes may not be as good as they used to be, but I can still count. This is not five dozen, child.","swamptanner known":"Who is `she`?","swamptanner known answ":"The person I needed these skins for. She needs new armor if she's going to survive out there, next time. I will be honest, child: if I am to make her new armor, I am in need of more; these hides can protect, but not alone. I will need the skins of five dozen snakes as well. But I cannot ask you to go and risk your life again for them. I have seen too many children already...","swamptanner deliver 2":"You don't need to worry any longer. I have the 60 snake skins you need.","swamptanner deliver 2 answ":`Child... You truly have a mighty soul.

*[The old woman stands up, and with ever shaky hands, takes the giant snake skins from you, staring at you as she does]*

My eyes are not as good as they used to be. But now that I see your armor... I know not how you survived such brutal attacks. Come. I will teach you how to process the skins you've brought. Surely they will be stronger than whatever it is you're wearing. I may even have some old turtle shells you could practice with. Their shells are very tough, but difficult to... 

*[The old woman teaches you what you need to know in order to process alligator and giant snake skins, as well as turtle shells]*`,"swamptanner deliver 2 not":"Child... It is okay, you need not lie nor risk your life. You have done enough already. We will manage. We always have.","swamptanner liked":"Just checking in. Is there anything more I can do to help you?","swamptanner liked answ":"Ahh, you are a good child, and a strong warrior. Warriors such as you need not concern yourself with the worries of an old woman.","swampscout description 1":"You see a young woman lying in a cot near the door. Her chest is covered in worn bandages stained with old blood, her arms covered in cuts and abrasions, and her lower half obscured by a blanket. The smell of rot gets stronger as you approach her.","swampscout description 2":"You see the scout lying in a cot near the door. Her chest is covered in worn bandages stained with fresh blood, her arms covered in cuts and abrasions, and her lower half obscured by a blanket. The smell of rot gets stronger as you approach her.","swampscout description 3":"You see the scout lying in a cot near the door. Her chest is covered in fresh bandages stained with fresh blood, her arms covered in bruises and scars, and her lower half partially obscured by a blanket, revealing empty space where her right leg used to be.","swampscout description 4":"You see the scout lightly sleeping in a cot near the door. Better to just let her rest.","swampscout meet":"Hello? Sorry to bother you, I just wanted to introduce myself.","swampscout meet answ":`*[The young woman listlessly turns her head and smiles meekly at you]*

I've heard of you already. Our leader said we may have a new den kin joining our ranks. It's been a while since... I last saw it happen. I was just a kid then. And now look... at him, trying to help everyone even now...`,"swampscout lore1":"Are you alright?","swampscout lore1 answ":"Forgive me if my speech is unclear or absurd. I've been in a state of limbo since... I don't even know how long ago it was. It feels like yesterday. But it also feels... like it was years ago. Like I've been living in this cot forever...","swampscout lore2":"What happened?","swampscout lore2 answ":`Oh. I figured you must had heard... 

*[The young woman listlessly turns her head away and stares off into the distance]*

It had been a rough few years: the amount of good... huntable meat in the swamps was dwindling. Natural herbs and vegetables were growing more scarce... every year. And the snakes were... creeping into the camp more often. We had posted guards, but they were so fast and quiet, we... often wouldn't notice they were gone until the sun rose.`,"swampscout lore3":"*[Let her continue]*","swampscout lore3 answ":"Our current chief, the brother... to our last chieftan's bondmate and at the former... huntmaster, decided that the best option was to sent hunting parties out into the... swamp, to find the snake's den, so that we could stop their... attacks in the middle of the night. The snake attacks had been... intensifying under his time as huntmaster, and he considered it his destiny to... drive them from the swamp.","swampscout lore4":"*[Let her continue]*","swampscout lore4 answ":"Weeks went by, with our supplies... dwindling with them. Groups that should've been gathering or... scouting new hunting spots were searching for snake dens that didn't exist, and deaths... became an almost daily occurance from unskilled scouts pushed to explore past their bounds. No snakes that big could hide... their nest in a bog this small anyway. We tried to tell him, but no, we dare not... challenge the chief's honor by questioning his rule. It didn't take long before some people started talking about... leaving for the great plains southeast of here.","swampscout lore5":"*[Let her continue]*","swampscout lore5 answ":"The chief was angry. He... banished the lot of them, saying they'd be better off... as bog feed than weakening the tribe. And so we were split. Many artisans, scouts, and... warriors went that night. My brother went with them, as did our... doctor, our blacksmith, and the tailor's sister. Even though I'm just... a scout, I had wanted to be a warrior. I was fully loyal to... our chief's vision, at the time. I thought might made right, that force made security. I wonder... if they survived, if they made something new down there... I wonder what life I could have lived...","swampscout lore6":"*[Let her continue]*","swampscout lore6 answ":"Well, with so much of our... people gone, there were less eyes to watch the gate, less hand to hold the... spears, less ears to the ground. It became necessary to... scale everything down, pull the walls in, and turtle up. Everyone had double- and triple-duty. And yet the hunt... for the snakes continued. A hunt across the bog with naught but ghosts to watch over us... ...as the snakes bore down on us...","swampscout lore7":"I'm sorry all that happened.","swampscout lore7 answ":"I thought myself strong. I thought that... to live meant to be strong. To stand up to... death. But now... Everything that lives is destined to end. To live in pain, in... a neverending spiral of life and death...","swampscout lore8":"Wow...","swampscout lore8 answ":`*[The scout listlessly turns her head towards you]*

I'm sorry. I just met you and I'm rambling about... this of all things. We can talk about something... else. I've spent a lot of time in the... swamps, there's some interesting things... growing out there.`,"swampscout generic":"Is there anything I can do for you?","swampscout generic answ":"No... No, time is the only help for me at this... point. But sitting and talking with me... helps. Thank you.","swampscout help":"Here, I brought you a healing potion to help ease your pain.","swampscout help answ":"Oh... Thank you. Hopefully this'll... help me get some sleep.","swampscout help not":"I'm sorry, can you... show me what you're giving me?","swampscout foraging":"I would actually be really interested in hearing about what things are growing in the swamp.","swampscout foraging answ":"Alright... Sit down on the bed, and I'll tell you... about what I've seen over the years."},mofu_english:{"elder description":"You see an older man with curly white hair and dull, heavy horns. Despite his years, he stands with a strong posture, ready to ram any threat to the village. He eyes you with curiosity.","craftsman description":"You see an old man with a medium length white tail, who clearly experienced a lot in life. His hair is composed of a black and a white part, with the former very dulled by age. He's wearing some handmade accessories. Despite his age and his massive hands, his fingers seem exceptionally nimble.","craftsman learn answ":`Ahh, that's great. Well then... 
*[Old man spends some time explaining all the important basics of crafting and providing you with tips, his large fingers proving to be as nimble as they seemed]*
Ahh, and before I forget, here, take these. They will be helpful for gathering necessary materials.`,"craftsman about guard answ":"Ahhh, our fierce she-wolf... She once wanted to be an adventurer, but I believe it didn't work out for her. Hard work is not enough when talent is lacking nor can it allow one to conquer fate. Still, she's a good girl and keeps us safe now.","guard description":"You see a tall woman in light armor, with a spear in her hand and two daggers on her belt. Her sharp fuzzy ears rotate every now and then towards any new sound, while her fluffy tail remains motionless. There's a scar across her face. When she spots you, she looks at you as if you were prey, but then her expression softens a lot.","guard hi answ":`Hey there. I heard you've been helping around a lot, good job cutie~ 
 *[As she says that, she bends forward and pats your head a few times with a surprisingly gentle touch, her tail slightly wagging]*`,"guard serious answ":"Ohhh, someone wants to impress the cute fluffy wolf lady? Sorry, but I'm way too strong for you~","millers description":"You see two teenagers with mischievous looks on their faces. One has cat ears and a fluffy tail, the other mouse ears and a tail with barely any hair on it. It's only with great deal of effort that you manage to recognize them both as males. The cat has red hair, the mouse gray.","millers hello answ":`[Cat] Hi~! 
 [Mouse]: Hello`,"millers how answ":`[Mouse] We are fine, mostly. 
 [Cat] Except for rats in the storehouse, especially since we are about to have grain delivery. 
 [Mouse] The big rats, like on the fields... 
 [Cat] I would prefer mice, at least those are cute. 
 [Mouse] Shut up. 
 [Cat] So if you could help us with them, it would be great!`,"millers sure answ":`[Cat] Ehehe, thank you~ 
 [Mouse] We will get you some reward for it later. 
 [Cat] A bit of money, and maybe a kiss or two~`,"millers cleared answ":`[Cat] Nice job! 
[Mouse] Now where is that grain? 
 [Cat] Oh right, it was supposed to be delivered by now. 
[Mouse] Could you search the village for a cart loaded with bags of grain that's 'supposed' to be heading our way?`,"millers delivered answ":`[Cat] Thanks 
[Mouse] Thank you! 
[Cat] And here's your reward.`,"millers kiss answ":"[Cat] Yes? Which one of us do you want it from?","millers kiss mouse answ":"*[Mouse teen slowly approaches you from the side and gives you a gentle smooch on your cheek with his tail brushing against your legs, then steps back with a slightly shy smile]*","millers kiss cat answ":"*[Cat teen slowly approaches you from the side and gives a gentle smooch on your cheek with his tail brushing against your legs, then steps back with a smirk]*","millers kiss both answ":"*[The two slowly approach you from both sides and you receive two simultanous gentle smooches, one of each of your cheek with their tails brushing against your legs, after which they take a step back]*","millers reject nice answ":"[Cat] Oh well, that's a pity~","millers reject mean answ":"[Cat] Whatever you say~","millers kiss more answ":`[Cat] Hmmm... should we? 
[Mouse] Maybe some other time. 
[Mouse] You heard him~`,"millers how2 answ":`[Cat] Kinda boring, but at least company is good. 
[Mouse] What he said.`,"millers about guard answ":`[Cat] Nope, nothing. She just happens to have same name and looks, as far as oral descriptions go, as one the continent's top ten adventurers who retired just before she returned. 
[Mouse] Obviously it's a total coincidence, right? Two completely unrelated wolves. *[The two exchange amused looks]* 
[Cat] Jokes aside, no one here besides us managed to make that connection, that's just sooo stupid~ 
[Mouse] When they hear how there was a powerful adventurer who happens to match her perfectly, they all just assume that it's a pure coincidence and a completely different person. 
[Cat] She doesn't seem to care much about it, probably prefers peace and quiet. Let her have them, I'm sure she went through a lot, and with her here we can feel safer than ever.`,"g guard description":"You see a massive, hairy man with round ears and a tiny tail. He's clad in a steel chainmail, with a spear in his hand and an axe on his belt.","sus description 1":"You see a young man in shabby clothes and with messy hair, who keeps looking around. He appears to have some nervous ticks, or maybe he's just really stressed. Both his doggy ears and his tail are lowered and not moving. He notices you and stares.","sus description 2":"You see a young man in shabby clothes and with messy hair, who keeps calmly looking around, with ears straight up and occasionally turning towards new sounds. The moment he notices you, he appears to get calmer and his tail starts slowly wagging.","sus headpat answ":"[He smiles like a little puppy, his tail wagging a lot faster]","old description 1":"With some safety returned to the area, more folk are now out on the streets. One of them, an elderly tanuki lady, is looking at you.","old description 2":"You see a gentle elderly tanuki lady with warm look in her eyes","sup description":"You see a well dressed man with a notebook on his belt and a hat on his head, awkwardly placed between a pair of antlers. Despite seeming more like a scribe, he's buff and tanned.","swampchief description 1":"Looking around the encampment, you see a large hut framed by banners and lit torches. You approach the hut, calling out in greeting, but getting no response. As you step closer, you see a large man in thick scaly armor wielding a great trident emerge, his thick scaly tail resting behind him. He points the trident at you as he takes a firm stance.","swampcook description 1":"As you get closer to the cook's workhut, you're met with a distinctive tune bellowed loudly and an acrid smell emanating from inside. Bracing your nose, you approach to find a short fellow nearly obscured by hanging meats, moving between a rack larger than he is housing thin cuts suspended between grated slats and a large cauldron build into a workbench covered in large slabs of rough leather in various stages of processing. You're surprised to find that he was the source of the singing. Noticing your approach, he stops his song and turns to address you with a smile on his face, somehow managing to not hit anything with his scaly tail.","swampcook description 3":"As you approach the workhut, you absentmindedly sing along to the cook's song. He notices your singing before turning to you and giving a big nod with a toothy grin before resuming his work, his large tail once again somehow not hitting anything.","swampcook peopleend":"I think I've learned all I need to about the lizardfolk of the Snake Fang tribe.","swamptanner description 1":"You approach the tanner's workhut to find the old woman with a scowl on her face standing next to a rack stretching drying leather. Her hands are visibly shaking while her tail is dull in color and thin, an apparent sign of wear and old age, as she goes about her work.","swampscout description 1":"You see a young woman lying in a cot near the door. Her chest is covered in worn bandages stained with old blood, her arms covered in cuts and abrasions, and her lower half obscured by a blanket. The smell of rot gets stronger as you approach her.","swampscout description 2":"You see the scout lying in a cot near the door. Her chest is covered in worn bandages stained with fresh blood, her arms covered in cuts and abrasions, and her lower half obscured by a blanket. The smell of rot gets stronger as you approach her.","swampscout description 3":"You see the scout lying in a cot near the door. Her chest is covered in fresh bandages stained with fresh blood, her arms covered in bruises and scars, and her lower half partially obscured by a blanket, revealing empty spaces where her tail and right leg used to be."}};var Jl,Ae={},oe=document.getElementById("location_actions_div"),Xl=document.getElementById("trade_div"),Zl=document.getElementById("storage_div"),er=document.getElementById("location_name_span"),Ys=document.getElementById("location_icon_span"),Xn=document.getElementById("location_types_div"),ao=document.getElementById("location_name_tooltip"),tt,ia,tr,ir,Qn=[],ea=document.getElementById("inventory_content_div"),se={},je={},kt={},Ci={},Li={},cn=document.getElementById("trader_inventory_div"),Un=document.getElementById("storage_inventory_div"),sn=document.getElementById("message_box_div"),ar=document.getElementById("combat_div"),ot=document.getElementById("enemies_div"),Kn=document.getElementById("enemy_count_div"),Jn=document.getElementById("clear_count_div"),ru=[{backgroundColor:"rgba(0, 0, 0, 0)",rotate:"0deg"},{backgroundColor:"rgba(255, 0, 0, 0.2)",rotate:"0.3deg"}],cu={duration:100,iterations:2,direction:"alternate"},uu=[{opacity:"0.2",backgroundColor:"rgba(0, 124, 17, 0.2)"},{opacity:"1"}],du={duration:800,iterations:1},un={},mu=document.getElementById("character_health_value"),hu=document.getElementById("character_healthbar_current"),_u=document.getElementById("character_health_tooltip"),pu=document.getElementById("character_stamina_value"),fu=document.getElementById("character_stamina_bar_current"),gu=document.getElementById("character_stamina_tooltip"),Vl=document.getElementById("character_xp_div"),wu=document.getElementById("character_level_div"),yu=document.getElementById("character_xp_tooltip"),Ds=document.getElementById("effects_tooltip"),ku=document.getElementById("active_effect_count"),bu=document.getElementById("time_div"),xa=document.getElementById("weather_div"),pe={},vt=document.getElementById("skill_list"),Ne=[],At={},on=document.getElementById("stance_list"),Yt={},Vs=document.getElementById("books_list"),Ea={},Qs=document.getElementById("bestiary_list"),Wi=document.getElementById("switch_to_combat"),nr=document.getElementById("switch_to_inventory"),no={},so=document.getElementById("quest_list"),vu=document.getElementById("quest_hiding_button"),oo={reputation:document.getElementById("data_tab_reputation_div"),item_log:document.getElementById("data_tab_item_log_div")},ln="name",Xi="asc",Us="name",qa="asc",Ks="name",Sa="asc",Js="name",Ia="asc",ue={message_combat:0,message_unlocks:0,message_loot:0,message_events:0,message_background:0,message_crafting:0},ta={strength:document.getElementById("strength_slot"),agility:document.getElementById("agility_slot"),dexterity:document.getElementById("dexterity_slot"),intuition:document.getElementById("intuition_slot"),magic:document.getElementById("magic_slot"),attack_speed:document.getElementById("attack_speed_slot"),attack_power:document.getElementById("attack_power_slot"),defense:document.getElementById("defense_slot"),crit_rate:document.getElementById("crit_rate_slot"),crit_multiplier:document.getElementById("crit_multiplier_slot")},hi={attack_points:document.getElementById("hit_chance_slot"),defensive_action:document.getElementById("defensive_action_slot"),defensive_points:document.getElementById("defensive_action_chance_slot")},_i={},xu=document.getElementById("character_attack_bar"),Bi={head:document.getElementById("head_slot"),torso:document.getElementById("torso_slot"),arms:document.getElementById("arms_slot"),ring:document.getElementById("ring_slot"),weapon:document.getElementById("weapon_slot"),"off-hand":document.getElementById("off-hand_slot"),legs:document.getElementById("legs_slot"),feet:document.getElementById("feet_slot"),amulet:document.getElementById("amulet_slot"),artifact:document.getElementById("artifact_slot"),cape:document.getElementById("cape_slot"),pickaxe:document.getElementById("pickaxe_slot"),axe:document.getElementById("axe_slot"),sickle:document.getElementById("sickle_slot"),shovel:document.getElementById("shovel_slot"),fishing_pole:document.getElementById("fishing_slot")},Mt={trash:"#d3d3d3",common:"#ffffff",uncommon:"#90ee90",rare:"#0000ff",epic:"#ffc0cb",legendary:"#800080",mythical:"#ffa500"},Zi={};Object.keys(Mt).forEach(e=>{Zi[e]=fl(Mt[e])});var it={},mo,lo,qu=document.getElementById("loading_screen_loading_progress"),di=document.getElementById("backup_load_button"),Tt=document.getElementById("import_other_save_button"),Ql=document.getElementById("export_button_tooltip"),Su="Nevermind";function De(e){if(e)for(;e.firstChild;)e.removeChild(e.lastChild)}function j(e,t){e.insertAdjacentHTML("beforeend",t)}function ae(e,t){De(e),e.insertAdjacentHTML("beforeend",t)}function bt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function sr(e){return Ni.is_known(e)?c[e].getName():"???"}function or(e,t){let i=document.createElement("div");t.x=t.x+Math.random()*80-40,i.style.top=t.y+"px",i.style.left=t.x+"px",i.classList.add("floating_effect"),i.innerText=e,i.posX=t.x,i.posY=t.y,document.body.appendChild(i);let a=0,s;Math.random()>.5?s=setInterval(()=>{i.style.top=i.posY-2*a**.95+"px",i.style.left=i.posX-Math.sin(a/10)*20+"px",i.style.opacity=(100-a**.95)/100,a++},30):s=setInterval(()=>{i.style.top=i.posY-2*a**.95+"px",i.style.left=i.posX-Math.cos(a/8)*16+"px",i.style.opacity=(100-a**.95)/100,a++},30),setTimeout(()=>{clearInterval(s),i.remove()},4*1e3)}function sa(){for(;oe.lastElementChild;)oe.removeChild(oe.lastElementChild),Ae={}}function oa(e,t={},i=!1){let a=document.createElement("span");return a.classList.add(t?.class_name||"item_tooltip"),j(a,Ta({item:e,options:t,is_trade:i})),a}function Ta({item:e,options:t={},is_trade:i=!1}){let a="",s=i?"getValue":"getBaseValue";a=`<b>${e.getName()}</b>`,e.description&&(a+=`<br>${e.description}`);let n=e.quality;if(e.item_type==="EQUIPPABLE"){if(t?.quality&&t.quality[0]&&(n=t.quality[0]),!e.ignore_quality)if(!t.skip_quality&&t?.quality?.length==2){let l=Zi[e.getRarity(t.quality[0])],d=Zi[e.getRarity(t.quality[1])];a+=`<br><br><b>Quality: <span class="${l}" style="color: ${Mt[e.getRarity(t.quality[0])]}"> ${t.quality[0]}% </span> - <span class="${d}" style="color: ${Mt[e.getRarity(t.quality[1])]}"> ${t.quality[1]}% </span>`,a+=`<br>[<span class="${l}" style="color: ${Mt[e.getRarity(t.quality[0])]}">${e.getRarity(t.quality[0])}</span>-<span class="${d}" style="color: ${Mt[e.getRarity(t.quality[1])]}">${e.getRarity(t.quality[1])}</span>] </b>`}else{let l=Zi[e.getRarity(n)];a+=`<br><br><b class="${l}" style="color: ${Mt[e.getRarity(n)]}">Quality: ${n}% [${e.getRarity(n)}]</b>`}if(e.tags.unique&&(a+='<br><br><b class="item_unique outline_white">Unique</b>'),a+=`<br><br>Slot: <b>${e.equip_slot}</b>`,e.equip_slot==="weapon"&&(a+=`<br>Type: <b>${e.weapon_type}</b>`),e.components){let l='<br><br><span class="item_component_list">',d=Object.keys(e.components);e.components&&(l+=`[${c[e.components[d[0]]].name}]`,e.components[d[1]]?l+=`<br>+<br>[${c[e.components[d[1]]].name}]`:l+=`<br>+<br>no [${d[1]}]`),l+="</span>",a+=l}if(!t.skip_quality&&t?.quality?.length==2){e.getAttack?a+=`<br><br>Attack: ${Math.round(10*e.getAttack(t.quality[0]),!0)/10} - ${Math.round(10*e.getAttack(t.quality[1],!0))/10}`:e.getDefense?a+=`<br><br>Defense: ${Math.round(10*e.getDefense(t.quality[0]))/10} - ${Math.round(10*e.getDefense(t.quality[1]))/10}`:e.offhand_type==="shield"&&(e.tags.ignore_skill?a+=`<br><br>Can block up to: ${Math.round(10*e.getShieldStrength(t.quality[0]))/10} - ${Math.round(10*e.getShieldStrength(t.quality[1]))/10} damage [base: ${e.getShieldStrength(t.quality[0])}-${e.getShieldStrength(t.quality[1])}]`:a+=`<br><br>Can block up to: ${Math.round(10*e.getShieldStrength(t.quality[0])*r.stats.total_multiplier.block_strength)/10} - ${Math.round(10*e.getShieldStrength(t.quality[1])*r.stats.total_multiplier.block_strength)/10} damage [base: ${e.getShieldStrength(t.quality[0])}-${e.getShieldStrength(t.quality[1])}]`);let l=e.getStats(t.quality[0]),d=e.getStats(t.quality[1]);Object.keys(l).length>0&&(a+="<br>"),Object.keys(l).forEach(u=>{l[u].flat!=null&&(a+=`<br>${bt(u).replace("_"," ")}: +${l[u].flat} - ${d[u].flat}`),l[u].multiplier!=null&&(a+=`<br>${bt(u).replace("_"," ")}: x${l[u].multiplier} - ${d[u].multiplier}`)})}else{e.getAttack?a+=`<br><br>Attack: ${Math.round(10*e.getAttack())/10}`:e.getDefense?a+=`<br><br>Defense: ${Math.round(10*e.getDefense())/10}`:e.offhand_type==="shield"&&(e.tags.ignore_skill?a+=`<br><br>Can block up to: ${Math.round(10*e.getShieldStrength())/10} damage [unaffected by skill]`:a+=`<br><br>Can block up to: ${Math.round(10*e.getShieldStrength()*r.stats.total_multiplier.block_strength)/10} damage [base: ${e.getShieldStrength()}]`);let l=e.getStats();Object.keys(l).length>0&&(a+="<br>"),Object.keys(l).forEach(function(d){l[d].flat!=null&&(a+=`<br>${bt(d).replace("_"," ")}: +${l[d].flat}`),l[d].multiplier!=null&&(a+=`<br>${bt(d).replace("_"," ")}: x${l[d].multiplier}`)})}let o=e.getBonusSkillLevels();Object.keys(o).length>0&&(a+="<br>"),Object.keys(o).forEach(l=>{l.includes("category_")?a+=`<br>${l} skills level: +${o[l]}`:a+=`<br>${f[l].name()} level: +${o[l]}`}),a+="<br>"}else if(e.item_type==="USABLE"){a+="<br>",e.effects.length>0&&(a+="<br>Effects: ");for(let o=0;o<e.effects.length;o++)a+=lr({effect_name:e.effects[o].effect,duration:e.effects[o].duration,add_bonus:!0}).outerHTML}else if(e.item_type==="BOOK")V[e.name].is_finished?(a+=`<br><br>Reading it provided ${r.name} with:`,Object.keys(V[e.name].bonuses).length>0&&(a+=`<br>- ${Iu(V[e.name].bonuses)}`),V[e.name].rewards?.skills&&(V[e.name].rewards.skills.length==1?a+="<br>- a new skill":a+="<br>- new skills"),V[e.name].rewards?.recipes&&(V[e.name].rewards.recipes.length==1?a+="<br>- a new recipe":a+="<br>- new recipes")):a+=`<br><br>Time to read: ${e.getRemainingTime()} minutes`,a+="<br>";else if(e.tags.component){if(t?.quality&&t.quality[0]&&(n=t.quality[0]),!t.skip_quality&&t?.quality?.length==2){let o=Zi[e.getRarity(t.quality[0])],l=Zi[e.getRarity(t.quality[1])];a+=`<br><br><b>Quality: <span class="${o}" style="color: ${Mt[e.getRarity(t.quality[0])]}"> ${t.quality[0]}% </span> - <span class="${l}" style="color: ${Mt[e.getRarity(t.quality[1])]}"> ${t.quality[1]}% </span>`,a+=`<br>[<span class="${o}" style="color: ${Mt[e.getRarity(t.quality[0])]}"> ${e.getRarity(t.quality[0])}</span> - <span class="${l}" style="color: ${Mt[e.getRarity(t.quality[1])]}"> ${e.getRarity(t.quality[1])}</span>]</b>`}else{let o=Zi[e.getRarity(n)];a+=`<br><br><b class="${o}" style="color: ${Mt[e.getRarity(n)]}">Quality: ${n}% [${e.getRarity(n)}]</b>`}e.component_tier&&(a+=`<br><br>Component tier: ${e.component_tier}`),(Object.keys(e.component_stats).length>0||e?.attack_value!==0||e?.attack_multiplier!==1||e?.defense_value!==0)&&(a+="<br><br>Basic stats: "),e?.attack_value&&(a+=`<br>Attack power: +${e.attack_value}`),e?.attack_multiplier&&e.attack_multiplier!==1&&(a+=`<br>Size-specific attack power: x${e.attack_multiplier}`),e?.defense_value&&(a+=`<br>Defense: +${e.defense_value}`),Object.keys(e.component_stats).forEach(function(o){e.component_stats[o].flat!=null&&(a+=`<br>${bt(o).replace("_"," ")}: +${e.component_stats[o].flat}`),e.component_stats[o].multiplier!=null&&(a+=`<br>${bt(o).replace("_"," ")}: x${e.component_stats[o].multiplier}`)}),a+="<br>"}else a+="<br>";return e.material_type&&(a+=`<br>Material type: ${e.material_type}<br>`),!t.skip_quality&&t?.quality?.length==2?a+=`<br>Value: ${Ke(We(e[s]({quality:t.quality[0],region:x?.market_region})))} - ${Ke(We(e.getBaseValue({quality:t.quality[1]})))}`:(a+=`<br>Value: ${Ke(We(e[s]({quality:n,region:x?.market_region,multiplier:t&&t.trader?F[Ye].getProfitMargin(x.market_region):1})))}`,e.saturates_market&&(a+=` [originally ${Ke(We(e.getBaseValue({quality:n,region:x?.market_region})*(t&&t.trader?F[Ye].getProfitMargin(x.market_region):1)||1))}]`)),a}function lr({effect_name:e,duration:t,add_bonus:i=!1}){let a=z[e],s=document.createElement("div"),n="";s.classList.add("active_effect_tooltip");let o=document.createElement("span");o.classList.add("active_effect_name"),j(o,`'${a.name}' : `);let l=document.createElement("span");l.classList.add("active_effect_duration"),l.innerText=""+qi({time:{minutes:t}});let d=document.createElement("div");if(d.classList.add("active_effect_name_and_duration"),d.appendChild(o),d.appendChild(l),s.appendChild(d),a.description){let w=document.createElement("div");w.classList.add("active_effect_description"),w.innerText=a.description,s.appendChild(w)}let u=document.createElement("div"),h;i?h=jo(a):h=a.effects;for(let[w,b]of Object.entries(h.stats)){n+=`<br>${bt(Je[w])}`;let g=!1;if(b.flat){let v=b.flat>0?"+":"";n+=`: ${v}${Math.round(100*b.flat)/100}`,g=!0}b.multiplier&&(g?n+=`, x${Math.round(100*b.multiplier)/100}`:n+=`: x${Math.round(100*b.multiplier)/100}`)}let _=Object.keys(h.xp_multipliers);if(_.length>0){let w;_[0]!=="all"&&_[0]!=="hero"&&_[0]!=="all_skill"?w=f[_[0]].name():w=_[0].replace("_"," "),w=bt(w),n?n+=`<br>${w} xp gain: x${h.xp_multipliers[_[0]]}`:n=`${w} xp gain: x${h.xp_multipliers[_[0]]}`;for(let b=1;b<_.length;b++){let g;_[b]!=="all"&&_[b]!=="hero"&&_[b]!=="all_skill"?g=f[_[b]].name():g=_[b].replace("_"," "),n+=`<br>${g} xp gain: x${h.xp_multipliers[_[b]]}`}}return j(s,n),s.appendChild(u),s}function pi(e){clearInterval(Jl);let t=document.getElementById("action_status_div");e&&t&&De(t)}function C(e,t){if(typeof e>"u")return;let i=document.createElement("div");i.classList.add("message_common");let a="message_default",s="message_events";switch(t){case"enemy_defeated":a="message_victory",s="message_combat",ue.message_combat+=1;break;case"hero_defeat":a="message_hero_defeated",s="message_combat",ue.message_combat+=1;break;case"enemy_attacked":a="message_enemy_attacked",s="message_combat",ue.message_combat+=1;break;case"enemy_attacked_critically":a="message_enemy_attacked_critically",s="message_combat",ue.message_combat+=1;break;case"hero_attacked":a="message_hero_attacked",s="message_combat",ue.message_combat+=1;break;case"hero_missed":s="message_combat",ue.message_combat+=1;break;case"hero_blocked":s="message_combat",ue.message_combat+=1;break;case"enemy_missed":s="message_combat",ue.message_combat+=1;break;case"hero_attacked_critically":a="message_hero_attacked_critically",s="message_combat",ue.message_combat+=1;break;case"combat_loot":a="message_items_obtained",s="message_loot",ue.message_loot+=1;break;case"gathered_loot":a="message_items_obtained",s="message_loot",ue.message_loot+=1;break;case"total_gathered_loot":a="message_total_items_obtained",s="message_loot",ue.message_loot+=1;break;case"location_reward":s="message_loot",ue.message_loot+=1;break;case"skill_raised":a="message_skill_leveled_up",s="message_unlocks",ue.message_unlocks+=1;break;case"level_up":s="message_unlocks",ue.message_unlocks+=1;break;case"activity_unlocked":s="message_unlocks",ue.message_unlocks+=1;break;case"location_unlocked":a="message_location_unlocked",s="message_unlocks",ue.message_unlocks+=1;break;case"dialogue_unlocked":s="message_unlocks",ue.message_unlocks+=1;break;case"message_travel":a="message_travel",s="message_events",ue.message_events+=1;break;case"export_reward":a="message_export_reward",s="message_events",ue.message_events+=1;break;case"activity_finished":s="message_events",ue.message_events+=1;break;case"activity_money":s="message_events",ue.message_events+=1;break;case"notification":ue.message_events+=1,s="message_events",a="message_notification";break;case"background":ue.message_background+=1,s="message_background";break;case"crafting":ue.message_crafting+=1,s="message_crafting";break;case"message_critical":ue.message_events+=1,s="message_events",a="message_critical";break}(s==="message_combat"&&ue.message_combat>80||s==="message_loot"&&ue.message_loot>28||s==="message_unlocks"&&ue.message_unlocks>40||s==="message_events"&&ue.message_events>40||s==="message_background"&&ue.message_background>28||s==="message_crafting"&&ue.message_crafting>28)&&sn.removeChild(sn.getElementsByClassName(s)[0]),i.classList.add(a,s),j(i,e+"<div class='message_border'> </>"),sn.appendChild(i);let n=s.replace("_","_show_");document.getElementById(n).classList.contains("active_selection_button")&&(sn.scrollTop=sn.scrollHeight)}function Iu(e){let t="";if(e.stats){let i=Object.keys(e.stats);t=`+${e.stats[i[0]]} ${Je[i[0]]}`;for(let a=1;a<i.length;a++)t+=`, +${e.stats[i[a]]} ${Je[i[a]]}`}if(e.multipliers){let i=Object.keys(e.multipliers);t?t+=`, x${e.multipliers[i[0]]} ${Je[i[0]]}`:t=`x${e.multipliers[i[0]]} ${Je[i[0]]}`;for(let a=1;a<i.length;a++)t+=`, x${e.multipliers[i[a]]} ${Je[i[a]]}`}if(e.xp_multipliers){let i=Object.keys(e.xp_multipliers),a;i[0]!=="all"&&i[0]!=="hero"&&i[0]!=="all_skill"?a=f[i[0]].name():a=i[0].replace("_"," "),t?t+=`, x${e.xp_multipliers[i[0]]} ${a} xp gain`:t=`x${e.xp_multipliers[i[0]]} ${a} xp gain`;for(let s=1;s<i.length;s++){let n;i[s]!=="all"&&i[s]!=="hero"&&i[s]!=="all_skill"?n=f[i[s]].name():n=i[s].replace("_"," "),t+=`, x${e.xp_multipliers[i[s]]} ${n} xp gain`}}return t}function Zn({loot_list:e,is_combat:t=!1,is_a_summary:i=!1}){if(e.length==0)return;let a;e[0].item_id?a=c[e[0].item_id]:e[0].item_key&&(a=xe(e[0].item_key));let s,n;if(t?(n="combat_loot",s='Looted "'):i?(n="total_gathered_loot",s='Gained in total: "'):(n="gathered_loot",s='Gained "'),s+=a.getName()+'" x'+e[0].count,e.length>1)for(let o=1;o<e.length;o++)e[o].item_id?a=c[e[o].item_id]:e[o].item_key&&(a=xe(e[o].item_key)),s+=', "'+a.getName()+'" x'+e[o].count;C(s,n)}function es(e){pi(),Jl=setInterval(()=>{let t=document.getElementById("action_status_div"),i="";if(t.innerText.endsWith("...")?i="...":t.innerText.endsWith("..")?i="..":t.innerText.endsWith(".")&&(i="."),e?.book_title){let a=t.innerText;ae(t,a.split(",")[0]+`, ${Mn(c[e.book_title].getRemainingTime())} left`+i)}if(i.length<3)j(t,".");else{let a=t.innerText;ae(t,a.substring(0,a.length-3))}},600)}function Wl(){oe.style.display="none",Xl.style.display="inherit",document.getElementById("trader_cost_mult_value").textContent=`${Math.round(100*F[Ye].getProfitMargin(x.market_region))}%`,Kt()}function jn(){oe.style.display="none",Zl.style.display="inherit",ho()}function ba(){ae(document.getElementById("money_div"),`Your purse contains: ${Ke(r.money)}`)}function rr(e){ae(document.getElementById("trade_price_value"),Ke(e))}function $u(){let e=document.createElement("div");e.classList.add("trade_ammount_buttons");let t=document.createElement("div");t.classList.add("trade_ammount_button"),t.innerText="5",t.setAttribute("data-trade_ammount",5),e.appendChild(t);let i=document.createElement("div");i.classList.add("trade_ammount_button"),i.innerText="10",i.setAttribute("data-trade_ammount",10),e.appendChild(i);let a=document.createElement("div");return a.classList.add("trade_ammount_button"),a.innerText="all",a.setAttribute("data-trade_ammount",1/0),e.appendChild(a),e}function Aa({sort_by:e,target:t="character",change_direction:i=!1}){let a,s;if(t==="trader")e?i&&(e===Us&&qa==="asc"?qa="desc":qa="asc"):e=Us,t=cn,a=qa==="asc"?1:-1,s=qa==="asc"?-1:1,Us=e||"name";else if(t==="character")e?i&&(e===Js&&Ia==="asc"?Ia="desc":Ia="asc"):e=Js,t=ea,a=Ia==="asc"?1:-1,s=Ia==="asc"?-1:1,Js=e||"name";else if(t==="storage")e?i&&(e===Ks&&Sa==="asc"?Sa="desc":Sa="asc"):e=Ks,t=Un,a=Sa==="asc"?1:-1,s=Sa==="asc"?-1:1,Ks=e||"name";else{console.warn(`Something went wrong, no such inventory as '${t}'`);return}[...t.children].sort((n,o)=>{if(n.classList.contains("equipped_item_control")&&!o.classList.contains("equipped_item_control"))return-1;if(!n.classList.contains("equipped_item_control")&&o.classList.contains("equipped_item_control")||n.classList.contains("item_to_trade")&&!o.classList.contains("item_to_trade"))return 1;if(!n.classList.contains("item_to_trade")&&o.classList.contains("item_to_trade"))return-1;if(n.classList.contains("character_item_equippable")&&!o.classList.contains("character_item_equippable"))return 1;if(!n.classList.contains("character_item_equippable")&&o.classList.contains("character_item_equippable"))return-1;if(n.classList.contains("trader_item_equippable")&&!o.classList.contains("trader_item_equippable"))return 1;if(!n.classList.contains("trader_item_equippable")&&o.classList.contains("trader_item_equippable"))return-1;if(n.classList.contains("storage_item_equippable")&&!o.classList.contains("storage_item_equippable"))return 1;if(!n.classList.contains("storage_item_equippable")&&o.classList.contains("storage_item_equippable"))return-1;if(n.children[0].children[0].children[0].innerText==="[Comp]"&&o.children[0].children[0].children[0].innerText!=="[Comp]")return 1;if(n.children[0].children[0].children[0].innerText!=="[Comp]"&&o.children[0].children[0].children[0].innerText==="[Comp]")return-1;if(n.children[0].children[0].children[0].innerText==="[Book]"&&o.children[0].children[0].children[0].innerText!=="[Book]")return 1;if(n.children[0].children[0].children[0].innerText!=="[Book]"&&o.children[0].children[0].children[0].innerText==="[Book]")return-1;let l=n.dataset.item_slot,d=o.dataset.item_slot;if(e==="type"){if(l!=d)return Object.keys(Bi).indexOf(n.dataset.item_slot)-Object.keys(Bi).indexOf(o.dataset.item_slot);if(n.classList.contains("character_item_usable")!=o.classList.contains("character_item_usable"))return o.classList.contains("character_item_usable")>n.classList.contains("character_item_usable")?a:s;if(n.classList.contains("trader_item_usable")!=o.classList.contains("trader_item_usable"))return o.classList.contains("trader_item_usable")>n.classList.contains("trader_item_usable")?a:s;if(n.classList.contains("storage_item_usable")!=o.classList.contains("storage_item_usable"))return o.classList.contains("storage_item_usable")>n.classList.contains("storage_item_usable")?a:s;let u=null,h=null;if(t===ea?(u=c[JSON.parse(n.dataset.character_item).id],h=c[JSON.parse(o.dataset.character_item).id]):t===cn?(u=c[JSON.parse(n.dataset.trader_item).id],h=c[JSON.parse(o.dataset.trader_item).id]):t===Un&&(u=c[JSON.parse(n.dataset.storage_item).id],h=c[JSON.parse(o.dataset.storage_item).id]),u&&h){if(u.material_type!=h.material_type)return u.material_type>h.material_type?a:s;if(u.component_type!=h.component_type)return u.component_type>h.component_types?a:s;if(u.component_tier!=h.component_tier)return u.component_tier>h.component_tier?a:s}}if(e==="name"||e==="type"){let u=(n.querySelector(".inventory_item_name")||n.querySelector(".equipped_item_name")).innerText.toLowerCase().replaceAll('"',""),h=(o.querySelector(".inventory_item_name")||o.querySelector(".equipped_item_name")).innerText.toLowerCase().replaceAll('"',"");if(u>h)return a;if(u<h)return s;{let _=Number.parseInt(n.dataset.item_quality),w=Number.parseInt(o.dataset.item_quality);return _>w?a:s}}else if(e==="price"){let u=Number.parseInt(n.getAttribute("data-item_value")),h=Number.parseInt(o.getAttribute("data-item_value"));return u>h||u===h&&"item_quality"in n.dataset&&"item_quality"in o.dataset&&Number.parseInt(n.dataset.item_quality)>Number.parseInt(o.dataset.item_quality)?a:s}}).forEach(n=>t.appendChild(n))}function Kt({item_key:e,trader_sorting:t="name",sorting_direction:i="asc",was_anything_new_added:a=!1}={}){let s=F[Ye];if(e||(Object.keys(je).forEach(n=>{s.inventory[n]||(je[n].remove(),delete je[n])}),Object.keys(Li).forEach(n=>{P.items.filter(o=>o.item_key===n).length===0&&(Li[n].remove(),delete Li[n])})),e){let n=s.inventory[e].count;a=je[e];let o=ei({key:e,item_count:n,target:"trader",is_trade:!0});je[e]?(je[e].replaceWith(o),je[e]=o):(je[e]=o,cn.appendChild(o))}else{Object.keys(s.inventory).forEach(n=>{let o=s.inventory[n].count;for(let l=0;l<L.items.length;l++)if(n===L.items[l].item_key){if(o-=Number(L.items[l].count),o==0){je[n]?.remove(),delete je[n];return}if(o<0)throw new Error("Something is wrong with trader item count");break}if(!je[n])je[n]=ei({key:n,item_count:o,target:"trader",is_trade:!0}),cn.appendChild(je[n]),a=!0;else{let l=Number.parseInt(je[n].getElementsByClassName("item_count")[0].innerText.replace("x",""));Number.isNaN(l)&&(l=0),l!=o&&(o>1?je[n].getElementsByClassName("item_count")[0].innerText=` x${o}`:je[n].getElementsByClassName("item_count")[0].innerText=""),je[n].querySelector(".item_tooltip").replaceWith(oa(s.inventory[n].item,{trader:!0},!0));let u=je[n].getElementsByClassName("item_value")[0];ae(u,`${Ke(We(s.inventory[n].item.getValue({region:x.market_region,multiplier:F[Ye].getProfitMargin(x.market_region)||1})),!0)}`)}});for(let n=0;n<P.items.length;n++){let o=P.items[n].item_key;if(!Li[o])Li[o]=ei({target:"trader",trade_index:n,is_trade:!0}),cn.appendChild(Li[o]);else{let l=je[o]?.dataset.item_count??0,d=P.items[n].count;l!==d&&(d>1?Li[o].getElementsByClassName("item_count")[0].innerText=` x${d}`:Li[o].getElementsByClassName("item_count")[0].innerText="")}}}a&&Aa({target:"trader",sort_by:t,direction:i})}function ve({item_key:e,equip_slot:t,character_sorting:i,sorting_direction:a="asc",was_anything_new_added:s=!1,is_trade:n=!1,skip_sorting:o=!1}={}){if(e||(Object.keys(se).forEach(l=>{if(se[l].classList.contains("equipped_item_control")){let d=se[l].dataset.character_item;(!r.equipment[l]||d!==r.equipment[l].getInventoryKey())&&(se[l].remove(),delete se[l])}else r.inventory[l]||(se[l].remove(),delete se[l])}),Object.keys(Ci).forEach(l=>{L.items.filter(d=>d.item_key===l).length===0&&(Ci[l].remove(),delete Ci[l])})),e){let l=r.inventory[e].count;s=je[e];let d=ei({key:e,item_count:l,target:"character",is_trade:n});se[e]?(se[e].replaceWith(d),se[e]=d):(se[e]=d,ea.appendChild(d))}else if(t){let l=ei({key:t,target:"character",is_equipped:!0,is_trade:n});se[t]?(se[t].replaceWith(l),se[t]=l):(se[t]=l,ea.appendChild(l))}else{Object.keys(r.inventory).forEach(l=>{let d=r.inventory[l].count;for(let u=0;u<P.items.length;u++)if(l===P.items[u].item_key){if(d-=Number(P.items[u].count),d==0){se[l]?.remove(),delete se[l];return}if(d<0)throw new Error("Something is wrong with character item count");break}if(!se[l])se[l]=ei({key:l,item_count:d,target:"character",is_trade:n}),ea.appendChild(se[l]),s=!0;else{let u=Number.parseInt(se[l].getElementsByClassName("item_count")[0].innerText.replace("x",""));if(Number.isNaN(u)&&(u=0),u!=d&&(d>1?se[l].getElementsByClassName("item_count")[0].innerText=` x${d}`:se[l].getElementsByClassName("item_count")[0].innerText=""),se[l].querySelector(".item_tooltip").replaceWith(oa(r.inventory[l].item,{},n)),!r.inventory[l].item.tags.unsellable){let _=se[l].getElementsByClassName("item_value")[0];n?ae(_,`${Ke(We(r.inventory[l].item.getValue({region:x.market_region})),!0)}`):ae(_,`${Ke(We(r.inventory[l].item.getBaseValue()),!0)}`)}}}),Object.keys(r.equipment).forEach(l=>{if(!se[l]&&r.equipment[l]){if(r.equipment[l]?.tags.tool)return;se[l]=ei({key:l,target:"character",is_equipped:!0,is_trade:n}),ea.appendChild(se[l]),s=!0}});for(let l=0;l<L.items.length;l++){let d=L.items[l].item_key;if(!Ci[d])Ci[d]=ei({target:"character",trade_index:l,is_trade:n}),ea.appendChild(Ci[d]);else{let u=se[d]?.dataset.item_count??0,h=L.items[l].count;u!==h&&(h>1?Ci[d].getElementsByClassName("item_count")[0].innerText=` x${h}`:Ci[d].getElementsByClassName("item_count")[0].innerText="")}}}s&&!o&&Aa({target:"character",sort_by:i,direction:a})}function ho({item_key:e,sorting_direction:t="asc",was_anything_new_added:i=!1}={}){if(e||Object.keys(kt).forEach(a=>{dt.inventory[a]||(kt[a].remove(),delete kt[a])}),e){let a=dt.inventory[e].count;kt[e].remove(),delete kt[e],kt[e]=ei({key:e,item_count:a,target:"storage"}),Un.appendChild(kt[e]),i=!0}else Object.keys(dt.inventory).forEach(a=>{let s=dt.inventory[a].count;if(!kt[a])kt[a]=ei({key:a,item_count:s,target:"storage"}),Un.appendChild(kt[a]),i=!0;else{let n=Number.parseInt(kt[a].getElementsByClassName("item_count")[0].innerText.replace("x",""));Number.isNaN(n)&&(n=0),n!=s&&(s>1?kt[a].getElementsByClassName("item_count")[0].innerText=` x${s}`:kt[a].getElementsByClassName("item_count")[0].innerText="")}});!e&&i&&Aa({target:"storage",direction:t})}function Hl(){oe.style.display="",Zl.style.display="none"}function ei({key:e,item_count:t,target:i,is_equipped:a,trade_index:s,is_trade:n=!1}){let o=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div");u.classList.add("item_additional_content");let h,_,w,b={},g=1;if(i==="trader"?(b.trader=!0,g=F[Ye].getProfitMargin(x.market_region)||g):i==="storage"&&(b.storage=!0),a)h=r.equipment[e],e=h.getInventoryKey(),t=t??1,w="equipped_item",_="character_item";else if(w="inventory_item",i==="character")typeof s>"u"?(h=r.inventory[e].item,t=t||r.inventory[e].count):(h=F[Ye].inventory[L.items[s].item_key].item,t=t||L.items[s].count),_="character_item";else if(i==="trader")typeof s>"u"?(h=F[Ye].inventory[e].item,t=t||F[Ye].inventory[e].count):(h=r.inventory[P.items[s].item_key].item,t=t||P.items[s].count),_="trader_item";else if(i==="storage")h=dt.inventory[e].item,t=t||dt.inventory[e].count,_="storage_item";else throw new Error(`"${i}" is not a correct inventory owner`);"quality"in h&&(o.dataset.item_quality=h.quality),De(d);let v="";if(h.tags?.equippable?(h.tags.tool?v=`<span class = "item_slot" >[tool]</span> <span>${h.getName()}</span>`:v=`<span class = "item_slot" >[${h.equip_slot}]</span> <span>${h.getName()}</span>`,d.classList.add(`${w}_name`),l.appendChild(d),o.classList.add(`${w}_control`,`${_}_control`,`${_}_equippable`),o.appendChild(l),typeof s<"u"?l.classList.add(`${w}`,`${_}`,"trade_item_equippable"):l.classList.add(`${w}`,`${_}`,"item_equippable"),o.dataset.item_slot=h.equip_slot):h.tags.component?(v=`<span class = "item_category">[Comp]</span> <span class="item_name">${h.getName()}</span>`,d.classList.add(`${w}_name`),l.appendChild(d),o.classList.add(`${w}_control`,`${_}_control`,`${_}_component`),o.appendChild(l),l.classList.add(`${w}`,`${_}`,"item_component")):h.tags.book?(v=`<span class = "item_category">[Book]</span> <span class = "book_name item_name">"${h.name}"</span>`,d.classList.add(`${w}`),V[h.name].is_finished?l.classList.add("book_finished"):No()===h.name&&o.classList.add("book_active")):v=`<span class = "item_category"></span> <span class = "item_name">${h.getName()}</span>`,t>1?v+=`<span class="item_count"> x${t}</span>`:v+='<span class="item_count"></span>',j(d,v),d.classList.add(`${w}_name`),i==="character"){let I=document.createElement("div");I.classList.add("item_fav_div");let $=document.createElement("i");$.classList.add("material-icons","item_fav_icon"),typeof s>"u"&&(gi[e]?($.innerText="star",o.classList.add("character_item_faved")):$.innerText="star_border"),I.appendChild($),l.appendChild(I)}if(l.appendChild(d),l.classList.add(`${w}`,`${_}`,`item_${h.item_type.toLowerCase()}`),l.appendChild(oa(h,b,n)),o.classList.add(`${w}_control`,`${_}_control`,`${_}_${h.item_type.toLowerCase()}`),o.setAttribute(`data-${_}`,`${h.getInventoryKey()}`),o.setAttribute("data-item_count",`${t}`),o.setAttribute("data-item_value",`${h.getBaseValue()}`),o.appendChild(l),i==="character"){if(h.item_type==="USABLE"){let I=document.createElement("div");I.classList.add("item_use_button"),I.innerText="[use]";let $=document.createElement("div");$.classList.add("item_auto_use_button"),$.innerText="auto",Vt[h.id]&&$.classList.add("item_auto_use_button_active"),u.appendChild(I),u.appendChild($)}else if(h.item_type==="BOOK"){let I=document.createElement("div");I.classList.add("item_use_button"),I.innerText="[read]",u.appendChild(I),l.classList.add("item_book")}if(typeof s>"u"&&h.tags.equippable)if(a){let I=document.createElement("div");j(I,"[take off]"),I.classList.add("unequip_item_button","item_controls"),u.appendChild(I)}else{let I=document.createElement("span");j(I,"[equip]"),I.classList.add("equip_item_button","item_controls"),u.appendChild(I)}}let y=document.createElement("span");return y.classList.add("item_value","item_controls"),h.tags.unsellable?(o.setAttribute("data-unsellable","true"),De(y)):(u.appendChild($u()),j(y,`${Ke(We(h.getValue({region:x?.market_region,multiplier:g})),!0)}`)),u.appendChild(y),o.appendChild(u),typeof s<"u"&&o.classList.add("item_to_trade"),o}function Pi(){Object.keys(Bi).forEach(function(e){let t;r.equipment[e]==null?(t=document.createElement("span"),t.classList.add("item_tooltip"),ae(Bi[e],`${e.replace("_"," ")} slot`),Bi[e].classList.add("equipment_slot_empty"),ae(t,`Your ${e.replace("_"," ")} slot`)):(ae(Bi[e],r.equipment[e].getName()),Bi[e].classList.remove("equipment_slot_empty"),t=oa(r.equipment[e])),Bi[e].appendChild(t)})}function ts(e,t){t?(e.children[0].innerText="star",e.parentNode.parentNode.classList.add("character_item_faved")):(e.children[0].innerText="star_border",e.parentNode.parentNode.classList.remove("character_item_faved"))}function is(e){let t=c[e],i=t.getInventoryKey();V[t.name].is_finished?(se[i].classList.add("book_finished"),se[i].classList.remove("book_active")):No()===t.name?se[i].classList.add("book_active"):se[i].classList.remove("book_active"),se[i].getElementsByClassName("item_tooltip")[0].remove(),se[i].getElementsByClassName("item_book")[0].appendChild(oa(t))}function Ca(){for(let e=0;e<8;e++)if(e<H.length){ot.children[e].children[0].style.display=null,ae(ot.children[e].children[0].children[0],H[e].name);let t;H[e].stats.attack_speed>20?t=Math.round(H[e].stats.attack_speed):H[e].stats.attack_speed>2?t=Math.round(H[e].stats.attack_speed*10)/10:t=Math.round(H[e].stats.attack_speed*100)/100;let i=H.filter(d=>d.is_alive).length**(-1/4),a=H.filter(d=>d.is_alive).length**(-1/3),s=H[e];Object.keys(s.tags).forEach(d=>{if(Gt[d])for(let u=0;u<Gt[d].length;u++){let h=f[Gt[d][u]],{modifier_to_hit_chance:_,modifier_to_evasion:w}=h.get_stat_modifiers();i*=_||1,a*=w||1}});let n=1-ga(r.stats.full.attack_points*i,H[e].stats.agility*Math.sqrt(H[e].stats.intuition??1)),o=ga(H[e].stats.dexterity*Math.sqrt(H[e].stats.intuition??1),r.stats.full.evasion_points*a);r.equipment["off-hand"]?.offhand_type==="shield"&&(o=1);let l=`Atk: ${H[e].stats.attack}dmg`;H[e].stats.attack_count>1&&(l+=` x${H[e].stats.attack_count}`),ot.children[e].children[0].children[1].children[0].innerText=l,ot.children[e].children[0].children[1].children[1].innerText=`Spd: ${t}`,ot.children[e].children[0].children[1].children[2].innerText=`Hit: ${Math.min(100,Math.max(0,Math.round(100*o)))}%`,ot.children[e].children[0].children[1].children[3].innerText=`Ddg: ${Math.min(100,Math.max(0,Math.round(100*n)))}%`,ot.children[e].children[0].children[1].children[4].innerText=`Def: ${H[e].stats.defense}`}else ot.children[e].children[0].style.display="none"}function _o(){for(let e=0;e<H.length;e++)H[e].is_alive?ot.children[e].children[0].style.filter="brightness(100%)":(ot.children[e].children[0].style.filter="brightness(30%)",Ca()),ot.children[e].children[0].children[2].children[0].children[0].style.width=Math.max(0,100*H[e].stats.health/H[e].stats.max_health)+"%",ot.children[e].children[0].children[2].children[1].innerText=`${Math.ceil(H[e].stats.health)}/${Math.ceil(H[e].stats.max_health)} hp`}function as(e){if(sa(),De(Xn),ar.style.display="none",ao.innerText="",document.documentElement.style.setProperty("--location_desc_tooltip_visibility","hidden"),Kn.style.display="none",Jn.style.display="none",document.documentElement.style.setProperty("--actions_div_height",getComputedStyle(document.body).getPropertyValue("--actions_div_height_default")),document.documentElement.style.setProperty("--actions_div_top",getComputedStyle(document.body).getPropertyValue("--actions_div_top_default")),nr.click(),Wi.style.pointerEvents="none",Wi.style.cursor="default",Wi.style.color="gray",er.innerText=x.name,document.getElementById("location_description_div").innerText=x.getDescription(),dn(e),Ie.is_crafting_unlocked&&e.crafting?.is_unlocked){let u=document.createElement("div");u.classList.add("location_choices","choice_craft"),u.setAttribute("onclick","openCraftingWindow()"),j(u,`<i class="material-icons">construction</i> ${e.crafting.use_text}`),oe.appendChild(u)}if(e.housing?.is_unlocked){let u=document.createElement("div");j(u,'<i class="material-icons">bed</i>  '+e.housing.text_to_sleep),u.id="start_sleeping_div",u.setAttribute("onclick","start_sleeping()");let h=document.createElement("div");j(h,'<i class="material-icons">inventory_2</i>  Open your personal chest'),h.id="open_storage_div",h.setAttribute("onclick","openStorage()"),oe.appendChild(u),oe.appendChild(h)}e.dialogues.filter(u=>{if(!q[u].is_unlocked||q[u].is_finished)return!1;{let h=!1;return Object.keys(q[u].textlines).forEach(_=>{h||(h=q[u].textlines[_].is_unlocked&&!q[u].textlines[_].is_finished)}),h}}).length>0&&(Ae.dialogues=mi({name:"Talk to someone",icon:"question_answer",class_name:"choice_dialogue"}),Ae.dialogues.append(...Zt({location:e,category:"talk"}))),e.traders.filter(u=>F[u].is_unlocked&&!F[u].is_finished).length>0&&(Ae.traders=mi({name:"Visit a merchant",icon:"storefront",class_name:"choice_trade"}),Ae.traders.append(...Zt({location:e,category:"trade"}))),Object.values(e.activities).filter(u=>A[u.activity_name].type==="JOB"&&A[u.activity_name].is_unlocked&&u.is_unlocked&&A[u.activity_name].base_skills_names.filter(h=>!f[h].is_unlocked).length==0).length>0&&(Ae.jobs=mi({name:"Find work",icon:"work_outline",class_name:"choice_work"}),Ae.jobs.append(...Zt({location:e,category:"work"}))),Object.values(e.activities).filter(u=>A[u.activity_name].type==="TRAINING"&&A[u.activity_name].is_unlocked&&u.is_unlocked&&A[u.activity_name].base_skills_names.filter(h=>!f[h].is_unlocked).length==0).length>0&&(Ae.trainings=mi({name:"Train",icon:"fitness_center",class_name:"choice_train"}),Ae.trainings.append(...Zt({location:e,category:"train"}))),Ie.is_gathering_unlocked&&Object.values(e.activities).filter(h=>A[h.activity_name].type==="GATHERING"&&A[h.activity_name].is_unlocked&&h.is_unlocked&&A[h.activity_name].base_skills_names.filter(_=>!f[_].is_unlocked).length==0).length>0&&(Ae.gatherings=mi({name:"Gather resources",icon:"search",class_name:"choice_gather"}),Ae.gatherings.append(...Zt({location:e,category:"gather"}))),Object.values(e.actions).filter(u=>u.is_unlocked&&!u.is_finished).length>0&&(Ae.actions=mi({name:"Take an action",icon:"circle",class_name:"choice_action"}),Ae.actions.append(...Zt({location:e,category:"action"}))),e.connected_locations.filter(u=>u.location.is_unlocked&&!u.location.is_finished&&!u.location.is_challenge).length>0&&(Ae.locations=mi({name:"Move somewhere else",icon:"directions",class_name:"choice_travel"}),Ae.locations.append(...Zt({location:e,category:"travel"}))),e.connected_locations.filter(u=>u.location.is_challenge&&u.location.is_unlocked&&!u.location.is_finished).length>0&&(Ae.challenges=mi({name:"Take on a challenge",icon:"warning_amber",class_name:"choice_travel"}),Ae.challenges.append(...Zt({location:e,category:"challenge"}))),[...Object.keys(ut).filter(u=>u!==x.id),...Object.keys(Pa).filter(u=>u!==x.id&&m[u].is_unlocked&&!m[u].is_finished)].length+(Lt?1:0)>0&&(Ae.fast_travel=mi({name:"Fast travel",icon:"directions",class_name:"choice_travel"}),Ae.fast_travel.append(...Zt({location:e,category:"fast_travel"}))),oe.append(...Object.values(Ae))}function dn(){x.housing&&x.housing.is_unlocked?ae(Ys,'<i class="material-icons location_bed_icon">bed</i>'):ut[x.id]?ae(Ys,'<i class="material-icons">star</i>'):ae(Ys,'<i class="material-icons">star_border</i>')}function mi({name:e,icon:t,class_name:i}){let a=document.createElement("div");return j(a,`<i class="material-icons">${t}</i> ${e}`),a.classList.add("location_choice_dropdown",i),a.addEventListener("click",s=>{let n=s.target;n.classList.contains("material-icons")&&(n=n.parentNode),n.classList.contains("location_choice_dropdown")&&(n.classList.toggle("location_choice_dropdown_expanded"),n.classList.contains("location_choice_dropdown_expanded")&&n.scrollIntoView({block:"end",inline:"nearest",behavior:"smooth"}))}),a}function Zt({location:e,category:t,is_combat:i=!1}){let a=[];if(t==="talk")for(let s=0;s<e.dialogues.length;s++){if(!q[e.dialogues[s]].is_unlocked||q[e.dialogues[s]].is_finished||!(e.dialogues.filter(l=>{let d=!1;return Object.keys(q[l].textlines).forEach(u=>{d||(d=q[l].textlines[u].is_unlocked&&!q[l].textlines[u].is_finished)}),d}).length>0))continue;let o=document.createElement("div");j(o,'<i class="material-icons location_choice_icon">check_box_outline_blank</i> '+q[e.dialogues[s]].getStartingText({is_mofu_mofu_enabled:Ie.is_mofu_mofu_enabled})),o.classList.add("start_dialogue","location_choice"),o.setAttribute("data-dialogue",e.dialogues[s]),o.setAttribute("onclick","start_dialogue(this.getAttribute('data-dialogue'));"),a.push(o)}else if(t==="trade")for(let s=0;s<e.traders.length;s++){if(!F[e.traders[s]].is_unlocked||F[e.traders[s]].is_finished)continue;let n=document.createElement("div");j(n,'<i class="material-icons location_choice_icon">check_box_outline_blank</i> '+F[e.traders[s]].trade_text),n.classList.add("start_trade","location_choice"),n.setAttribute("data-trader",e.traders[s]),n.setAttribute("onclick","startTrade(this.getAttribute('data-trader'));"),a.push(n)}else if(t==="work")Object.keys(e.activities).forEach(s=>{if(!A[e.activities[s].activity_name]?.is_unlocked||!e.activities[s]?.is_unlocked||A[e.activities[s].activity_name].type!=="JOB")return;let n=document.createElement("div");n.classList.add("activity_div","location_choice"),n.setAttribute("data-activity",s),n.setAttribute("onclick","start_activity(this.getAttribute('data-activity'));"),na(e.activities[s])?n.classList.add("start_activity"):n.classList.add("activity_unavailable");let o=document.createElement("div"),l="";if(o.classList.add("job_tooltip"),!e.activities[s].infinite&&(e.activities[s].availability_time&&(l=`Available from ${e.activities[s].availability_time.start} to ${e.activities[s].availability_time.end} <br>`),e.activities[s].availability_seasons))if(e.activities[s].availability_seasons.length===3){let d=xi.filter(u=>!e.activities[s].availability_seasons.includes(u));l+=`Not available during ${d.toString().replaceAll(",",", ")} <br>`}else l+=`Available during ${e.activities[s].availability_seasons.toString().replaceAll(",",", ")} <br>`;l+=`Pays ${Ke(e.activities[s].get_payment())} per every ${Ua(e.activities[s].gathering_time_needed)} worked`,j(o,l),n.appendChild(o),j(n,'<i class="material-icons location_choice_icon">check_box_outline_blank</i> '+e.activities[s].starting_text),a.push(n)});else if(t==="train")Object.keys(e.activities).forEach(s=>{if(!A[e.activities[s].activity_name]?.is_unlocked||!e.activities[s]?.is_unlocked||A[e.activities[s].activity_name].type!=="TRAINING"||A[e.activities[s].activity_name].base_skills_names.filter(o=>!f[o].is_unlocked).length>0)return;let n=document.createElement("div");if(n.classList.add("activity_div","start_activity","location_choice"),n.setAttribute("data-activity",s),n.setAttribute("onclick","start_activity(this.getAttribute('data-activity'));"),e.activities[s].availability_seasons){let o=document.createElement("div");if(o.classList.add("job_tooltip"),e.activities[s].availability_seasons.length===3){let l=xi.filter(d=>!e.activities[s].availability_seasons.includes(d));j(o,`Not available during ${l.toString().replaceAll(",",", ")} <br>`)}else j(o,`Available during ${e.activities[s].availability_seasons.toString().replaceAll(",",", ")} <br>`);n.appendChild(o)}j(n,'<i class="material-icons location_choice_icon">check_box_outline_blank</i> '+e.activities[s].starting_text),a.push(n)});else if(t==="gather")Object.keys(e.activities).forEach(s=>{if(!A[e.activities[s].activity_name]?.is_unlocked||!e.activities[s]?.is_unlocked||A[e.activities[s].activity_name].type!=="GATHERING"||A[e.activities[s].activity_name].base_skills_names.filter(o=>!f[o].is_unlocked).length>0)return;let n=document.createElement("div");n.classList.add("activity_div","start_activity","location_choice"),n.setAttribute("data-activity",s),n.setAttribute("onclick","start_activity(this.getAttribute('data-activity'));"),na(e.activities[s])?n.classList.add("start_activity"):n.classList.add("activity_unavailable"),n.appendChild(kr(e.activities[s])),j(n,'<i class="material-icons location_choice_icon">check_box_outline_blank</i> '+e.activities[s].starting_text),a.push(n)});else if(t==="travel"){if(i){let s=document.createElement("div"),n="";s.classList.add("travel_normal","action_travel","location_choice");let o=qi({time:{minutes:Bt[e.id][e.parent_location.id]}}),l="";o&&(l=" ["+o+"]"),e.leave_text?n=e.leave_text+l:n="Go back to ["+e.parent_location.name+"]"+l,j(s,n),s.setAttribute("data-travel",e.parent_location.id),s.setAttribute("onclick","change_location({location_id:this.getAttribute('data-travel')});"),a.push(s)}else for(let s=0;s<e.connected_locations.length;s++){if(!e.connected_locations[s].location.is_unlocked||e.connected_locations[s].location.is_finished||e.connected_locations[s].location.is_challenge)continue;let n=document.createElement("div"),o="",l=qi({time:{minutes:Bt[e.id][e.connected_locations[s].location.id]}});"connected_locations"in e.connected_locations[s].location?(n.classList.add("travel_normal"),"custom_text"in e.connected_locations[s]?o=`<div class='location_choice_icon_box'><i class="material-icons location_choice_icon">check_box_outline_blank</i></div> `+e.connected_locations[s].custom_text+" ["+l+"]":o=`<div class='location_choice_icon_box'><i class="material-icons location_choice_icon">check_box_outline_blank</i></div> Go to [`+e.connected_locations[s].location.name+"] ["+l+"]"):(n.classList.add("travel_combat"),"custom_text"in e.connected_locations[s]?o=`<div class='location_choice_icon_box'><i class="material-icons">warning_amber</i></div> `+e.connected_locations[s].custom_text+" ["+l+"]":o=`<div class='location_choice_icon_box'><i class="material-icons">warning_amber</i></div>  Enter the [`+e.connected_locations[s].location.name+"] ["+l+"]"),j(n,o),n.classList.add("action_travel","location_choice"),n.setAttribute("data-travel",e.connected_locations[s].location.id),n.setAttribute("onclick","change_location({location_id: this.getAttribute('data-travel')});"),a.push(n)}if(ti&&!e.housing?.is_unlocked&&!e.connected_locations){let s=m[ti],n=document.createElement("div"),o="";n.classList.add("action_travel","travel_normal","location_choice");let l=qi({time:{minutes:Bt[e.id][s.id]}});i||(o+='<i class="material-icons location_choice_icon">check_box_outline_blank</i> '),l?o+=`Quick return to [${s.name}] [`+l+"]":o+=`Quick return to [${s.name}]`,j(n,o),n.setAttribute("data-travel",s.name),n.setAttribute("onclick","change_location({location_id:this.getAttribute('data-travel')});"),a.push(n)}a.sort((s,n)=>n.classList.contains("travel_normal")-s.classList.contains("travel_normal"))}else if(t==="challenge"){let s=e.connected_locations.filter(n=>n.location.is_challenge&&n.location.is_unlocked&&!n.location.is_finished);for(let n=0;n<s.length;n++){let o=document.createElement("div"),l="";o.classList.add("travel_combat","location_choice"),"custom_text"in s[n]?l='<i class="material-icons">warning_amber</i>  '+s[n].custom_text:l='<i class="material-icons">warning_amber</i>  Enter the '+s[n].location.name,j(o,l),o.classList.add("action_travel"),o.setAttribute("data-travel",s[n].location.id),o.setAttribute("onclick","change_location({location_id:this.getAttribute('data-travel')});"),a.push(o)}}else t==="action"?Object.keys(e.actions).forEach(s=>{if(e.actions[s].is_finished||!e.actions[s].is_unlocked)return;let n=document.createElement("div");n.classList.add("location_action_div","start_game_action","location_choice"),n.setAttribute("data-location_action",s),n.setAttribute("onclick","start_game_action(this.getAttribute('data-location_action'));"),n.appendChild(Mu(e.actions[s])),j(n,'<i class="material-icons location_choice_icon">check_box_outline_blank</i> '+e.actions[s].starting_text),a.push(n)}):t==="fast_travel"&&(a=Eu());return a}function Eu(){let e=[],t=[...Object.keys(ut).filter(i=>i!==x.id),...Object.keys(Pa).filter(i=>i!==x.id&&m[i].is_unlocked&&!m[i].is_finished)];Lt&&!t.includes(Lt)&&t.push(Lt),t=t.sort((i,a)=>m[i].housing?.is_unlocked&&!m[a].housing?.is_unlocked?-1:!m[i].housing?.is_unlocked&&m[a].housing?.is_unlocked?1:m[i].tags.safe_zone&&!m[a].tags.safe_zone?-1:!m[i].tags.safe_zone&&m[a].tags.safe_zone?1:0);for(let i=0;i<t.length;i++){if(!m[t[i]].is_unlocked||m[t[i]].is_finished||t[i]===x.id)continue;let a=document.createElement("div"),s="",n=qi({time:{minutes:Bt[x.id][t[i]]}});if(m[t[i]].tags.safe_zone?(a.classList.add("travel_normal"),m[t[i]].housing?.is_unlocked?s='<i class="material-icons">bed</i> <span class="fast_travel_name">Travel to ['+m[t[i]].name+"] ["+n+"]</span>":s='<i class="material-icons location_choice_icon">check_box_outline_blank</i> <span class="fast_travel_name">Travel to ['+m[t[i]].name+"] ["+n+"]</span>",a.classList.add("action_travel","location_choice"),a.setAttribute("data-travel",m[t[i]].id),a.setAttribute("onclick","change_location({location_id:this.getAttribute('data-travel'), event});")):(a.classList.add("travel_combat"),s=`<i class="material-icons">warning_amber</i> <span class="fast_travel_name">Travel to [${m[t[i]].name}] [${n}] </span>`,a.classList.add("action_travel","location_choice"),a.setAttribute("data-travel",m[t[i]].id),a.setAttribute("onclick","change_location({location_id: this.getAttribute('data-travel'), event});")),j(a,s),!m[t[i]].housing?.is_unlocked&&m[t[i]].id!==Lt){let o=document.createElement("span");j(o,'<i class="material-icons fast_travel_removal_button">close</i>'),o.setAttribute("onclick","remove_location_from_favourites({location_id:this.parentNode.getAttribute('data-travel')})"),a.appendChild(o)}e.push(a)}return e}function ns({location_id:e}){if(!Ae.fast_travel)return;let t=Ae.fast_travel.querySelector(`[data-travel="${e}"`);t&&(e===Lt||m[e].housing?.is_unlocked?t.getElementsByClassName("fast_travel_removal_button")[0].parentNode.remove():t.remove())}function cr(e){document.documentElement.style.setProperty("--location_desc_tooltip_visibility","visible"),sa(),De(Xn);let t;dn(e),Jn.style.display="block",Kn.style.display="block",ar.style.display="block",M.disable_combat_autoswitch||(Wi.click(),Wi.classList.add("active_selection_button"),nr.classList.remove("active_selection_button")),Wi.style.pointerEvents="auto",Wi.style.cursor="pointer",Wi.style.color="white",document.documentElement.style.setProperty("--actions_div_height",getComputedStyle(document.body).getPropertyValue("--actions_div_height_combat")),document.documentElement.style.setProperty("--actions_div_top",getComputedStyle(document.body).getPropertyValue("--actions_div_top_combat")),Kn.children[0].children[1].innerText=e.enemy_count-e.enemy_groups_killed%e.enemy_count+" / "+e.enemy_count,Jn.children[0].children[0].innerText="Clears: ["+Math.floor(e.enemy_groups_killed/e.enemy_count)+"]",t=Zt({location:e,category:"travel",is_combat:!0}),oe.append(...t),er.innerText=x.name,x.types.length==0?document.documentElement.style.setProperty("--location_name_div_width","390px"):document.documentElement.style.setProperty("--location_name_div_width","250px"),ao.innerText=x.getDescription(),ao.classList.add("location_tooltip"),document.getElementById("location_description_div").innerText=x.getDescription(),dr(x)}function ur(e){Kn.children[0].children[1].innerText=e.enemy_count-e.enemy_groups_killed%e.enemy_count+" / "+e.enemy_count,Jn.children[0].children[0].innerText="Clears: ["+Math.floor(e.enemy_groups_killed/e.enemy_count)+"]"}function dr(e){for(let t=0;t<e.types?.length;t++){let i=document.createElement("div");j(i,e.types[t].type+(e.types[t].stage>1?` ${"I".repeat(e.types[t].stage)}`:"")),i.classList.add("location_type_div");let a=document.createElement("div"),s=$e[e.types[t].type].stages[e.types[t].stage].description;a.classList.add("location_type_tooltip");let{type:n,stage:o}=e.types[t],{effects:l}=$e[n].stages[o];Object.keys(l||{}).length>0&&(s+="<br>",Object.keys(l).forEach(d=>{if(l[d].multiplier){let u=l[d].multiplier,h=en(n,o,d,"multiplier");s+=`<br>${Je[d]} x${Math.round(1e3*h)/1e3}`,u!=h&&(s+=` [base: x${l[d].multiplier}]`)}if(l[d].flat){let u=l[d].flat,h=en(n,o,d,"flat");s+=`<br>${Je[d]}: ${Math.round(1e3*h)/1e3}`,u!=h&&(s+=` [base: ${l[d].flat}]`)}})),j(a,s),i.appendChild(a),Xn.appendChild(i)}}function mr(e){De(Xn),dr(e)}function hr(){oe.style.display="none",document.getElementById("crafting_window").style.display="block",(!mo||!lo)&&po("crafting"),go()}function _r(){oe.style.display="block",document.getElementById("crafting_window").style.display="none",as(x)}function po(e){mo=e;let t=document.getElementById("crafting_subpage_buttons").children;for(let i=0;i<t.length;i++)t[i].style.display=G[e][t[i].dataset.crafting_subcategory]?"":"none";t[0].click(),fr()}function pr(e){lo=e;let t=document.querySelectorAll("[data-crafting_category][data-crafting_subcategory]");for(let i=0;i<t.length;i++)t[i].dataset.crafting_category==mo&&t[i].dataset.crafting_subcategory==lo?t[i].style.display="":t[i].style.display="none";fr()}function fr(){let e=["selected_recipe","selected_component_list","selected_component_category"];for(let t=0;t<e.length;t++){let i=document.getElementsByClassName(e[t]);for(let a=0;a<i.length;a++)i[a].classList.remove(e[t])}}function gr(e,t){if(it[e]||(it[e]={}),it[e][t]||(it[e][t]=document.querySelector(`[data-crafting_category="${e}"][data-crafting_subcategory="${t}"]`)),!it[e][t]){let i=document.createElement("div");i.classList.add("crafting_category"),i.classList.add("crafting_recipe_list"),i.dataset.crafting_category=e,i.dataset.crafting_subcategory=t,it[e][t]=document.getElementById("recipe_categories").appendChild(i)}return it[e][t]}function fo(){Object.keys(G).forEach(e=>{Object.keys(G[e]).forEach(t=>{t==="items"&&De(gr(e,t)),Object.keys(G[e][t]).forEach(i=>{wr({category:e,subcategory:t,recipe_id:i})})})}),ko()}function wr({category:e,subcategory:t,recipe_id:i}){let a=G[e][t][i];if(!a.is_unlocked)return;let s=document.createElement("div"),n=document.createElement("span");if(n.innerText=a.name,s.append(n),s.classList.add("recipe_div"),s.dataset.recipe_id=i,t==="items"){n.classList.add("recipe_item_name"),ae(s.children[0],'<i class="material-icons icon" style="visibility:hidden"> keyboard_double_arrow_down </i>'+s.children[0].innerText),a.get_availability().available_ammount||s.classList.add("recipe_unavailable"),s.addEventListener("click",h=>{h.target.classList.contains("recipe_item_name")&&!h.target.parentNode.classList.contains("recipe_unavailable")?window.useRecipe(h.target):h.target.classList.contains("craft_ammount_button")&&window.useRecipe(h.target.parentNode,Number(h.target.dataset.craft_ammount))});let o=document.createElement("div");o.classList.add("craft_ammount_buttons");let l=document.createElement("div");l.innerText="5",l.dataset.craft_ammount=5,l.classList.add("craft_ammount_button"),o.append(l);let d=document.createElement("div");d.innerText="10",d.dataset.craft_ammount=10,d.classList.add("craft_ammount_button"),o.append(d);let u=document.createElement("div");u.innerText="all",u.dataset.craft_ammount=1/0,u.classList.add("craft_ammount_button"),o.append(u),s.append(o),s.append(ro({category:e,subcategory:t,recipe_id:i}))}else if(t==="components"){n.classList.add("recipe_name"),ae(s.children[0],'<i class="material-icons icon crafting_dropdown_icon"> keyboard_double_arrow_down </i>'+s.children[0].innerText);let o=document.createElement("div");o.classList.add("folded_material_list"),s.addEventListener("click",l=>{(l.target.classList.contains("recipe_name")||l.target.classList.contains("crafting_dropdown_icon"))&&(window.updateDisplayedMaterialChoice({category:e,subcategory:t,recipe_id:i}),Vn({element:s,class_name:"selected_recipe"}))}),s.append(o)}else if(a.recipe_type==="component"||a.recipe_type==="componentless"){n.classList.add("recipe_name"),a.item_type==="Armor"&&s.classList.add("clothing_recipe"),ae(s.children[0],'<i class="material-icons icon crafting_dropdown_icon"> keyboard_double_arrow_down </i>'+s.children[0].innerText);let o=document.createElement("div");o.classList.add("folded_material_list"),s.addEventListener("click",l=>{(l.target.classList.contains("recipe_name")||l.target.classList.contains("crafting_dropdown_icon"))&&(Dn("selected_component_list"),Dn("selected_component_category"),window.updateDisplayedMaterialChoice({category:e,subcategory:t,recipe_id:i}),Vn({element:s,class_name:"selected_recipe"}))}),s.append(o)}else if(t==="equipment"){a.item_type==="Armor"?s.classList.add("armor_recipe"):a.item_type==="Weapon"?s.classList.add("weapon_recipe"):a.item_type==="Shield"?s.classList.add("shield_recipe"):console.warn(`Recipe "${e}" -> "${t}" -> "${i}" has wrong type of resulting item ("${a.item_type}")`),n.classList.add("recipe_name"),ae(s.children[0],'<i class="material-icons icon crafting_dropdown_icon"> keyboard_double_arrow_down </i>'+s.children[0].innerText);let o=document.createElement("div");ae(o,`<span class="crafting_selection"><i class="material-icons icon subcrafting_dropdown_icon"> keyboard_double_arrow_down </i>Select a [${a.components[0]}]</span>`);let l=document.createElement("div");l.classList.add("folded_crafting_selection"),o.appendChild(l);let d=document.createElement("div");ae(d,`<span class="crafting_selection"><i class="material-icons icon subcrafting_dropdown_icon"> keyboard_double_arrow_down </i>Select a [${a.components[1]}]</span>`);let u=document.createElement("div");u.classList.add("folded_crafting_selection"),d.appendChild(u);let h=document.createElement("div");h.append(o),h.append(d),s.addEventListener("click",y=>{(y.target.classList.contains("recipe_name")||y.target.classList.contains("crafting_dropdown_icon"))&&(Dn("selected_component_list"),Dn("selected_component_category"),Vn({element:s,class_name:"selected_recipe"}),window.updateDisplayedComponentChoice({category:e,subcategory:t,recipe_id:i}),aa({category:e,subcategory:t,recipe_id:i,components:[]}))}),o.parentNode.children[0].addEventListener("click",y=>{(y.target.classList.contains("crafting_selection")||y.target.classList.contains("subcrafting_dropdown_icon"))&&(o.children[1].classList.toggle("selected_component_list"),o.children[0].classList.toggle("selected_component_category"),s.querySelectorAll(".folded_crafting_selection").item(0).lastChild&&!uo(s.querySelectorAll(".folded_crafting_selection").item(0).lastChild,document.getElementById("exit_crafting_button"))&&s.querySelectorAll(".folded_crafting_selection").item(0).lastChild.scrollIntoView({block:"end",inline:"nearest"}))}),d.parentNode.children[1].addEventListener("click",y=>{(y.target.classList.contains("crafting_selection")||y.target.classList.contains("subcrafting_dropdown_icon"))&&(d.children[1].classList.toggle("selected_component_list"),d.children[0].classList.toggle("selected_component_category"),uo(s.querySelector(".recipe_creation_button"),document.getElementById("exit_crafting_button"))||s.querySelector(".recipe_creation_button").scrollIntoView({block:"end",inline:"nearest"}))});let _=document.createElement("div");j(_,"<span class='recipe_creation_span'>Create</span>"),_.classList.add("recipe_creation_button");let w=document.createElement("div");w.classList.add("craft_ammount_buttons");let b=document.createElement("div");b.innerText="5",b.dataset.craft_ammount=5,b.classList.add("craft_ammount_button"),w.append(b);let g=document.createElement("div");g.innerText="10",g.dataset.craft_ammount=10,g.classList.add("craft_ammount_button"),w.append(g);let v=document.createElement("div");v.innerText="all",v.dataset.craft_ammount=1/0,v.classList.add("craft_ammount_button"),w.append(v),_.append(w),_.addEventListener("click",y=>{y.target.classList.contains("recipe_creation_button")?window.useRecipe(y.target):y.target.classList.contains("craft_ammount_button")?window.useRecipe(y.target.parentNode.parentNode,Number(y.target.dataset.craft_ammount)):window.useRecipe(y.target.parentNode)}),s.append(h),s.append(_),_.append(ro({category:e,subcategory:t,recipe_id:i,components:[]}))}else throw new Error(`No such crafting subcategory as "${t}"`);gr(e,t).appendChild(s)}function go(){Object.keys(G).forEach(e=>{Object.keys(G[e]).forEach(t=>{Object.keys(G[e][t]).forEach(i=>{G[e][t][i].is_unlocked&&(it[e][t].querySelector(`[data-recipe_id="${i}"]`)?Tu({category:e,subcategory:t,recipe_id:i}):wr({category:e,subcategory:t,recipe_id:i}))})})})}function Tu({category:e,subcategory:t,recipe_id:i}){let a=it[e][t].querySelector(`[data-recipe_id="${i}"]`),s=G[e][t][i];t==="items"?(s.get_availability().available_ammount?a.classList.remove("recipe_unavailable"):a.classList.add("recipe_unavailable"),aa({category:e,subcategory:t,recipe_id:i})):t==="components"||s.recipe_type==="component"?aa({category:e,subcategory:t,recipe_id:i}):t==="equipment"||console.error(`No such crafting subcategory as "${t}"`)}function ro({category:e,subcategory:t,recipe_id:i,material:a,components:s}){let n=G[e][t][i],o=document.createElement("div");if(o.classList.add("recipe_tooltip"),t==="items")j(o,Ma({category:e,subcategory:t,recipe_id:i})),o.classList.add("items_recipe_tooltip");else if(t==="components"||n.recipe_type==="component"){if(!a)throw new Error(`Component recipes require passing a material, but recipe "${e}" -> "${t}" -> "${i}" had none!`);j(o,Ma({category:e,subcategory:t,recipe_id:i,material:a})),o.classList.add("component_recipe_tooltip")}else t==="equipment"?(j(o,Ma({category:e,subcategory:t,recipe_id:i,material:a,components:s})),o.classList.add("equipment_recipe_tooltip")):console.error(`No such crafting subcategory as "${t}"`);return o}function yr(){Object.keys(G).forEach(e=>{Object.keys(G[e]).forEach(t=>{t==="items"&&Object.keys(G[e][t]).forEach(i=>{G[e][t][i].is_unlocked&&aa({category:e,subcategory:"items",recipe_id:i})})})})}function aa({category:e,subcategory:t,recipe_id:i,components:a}){let s=G[e][t][i];if(t==="items"){let n=it[e][t].querySelector(`[data-recipe_id="${i}"]`).querySelector(`.${t}_recipe_tooltip`);j(n,Ma({category:e,subcategory:t,recipe_id:i}))}else if(t==="components"||s.recipe_type==="component"||s.recipe_type==="componentless"){let n=it[e][t].querySelector(`[data-recipe_id='${i}']`).children[1];for(let o=0;o<n.children.length;o++){let l=n.children[o].querySelector(`[data-recipe_id="${i}"]`)?.querySelector(`.${t}_recipe_tooltip`);if(!l)return;let d=n.children[o].dataset.item_key,{id:u}=JSON.parse(d),h=s.materials.filter(_=>_.material_id===u);j(l,Ma({category:e,subcategory:t,recipe_id:i,material:h[0]}))}}else if(t==="equipment"){let n=it[e][t].querySelector(`[data-recipe_id="${i}"]`)?.querySelector(`.${t}_recipe_tooltip`);if(!n)return;j(n,Ma({category:e,subcategory:t,recipe_id:i,components:a}))}else console.error(`No such crafting subcategory as "${t}"`)}function Ma({category:e,subcategory:t,recipe_id:i,material:a,components:s}){let n=G[e][t][i],o=x?.crafting?.tiers[e]||1,l="";if(t==="items"){let d=Math.round(100*n.get_success_chance(o));l+=`Success chance: <b><span style="color:${d>74?"lime":d>49?"yellow":d>24?"orange":"red"}">${d}%</span></b><br><br>Materials required:<br>`;for(let h=0;h<n.materials.length;h++)if(n.materials[h].material_id){let _=c[n.materials[h].material_id].getInventoryKey();r.inventory[_]?.count>=n.materials[h].count?l+=`<span style="color:lime"><b>${c[n.materials[h].material_id].getName()} x${r.inventory[_]?.count||0}/${n.materials[h].count}</b></span><br>`:l+=`<span style="color:red"><b>${c[n.materials[h].material_id].getName()} x${r.inventory[_]?.count||0}/${n.materials[h].count}</b></span><br>`}else if(n.materials[h].material_type){let _=[];Object.keys(r.inventory).forEach(g=>{r.inventory[g].item.material_type===n.materials[h].material_type&&_.push(r.inventory[g])}),_=_.sort((g,v)=>g.item.getBaseValue()-v.item.getBaseValue());let w=!1,b="";for(let g=0;g<_.length;g++)_[g].count>=n.materials[h].count?(w=!0,b+=`<span style="color:lime"><b>${_[g].item.getName()} x${_[g].count||0}/${n.materials[h].count}</b></span><br>`):b+=`<span style="color:red"><b>${_[g].item.getName()} x${_[g].count||0}/${n.materials[h].count}</b></span><br>`;_.length>0?(w?l+=`<span style="color:lime"><b>Any ${n.materials[h].material_type} x${n.materials[h].count}:</b></span><br>`:l+=`<span style="color:red"><b>Any ${n.materials[h].material_type} x${n.materials[h].count}:</b></span><br>`,l+=`<div class="crafting_tooltip_mat_list">${b}</div>`):l+=`<span style="color:red"><b>Any ${n.materials[h].material_type} x${n.materials[h].count}:</b></span><br>`}let u=It({category:e,subcategory:t,recipe_id:i});l+=`<br>XP value: ${u}`,l+=`<br>Result:<br><div class="recipe_result">${Ta({item:c[n.getResult().result_id],options:{skip_quality:!0,anchor_tooltip:!0}})}</div>`}else if(t==="components"||n.recipe_type==="component"){l+="Material required:<br>",r.inventory[c[a.material_id].getInventoryKey()]?.count>=a.count?l+=`<span style="color:lime"><b>${c[a.material_id].getName()} x${r.inventory[c[a.material_id].getInventoryKey()]?.count||0}/${a.count}</b></span><br>`:l+=`<span style="color:red"><b>${c[a.material_id].getName()} x${r.inventory[c[a.material_id].getInventoryKey()]?.count||0}/${a.count}</b></span><br>`;let d=n.get_quality_range(o-c[a.result_id].component_tier),u=It({category:e,subcategory:t,recipe_id:i,material_count:a.count,result_tier:c[a.result_id].component_tier,rarity_multiplier:Ee[at(d[0])]}),h=It({category:e,subcategory:t,recipe_id:i,material_count:a.count,result_tier:c[a.result_id].component_tier,rarity_multiplier:Ee[at(d[1])]});l+=`<br>XP value: ${u} - ${h}<br>`,l+=`<br>Result:<br><div class="recipe_result">${Ta({item:c[a.result_id],options:{quality:d}})}</div>`}else if(t==="equipment")if(s)if(s.length<2)l+='Result:<br><div class="recipe_result">Select one component from each category</div>';else if(s.length==2){let d="";if(n.item_type==="Weapon")d=new Me({components:{head:s[0].item.id,handle:s[1].item.id}});else if(n.item_type==="Armor")d=new N({components:{internal:s[0].item.id,external:s[1].item.id}});else if(n.item_type==="Shield")d=new Ue({components:{shield_base:s[0].item.id,handle:s[1].item.id}});else throw new Error(`Recipe "${e}" -> "${t}" -> "${i}" has an incorrect item type "${n.item_type}"`);let u=n.get_quality_range(n.get_component_quality_weighted(s[0].item,s[1].item),o-Math.max(s[0].item.component_tier,s[1].item.component_tier)||0),h=It({category:e,subcategory:t,recipe_id:i,selected_components:[c[s[0].item.id],c[s[1].item.id]],rarity_multiplier:Ee[at(u[0])]}),_=It({category:e,subcategory:t,recipe_id:i,selected_components:[c[s[0].item.id],c[s[1].item.id]],rarity_multiplier:Ee[at(u[1])]});l+=`<br>XP value: ${h} - ${_}<br>`,l+=`Result:<br><div class="recipe_result">${Ta({item:d,options:{quality:u}})}</div>`}else throw new Error(`Somehow recipe "${e}" -> "${t}" -> "${i}" received more components than there should be (${s.length} instead of 2)`);else{l+="Material required:<br>",r.inventory[c[a.material_id].getInventoryKey()]?.count>=a.count?l+=`<span style="color:lime"><b>${c[a.material_id].getName()} x${r.inventory[c[a.material_id].getInventoryKey()]?.count||0}/${a.count}</b></span><br>`:l+=`<span style="color:red"><b>${c[a.material_id].getName()} x${r.inventory[c[a.material_id].getInventoryKey()]?.count||0}/${a.count}</b></span><br>`;let d=n.get_quality_range(o-c[a.result_id].item_tier),u=It({category:e,subcategory:t,recipe_id:i,material_count:a.count,result_tier:c[a.result_id].item_tier,rarity_multiplier:Ee[at(d[0])]}),h=It({category:e,subcategory:t,recipe_id:i,material_count:a.count,result_tier:c[a.result_id].item_tier,rarity_multiplier:Ee[at(d[1])]});l+=`<br>XP value: ${u} - ${h}<br>`,l+=`<br>Result:<br><div class="recipe_result">${Ta({item:c[a.result_id],options:{quality:d}})}</div>`}else console.error(`No such crafting subcategory as "${t}"`);return l}function wo({category:e,recipe_id:t,component_keys:i={}}){let a=it[e].equipment.querySelector(`[data-recipe_id="${t}"]`),s=G[e].equipment[t],n=it[e].equipment.querySelector(`[data-recipe_id='${t}']`).children[1].children;De(n[0].children[1]),De(n[1].children[1]);let o=[];o.push(Object.values(r.inventory).filter(l=>s.components[0]===l.item.component_type)),o.push(Object.values(r.inventory).filter(l=>s.components[1]===l.item.component_type));for(let l=0;l<2;l++)for(let d=0;d<o[l].length;d++){let u=document.createElement("div");j(u,`<i class="material-icons icon selected_component_icon"> check </i>${o[l][d].item.name}, ${o[l][d].item.quality}%, x${o[l][d].count}`),u.classList.add("selectable_component"),u.dataset.item_key=o[l][d].item.getInventoryKey(),u.dataset.item_quality=o[l][d].item.quality,u.dataset.item_name=o[l][d].item.getName(),u.dataset.component_tier=o[l][d].item.component_tier,u.appendChild(oa(o[l][d].item,{class_name:"recipe_tooltip"})),u.addEventListener("click",()=>{Vn({element:u,siblings_only:!0,class_name:"selected_component"});let h=[],_=a.children[1].children[0].children[1].querySelector(".selected_component")?.dataset.item_key;_&&h.push(r.inventory[_]);let w=a.children[1].children[1].children[1].querySelector(".selected_component")?.dataset.item_key;w&&h.push(r.inventory[w]),aa({category:e,subcategory:"equipment",recipe_id:t,components:h})}),n[l].children[1].appendChild(u),i[u.dataset.item_key]&&u.click()}uo(a.querySelector(".recipe_creation_button"),document.getElementById("exit_crafting_button"))||a.querySelector(".recipe_creation_button").scrollIntoView({block:"end",inline:"nearest"});for(let l=0;l<2;l++)[...n[l].children[1].children].sort((d,u)=>Number.parseInt(d.dataset.component_tier)>Number.parseInt(u.dataset.component_tier)?-1:Number.parseInt(d.dataset.component_tier)<Number.parseInt(u.dataset.component_tier)||d.dataset.item_name>u.dataset.item_name?1:d.dataset.item_name<u.dataset.item_name||Number.parseInt(d.dataset.item_quality)>Number.parseInt(u.dataset.item_quality)?-1:1).forEach(d=>n[l].children[1].appendChild(d))}function yo({category:e,subcategory:t,recipe_id:i,refreshing:a}){let s=G[e][t][i],n=it[e][t].querySelector(`[data-recipe_id='${i}']`).children[1];De(n);let o=Object.values(r.inventory).filter(l=>s.materials.filter(d=>d.material_id===l.item?.id).length>0);for(let l=0;l<o.length;l++){let d=s.materials.filter(v=>v.material_id===o[l].item.id)[0],u=document.createElement("div"),h=document.createElement("span");j(h,`<i class="material-icons icon selected_material_icon"> check </i>${c[d.result_id].getName()}`),h.classList.add("recipe_comp_name"),u.append(h),u.classList.add("selectable_material"),u.dataset.item_key=o[l].item.getInventoryKey(),d.count<=o[l].count?u.addEventListener("click",v=>{u.classList.add("selected_material"),v.target.classList.contains("selectable_material")?window.useRecipe(v.target.parentNode):v.target.classList.contains("craft_ammount_button")?window.useRecipe(v.target.parentNode.parentNode.parentNode,Number(v.target.dataset.craft_ammount)):window.useRecipe(v.target.parentNode.parentNode),u.classList.remove("selected_material")}):u.classList.add("recipe_unavailable");let _=document.createElement("div");_.classList.add("craft_ammount_buttons");let w=document.createElement("div");w.innerText="5",w.dataset.craft_ammount=5,w.classList.add("craft_ammount_button"),_.append(w);let b=document.createElement("div");b.innerText="10",b.dataset.craft_ammount=10,b.classList.add("craft_ammount_button"),_.append(b);let g=document.createElement("div");g.innerText="all",g.dataset.craft_ammount=1/0,g.classList.add("craft_ammount_button"),_.append(g),u.append(_),u.append(ro({category:e,subcategory:t,recipe_id:i,material:d})),n.appendChild(u)}a||n.lastChild?.scrollIntoView()}function ko(){Object.keys(G).forEach(e=>{Object.keys(G[e]).forEach(t=>{t==="items"&&Object.keys(G[e][t]).forEach(i=>{if(!G[e][t][i].is_unlocked)return;let a=it[e][t].querySelector(`[data-recipe_id="${i}"`);G[e][t][i].get_availability().available_ammount?a.classList.remove("recipe_unavailable"):a.classList.add("recipe_unavailable")})})})}function Mu(e){let t=document.createElement("div");return t.classList.add("job_tooltip","location_action_tooltip"),t.innerText=e.description,e.keep_progress&&(t.innerText+=`

Pausing this task will not waste your progress`),t}function kr(e){let t=document.createElement("div");t.classList.add("job_tooltip"),t.dataset.job_tooltip=e.activity_id;let{gathering_time_needed:i,gained_resources:a}=e.getActivityEfficiency(),s="",n="";if(e.availability_seasons)if(e.availability_seasons.length===3){let o=xi.filter(l=>!e.availability_seasons.includes(l));n+=`Not available during ${o.join(", ")} <br>`}else n+=`Available during ${e.availability_seasons.join(", ")} <br>`;for(let o=0;o<A[e.activity_name].base_skills_names.length;o++)s+=f[A[e.activity_name].base_skills_names[o]].name();e.gained_resources.scales_with_skill&&(n+=`<span class="activity_efficiency_info">Efficiency scaling:<br>"${s}" skill lvl ${e.gained_resources.skill_required[0]} to ${e.gained_resources.skill_required[1]}</span><br><br>`),n+=`Every ${Ua(i)}, chance to find:`;for(let o=0;o<a.length;o++){let l=c[a[o].name].getName();n+=`<br>x${a[o].count[0]===a[o].count[1]?a[o].count[0]:`${a[o].count[0]}-${a[o].count[1]}`} "${sr(l)}" at ${Math.round(100*a[o].chance)}%`}return ae(t,n),t}function ss(e){let t=document.querySelector(`[data-activity="${e.activity_id}"]`),i;if(t?i=t.getElementsByClassName("job_tooltip")[0]:i=document.getElementById("gathering_progress_bar_max")?.querySelector(`[data-job_tooltip="${e.activity_id}"]`),!i)return;let{gathering_time_needed:a,gained_resources:s}=e.getActivityEfficiency(),n="",o="";for(let l=0;l<A[e.activity_name].base_skills_names.length;l++)n+=f[A[e.activity_name].base_skills_names[l]].name();e.gained_resources.scales_with_skill&&(o=`<span class="activity_efficiency_info">Efficiency scaling:<br>"${n}" skill lvl ${e.gained_resources.skill_required[0]} to ${e.gained_resources.skill_required[1]}</span><br><br>`),o+=`Every ${Ua(a)}, chance to find:`;for(let l=0;l<s.length;l++)o+=`<br>x${s[l].count[0]===s[l].count[1]?s[l].count[0]:`${s[l].count[0]}-${s[l].count[1]}`} "${sr(s[l].name)} " at ${Math.round(100*s[l].chance)}%`;ae(i,o)}function fi(){mu.innerText=Math.ceil(r.stats.full.health)+"/"+Math.ceil(r.stats.full.max_health)+" hp",hu.style.width=(r.stats.full.health*100/r.stats.full.max_health).toString()+"%"}function la(){pu.innerText=Math.round(r.stats.full.stamina)+"/"+Math.round(r.stats.full.max_stamina)+" stamina",fu.style.width=(r.stats.full.stamina*100/r.stats.full.max_stamina).toString()+"%"}function os(){Object.keys(ta).forEach(function(a){a==="crit_rate"||a==="crit_multiplier"?ta[a].innerText=`${(r.stats.full[a]*100).toFixed(1)}%`:a==="attack_speed"?ta[a].innerText=`${r.get_attack_speed().toFixed(1)}`:a==="attack_power"?ta[a].innerText=`${r.get_attack_power().toFixed(1)}`:ta[a].innerText=`${r.stats.full[a].toFixed(1)}`,Xs(a)});let e=document.getElementById("attack_stats"),t=Math.round(r.stats.full.attack_points);if(hi.attack_points.innerText=`${t}`,r.equipment["off-hand"]!=null&&r.equipment["off-hand"].offhand_type==="shield"){let a=(r.stats.full.block_chance*100).toFixed(1);hi.defensive_action.innerText="Block :",hi.defensive_points.innerText=`${a}%`,hi.defensive_points.parentNode.children[2].children[0].innerText="Chance to block an attack",e.children[3].innerText=`Block : ${Math.round(a)}%`}else{let a=Math.round(r.stats.full.evasion_points);hi.defensive_action.innerText="EP : ",hi.defensive_points.innerText=`${a}`,hi.defensive_points.parentNode.children[2].children[0].innerText="Evasion points, a total value of everything that contributes to the evasion chance, except for some situational skills and modifiers",e.children[3].innerText=`EP: ${Math.round(a)} `}Xs("defensive_points"),Xs("attack_points"),Au();let i=r.get_attack_power();i>100?i=Math.round(i):i=Math.round(10*i)/10,e.children[0].innerText=`Atk: ${i}`,e.children[1].innerText=`Spd: ${Math.round(r.get_attack_speed()*100)/100}`,e.children[2].innerText=`AP:  ${Math.round(t)}`,e.children[4].innerText=`Def: ${Math.round(r.stats.full.defense)} `}function Xs(e){let t;if(ta[e])t=ta[e].parentNode.children[2].children[1];else if(hi[e]&&e!=="defensive_action")t=hi[e].parentNode.children[2].children[1];else return;ae(t,Ct(e))}function Au(){Cu(),br(),vr()}function Cu(){let e="<b>Max health:</b> "+Math.round(r.stats.full.max_health)+"<br>";e+=Ct("max_health"),r.stats.full.health_regeneration_flat&&(e+="<br>------------------------<br><b>Health regen (flat):</b> "+Math.round(10*r.stats.full.health_regeneration_flat)/10+"<br>",e+=Ct("health_regeneration_flat")),r.stats.full.health_regeneration_percent&&(e+="<br>------------------------<br><b>Health regen (%):</b> "+Math.round(10*r.stats.full.health_regeneration_percent)/10+"<br>",e+=Ct("health_regeneration_percent")),r.stats.full.health_loss_flat&&(e+="<br>------------------------<br><b>Health loss (flat):</b> "+Math.round(10*r.stats.full.health_loss_flat)/10+"<br>",e+=Ct("health_loss_flat")),r.stats.full.health_loss_percent&&(e+="<br>------------------------<br><b>Health loss (%):</b> "+Math.round(10*r.stats.full.health_loss_percent)/10+"<br>",e+=Ct("health_loss_percent"));let t=r.stats.full.health_regeneration_flat+r.stats.full.health_loss_flat+r.stats.full.max_health*(r.stats.full.health_regeneration_percent+r.stats.full.health_loss_percent)/100;e+="<br>------------------------<br><b>Total health balance:</b> "+(t>0?"+":"")+Math.round(10*t)/10+"<br>",ae(_u,e)}function br(){let e;e="<b>Max stamina:</b> "+Math.round(r.stats.full.max_stamina)+"<br>",e+=Ct("max_stamina"),r.stats.full.stamina_efficiency!=1&&(e+="<br>------------------------<br><b>Stamina efficiency:</b> "+Math.round(100*r.stats.full.stamina_efficiency)/100+"<br>",e+=Ct("stamina_efficiency")),r.stats.full.stamina_regeneration_flat&&(e+="<br>------------------------<br><b>Stamina regen (flat):</b> "+Math.round(10*r.stats.full.stamina_regeneration_flat)/10+"<br>",e+=Ct("stamina_regeneration_flat")),r.stats.full.stamina_regeneration_percent&&(e+="<br>------------------------<br><b>Stamina regen (%):</b> "+Math.round(10*r.stats.full.stamina_regeneration_percent)/10+"<br>",e+=Ct("stamina_regeneration_percent")),ae(gu,e)}function vr(){let e="";r.xp_bonuses.total_multiplier.all!=1?(e+="<b>Global xp multiplier:</b> "+Math.round(100*r.xp_bonuses.total_multiplier.all)/100+"<br>",e+=Zs("all",!1)):e+="<b>No global xp multipliers</b><br>",r.xp_bonuses.total_multiplier.hero!=1&&(e+="<br>------------------------<br><b>Hero xp multiplier:</b> "+Math.round(100*r.xp_bonuses.total_multiplier.hero)/100+" (with global: "+Math.round(Yr()*100)/100+")<br>",e+=Zs("hero",!1)),r.xp_bonuses.total_multiplier.all_skill!=1&&(e+="<br>------------------------<br><b>Skill xp multiplier:</b> "+Math.round(100*r.xp_bonuses.total_multiplier.all_skill)/100+" (with global: "+Math.round(zr()*100)/100+")<br>",e+=Zs("all_skill",!1)),ae(yu,e)}function Ct(e){let t="";return e==="attack_power"?t+=`<br>Breakdown:
        <br>Base value (weapon * str/10): ${Math.round(100*r.stats.total_flat.attack_power)/100}`:e==="attack_points"?t+=`<br>Breakdown:
        <br>Base value: ${Math.round(100*r.stats.total_flat.attack_points)/100}`:e==="defensive_points"?(r.equipment["off-hand"]!=null&&r.equipment["off-hand"].offhand_type==="shield"?e="block_chance":e="evasion_points",t+=`<br>Breakdown:
            <br>Base value: ${Math.round(100*r.stats.total_flat[e])/100}`):t+=`<br>Breakdown:
        <br>Base value: ${Math.round(100*r.base_stats[e])/100}`,Object.keys(r.stats.flat).forEach(i=>{if(r.stats.flat[i][e]&&r.stats.flat[i][e]!==0){let a=r.stats.flat[i][e]>=0?"+":"";t+=`<br>${bt(i.replace("_"," "))}: ${a}${Math.round(100*r.stats.flat[i][e])/100}`}}),Object.keys(r.stats.multiplier).forEach(i=>{r.stats.multiplier[i][e]&&r.stats.multiplier[i][e]!==1&&(t+=`<br>${bt(i.replace("_"," "))}: x${Math.round(100*r.stats.multiplier[i][e])/100}`)}),t}function Zs(e,t){let i="",a=1;return t&&e!=="all"&&(e!=="all_skill"&&e!=="hero"?a=Po(e):a*=r.xp_bonuses.total_multiplier.all||1),i+=`<br>Breakdown:
        <br>Base value: ${Math.round(100*a)/100}`,Object.keys(r.xp_bonuses.multiplier).forEach(s=>{r.xp_bonuses.multiplier[s]?.[e]&&r.xp_bonuses.multiplier[s]?.[e]!==1&&(i+=`<br>${bt(s.replace("_"," "))}: x${Math.round(100*r.xp_bonuses.multiplier[s][e])/100}`)}),i}function La(){let e=Object.keys(Se).length;ku.innerText=e,e>0?(De(Ds),Object.values(_i).forEach(t=>{t.remove()}),_i={},Object.values(Se).forEach(t=>{_i[t.name]=lr({effect_name:t.name,duration:t.duration,add_bonus:!0}),Ds.appendChild(_i[t.name])})):(ae(Ds,"No active effects"),_i={}),bo()}function bo(){Object.keys(_i).forEach(e=>{Se[e]?.duration?_i[e].querySelector(".active_effect_duration").innerText=qi({time:{minutes:Se[e].duration},round:!1}):(_i[e].remove(),delete _i[e])})}function vo(){let e=E.getTimeOfDaySimple();ae(bu,E.toString()+", <b>"+e+"</b>")}function ls(){let e=Rn(),t=M.use_uncivilised_temperature_scale?Ja(e):e,i=M.use_uncivilised_temperature_scale?"\xB0F":"\xB0C",a=e<Oa[0]-Oi(),s="normal_temperature";a&&(s="cold_temperature"),t=t.toString(),t.includes(".")||(t+=".0"),De(xa),x.is_under_roof?j(xa,t+i):Fn()?e>0?j(xa,`<span class="material-icons icon">cloud</span><span class="${s}">`+t+i+"</span>"):j(xa,`<span class="material-icons icon">ac_unit</span><span class="${s}">`+t+i+"</span>"):j(xa,`<span class="${s}">`+t+i+"</span>"),xa.appendChild(Lu())}function Lu(){let e=document.createElement("div");e.id="temperature_tooltip",De(e);let t="";return M.use_uncivilised_temperature_scale?(t=`Lowest tolerable temperature: <strong>${Math.round(10*Ja(rn-Oi()))/10}</strong>`,t+=`<br>(<strong>${Math.round(10*Ja(rn))/10}</strong> base minus <strong>${Math.round(10*Ja(Oi())-320)/10}</strong> cold protection)<br>`,t+=Ct("cold_tolerance"),t+="<br>Scale conversion: x1.8"):(t=`Lowest tolerable temperature: <strong>${Math.round(10*(rn-Oi()))/10}</strong>`,t+=`<br>(<strong>${rn}</strong> base minus <strong>${Math.round(10*Oi())/10}</strong> cold protection)<br>`,t+=Ct("cold_tolerance")),j(e,t),e}function Ke(e){let t,i=e>=0?"":"-";return e=Math.abs(e),e>0?(t=e%10!=0?`${e%10}<span class="coin coin_wood">W</span>`:"",e>9&&(t=(Math.floor(e/10)%100!=0?`${Math.floor(e/10)%100}<span class="coin coin_copper">C</span>${t?" ":""}`:"")+t,e>999&&(t=(Math.floor(e/1e3)%100!=0?`${Math.floor(e/1e3)%100}<span class="coin coin_silver">S</span>${t?" ":""}`:"")+t,e>99999&&(t=`${Math.floor(e/1e5)}<span class="coin coin_gold">G</span>${t?" ":""}`+t))),i+t):"nothing"}function xr(e=!1){Vl.children[0].children[0].style.width=`${100*r.xp.current_xp/r.xp.xp_to_next_lvl}%`,Vl.children[1].innerText=`${Vi(r.xp.current_xp)} / ${Vi(r.xp.xp_to_next_lvl)} xp`,e&&(wu.innerText=`Level: ${r.xp.current_level}`,fi())}function rs(){vr()}function cs(){br()}function xo(){De(oo.reputation),Object.keys(r.reputation).forEach(e=>{if(r.reputation[e]>0){let t=document.createElement("div"),i=document.createElement("span"),a=document.createElement("span");t.classList.add("data_entry"),i.classList.add("data_entry_name"),a.classList.add("data_entry_value"),De(i),De(a),j(i,bt(e)+" reputation"),j(a,r.reputation[e]),t.appendChild(i),t.appendChild(a),oo.reputation.appendChild(t)}})}function us(){let e="<table><tr><th width='100%'>Item</th><th>Best</th><th>Total</th></tr>";Object.values(Ni.items).forEach(t=>{let i=c[t.id]?.getName()||t.id;e+=`<tr><td>${i}</td ><td>`,t.quality_highest>0&&(e+=`${t.quality_lowest}-${t.quality_highest}%`),e+=`</td><td>${t.number}</td></tr>`}),e+="</table>",ae(oo.item_log,e)}function eo({dialogue_key:e,textlines:t,origin:i}){let a=q[e];sa();let s=document.createElement("div");j(s,bt(q[e].getName({is_mofu_mofu_enabled:Ie.is_mofu_mofu_enabled}))),s.id="dialogue_name_div",oe.appendChild(s);let n=document.createElement("div");if(n.id="dialogue_answer_div",oe.appendChild(n),t){for(let l=0;l<t.length;l++){let d=t[l];if(a.textlines[d].is_unlocked&&!a.textlines[d].is_finished&&Ji(a.textlines[d].display_conditions,r)){if(a.textlines[d].required_flags){if((a.textlines[d].required_flags.yes&&!Array.isArray(a.textlines[d].required_flags.yes)||a.textlines[d].required_flags.no&&!Array.isArray(a.textlines[d].required_flags.no))&&console.error(`Textline "${d}" in dialogue "${e}" has required flag passed as a single value but it should be an array!`),a.textlines[d].required_flags.yes){for(let h=0;h<a.textlines[d].required_flags.yes.length;h++)if(!Ie[a.textlines[d].required_flags.yes[h]])return}if(a.textlines[d].required_flags.no){for(let h=0;h<a.textlines[d].required_flags.no.length;h++)if(Ie[a.textlines[d].required_flags.no[h]])return}}let u=document.createElement("div");j(u,`"${nn.getText(Dt,a.textlines[d].name)}"`),u.classList.add("dialogue_textline"),u.setAttribute("data-textline",d),u.setAttribute("onclick",`start_textline(this.getAttribute('data-textline'), ${i})`),oe.appendChild(u)}}let o=document.createElement("div");j(o,"<i class='material-icons'>arrow_back</i> "+Su),o.classList.add("backstep_dialogue_button"),o.setAttribute("onclick",`start_dialogue("${e}")`),oe.appendChild(o)}else{if(Object.keys(a.textlines).forEach(l=>{if(a.textlines[l].is_unlocked&&!a.textlines[l].is_finished&&!a.textlines[l].is_branch_only&&Ji(a.textlines[l].display_conditions,r)){if(a.textlines[l].required_flags){if((a.textlines[l].required_flags.yes&&!Array.isArray(a.textlines[l].required_flags.yes)||a.textlines[l].required_flags.no&&!Array.isArray(a.textlines[l].required_flags.no))&&console.error(`Textline "${l}" in dialogue "${e}" has required flag passed as a single value but it should be an array!`),a.textlines[l].required_flags.yes){for(let u=0;u<a.textlines[l].required_flags.yes.length;u++)if(!Ie[a.textlines[l].required_flags.yes[u]])return}if(a.textlines[l].required_flags.no){for(let u=0;u<a.textlines[l].required_flags.no.length;u++)if(Ie[a.textlines[l].required_flags.no[u]])return}}let d=document.createElement("div");j(d,`"${nn.getText(Dt,a.textlines[l].name)}"`),d.classList.add("dialogue_textline"),d.setAttribute("data-textline",l),d.setAttribute("onclick","start_textline(this.getAttribute('data-textline'))"),oe.appendChild(d)}}),Object.keys(a.actions).forEach(l=>{if(a.actions[l].is_unlocked&&!a.actions[l].is_finished&&a.actions[l].can_be_displayed(r)){let d=document.createElement("div");j(d,`${nn.getText(Dt,a.actions[l].starting_text)}`),d.classList.add("dialogue_textline"),d.setAttribute("data-location_action",l),d.setAttribute("onclick","start_game_action(this.getAttribute('data-location_action'), event)"),oe.appendChild(d)}}),a.trader){let l=document.createElement("div");j(l,'<i class="material-icons">storefront</i>  '+F[a.trader].trade_text),l.classList.add("dialogue_trade"),l.setAttribute("data-trader",a.trader),l.setAttribute("onclick","startTrade(this.getAttribute('data-trader'))"),oe.appendChild(l)}let o=document.createElement("div");j(o,"<i class='material-icons'>arrow_back</i> "+a.ending_text),o.classList.add("end_dialogue_button"),o.setAttribute("onclick","end_dialogue()"),oe.appendChild(o)}}function to({text:e,is_description:t}){e=nn.getText(Dt,e),t?(document.getElementById("dialogue_answer_div").innerText="*"+e+"*",document.getElementById("dialogue_answer_div").classList.remove("italic")):(document.getElementById("dialogue_answer_div").innerText=e,document.getElementById("dialogue_answer_div").classList.add("italic"))}function Ol(){oe.style.display="",Xl.style.display="none"}function Bu(e){let t=A[e.activity_name],i=t.type==="JOB";sa();let a=document.createElement("div");a.innerText=t.action_text,a.id="action_status_div";let s=document.createElement("div");s.id="action_xp_div",t.base_skills_names||console.warn(`Activity "${e.activity_name}" has no skills assigned!`);let n=document.createElement("div");n.setAttribute("onclick","end_activity()"),n.id="action_end_div";let o=document.createElement("div");if(o.innerText=`Finish ${e.activity_name}`,o.id="action_end_text",n.appendChild(o),i){let l=document.createElement("div");l.innerText=`(earnings: ${Ke(0)})`,l.id="action_end_earnings",n.appendChild(l)}if(oe.appendChild(a),oe.appendChild(s),e.gathering_time_needed!=1){let l=document.createElement("div"),d=document.createElement("div");l.appendChild(d),d.id="gathering_progress_bar",d.style.width=385*e.gathering_time/e.gathering_time_needed+"px",l.id="gathering_progress_bar_max",oe.appendChild(l),e.gained_resources&&l.appendChild(kr(e))}if(oe.appendChild(n),i){let l=document.createElement("div");l.id="time_for_earnings_div",oe.insertBefore(l,oe.children[2])}es(),qo(e)}function qo(e){let t=A[e.activity_name];if(t.type==="JOB"){document.getElementById("action_end_earnings").innerText=`(earnings: ${Ke(e.earnings)})`;let s=document.getElementById("time_for_earnings_div");Dr(e)?s.innerText=`Next earnings in: ${Ua(e.gathering_time_needed-e.gathering_time%e.gathering_time_needed)}`:s.innerText=`There's not enough time left to earn more, but ${r.name} might still learn something...`}let i=document.getElementById("action_xp_div");if(!i){console.warn(`Failed to find htmlElement with id "action_xp_div" for activity "${e.activity_id}"`);return}let a=e.skill_names||t.base_skills_names;for(let s=0;s<a.length;s++){s>0?j(i,"<br><br>"):i.innerText="";let n=f[a[s]],o=e.skill_xp_per_tick[s],l=K(n.skill_id)==n.max_level;if(t.type!=="GATHERING"?i.innerText+=`Getting ${o} base xp per in-game minute to `:i.innerText+=`Getting ${o} base xp per gathering cycle to `,l)i.innerText+=` ${n.name()} (Maxed out!)`;else{let d=l?"Max":`${Math.round(1e4*n.current_xp/n.xp_to_next_lvl)/100}%`,u=l?"Max":`${Math.floor(n.current_xp)}`,h=l?"Max":`${Math.ceil(n.xp_to_next_lvl)}`,_=Math.ceil((h-u)/(o*ji(n.skill_id)))*e.gathering_time_needed;i.innerText+=` ${n.name()} (${d}  [${Vi(u)} / ${Vi(h)}])`,j(i,`<br>Next level in ${Mn(_)} (${qi({time:{minutes:_/60},long_names:!0})}realtime)`)}}e.gathering_time_needed!=1&&(document.getElementById("gathering_progress_bar").style.width=385*e.gathering_time/e.gathering_time_needed+"px")}function Wu(e,t){sa();let i;e?i=q[e].actions[t]:i=x.actions[t];let a=document.createElement("div");a.innerText=i.action_text,a.id="action_status_div",oe.appendChild(a);let s=document.createElement("div"),n=document.createElement("div");s.appendChild(n),n.id="action_progress_bar",n.style.width="0px",s.id="action_progress_bar_max",oe.appendChild(s);let o=document.createElement("div");o.setAttribute("onclick","end_game_action()"),o.id="action_end_div";let l=document.createElement("div");l.innerText="Give up for now",l.id="action_end_text",o.appendChild(l),oe.appendChild(o),es()}function So(e){document.getElementById("action_progress_bar").style.width=385*e+"px"}function qr(e){document.getElementById("action_status_div").innerText=e}function Sr(){document.getElementById("action_end_div").innerText="Finish"}function ds({content_type:e,data:t}){let i="";if(t.special?.upstack_result_message&&(i=t.special.upstack_result_message),e==="dialogue")eo({dialogue_key:t.dialogue_key}),i||(i=q[t.dialogue_key].getDescription()),to({text:i,is_description:!0});else if(e==="dialogue_answer")eo({dialogue_key:t.dialogue_key}),i||(i=t.text),to({text:i});else if(e==="dialogue_branch")eo({dialogue_key:t.dialogue_key,textlines:t.textlines}),i||(i=t.text),to({text:i});else if(e==="action")Wu(t.dialogue_key,t.action_key);else if(e==="activity")Bu(t.activity);else throw new Error(`Error on filling action box content: no such content type as "${e}"`)}function Ir(){sa();let e=document.createElement("div");e.innerText="Sleeping...",e.id="action_status_div";let t=document.createElement("div");t.setAttribute("onclick","end_sleeping()"),t.id="action_end_div";let i=document.createElement("div");i.innerText="Wake up",i.id="action_end_text",t.appendChild(i),oe.appendChild(e),oe.appendChild(t),es()}function $r(e){sa();let t=document.createElement("div");t.innerText=`Reading the book, ${Mn(c[e].getRemainingTime())} left`,t.id="action_status_div";let i=document.createElement("div");i.setAttribute("onclick","end_reading()"),i.id="action_end_div";let a=document.createElement("div");a.innerText="Stop reading for now",a.id="action_end_text",i.appendChild(a),oe.appendChild(t),oe.appendChild(i),es({book_title:e})}function Io(e){if(!pe[e.category]){pe[e.category]={};let g=document.createElement("div");j(g,`<i class="material-icons icon skill_dropdown_icon"> keyboard_double_arrow_down </i>${e.category} skills`),g.dataset.skill_category=e.category,g.classList.add("skill_category_div");let v=document.createElement("a");v.className="material-icons icon",v.style.float="right",v.innerText="keyboard_arrow_up",v.addEventListener("click",()=>{let $=Ne.indexOf(e.category);$>0&&([Ne[$],Ne[$-1]]=[Ne[$-1],Ne[$]],io(),Ul())});let y=document.createElement("a");y.className="material-icons icon",y.style.float="right",y.innerText="keyboard_arrow_down",y.addEventListener("click",()=>{let $=Ne.indexOf(e.category);$<Ne.length-1&&([Ne[$],Ne[$+1]]=[Ne[$+1],Ne[$]],io(),Ul())}),g.appendChild(v),g.appendChild(y);let I=document.createElement("div");I.dataset.skill_category_skills=!0,g.appendChild(I),vt.appendChild(g),g.addEventListener("click",$=>{$.target.classList.contains("skill_category_div")?$.target.classList.toggle("skill_category_expanded"):$.target.classList.contains("skill_dropdown_icon")&&$.target.parentNode.classList.toggle("skill_category_expanded")}),Ne.indexOf(e.category)==-1&&Ne.push(e.category)}if(pe[e.category][e.skill_id]){console.trace(`Tried to create a skillbar for skill "${e.skill_id}", but it already has one!`);return}pe[e.category][e.skill_id]=document.createElement("div");let t=document.createElement("div"),i=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div"),h=document.createElement("div"),_=document.createElement("div"),w=document.createElement("div");t.classList.add("skill_bar_max"),i.classList.add("skill_bar_current"),a.classList.add("skill_bar_text"),s.classList.add("skill_bar_name"),n.classList.add("skill_bar_xp"),o.classList.add("skill_tooltip"),w.classList.add("skill_tooltip_next_milestone"),a.appendChild(s),a.append(n),d.classList.add("skill_xp_gain"),o.appendChild(l),o.appendChild(d),o.appendChild(u),o.appendChild(h),o.appendChild(_),o.appendChild(w);let b=`<span class="skill_id">id: "${e.skill_id}"</span><br><br>${e.description}<br>`;e.flavour_text&&(b+=`<br><span class="skill_flavour_text">"${e.flavour_text}"</span>`),e.parent_skill&&(b+=`<br>Parent skill: ${e.parent_skill}<br><br>`),j(u,b),t.appendChild(a),t.appendChild(i),t.appendChild(o),pe[e.category][e.skill_id].appendChild(t),pe[e.category][e.skill_id].setAttribute("data-skill",e.skill_id),pe[e.category][e.skill_id].classList.add("skill_div"),vt.querySelector(`[data-skill_category=${e.category}]`).querySelector("[data-skill_category_skills]").appendChild(pe[e.category][e.skill_id]),_s({}),io(),Ba(e)}function ra(e,t=!0){pe[e.category][e.skill_id]&&(ms(e),e.current_xp!=="Max"?(pe[e.category][e.skill_id].children[0].classList.remove("skill_bar_capped"),pe[e.category][e.skill_id].children[0].children[0].children[1].innerText=`${100*Math.floor(e.current_xp/e.xp_to_next_lvl*1e3)/1e3}%`,pe[e.category][e.skill_id].children[0].children[2].children[0].innerText=`${Vi(e.current_xp)} / ${Vi(e.xp_to_next_lvl)}`):(pe[e.category][e.skill_id].children[0].classList.add("skill_bar_capped"),pe[e.category][e.skill_id].children[0].children[0].children[1].innerText="Max!",pe[e.category][e.skill_id].children[0].children[2].children[0].innerText="Maxed out!"),pe[e.category][e.skill_id].children[0].children[1].style.width=`${100*e.current_xp/e.xp_to_next_lvl}%`,js(e.skill_id)&&ae(pe[e.category][e.skill_id].children[0].children[2].children[4],`<br>${js(e.skill_id)}`),typeof Ns(e.skill_id)<"u"?pe[e.category][e.skill_id].children[0].children[2].children[5].innerText=`lvl ${Ns(e.skill_id)}: ???`:pe[e.category][e.skill_id].children[0].children[2].children[5].innerText="",typeof e.get_effect_description<"u"&&(pe[e.category][e.skill_id].children[0].children[2].children[3].innerText=`${e.get_effect_description()}`),t&&_s({sort_by:ln}))}function ms(e){if(!pe[e.category]?.[e.skill_id])return;pe[e.category][e.skill_id].children[0].children[0].children[0].innerText=`${e.name()} : level ${e.current_level}/${e.max_level}`;let t=r.bonus_skill_levels.full[e.skill_id];t!=0&&ae(pe[e.category][e.skill_id].children[0].children[0].children[0],` <b>[${t>0?"+":""}${t}]</b>`)}function Er(e){pe[e.category][e.skill_id]&&(pe[e.category][e.skill_id].children[0].children[2].children[3].innerText=`${e.get_effect_description()}`)}function Ba(e){if(!pe[e.category]||!pe[e.category][e.skill_id])return;let t=Math.round(100*e.get_parent_xp_multiplier()*ji(e.skill_id))/100||1;pe[e.category][e.skill_id].children[0].children[2].children[1].innerText=`XP gain: x${t}<br><span>XP cost scaling: x${e.xp_scaling}</span>`}function hs(){Object.keys(pe).forEach(e=>{Object.keys(pe[e]).forEach(t=>{Ba(f[t])})})}function _s({sort_by:e="name",change_direction:t=!1}){t&&(e&&e===ln?Xi==="asc"?Xi="desc":Xi="asc":e==="level"?Xi="desc":Xi="asc"),ln=e;let i=Xi=="asc"?1:-1,a=Xi==="asc"?-1:1;for(let s=0;s<vt.children.length;s++)[...vt.children[s].querySelector("[data-skill_category_skills]").children].sort((n,o)=>{let l,d;if(e==="level")ln=e,l=f[n.getAttribute("data-skill")].current_level,d=f[o.getAttribute("data-skill")].current_level;else if(e==="progress"){if(isNaN(f[n.getAttribute("data-skill")].current_xp))return 1;if(isNaN(f[o.getAttribute("data-skill")].current_xp))return-1;l=-f[n.getAttribute("data-skill")].current_xp/f[n.getAttribute("data-skill")].xp_to_next_lvl,d=-f[o.getAttribute("data-skill")].current_xp/f[o.getAttribute("data-skill")].xp_to_next_lvl}else l=f[n.getAttribute("data-skill")].name(),d=f[o.getAttribute("data-skill")].name(),ln="name";return l>d?i:a}).forEach(n=>vt.children[s].querySelector("[data-skill_category_skills").appendChild(n))}function io(){[...vt.children].sort((e,t)=>{let i=Ne.indexOf(e.dataset.skill_category),a=Ne.indexOf(t.dataset.skill_category);return i==-1||a==-1?e.dataset.skill_category>t.dataset.skill_category?1:-1:i>a?1:-1}).forEach(e=>vt.appendChild(e))}function Ul(){Ne.length=0,[...vt.children].forEach((e,t)=>{Ne[t]=e.dataset.skill_category})}function ps(e,t,i){De(on),Object.keys(At).forEach(a=>{delete At[a]}),ae(on,`<tr class="stance_list_entry stance_list_header">
            <th class="stance_list_header stance_list_header_fav">Fav</th>
            <th class="stance_list_header stance_list_header_select">Select</th>
            <th class="stance_list_header stance_list_header_name">Name</th>
        </tr>`),Object.keys(e).forEach(a=>{if(e[a].is_unlocked){At[a]=document.createElement("tr"),At[a].classList.add("stance_list_entry"),At[a].dataset.stance=a;let s=`<td class="stances_button stances_button_checkbox"><input type="checkbox" id="stances_fav_${a}" name="stance_fav_selection" onclick="fav_stance('${a}')"></td>`,n=`<td class="stances_button stances_button_radio"><input type="radio" id="stances_select_${a}" name="stance_list_selection" onclick="select_stance('${a}')"></td>`,o=`<td class="stances_name"><label for="stances_select_${a}">${e[a].name}</td>`;ae(At[a],s+n+o);let l=document.createElement("td");l.appendChild(Ou(e[a])),At[a].appendChild(l),on.append(At[a])}}),[...on.children].sort((a,s)=>{let n=e[a.getAttribute("data-stance")],o=e[s.getAttribute("data-stance")];if(o){if(!n)return-1}else return 1;return(!n||!o||!n.is_unlocked||!o.is_unlocked)&&console.error(`No such stance as either '${n}' or '${o}', or at least one of them is not yet unlocked!`),n.stamina_cost<o.stamina_cost?-1:n.stamina_cost>o.stamina_cost||n.name>o.name?1:-1}).forEach(a=>on.appendChild(a)),$o(t),Eo(i)}function Ou(e){let t=document.createElement("div");t.classList.add("stance_tooltip");let i=`<div>${e.name}</div><br>
        <div>${e.getDescription()}</div><br>
        <div>Stamina cost: ${e.stamina_cost}</div>
        <div class='stance_tooltip_stats'>${Tr(e)}</div`,a=e.target_count;return a>1&&e.related_skill&&(a=a+Math.round(a*K(e.related_skill)/f[e.related_skill].max_level)),a>1&&(i+=`
            <br><div class='stance_tooltip_hitcount'>${e.randomize_target_count?"Randomly hits up to":"Hits up to"} ${a} enemies</div>`),j(t,i),t}function Tr(e){let t="",i=e.getStats();return Object.keys(i).forEach(a=>{t+=`<br>x${Math.round(100*i[a])/100} ${Je[a]}`}),t}function Mr(e){ae(At[e.id].querySelector(".stance_tooltip_stats"),Tr(e));let t=e.target_count;t>1&&(e.related_skill&&(t=t+Math.round(t*K(e.related_skill)/f[e.related_skill].max_level)),ae(At[e.id].querySelector(".stance_tooltip_hitcount"),`${e.randomize_target_count?"Randomly hits up to":"Hits up to"} ${t} enemies</div>`))}function $o(e){At[e.id].children[1].children[0].checked=!0,document.getElementById("character_stance_name").children[0].innerText=e.name;let t=document.getElementById("character_stance_selection");t.children&&(t.querySelector(`[data-stance='${e.id}']`)?t.querySelector(`[data-stance='${e.id}']`).children[0].checked=!0:!ii[e.id]&&t.querySelector("[data-stance] :checked")&&(t.querySelector("[data-stance] :checked").checked=!1))}function Eo(e){let t=document.getElementById("character_stance_selection");De(t);let i="";Object.keys(ii).forEach(s=>{At[s].children[0].children[0].checked=!0,i+=`<div data-stance="${s}"><input type="radio" id="stances_quick_select_${s}" name="stance_quick_selection" onclick="select_stance('${s}')">
            <label for="stances_quick_select_${s}">${e[s].name}</div>`}),j(t,i),[...t.children].sort((s,n)=>{let o=e[s.getAttribute("data-stance")],l=e[n.getAttribute("data-stance")];return(!o||!l)&&console.error(`No such stance as either '${o}' or '${l}'!`),o.stamina_cost<l.stamina_cost?-1:o.stamina_cost>l.stamina_cost||o.name>l.name?1:-1}).forEach(s=>t.appendChild(s));let a=document.getElementById("character_stance_selection");a.children&&a.querySelector(`[data-stance='${xt}']`)&&(a.querySelector(`[data-stance='${xt}']`).children[0].checked=!0)}function To(e){let t=U[e];Ea[e]=Pu(e),Ea[e].setAttribute("data-bestiary_rank",t.rank),Ea[e].classList.add("bestiary_entry_div"),Qs.appendChild(Ea[e]),[...Qs.children].sort((i,a)=>{let s=parseInt(i.getAttribute("data-bestiary_rank")),n=parseInt(a.getAttribute("data-bestiary_rank"));if(s!=n)return s-n;{let o=i.querySelector(".bestiary_entry_name").innerText,l=a.querySelector(".bestiary_entry_name").innerText;return o>l?1:-1}}).forEach(i=>Qs.appendChild(i))}function Pu(e){let t=document.createElement("div"),i=document.createElement("div");i.innerText=e,i.classList.add("bestiary_entry_name");let a=document.createElement("div");return a.innerText=Xt[e],a.classList.add("bestiary_entry_kill_count"),t.appendChild(i),t.appendChild(a),t.appendChild(Ar(e)),t}function Ar(e){let t=U[e],i=document.createElement("div");i.classList.add("bestiary_entry_tooltip");let a=document.createElement("div");j(a,`<br>Base xp value: ${t.xp_value} <br><br>`);let s=document.createElement("div");s.innerText=t.description;let n=document.createElement("div");Object.keys(t.tags).forEach(_=>{n.innerText+=`[${_}] `}),j(n,"<br><br>");let o=document.createElement("div");j(o,"Stats: <br>");let l=document.createElement("div");l.classList.add("grid_container"),l.append($a(t,"Health"),$a(t,"Defense"));let d=document.createElement("div");d.classList.add("grid_container"),d.append($a(t,"Attack power"),$a(t,"Attack speed"));let u=document.createElement("div");u.classList.add("grid_container"),u.append($a(t,"AP"),$a(t,"EP")),o.appendChild(l),o.appendChild(d),o.appendChild(u);let h=document.createElement("div");h.classList.add("loot_slots_div"),t.loot_list.length>0&&h.appendChild(Kl());for(let _=0;_<t.loot_list.length;_++)h.appendChild(Kl(t,t.loot_list[_]));return i.appendChild(s),i.appendChild(a),i.appendChild(n),i.appendChild(o),i.appendChild(h),i}function Cr(e){Ea[e].querySelector(".bestiary_entry_tooltip").replaceWith(Ar(e))}function Lr(e){Ea[e].children[1].innerText=Xt[e]}function Kl(e,t){let i=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div");return i.classList.add("loot_slot_div"),a.classList.add("loot_name"),s.classList.add("loot_chance"),n.classList.add("loot_chance_base"),o.classList.add("loot_chance_current"),e?(a.innerText=`${t.item_name}`,n.innerText=`[${t.chance*100}%]`,o.innerText=`${Math.round(1e4*t.chance*e.get_droprate_modifier())/100}%`,s.append(o,n),i.append(a,s)):(a.innerText="Item name",n.innerText="base %",o.innerText="current %",s.append(o,n),i.append(a,s)),i}function $a(e,t){let i=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div");switch(i.classList.add("stat_slot_div"),a.classList.add("stat_name"),s.classList.add("stat_value"),t){case"Health":a.innerText="Health:",s.innerText=`${e.stats.health}`,i.append(a,s);break;case"Defense":a.innerText="Defense:",s.innerText=`${e.stats.defense}`,i.append(a,s);break;case"Attack power":a.innerText="Attack power:",s.innerText=`${e.stats.attack}`,e.stats.attack_count>1&&(s.innerText+=`x${e.stats.attack_count}`),i.append(a,s);break;case"Attack speed":a.innerText="Attack speed:",s.innerText=`${e.stats.attack_speed}`,i.append(a,s);break;case"AP":a.innerText="AP:",s.innerText=`${Math.round(e.stats.dexterity*Math.sqrt(e.stats.intuition||1))}`,i.append(a,s);break;case"EP":a.innerText="EP:",s.innerText=`${Math.round(e.stats.agility*Math.sqrt(e.stats.intuition||1))}`,i.append(a,s);break}return i}function ju(e){Yt[e]=document.createElement("div");let t=c[e],i=document.createElement("div");i.innerText=e,i.classList.add("anthology_entry_name");let a=oa(t);a.classList.add("anthology_entry_tooltip"),Yt[e].appendChild(i),Yt[e].appendChild(a),Yt[e].setAttribute("data-book",e),Yt[e].classList.add("anthology_entry_div"),Vs.appendChild(Yt[e]),[...Vs.children].sort((s,n)=>s.getAttribute("data-book")-n.getAttribute("data-book")).forEach(s=>Vs.appendChild(s))}function fs(e,t){Yt[e]||ju(e),ae(Yt[e].children[1],Ta({item:c[e]})),Yt[e].style.display=t?"flex":"none"}function Mo(e,t){ot.children[e].querySelector(".enemy_attack_bar").style.width=`${Math.min(t*100,100)}%`}function Br(e){let t=ot.children[e];un[e]?.cancel(),un[e]=t.animate(ru,cu)}function Ao(e){un[e]?.cancel()}function Wr(e){let t=ot.children[e];un[e]?.cancel(),un[e]=t.animate(uu,du)}function Co(e){xu.style.width=`${Math.min(e*100,100)}%`}function zl(e){if(no[e]){console.warn(`Tried to add quest "${e}" to display, but it's already there!`);return}else if(O[e].is_hidden){console.warn(`Tried to add quest "${e}" to display, but it's a hidden quest!`);return}let t=O[e],i=Nu(e);no[e]=i,so.appendChild(i),t.is_finished&&i.classList.add("quest_finished"),Or()}function tn(e){if(O[e].is_hidden){console.warn(`Tried to update display of quest "${e}", but it's a hidden quest!`),console.trace();return}else if(!no[e]){console.warn(`Tried to update display of quest "${e}", but it's not in display!`);return}let t=O[e],i=document.querySelector(`[data-quest_id="${e}"]`),a=i.querySelector(".quest_name_div");a.innerText=t.getQuestName();let s=i.querySelector(".quest_description_div");s.innerText=t.getQuestDescription()??"",t.is_finished&&i.classList.add("quest_finished"),Ru(e),Or()}function Or(){[...so.children].sort((e,t)=>{let i=O[e.getAttribute("data-quest_id")],a=O[t.getAttribute("data-quest_id")];return i.is_finished&&!a.is_finished?1:!i.is_finished&&a.is_finished?-1:i.display_priority!==a.display_priority?i.display_priority-a.display_priority:i.getQuestName()>a.getQuestName()?1:-1}).forEach(e=>so.appendChild(e))}function Nu(e){let t=O[e],i=document.createElement("div");i.dataset.quest_id=e;let a=document.createElement("div"),s=document.createElement("div");return i.classList.add("quest_div"),s.innerText=t.getQuestName(),s.classList.add("quest_name_div"),a.innerText=t.getQuestDescription(),a.classList.add("quest_description_div"),i.appendChild(s),i.appendChild(a),i.appendChild(Pr(e)),i.addEventListener("click",n=>{n.target.classList.contains("quest_name_div")&&i.classList.toggle("quest_div_expanded")}),i}function Pr(e){let t=O[e],i=document.createElement("div");i.classList.add("quest_task_list_div");let a=t.quest_tasks.findIndex(s=>!s.is_finished);a=a==-1?t.quest_tasks.length:a;for(let s=0;s<a;s++)t.quest_tasks[s].is_hidden||i.appendChild(co(e,s));return a!==t.quest_tasks.length&&(t.quest_tasks[a].is_hidden||i.appendChild(co(e,a))),i}function co(e,t){let i=O[e].quest_tasks[t],a=document.createElement("div");a.classList.add("quest_task_div");let s=document.createElement("span");s.classList.add("task_status_icon");let n;i.is_finished?(a.classList.add("task_finished"),n='<i class="material-icons">check_box</i>'):n='<i class="material-icons">check_box_outline_blank</i>',j(s,n);let o=document.createElement("div");o.classList.add("task_description_div"),o.innerText=i.task_description;let l=document.createElement("div"),d=0;if(Object.keys(i.task_condition).forEach(u=>{if(Object.keys(i.task_condition[u]).length){let h=document.createElement("div");h.classList.add("task_condition_div"),h.innerText+=u+":",Object.keys(i.task_condition[u]).forEach(_=>{let w=document.createElement("div");w.classList.add("task_type_div"),w.innerText+=_l[_]+":",Object.keys(i.task_condition[u][_]).forEach(b=>{let g=document.createElement("div");g.classList.add("task_target_div"),g.innerText+=b+": "+i.task_condition[u][_][b].current+"/"+i.task_condition[u][_][b].target,w.appendChild(g),d++}),h.appendChild(w)}),l.appendChild(h)}}),d==1){let u=l.getElementsByClassName("task_condition_div");for(let h=0;h<u.length;h++)u.item(h).innerText=u.item(h).innerText.replace("any:","").replace("all:","")}return a.appendChild(s),a.appendChild(o),a.appendChild(l),a}function Yl(e,t){let i=O[e];if(i.quest_tasks[t].is_hidden||i.is_hidden)return;let s=document.querySelector(`[data-quest_id="${e}"]`).querySelector(".quest_task_list_div");(s.children.item(t)||s.children.item(t-1)).replaceWith(co(e,t))}function Ru(e){let i=document.querySelector(`[data-quest_id="${e}"]`).querySelector(".quest_task_list_div");i.replaceWith(Pr(e)),i.remove()}function Lo(){vu.checked?document.documentElement.style.setProperty("--completed_quest_display","none"):document.documentElement.style.setProperty("--completed_quest_display","block")}function ca(){Bo("rain")}function ua(){Bo("snow")}function da(){Bo("stars")}function Bo(e){mn();let t;switch(e){case"snow":t=Hn,tt=document.getElementById("foreground_canvas");break;case"rain":t=Gn,tt=document.getElementById("foreground_canvas");break;case"stars":t=zn,tt=document.getElementById("background_canvas");break;default:break}ia=tt.getContext("2d"),tt.width=ia.canvas.clientWidth,tt.height=ia.canvas.clientHeight,Qn=[];for(let i=0;i<Math.ceil(tt.width*tt.height/5e3);i++)Qn.push(new t({canvas:tt}));jr()}function mn(){tt=tt||document.getElementById("foreground_canvas"),ia=ia||tt.getContext("2d"),ia.clearRect(0,0,tt.width,tt.height),cancelAnimationFrame(tr),clearTimeout(ir)}function jr(){ir=setTimeout(()=>{tr=requestAnimationFrame(jr),ia.clearRect(0,0,tt.width,tt.height);for(let e=0;e<Qn.length;e++)Qn[e].draw()},1e3/60)}function Nr(e,t){if(e>t)Ql.innerText="Reward available!";else{let i=t-e;i/=1e3;let a=Math.floor(i%60);i=Math.floor(i/60);let s=Math.floor(i%60);i=Math.floor(i/60);let n=i;Ql.innerText=`Reward available in: ${n}:${s}:${a} real time`}}function Wa(e){e?(di.innerText=`Load the backup autosave [${e.replaceAll("_",":")}]`,di.style["background-image"]="var(--options_gradient);",di.style["background-color"]="transparent",di.style.color="white",di.style.cursor="pointer"):(di.style["background-image"]="none",di.style["background-color"]="#181818",di.style.color="gray",di.style.cursor="not-allowed")}function hn(e,t){t?Tt.innerText="Import save from main version":Tt.innerText="Import save from dev version",e!==void 0?(Tt.style["background-image"]="var(--options_gradient);",Tt.style["background-color"]="transparent",Tt.style.color="white",Tt.style.cursor="pointer",e?Tt.innerText+=` [${e.replaceAll("_",":")}]`:Tt.innerText+=" [unknown date]"):(Tt.style["background-image"]="none",Tt.style["background-color"]="#181818",Tt.style.color="gray",Tt.style.cursor="not-allowed")}function Rr(){document.getElementById("loading_screen").style.visibility="hidden"}function gs(e){let t=document.getElementById("loading_screen_version_info"),i=Yn(),a=`Save game version: ${e||"none"}<br> Current game version: ${i}<br>`;e&&(e===i?a+="<div class='top_border'>No changes since the last time you played~</div>":Qe(e,i)?a+="<div class='top_border'>Game has been updated since the last time you played, check the changelog for more details</div>":a+="<div class='top_border'>Your save is from a newer version of the game. Continuing is likely to lead to multiple issues!</div>"),ae(t,a)}function Wt(e){qu.innerText=e}function Wo(){document.getElementById("loading_screen_loading_text").classList.add("fade")}function Fr(){let e=document.getElementById("loading_screen_status");e.classList.remove("loading_screen_status_warnings"),e.classList.add("loading_screen_status_errors"),e.innerText="An error has occured on loading! Please open the browser console to check for details and then let the developer know!"}function Gr(){let e=document.getElementById("loading_screen_status");e.classList.add("loading_screen_status_warnings"),e.innerText="A potential issue has occured on loading. Please open the browser console to check for details."}function Oo(){let e=document.getElementById("loading_screen_play_button");e.classList.remove("none_display"),e.classList.add("fade_in")}function Hr(e){let t=document.getElementById("loading_screen_play_button");t.innerText=e}function Vn({element:e,siblings_only:t=!1,class_name:i}){let a=t?e.parentNode.querySelectorAll(`.${i}`):document.getElementsByClassName(i),s=e.classList.contains(i);for(let n=0;n<a.length;n++)a[n].classList.remove(i);s||e.classList.add(i)}function Dn(e){let t=document.getElementsByClassName(e);for(;t.length>0;)t.item(0).classList.remove(e)}function uo(e,t){let i=e.getBoundingClientRect(),a=t.getBoundingClientRect();return i.bottom<=a.top}var Fu=.75,Ro=10;var Ai=()=>r.name.match(/\b(?<![\w])rat\b/i),Vr=10,Qr=60,Ur=20,Oa=[14,8,2,-4],rn=Oa[0],ws=["Cold","Very cold","Freezing","Hypothermia"],Fo=class extends Ii{constructor(){super(),this.base_stats={max_health:50,health:50,health_regeneration_flat:0,health_regeneration_percent:0,health_loss_flat:0,health_loss_percent:0,max_stamina:50,stamina:50,stamina_regeneration_flat:0,stamina_regeneration_percent:0,stamina_efficiency:1,max_mana:0,mana:0,mana_regeneration_flat:0,mana_regeneration_percent:0,mana_efficiency:1,strength:10,agility:10,dexterity:10,intuition:10,magic:0,attack_speed:1,crit_rate:.05,crit_multiplier:1.3,attack_power:0,defense:0,block_strength:0,block_chance:0,evasion_points:0,attack_points:0,heat_tolerance:0,cold_tolerance:0,unarmed_power:1,armor_penetration:0},this.name="Hero",this.titles={},this.stats={full:{...this.base_stats},total_flat:{},total_multiplier:{},flat:{level:{},skills:{},equipment:{},skill_milestones:{},books:{},light_level:{},environment:{}},multiplier:{skills:{},skill_milestones:{},equipment:{},books:{},stance:{},light_level:{},environment:{}}},this.reputation={Village:0,Slums:0,Town:0},this.bonus_skill_levels={full:{},flat:{equipment:{},active_effects:{},skills:{}}},this.xp_bonuses={total_multiplier:{hero:1,all:1,all_skill:1},multiplier:{levels:{},skills:{},books:{},active_effects:{}}},this.equipment={head:null,torso:null,arms:null,ring:null,weapon:null,"off-hand":null,legs:null,feet:null,amulet:null,artifact:null,cape:null,axe:null,pickaxe:null,sickle:null,shovel:null,fishing_pole:null},this.money=0,this.xp={current_level:0,total_xp:0,current_xp:0,xp_to_next_lvl:Ro,total_xp_to_next_lvl:Ro,base_xp_cost:Ro,xp_scaling:1.6}}add_xp({xp_to_add:t,use_bonus:i=!0}){if(i&&(t*=(r.xp_bonuses.total_multiplier.hero||1)*(r.xp_bonuses.total_multiplier.all||1)),r.xp.total_xp+=t,t+r.xp.current_xp<r.xp.xp_to_next_lvl)r.xp.current_xp+=t;else{let a=0;for(;r.xp.total_xp>=r.xp.total_xp_to_next_lvl;)a+=1,r.xp.total_xp_to_next_lvl=Math.round(r.xp.base_xp_cost*(1-r.xp.xp_scaling**(a+1))/(1-r.xp.xp_scaling));let s=Math.round(r.xp.base_xp_cost*(1-r.xp.xp_scaling**a)/(1-r.xp.xp_scaling)),n=r.get_level_bonus(a);return r.xp.xp_to_next_lvl=r.xp.total_xp_to_next_lvl-s,r.xp.current_level=a,r.xp.current_xp=r.xp.total_xp-s,`${r.name} is getting stronger. Reached level ${r.xp.current_level} ${n}`}}get_level_bonus(t){let i=0,a=0,s=0,n=0,o=0,l=0,d=1.03,u=1;for(let _=r.xp.current_level+1;_<=t;_++)_%2==1?(s+=Math.ceil(_/10),l+=Math.ceil(_/10)):(n+=Math.ceil(_/10),o+=Math.ceil(_/10)),i+=10*Math.ceil(_/10),a+=5,u=u*d;r.stats.flat.level.max_health=(r.stats.flat.level.max_health||0)+i,r.stats.flat.level.health=r.stats.flat.level.max_health,r.stats.flat.level.max_stamina=(r.stats.flat.level.max_stamina||0)+a,r.stats.flat.level.stamina=r.stats.flat.level.max_stamina,r.stats.flat.level.strength=(r.stats.flat.level.strength||0)+s,r.stats.flat.level.intuition=(r.stats.flat.level.intuition||0)+l,r.stats.flat.level.agility=(r.stats.flat.level.agility||0)+n,r.stats.flat.level.dexterity=(r.stats.flat.level.dexterity||0)+o,r.xp_bonuses.multiplier.levels.all_skill=(r.xp_bonuses.multiplier.levels.all_skill||1)*u;let h=`<br>HP increased by ${i}<br>Stamina increased by ${a}`;return s>0&&(h+=`<br>Strength increased by ${s}`),n>0&&(h+=`<br>Agility increased by ${n}`),o>0&&(h+=`<br>Dexterity increased by ${o}`),l>0&&(h+=`<br>Intuition increased by ${l}`),h+=`<br>Skill xp gains increased by ${Math.round((d-1)*100)}%`,h}},r=new Fo;r.stats.add_skill_milestone_bonus=function({stats:e={},xp_multipliers:t={}}){Object.keys(e).forEach(i=>{e[i].flat&&(r.stats.flat.skill_milestones[i]=(r.stats.flat.skill_milestones[i]||0)+e[i].flat),e[i].multiplier&&(r.stats.multiplier.skill_milestones[i]=(r.stats.multiplier.skill_milestones[i]||1)*e[i].multiplier)}),t?.hero&&(r.xp_bonuses.multiplier.skills.hero=(r.xp_bonuses.multiplier.skills.hero||1)*t.hero),t?.all&&(r.xp_bonuses.multiplier.skills.all=(r.xp_bonuses.multiplier.skills.all||1)*t.all),t?.all_skill&&(r.xp_bonuses.multiplier.skills.all_skill=(r.xp_bonuses.multiplier.skills.all_skill||1)*t.all_skill),Object.keys(f).forEach(i=>{t[i]&&(r.xp_bonuses.multiplier.skills[i]=(r.xp_bonuses.multiplier.skills[i]||1)*t[i])}),Object.keys(Ui).forEach(i=>{let a="category_"+i;t[a]&&(r.xp_bonuses.multiplier.skills[a]=(r.xp_bonuses.multiplier.skills[a]||1)*t[a])})};r.stats.add_book_bonus=function({multipliers:e={},xp_multipliers:t={}}){Object.keys(r.base_stats).forEach(i=>{e[i]&&(r.stats.multiplier.books[i]=(r.stats.multiplier.books[i]||1)*e[i])}),t?.hero&&(r.xp_bonuses.multiplier.books.hero=(r.xp_bonuses.multiplier.books.hero||1)*t.hero),t?.all&&(r.xp_bonuses.multiplier.books.all=(r.xp_bonuses.multiplier.books.all||1)*t.all),t?.all_skill&&(r.xp_bonuses.multiplier.books.all_skill=(r.xp_bonuses.multiplier.books.all_skill||1)*t.all_skill),Object.keys(f).forEach(i=>{t[i]&&(r.xp_bonuses.multiplier.books[i]=(r.xp_bonuses.multiplier.books[i]||1)*t[i])})};r.stats.add_active_effect_bonus=function(){r.stats.flat.active_effects={},r.stats.multiplier.active_effects={},r.bonus_skill_levels.flat.active_effects={},r.xp_bonuses.multiplier.active_effects={},Object.keys(Se).forEach(e=>{let t=1,i=jo(Se[e]);for(let[a,s]of Object.entries(i.stats))s.flat&&(r.stats.flat.active_effects[a]=(r.stats.flat.active_effects[a]||0)+s.flat*t),s.multiplier&&(r.stats.multiplier.active_effects[a]=(r.stats.multiplier.active_effects[a]||1)*s.multiplier*t);for(let[a,s]of Object.entries(i.bonus_skill_levels))r.bonus_skill_levels.flat.active_effects[a]=(r.bonus_skill_levels.flat.active_effects[a]||0)+s;for(let[a,s]of Object.entries(i.xp_multipliers))r.xp_bonuses.multiplier.active_effects[a]=(r.xp_bonuses.multiplier.active_effects[a]||1)*s})};r.stats.add_all_equipment_bonus=function(){r.stats.flat.equipment={},r.stats.multiplier.equipment={},r.bonus_skill_levels.flat.equipment={},Object.keys(r.equipment).forEach(e=>{if(!r.equipment[e])return;r.equipment[e].getDefense&&(r.stats.flat.equipment.defense=(r.stats.flat.equipment.defense||0)+r.equipment[e].getDefense());let t=r.equipment[e].getStats(),i=r.equipment[e].getBonusSkillLevels();Object.keys(t).forEach(a=>{t[a].flat&&(r.stats.flat.equipment[a]=(r.stats.flat.equipment[a]||0)+t[a].flat),t[a].multiplier&&(r.stats.multiplier.equipment[a]=(r.stats.multiplier.equipment[a]||1)*t[a].multiplier)}),Object.keys(i).forEach(a=>{i[a]&&(r.bonus_skill_levels.flat.equipment[a]=(r.bonus_skill_levels.flat.equipment[a]||0)+i[a])})}),r.stats.add_weapon_type_bonuses()};r.stats.add_weapon_type_bonuses=function(){r.equipment.weapon==null?(r.stats.multiplier.skills.attack_power=R({skill_id:"Unarmed"}),r.stats.multiplier.skills.attack_speed=R({scaling_type:"multiplicative",skill_id:"Unarmed"})**.3333,r.stats.multiplier.skills.attack_points=R({scaling_type:"multiplicative",skill_id:"Unarmed"})**.3333,r.stats.multiplier.skills.evasion_points=R({scaling_type:"multiplicative",skill_id:"Unarmed"})**.3333):(r.stats.multiplier.skills.attack_speed=1,r.stats.multiplier.skills.attack_power=R({skill_id:Za[r.equipment.weapon.weapon_type]}),r.stats.multiplier.skills.attack_points=R({skill_id:Za[r.equipment.weapon.weapon_type]})**.3333,r.stats.multiplier.skills.evasion_points=1)};r.stats.add_all_skill_level_bonus=function(){r.stats.flat.skills.defense=$t("Iron skin"),r.stats.multiplier.skills.stamina_efficiency=R({scaling_type:"multiplicative",skill_id:"Running"}),r.stats.multiplier.skills.strength=R({scaling_type:"multiplicative",skill_id:"Weightlifting"})*R({scaling_type:"multiplicative",skill_id:"Climbing"})*R({scaling_type:"multiplicative",skill_id:"Breathing"}),r.stats.multiplier.skills.block_strength=1+5*$t("Shield blocking"),r.stats.multiplier.skills.agility=R({scaling_type:"multiplicative",skill_id:"Equilibrium"})*R({scaling_type:"multiplicative",skill_id:"Climbing"})*R({scaling_type:"multiplicative",skill_id:"Breathing"})*R({scaling_type:"multiplicative",skill_id:"Swimming"}),r.stats.multiplier.skills.dexterity=R({scaling_type:"multiplicative",skill_id:"Climbing"}),r.stats.multiplier.skills.max_stamina=R({scaling_type:"multiplicative",skill_id:"Breathing"})*R({scaling_type:"multiplicative",skill_id:"Swimming"}),r.stats.multiplier.skills.max_health=R({scaling_type:"multiplicative",skill_id:"Fortitude"}),r.stats.multiplier.skills.intuition=R({scaling_type:"multiplicative",skill_id:"Meditation"}),r.stats.flat.skills.unarmed_power=f.Unarmed.current_level*.1,r.stats.flat.skills.crit_rate=Math.min(f.Perception.max_level,K("Perception"))/100,r.stats.add_weapon_type_bonuses(),r.stats.flat.skills.cold_tolerance=.5*K("Cold resistance")};r.stats.add_all_stance_bonus=function(){let e=Fe.getStats();Object.keys(r.base_stats).forEach(t=>{e[t]?r.stats.multiplier.stance[t]=e[t]||1:r.stats.multiplier.stance[t]=1})};r.stats.add_location_penalties=function(){let e={},t=1;x&&("connected_locations"in x||(e=x.get_total_effect().hero_penalty),x.light_level==="dark"||x.light_level==="normal"&&Si(E)?(t=.5+.5*K("Night vision")/f["Night vision"].max_level,r.stats.multiplier.light_level.evasion_points=t,r.stats.multiplier.light_level.attack_points=t):(r.stats.multiplier.light_level.evasion_points=1,r.stats.multiplier.light_level.attack_points=1)),r.stats.multiplier.environment={},r.stats.flat.environment={},Object.keys(e.multipliers||{}).forEach(i=>{r.stats.multiplier.environment[i]=e.multipliers[i]}),Object.keys(e.flats||{}).forEach(i=>{r.stats.flat.environment[i]=e.flats[i]})};r.get_character_cold_tolerance=function(){return r.stats.full.cold_tolerance};r.get_character_heat_tolerance=function(){return r.stats.full.heat_tolerance};r.update_stats=function(){let e=Math.max(r.stats.full.max_health-r.stats.full.health,0)||0,t=Math.max(r.stats.full.max_stamina-r.stats.full.stamina,0)||0,i=Math.max(r.stats.full.max_mana-r.stats.full.mana,0)||0;Object.keys(r.bonus_skill_levels.full).forEach(a=>{if(a.includes("category_"))return;let s="category_"+f[a].category;r.bonus_skill_levels.full[a]=(r.bonus_skill_levels.flat.equipment[a]||0)+(r.bonus_skill_levels.flat.active_effects[a]||0)+(r.bonus_skill_levels.flat.skills[a]||0)+(r.bonus_skill_levels.flat.equipment[s]||0)+(r.bonus_skill_levels.flat.active_effects[s]||0)+(r.bonus_skill_levels.flat.skills[s]||0),r.bonus_skill_levels.full[a]!=0&&ms(f[a])}),r.stats.add_all_skill_level_bonus(),r.stats.add_all_stance_bonus(),Object.keys(r.stats.full).forEach(a=>{let s=0,n=1;a==="block_chance"?s=Fu+Math.round($t("Shield blocking")*1e4)/1e4:a==="attack_points"?s=Math.sqrt(r.stats.full.intuition)*r.stats.full.dexterity*R({scaling_type:"multiplicative",skill_id:"Combat"}):a==="evasion_points"?s=r.stats.full.agility*Math.sqrt(r.stats.full.intuition)*R({scaling_type:"multiplicative",skill_id:"Evasion"}):Object.values(r.stats.flat).forEach(o=>{s+=o[a]||0}),Object.values(r.stats.multiplier).forEach(o=>{n*=o[a]||1}),r.stats.full[a]=(r.base_stats[a]+s)*n,r.stats.total_flat[a]=r.base_stats[a]+s,r.stats.total_multiplier[a]=n||1,a==="health"?r.stats.full.health=Math.max(0,r.stats.full.max_health-e):a==="stamina"?r.stats.full.stamina=Math.max(0,r.stats.full.max_stamina-t):a==="mana"&&(r.stats.full.mana=Math.max(0,r.stats.full.max_mana-i))}),r.equipment.weapon!=null?r.stats.full.attack_power=r.stats.full.strength/10*r.equipment.weapon.getAttack()*r.stats.total_multiplier.attack_power:r.stats.full.attack_power=r.stats.full.strength/10*r.stats.total_multiplier.attack_power*r.stats.full.unarmed_power,r.stats.total_flat.attack_power=r.stats.full.attack_power/r.stats.total_multiplier.attack_power,Object.keys(r.xp_bonuses.total_multiplier).forEach(a=>{r.xp_bonuses.total_multiplier[a]=(r.xp_bonuses.multiplier.levels[a]||1)*(r.xp_bonuses.multiplier.skills[a]||1)*(r.xp_bonuses.multiplier.books[a]||1)*(r.xp_bonuses.multiplier.active_effects[a]||1),r.xp_bonuses.total_multiplier[a]!=1&&(a!=="hero"&&(a==="all"||a==="all_skill"||a.includes("category_")?hs():Ba(f[a])),(a==="hero"||a==="all")&&rs())})};r.get_stamina_multiplier=function(){return r.stats.full.stamina==0?.5+$t("Persistence"):1};r.get_attack_speed=function(){return r.stats.full.attack_speed*r.get_stamina_multiplier()};r.get_attack_power=function(){return r.stats.full.attack_power*r.get_stamina_multiplier()};r.wears_armor=function(){return r.equipment.head&&r.equipment.head.getDefense()!==0||r.equipment.torso&&r.equipment.torso.getDefense()!==0||r.equipment.arms&&r.equipment.arms.getDefense()!==0||r.equipment.legs&&r.equipment.legs.getDefense()!==0||r.equipment.feet&&r.equipment.feet.getDefense()!==0||r.equipment.cape&&r.equipment.cape.getDefense()!==0};r.take_damage=function({damage_values:e,can_faint:t=!0,give_skill_xp:i=!0,defense_modifier:a=0}){let s;e=e.map(o=>o<1?Math.max(Math.ceil(10*o)/10,0):Math.ceil(10*Math.max(o-(r.stats.full.defense+a),o*.05,1))/10);let n=e.reduce((o,l)=>o+l);return r.stats.full.health-=n,r.stats.full.health<=0&&t?(s=!0,r.stats.full.health=0):s=!1,{damage_taken:n,fainted:s}};r.get_character_money=function(){return r.money};function et(e){let t=r.add_to_inventory(e);Ni.log_items(e),ve({was_anything_new_added:t}),us()}function wt(e){r.remove_from_inventory(e),ve();for(let t=0;t<e.length;t++){if(r.inventory[e[t].item_key])continue;let{id:i}=JSON.parse(e[t].item_key);if(i&&c[i].tags.usable&&Vt[i])ys(i);else if(gi[e[t].item_key]){let a=xe(e[t].item_key);(a.tags.component||a.tags.equippable)&&r.equipment[a.equip_slot]?.getInventoryKey()!==a.getInventoryKey()&&zo(e[t].item_key)}}}function wi(e,t){if(!e)Pi(),r.stats.add_all_equipment_bonus(),Re();else{let i=r.equipment[e.equip_slot];Ho(e.equip_slot,!0),r.equipment[e.equip_slot]=e,Pi(),ve({skip_sorting:t}),r.stats.add_all_equipment_bonus(),Re(),Go(e),i&&Go(i)}}function Kr(e){e in r.inventory&&(wi(r.inventory[e].item),wt([{item_key:e}]))}function Ho(e,t=!1){if(r.equipment[e]!=null){let i=r.equipment[e];et([{item_key:i.getInventoryKey()}]),r.equipment[e]=null,Pi(),ve(),t||(r.stats.add_all_equipment_bonus(),Re(),Go(i))}}function Go(e){let t=Object.keys(e.getBonusSkillLevels());if(t.length>0)for(let i=0;i<t.length;i++)t[i].includes("category_")||ms(f[t[i]])}function Oi(){return r.get_character_cold_tolerance()}function Re(){r.stats.add_location_penalties(),r.update_stats(),os(),fi(),la(),cs(),Object.keys(r.inventory).forEach(e=>{xe(e).tags.shield&&ve({item_key:e})}),r.equipment["off-hand"]&&(Pi(),ve({equip_slot:"off-hand"}))}function ji(e){return(r.xp_bonuses.total_multiplier[e]||1)*Po(e)}function Po(e){let t="category_"+f[e].category;return(r.xp_bonuses.total_multiplier.all_skill||1)*(r.xp_bonuses.total_multiplier.all||1)*(r.xp_bonuses.total_multiplier[t]||1)}function zr(){return(r.xp_bonuses.total_multiplier.all_skill||1)*(r.xp_bonuses.total_multiplier.all||1)}function Yr(){return(r.xp_bonuses.total_multiplier.hero||1)*(r.xp_bonuses.total_multiplier.all||1)}function K(e){return f[e].current_level+(r.bonus_skill_levels.full[e]||0)}function Pl(e,t){return Math.min(1,Math.max(0,(K(e)-t[0]+1)/(t[1]-t[0]+1)))}function $t(e){return f[e].get_level_bonus(K(e))}function R({scaling_type:e,skill_id:t}){return f[t].get_coefficient({scaling_type:e,skill_level:K(t)})}function jo(e){let t=1;Object.keys(Di).forEach(a=>{e.tags[Di[a]]&&(t*=R({scaling_type:"multiplicative",skill_id:a}))});let i={stats:{},bonus_skill_levels:{...e.effects.bonus_skill_levels},xp_multipliers:{...e.effects.xp_multipliers}};for(let[a,s]of Object.entries(e.effects.stats))i.stats[a]={},s.flat?a.includes("_percent")?i.stats[a].flat=s.flat*(t>0?t:1):i.stats[a].flat=s.flat*(t>0?t:1)**2:s.multiplier&&(i.stats[a].multiplier=s.multiplier*(t>1?t:1));return i}var Ee={trash:1,common:1,uncommon:1.1,rare:1.3,epic:1.6,legendary:2,mythical:2.5},c={},Ni={items:{},log_items(e){for(let t=0;t<e.length;t++)if(e[t].item_id)this.log_item(e[t].item_id,e[t].count,e[t].quality);else if(e[t].item_key){let i=xe(e[t].item_key);this.log_item(i.id,e[t].count,i.quality)}else console.warn("id not included!")},log_item(e,t=1,i=0){this.items[e]||(this.items[e]={id:e,number:0,quality_highest:0,quality_lowest:Number.POSITIVE_INFINITY}),this.items[e].number+=t,this.items[e].quality_highest=Math.max(this.items[e].quality_highest,i),this.items[e].quality_lowest=Math.min(this.items[e].quality_lowest,i)},is_known(e){return this.items[e]}};function fn(e){let t;if(c[e].component_type==="helmet interior")t="head";else if(c[e].component_type==="chestplate interior")t="torso";else if(c[e].component_type==="leg armor interior")t="legs";else if(c[e].component_type==="glove interior")t="arms";else if(c[e].component_type==="shoes interior")t="feet";else return console.error(`Component type "${c[e].component_type}" doesn't correspond to any armor slot!`),null;return t}function at(e){let t;return e<50?t="trash":e<=100?t="common":e<130?t="uncommon":e<160?t="rare":e<200?t="epic":e<246?t="legendary":t="mythical",t}function Gu({components:e,quality:t=100}){let i=0;return Object.values(e).forEach(a=>{i+=c[a].value}),We(1.25*i*(t/100)*Ee[at(t)])}var ma=class{constructor({name:t,description:i,value:a=0,tags:s={},market_saturation_group:n,saturates_market:o,material_type:l=null,quality:d=null,id:u=null,components:h=null,getName:_=()=>this.name}){if(this.name=t,this.name?.startsWith(Oe))throw new Error(`Item name of item "${this.name}" starts with a forbidden prefix!`);this.id=u,this.description=i,this.saturates_market=o??!0,this.material_type=l,this.quality=d,this.components=h,this.value=a,this.tags=s,this.tags.item=!0,this.market_saturation_group=n,this.getName||(this.getName=_)}getMarketSaturationGroup(){return this.market_saturation_group||{group_key:this.id,group_tier:0}}getInventoryKey(){return this.inventory_key||(this.inventory_key=this.createInventoryKey()),this.inventory_key}createInventoryKey(){let t={};return this.components?(t.components={},Object.keys(this.components).forEach(i=>{t.components[i]=this.components[i]})):t.id=this.id,this.quality&&(t.quality=this.quality),JSON.stringify(t)}getBaseValue({quality:t,multiplier:i=1}={}){return t=t||this.quality||100,this.components?Gu({components:this.components,quality:t}):We(i*this.value*(t/100)*Ee[at(t)])}getValue({quality:t,region:i,multiplier:a}){return t=t||this.quality||100,!this.saturates_market||!i?this.getBaseValue({quality:t,multiplier:a}):this.getValueWithSaturation(i,a)}getValueWithSaturation(t,i=1){let{group_key:a,group_tier:s}=this.getMarketSaturationGroup();return bl({item:this,value:We(this.getBaseValue()*i),group_key:a,group_tier:s,region:t})}getValueOfMultiple({additional_traded_count:t=0,count:i,region:a,price_multiplier:s=1,is_selling:n=!0,stop_multiplier_at:o=1/0}){if(this.saturates_market){let{group_key:l,group_tier:d}=this.getMarketSaturationGroup(),u=this.getBaseValue(),h=kl({value:We(u*s),start_count:Bs({region:a,group_key:l,group_tier:d})+t,how_many_to_trade:i,region:a,is_group:l.startsWith(Oe),is_selling:n,stop_multiplier_at:o});return Math.max(i,h)}else return We(this.getBaseValue()*s)*i}getDescription(){return this.description}},ht=class extends ma{constructor(t){super(t),this.item_type="OTHER"}},S=class extends ht{constructor(t){super(t),this.item_type="MATERIAL",this.tags.material=!0}},_n=class extends ma{constructor(t){super(t),this.item_type="COMPONENT",this.component_tier=t.component_tier||1,this.component_stats=t.component_stats||{},this.component_bonus_skill_levels=t.component_bonus_skill_levels||{},this.tags.component=!0,this.quality=Math.round(t.quality)||100}getRarity(t){return t?at(t):(this.rarity||(this.rarity=at(this.quality)),this.rarity)}calculateRarity(t){let i;return t<50?i="trash":t<100?i="common":t<130?i="uncommon":t<160?i="rare":t<200?i="epic":t<246?i="legendary":i="mythical",i}getStats(){return this.component_stats}getBonusSkillLevels(){return this.component_bonus_skill_levels}},Y=class extends _n{constructor(t){if(super(t),t.component_type!=="axe head"&&t.component_type!=="hammer head"&&t.component_type!=="short blade"&&t.component_type!=="long blade"&&t.component_type!=="short handle"&&t.component_type!=="long handle"&&t.component_type!=="medium handle")throw new Error(`No such weapon component type as ${t.component_type}`);this.component_type=t.component_type,this.attack_value=t.attack_value||0,t.component_type==="short handle"?(this.attack_multiplier=1,this.market_saturation_group={group_key:Oe+"handle",group_tier:this.component_tier-1}):t.component_type==="medium handle"?(this.attack_multiplier=1,this.market_saturation_group={group_key:Oe+"handle",group_tier:this.component_tier-1}):t.component_type==="long handle"?(this.attack_multiplier=1.5,this.market_saturation_group={group_key:Oe+"handle",group_tier:this.component_tier-1}):(this.attack_multiplier=1,this.market_saturation_group={group_key:Oe+"weapon",group_tier:this.component_tier-1}),this.name_prefix=t.name_prefix,this.tags["weapon component"]=!0,this.tags.component=!0}},Ce=class extends _n{constructor(t){if(super(t),t.component_type!=="shield base"&&t.component_type!=="shield handle")throw new Error(`No such shield component type as ${t.component_type}`);this.component_type=t.component_type,t.component_type==="shield base"?this.market_saturation_group={group_key:Oe+"shield",group_tier:this.component_tier-1}:this.market_saturation_group={group_key:Oe+"handle",group_tier:this.component_tier-1},this.shield_strength=t.shield_strength,this.shield_name=t.shield_name||t.name,this.tags["shield component"]=!0,this.tags.component=!0}},X=class extends _n{constructor(t){if(super(t),t.component_type!=="helmet interior"&&t.component_type!=="helmet exterior"&&t.component_type!=="chestplate interior"&&t.component_type!=="chestplate exterior"&&t.component_type!=="leg armor interior"&&t.component_type!=="leg armor exterior"&&t.component_type!=="glove interior"&&t.component_type!=="glove exterior"&&t.component_type!=="shoes interior"&&t.component_type!=="shoes exterior")throw new Error(`No such armor component type as ${t.component_type}`);this.component_type=t.component_type,this.defense_value=t.defense_value,this.stats=t.stats||{},this.equip_slot=t.equip_slot,this.full_armor_name=t.full_armor_name,this.armor_name=t.armor_name,this.name_prefix=t.name_prefix,this.name_suffix=t.name_suffix,this.tags["armor component"]=!0,this.tags.component=!0,this.market_saturation_group={group_key:Oe+"armor",group_tier:this.component_tier-1}}},le=class extends ma{constructor(t){super(t),this.item_type="USABLE",this.effects=t.effects||{},this.recovery_chances=t.recovery_chances||{},this.saturates_market=!1,this.tags.usable=!0}},ai=class extends ma{constructor(t){super(t),this.item_type="EQUIPPABLE",this.base_bonus_skill_levels=t.base_bonus_skill_levels,this.quality=Math.round(Number(t.quality))||100,this.tags.equippable=!0}getItemTier(){if(this.components){let t=1;return Object.values(this.components).forEach(i=>{c[i].component_tier>t&&(t=c[i].component_tier)}),t}else return this.component_tier?this.component_tier:1}getRarity(t){return t?at(t):(this.rarity||(this.rarity=at(this.quality)),this.rarity)}getStats(t){return t?this.calculateStats(t):(this.stats||(this.stats=this.calculateStats(this.quality)),this.stats)}calculateStats(t){let i={};if(this.components){let a=Object.values(this.components).map(s=>c[s]).filter(s=>s);for(let s=0;s<a.length;s++)Object.keys(a[s].component_stats).forEach(n=>{i[n]||(i[n]={}),!(n==="defense"||n==="attack_power"||n==="block_strength")&&(a[s].component_stats[n].multiplier&&(i[n].multiplier=(i[n].multiplier||1)*a[s].component_stats[n].multiplier),a[s].component_stats[n].flat&&(i[n].flat=(i[n].flat||0)+a[s].component_stats[n].flat))});Object.keys(i).forEach(s=>{i[s].multiplier&&(i[s].multiplier>=1?i[s].multiplier=Math.round(100*(1+(i[s].multiplier-1)*Ee[this.getRarity(t)]))/100:i[s].multiplier=Math.round(100*i[s].multiplier)/100),i[s].flat&&(i[s].flat>0?i[s].flat=Math.round(100*i[s].flat*Ee[this.getRarity(t)])/100:i[s].flat=Math.round(100*i[s].flat)/100)})}else{let a=this.component_stats||this.base_stats||{};Object.keys(a).forEach(s=>{i[s]={},a[s].multiplier&&(i[s].multiplier=1,a[s].multiplier>=1?i[s].multiplier=Math.round(100*(1+(a[s].multiplier-1)*Ee[this.getRarity(t)]))/100:i[s].multiplier=Math.round(100*a[s].multiplier)/100),a[s].flat&&(i[s].flat=0,a[s].flat>0?i[s].flat=Math.round(100*a[s].flat*Ee[this.getRarity(t)])/100:i[s].flat=Math.round(100*a[s].flat)/100)})}return i}getBonusSkillLevels(t){return t?this.calculateBonusSkillLevels(t):(this.bonus_skill_levels||(this.bonus_skill_levels=this.calculateBonusSkillLevels(this.quality)),this.bonus_skill_levels)}calculateBonusSkillLevels(t){let i={};if(this.components){let a=Object.values(this.components).map(s=>c[s]).filter(s=>s);for(let s=0;s<a.length;s++)Object.keys(a[s].component_bonus_skill_levels).forEach(n=>{i[n]=(i[n]||0)+a[s].component_bonus_skill_levels[n]});Object.keys(i).forEach(s=>{i[s]&&(i[s]>0?i[s]=Math.round(i[s]*Ee[this.getRarity(t)]):i[s]=Math.round(i[s]))})}else{let a=this.component_bonus_skill_levels||this.base_bonus_skill_levels||{};Object.keys(a).forEach(s=>{a[s]>0?i[s]=Math.round(a[s]*Ee[this.getRarity(t)]):i[s]=Math.round(a[s])})}return i}},yi=class extends ai{constructor(t){super(t),this.equip_slot="artifact",this.stats=t.stats,this.ignore_quality=!0,this.tags.artifact=!0,this.id||(this.id=this.getName())}getStats(){return this.stats}},mt=class extends ai{constructor(t){super(t),this.equip_slot=t.equip_slot,this.ignore_quality=!0,this.tags.tool=!0,this.tags[this.equip_slot]=!0,this.id||(this.id=this.getName())}},Ue=class extends ai{constructor(t){if(super(t),this.equip_slot="off-hand",this.offhand_type="shield",!c[t.components.shield_base])throw new Error(`No such shield base component as: ${t.components.shield_base}`);if(this.components.shield_base=t.components.shield_base,t.components.handle&&!c[t.components.handle])throw new Error(`No such shield handle component as: ${t.components.handle}`);this.components.handle=t.components.handle,this.tags={...this.tags,...c[this.components.handle].tags,...c[this.components.shield_base].tags},this.tags.shield=!0,this.id||(this.id=this.getName()),this.market_saturation_group={group_key:Oe+"shield",group_tier:this.getItemTier()-1}}getShieldStrength(t){return t?this.calculateShieldStrength(t):(this.shield_strength||(this.shield_strength=this.calculateShieldStrength(this.quality)),this.shield_strength)}calculateShieldStrength(t){return Math.round(10*Math.ceil(10*c[this.components.shield_base].shield_strength*(c[this.components.handle].component_stats?.block_strength?.multiplier||1)*(t/100)*Ee[this.getRarity(t)]))/100}getName(){return c[this.components.shield_base].shield_name}},N=class extends ai{constructor(t){if(super(t),t.components){if(!c[t.components.internal])throw new Error(`No such internal armor element as: ${t.components.internal}`);if(this.components.internal=t.components.internal,this.components.external=t.components.external,c[this.components.internal].component_type==="helmet interior")this.equip_slot="head";else if(c[this.components.internal].component_type==="chestplate interior")this.equip_slot="torso";else if(c[this.components.internal].component_type==="leg armor interior")this.equip_slot="legs";else if(c[this.components.internal].component_type==="glove interior")this.equip_slot="arms";else if(c[this.components.internal].component_type==="shoes interior")this.equip_slot="feet";else throw new Error(`Component type "${c[this.components.internal].component_type}" doesn't correspond to any armor slot!`);if(t.external&&!c[t.external])throw new Error(`No such external armor element as: ${t.components.external}`);this.market_saturation_group={group_key:Oe+"armor",group_tier:this.getItemTier()-1}}else{if(this.tags.component=!0,this.tags["armor component"]=!0,this.tags.clothing=!0,this.component_stats=t.component_stats||{},this.component_bonus_skill_levels=t.component_bonus_skill_levels||{},delete this.components,!t.name)throw new Error("Component-less item needs to be provided a name!");if(this.name=t.name,!t.value)throw new Error(`Component-less item "${this.getName()}" needs to be provided a monetary value!`);if(this.component_type=t.component_type,this.value=t.value,this.component_tier=t.component_tier||1,this.base_defense=t.base_defense,this.market_saturation_group={group_key:Oe+"clothing",group_tier:this.getItemTier()-1},t.component_type==="helmet interior")this.equip_slot="head";else if(t.component_type==="chestplate interior")this.equip_slot="torso";else if(t.component_type==="leg armor interior")this.equip_slot="legs";else if(t.component_type==="glove interior")this.equip_slot="arms";else if(t.component_type==="shoes interior")this.equip_slot="feet";else throw new Error(`Component type "${t.component_type}" doesn't correspond to any armor slot!`)}this.tags.armor=!0,this.id||(this.id=this.getName())}getDefense(t){return t?this.calculateDefense(t):(this.defense_value||(this.defense_value=this.calculateDefense(this.quality)),this.defense_value)}calculateDefense(t){return this.components?Math.ceil(((c[this.components.internal].defense_value||c[this.components.internal].base_defense||0)+(c[this.components.external]?.defense_value||0))*(t/100||this.quality/100)*Ee[this.getRarity(t||this.quality)]):Math.ceil((this.base_defense||0)*(t/100||this.quality/100)*Ee[this.getRarity(t||this.quality)])}getName(){return this.name||(this.components.external?c[this.components.external].full_armor_name?this.name=c[this.components.external].full_armor_name:this.name=(c[this.components.external].name_prefix||"")+" "+c[this.components.internal].armor_name.toLowerCase()+" "+(c[this.components.external].name_suffix||""):this.name=c[this.components.internal].armor_name),this.name}},Me=class extends ai{constructor(t){if(super(t),this.equip_slot="weapon",!c[t.components.head])throw new Error(`No such weapon head as: ${t.components.head}`);if(this.components.head=t.components.head,!c[t.components.handle])throw new Error(`No such weapon handle as: ${t.components.handle}`);if(this.components.handle=t.components.handle,c[this.components.handle].component_type==="long handle"&&(c[this.components.head].component_type==="short blade"||c[this.components.head].component_type==="long blade"))this.weapon_type="spear";else if(c[this.components.handle].component_type==="medium handle"&&c[this.components.head].component_type==="axe head")this.weapon_type="axe";else if(c[this.components.handle].component_type==="medium handle"&&c[this.components.head].component_type==="hammer head")this.weapon_type="hammer";else if(c[this.components.handle].component_type==="short handle"&&c[this.components.head].component_type==="short blade")this.weapon_type="dagger";else if(c[this.components.handle].component_type==="short handle"&&c[this.components.head].component_type==="long blade")this.weapon_type="sword";else throw new Error(`Combination of elements of types ${c[this.components.handle].component_type} and ${c[this.components.head].component_type} does not exist!`);this.tags.weapon=!0,this.tags[this.weapon_type]=!0,this.id||(this.id=this.getName()),this.market_saturation_group={group_key:Oe+"weapon",group_tier:this.getItemTier()-1}}getAttack(t){return t?this.calculateAttackPower(t):(this.attack_power||(this.attack_power=this.calculateAttackPower(this.quality)),this.attack_power)}calculateAttackPower(t){return Math.ceil((c[this.components.head].attack_value+c[this.components.handle].attack_value+(c[this.components.handle].component_stats?.attack_power?.flat||0))*c[this.components.head].attack_multiplier*c[this.components.handle].attack_multiplier*(c[this.components.handle].component_stats?.attack_power?.multiplier||1)*(t/100)*Ee[this.getRarity(t)])}getName(){return`${c[this.components.head].name_prefix} ${this.weapon_type==="hammer"?"battle hammer":this.weapon_type}`}},Ft=class extends ai{constructor(t){if(super(t),this.components=void 0,this.equip_slot="cape",this.base_stats=t.base_stats,this.item_tier=t.item_tier,this.tags.cape=!0,!t.name)throw new Error("Component-less item needs to be provided a name!");if(this.name=t.name,!t.value)throw new Error(`Component-less item "${this.getName()}" needs to be provided a monetary value!`);this.value=t.value,this.base_defense=t.base_defense,this.id||(this.id=this.getName()),this.market_saturation_group={group_key:Oe+"cape",group_tier:this.getItemTier()-1}}getDefense(t){return t?this.calculateDefense(t):(this.defense_value||(this.defense_value=this.calculateDefense(this.quality)),this.defense_value)}calculateDefense(t){return Math.ceil((this.base_defense||0)*(t/100||this.quality/100)*Ee[this.getRarity(t||this.quality)])}},pn=class extends ai{constructor(t){super(t),this.equip_slot="amulet",this.stats=t.stats,this.ignore_quality=!0,this.tags.amulet=!0,this.id||(this.id=this.getName())}getStats(){return this.stats}},ks=class extends ai{constructor(t){super(t),this.equip_slot="ring",this.stats=t.stats,this.ignore_quality=!0,this.tags.ring=!0,this.id||(this.id=this.getName())}getStats(){return this.stats}},Qt=class{constructor({required_time:t=1,required_skills:i={literacy:0},literacy_xp_rate:a=1,finish_reward:s={},bonuses:n={},rewards:o={}}){this.required_time=t,this.accumulated_time=0,this.required_skills=i,this.literacy_xp_rate=a,this.finish_reward=s,this.is_finished=!1,this.bonuses=n,this.rewards=o}},V={},Ot=class extends ma{constructor(t){super(t),this.item_type="BOOK",this.name=t.name,this.tags.book=!0,this.saturates_market=!1}getReadingTime(){let{required_time:t}=V[this.name];return t}getRemainingTime(){return Math.max(V[this.name].required_time-V[this.name].accumulated_time,0)}addProgress(t=1){V[this.name].accumulated_time+=t,V[this.name].accumulated_time>=V[this.name].required_time&&this.setAsFinished()}setAsFinished(){V[this.name].is_finished=!0,V[this.name].accumulated_time=V[this.name].required_time}};function be(e){switch(e.item_type){case"EQUIPPABLE":switch(e.equip_slot){case"weapon":return new Me(e);case"off-hand":return new Ue(e);case"artifact":return new yi(e);case"axe":case"pickaxe":case"sickle":case"shovel":case"fishing_pole":return new mt(e);case"cape":return new Ft(e);case"amulet":return new pn(e);case"ring":return new ks(e);default:return new N(e)}case"USABLE":return new le(e);case"BOOK":return new Ot(e);case"OTHER":return new ht(e);case"COMPONENT":if(e.tags["weapon component"])return new Y(e);if(e.tags["armor component"])return new X(e);if(e.tags["shield component"])return new Ce(e);throw new Error(`Item ${e.name} has a wrong component type`);case"MATERIAL":return new S(e);default:throw new Error(`Wrong item type: ${e.item_type}`)}}function xe(e){let{id:t,components:i,quality:a}=JSON.parse(e);if(t&&!a){if(c[t])return be(c[t]);throw new Error(`Inventory item "${e}" couldn't be found!`)}else if(i){let{head:s,handle:n,shield_base:o,internal:l,external:d}=i;if(s)if(c[s]){if(c[n])return be({components:i,quality:a,equip_slot:"weapon",item_type:"EQUIPPABLE"});throw new Error(`Weapon handle component "${n}" couldn't be found!`)}else throw new Error(`Weapon head component "${s}" couldn't be found!`);else if(o)if(c[o]){if(c[n])return be({components:i,quality:a,equip_slot:"off-hand",item_type:"EQUIPPABLE"});throw new Error(`Shield handle component "${n}" couldn't be found!`)}else throw new Error(`Shield base component "${o}" couldn't be found!`);else if(l)if(c[l])if(c[d]){let u=fn(l);return u?be({components:i,quality:a,equip_slot:u,item_type:"EQUIPPABLE"}):void 0}else throw new Error(`External armor component "${d}" couldn't be found!`);else throw new Error(`Internal armor component "${l}" couldn't be found!`);else throw new Error(`Inventory key "${e}" seems to refer to non-existing item type!`)}else{if(a)return be({...c[t],quality:a});throw new Error(`Inventory key "${e}" is incorrect!`)}}V["ABC for kids"]=new Qt({required_time:120,literacy_xp_rate:1,bonuses:{xp_multipliers:{all:1.2}}});V["Old combat manual"]=new Qt({required_time:320,literacy_xp_rate:1,bonuses:{xp_multipliers:{Combat:1.5}}});V["Twist liek a snek"]=new Qt({required_time:320,literacy_xp_rate:1,bonuses:{xp_multipliers:{Evasion:1.5},multipliers:{agility:1.1}}});V["Medicine for dummies"]=new Qt({required_time:420,literacy_xp_rate:2,rewards:{recipes:[{category:"alchemy",subcategory:"items",recipe_id:"Weak healing powder"},{category:"alchemy",subcategory:"items",recipe_id:"Healing balm"},{category:"alchemy",subcategory:"items",recipe_id:"Oneberry juice"},{category:"alchemy",subcategory:"items",recipe_id:"Healing powder"},{category:"alchemy",subcategory:"items",recipe_id:"Healing potion"}],skill_xp:{Medicine:20}},bonuses:{xp_multipliers:{Medicine:1.5}}});V["Butchering and you"]=new Qt({required_time:240,literacy_xp_rate:2,rewards:{skills:["Butchering"],recipes:[{category:"cooking",subcategory:"items",recipe_id:"Animal fat"}]}});V["Ode to Whimsy, and other poems"]=new Qt({required_time:120,literacy_xp_rate:4,bonuses:{xp_multipliers:{all:1.2}}});V["A Glint On The Sand"]=new Qt({required_time:420,literacy_xp_rate:4,rewards:{recipes:[{category:"alchemy",subcategory:"items",recipe_id:"Potash"},{category:"smelting",subcategory:"items",recipe_id:"Raw Glass"},{category:"crafting",subcategory:"items",recipe_id:"Glass phial"},{category:"crafting",subcategory:"items",recipe_id:"Glass bottle"}],activities:[{location:"Village",activity:"sand"},{location:"Lake beach",activity:"sand"}]}});V["Shellfish desires"]=new Qt({required_time:420,literacy_xp_rate:6,rewards:{recipes:[{category:"cooking",subcategory:"items",recipe_id:"Crab bisque"},{category:"cooking",subcategory:"items",recipe_id:"Clam broth"},{category:"cooking",subcategory:"items",recipe_id:"Turtle soup"},{category:"cooking",subcategory:"items",recipe_id:"Basin gumbo"}]},bonuses:{xp_multipliers:{Cooking:1.5}}});V["Wood for Witches"]=new Qt({required_time:420,literacy_xp_rate:4,rewards:{recipes:[{category:"alchemy",subcategory:"items",recipe_id:"Potash"},{category:"alchemy",subcategory:"items",recipe_id:"Sulfur"},{category:"smelting",subcategory:"items",recipe_id:"Alchemical Wood"}]}});c["ABC for kids"]=new Ot({name:"ABC for kids",description:"The simplest book on the market",value:100}),c["Old combat manual"]=new Ot({name:"Old combat manual",description:"Old book about combat, worn and outdated, but might still contain something useful",value:200}),c["Twist liek a snek"]=new Ot({name:"Twist liek a snek",description:"This book has a terrible grammar, seemingly written by some uneducated bandit, but despite that it quite well details how to properly evade attacks",value:200}),c["Medicine for dummies"]=new Ot({name:"Medicine for dummies",description:"A simple book about healing, describing how to create some basic medicines",value:320}),c["Butchering and you"]=new Ot({name:"Butchering and you",description:"An introductory book to animal butchering, that goes into further detail on how to make a use of animal parts, especially hides and bones",value:240}),c["Ode to Whimsy, and other poems"]=new Ot({name:"Ode to Whimsy, and other poems",description:"A short and wonderful book of poetry that fills one with appreciation for life",value:200}),c["A Glint On The Sand"]=new Ot({name:"A Glint On The Sand",description:"This books recounts a tale of shipwrecked crew accidentally discovering glassmaking while cooking on a beach. More importantly, it details the processees and materials necessary to manufacture glass",value:300}),c["Shellfish desires"]=new Ot({name:"Shellfish desires",description:"A cookbook detailing various methods of cleaning and preparing crab, clam, snail, turtle, and other aquatic animals",value:1620}),c["Wood for Witches"]=new Ot({name:"Wood for Witches",description:"A dusty old tome explaining how to treat wood with alchemy to produce stronger wood",value:2e3});(function(){c["Rat fang"]=new ht({name:"Rat fang",description:"Fang of a huge rat, not very sharp, but can still pierce a human skin if enough force is applied",value:8,material_type:"animal tooth"}),c["Wolf fang"]=new ht({name:"Wolf fang",description:"Fang of a wild wolf. Somewhat sharp, still not very useful. Maybe if it had a bit better quality...",value:12,material_type:"animal tooth"}),c["Boar tusk"]=new S({name:"Boar tusk",description:"Tusk of a wild boar. Visibly worn and not very sharp",value:20}),c["Rat meat chunks"]=new ht({name:"Rat meat chunks",description:"Eww",value:8}),c["Fish fillet"]=new ht({name:"Fish fillet",description:"Cuts of meat from a fish that was too big to eat whole",value:30}),c["Glass phial"]=new ht({name:"Glass phial",description:"Small glass phial, a perfect container for a potion",value:10}),c["Glass bottle"]=new ht({name:"Glass bottle",description:"A glass bottle, perfect for carrying a drink around",value:20}),c["Camping supplies"]=new ht({name:"Camping supplies",description:"Bedroll, tent, small chest, and generally just anything that could be needed to establish a camp",value:2e3}),c["Coil of rope"]=new ht({name:"Coil of rope",description:"A nice, long coil of rope, for whatever use you might find (although you have a feeling it will only be very situational)",value:400}),c["Mountain goat horn"]=new ht({name:"Mountain goat horn",description:"A curved and sturdy horn of a mountain goat. While not very useful in itself, it makes for a nice decoration",value:30})})();(function(){c["Rat tail"]=new S({name:"Rat tail",description:"Tail of a huge rat. Doesn't seem very useful, but maybe some meat could be recovered from it",value:4}),c["Rat pelt"]=new S({name:"Rat pelt",description:"Pelt of a huge rat. Fur has terrible quality, but maybe leather could be used for something if you gather more?",value:10,material_type:"pelt"}),c["High quality wolf fang"]=new S({name:"High quality wolf fang",description:"Fang of a wild wolf. Very sharp, undamaged and surprisingly clean",value:15,material_type:"miscellaneous"}),c["Wolf pelt"]=new S({name:"Wolf pelt",description:"Pelt of a wild wolf. It's a bit damaged so it won't fetch a great price, but the leather itself could be useful",value:20,material_type:"pelt"}),c["Boar hide"]=new S({name:"Boar hide",description:"Thick hide of a wild boar. Too stiff for clothing, but might be useful for an armor",value:30,material_type:"pelt"}),c["Boar meat"]=new S({name:"Boar meat",description:"Fatty meat of a wild boar, all it needs is to be cooked",value:20,material_type:"raw meat"}),c["High quality boar tusk"]=new S({name:"High quality boar tusk",description:"Tusk of a wild boar. Sharp and long enough to easily kill an adult human",value:25,material_type:"miscellaneous"}),c["Bear hide"]=new S({description:"A strong hide of a wild bear, so strong that even steel struggles against it",value:50,material_type:"pelt"}),c["Bear claw"]=new S({description:"Large and dangerous claw of a wild bear, but it has seen better days",value:50}),c["Sharp bear claw"]=new S({description:"Large and dangerous claw of a wild bear, sharp enough to easily cut through meat",value:80,material_type:"miscellaneous"}),c["Weak monster bone"]=new S({name:"Weak monster bone",description:"Mutated and dark bone of a monster. While on the weaker side, it's still very strong and should be useful for crafting after some processing",value:30,material_type:"bone"}),c["Goat meat"]=new S({name:"Goat meat",description:"Lean meat of a goat, it's pretty tough and needs to be cooked for a long time",value:25,material_type:"raw meat"}),c["Mountain goat hide"]=new S({name:"Mountain goat hide",description:"Thick hide of a mountain goat hide. Not as strong as boar hide, but this one can actually be turned into clothes after some processing",value:30,material_type:"pelt"}),c["Pristine mountain goat horn"]=new S({name:"Pristine mountain goat horn",description:"Curved and sturdy horn of a mountain goat. It's noticeably bigger than average and seems to be even sturdier",value:70,material_type:"miscellaneous"}),c["Crab meat"]=new S({name:"Crab meat",description:"A sandy shell filled with crab meat. It needs to be cleaned before it can be cooked",value:20}),c["Crab claw"]=new S({name:"Crab claw",description:"A large claw of a crab, covered in abrasions and barnicles, but it makes a nice souvenier",value:40}),c["Giant crab claw"]=new S({description:"A large claw of a crab in pristine condition, still sharp and strong enough to take a finger off",value:100,material_type:"miscellaneous"}),c["Alligator meat"]=new S({name:"Alligator meat",description:"A lean chunk of alligator meat. It's tough, with a strange but not unappealing smell",value:40,material_type:"raw meat"}),c["Alligator skin"]=new S({name:"Alligator skin",description:"Rough, scaly hide of an alligator. Deceptively strong and flexible, but uncomfortable to touch and terrible at keeping the cold at bay",value:50,material_type:"pelt"}),c["Turtle meat"]=new S({name:"Turtle meat",description:"A lean cut of turtle meat. It's tender and versatile, but difficult to prepare",value:40,material_type:"raw meat"}),c["Turtle shell"]=new S({name:"Turtle shell",description:"A dense, thick turtle shell. It's stronger than steel, but too bulky to work with",value:30,material_type:"pelt"}),c["Giant snake meat"]=new S({name:"Giant snake meat",description:"A lean cut of snake meat. It's rubbery, and looks difficult to cook",value:40,material_type:"raw meat"}),c["Giant snake skin"]=new S({name:"Giant snake skin",description:"Smooth, scaly hide of a giant snake. Very durable, but very thin and a poor insulator",value:50,material_type:"pelt"}),c["Frog meat"]=new S({name:"Frog meat",description:"Surprisingly tender meat from a frog",value:50,material_type:"raw meat"}),c["Frog hide"]=new S({name:"Frog hide",description:"Slippery hide of a giant frog. If you could remove the toxins from it, the leather could be put into good use",value:50,material_type:"pelt"})})();(function(){c["Low quality iron ore"]=new S({name:"Low quality iron ore",description:"Iron content is rather low and there are a lot of problematic components that can't be fully removed, which will affect created materials",value:3,material_type:"raw metal"}),c["Iron ore"]=new S({name:"Iron ore",description:"It has a decent iron content and can be smelt into market-quality iron",value:5,material_type:"raw metal"}),c["Atratan ore"]=new S({name:"Atratan ore",description:"A dark-colored ore said to have minuscule magical effects, but used almost exclusively for refining all types of iron",value:6,material_type:"raw metal"}),c["Silver ore"]=new S({name:"Silver ore",description:"Peculiar for its ability to direct or disrupt magic",value:10,material_type:"raw metal"}),c.Coal=new S({name:"Coal",description:"A flammable material with extremely high carbon content",value:7,material_type:"coal"}),c.Charcoal=new S({name:"Charcoal",description:"A flammable material with extremely high carbon content, created by strongly heating wood",value:5,material_type:"coal"}),c["Piece of rough wood"]=new S({description:"Cheapest form of wood. There's a lot of bark and malformed pieces",value:2,material_type:"raw wood",getName:()=>Ai()?"Piece of rat wood":"Piece of rough wood"}),c["Piece of wood"]=new S({description:"Average quality wood. There's a lot of bark and malformed pieces",value:4,material_type:"raw wood"}),c["Piece of ash wood"]=new S({description:"Strong yet elastic, it's best wood you can hope to find around. There's a lot of bark and malformed pieces",value:7,material_type:"raw wood"}),c["Piece of hickory wood"]=new S({description:"Tough and dense and smells like cat pee, but it's even better than ash",value:10,material_type:"raw wood"}),c["Piece of willow wood"]=new S({description:"Not suitable for weapons, bu may have other uses",value:5,material_type:"raw wood"}),c["Belmart leaf"]=new S({description:"Small, round, dark-green leaves with very good disinfectant properties",value:8,material_type:"disinfectant herb"}),c["Golmoon leaf"]=new S({description:"Big green-brown leaves that can be applied to wounds to speed up their healing",value:8,material_type:"healing herb"}),c.Oneberry=new S({description:"Small blue berries capable of stimulating body's natural healing",value:8,material_type:"healing herb"}),c["Silver thistle"]=new S({description:"Rare herb that usually grows high up in mountains, a potent healing ingredient",value:20,material_type:"healing herb"}),c["Cooking herbs"]=new S({name:"Parsley, sage, rosemary and thyme",description:"A collection of various herbs commonly used to enhance the flavour and nutrition of dishes",value:10,material_type:"culinary herb"}),c.Wool=new S({description:"A handful of wool, raw and unprocessed",value:8,material_type:"raw fabric"}),c["Silica Sand"]=new S({name:"Silica sand",description:"Sand made potent by the remains of countless generations of creatures that lived and died in the body of water it was taken from",value:1}),c.Flax=new S({name:"Flax",description:"A bundle of flax, raw and unprocessed",value:14,material_type:"raw fabric"}),c.Clam=new S({name:"Clam",description:"Common shellfish found in the sand and mud around the lake shore. Can't be eaten raw",value:6}),c["Wild onion"]=new S({name:"Wild onion",description:"A wild root vegetable sometimes used to add flavor to dishes. Can't be eaten raw",value:20}),c["Wild garlic"]=new S({name:"Wild garlic",description:"A wild root vegetable known to possess anti-fungal properties, sometimes used to add flavor to dishes. Can't be eaten raw",value:20,material_type:"culinary herb"}),c["Wild potato"]=new S({name:"Wild potato",description:"A wild nutrient-rich stem tuber that can be used in a variety of dishes. Can't be eaten raw",value:20}),c.Ratfish=new S({name:"Ratfish",description:"A small sweetwater fish, named after its unremarkable coloration and propensity to travel in large groups",value:5,material_type:"small fish"}),c.Minnow=new S({name:"Minnow",description:"One of the variety of small fish that inhabit rivers and streams",value:10,material_type:"small fish"}),c["Mackerel shark"]=new S({name:"Mackerel shark",description:"A shark small enough to fit in a stream. Makes up for its size with its feistiness and big mouth",value:50,material_type:"medium fish"}),c.Trout=new S({name:"Trout",description:"A fish large enough for a full meal and common in most rivers, making it a convenient source of food. So far, this has not effected their population",value:50,material_type:"medium fish"}),c.Carp=new S({name:"Carp",description:"It hasn't grown into any of its more powerful forms yet, so its meat is still fatty and plump",value:50,material_type:"medium fish"}),c.Catfish=new S({name:"Catfish",description:"A large fish with whiskers. Usually found near the bottom of lakes, where it feeds on ratfish and pretty much everything else it can hunt",value:200,material_type:"large fish"})})();(function(){c.Bonemeal=new S({description:"Powdered bones and teeth, that can be used as an organic fertilizer",value:100}),c["Low quality iron ingot"]=new S({description:"It has a lot of impurities, resulting in it being noticeably below the market standard",value:10,material_type:"metal"}),c["Iron ingot"]=new S({description:"It doesn't suffer from any excessive impurities and can be used without worries",value:20,material_type:"metal"}),c["Steel ingot"]=new S({description:"Basic alloy of iron, harder and more resistant",value:40,material_type:"metal"}),c["Turtle shellplate"]=new S({description:"Small, dense plates capable of reflecting mighty blows. Useless in their current form, but can be turned into something useful with enough effort and focus",value:60,material_type:"metal"}),c["Silver ingot"]=new S({description:"Too soft to use as weapon material, but has potential for use in magic tools",value:30,material_type:"metal"}),c["Piece of wolf rat leather"]=new S({description:"It's slightly damaged and seems useless for anything that requires precise work",value:10,material_type:"piece of leather"}),c["Processed rat pelt"]=new S({description:"Processed pelt of a huge rat. It's of a barely acceptable quality, but it's still a miracle with how terrible the basic material was",value:15,material_type:"processed pelt"}),c["Piece of wolf leather"]=new S({description:"Somewhat strong, should offer some protection when turned into armor",value:20,material_type:"piece of leather"}),c["Processed wolf pelt"]=new S({description:"Processed pelt of a wild wolf. It's a nice, stylish material, with fur that's feels good to touch",value:30,material_type:"processed pelt"}),c["Piece of boar leather"]=new S({description:"Thick and resistant leather, too stiff for clothes but perfect for armor",value:30,material_type:"piece of leather"}),c["Processed boar hide"]=new S({description:"Processed hide of a wild boar. It's a thick, heavy material, with short rough fur, but it's quite strong",value:45,material_type:"processed pelt"}),c["Piece of goat leather"]=new S({description:"Thick and resistant, just barely elastic enough to be used for clothing",value:40,material_type:"piece of leather"}),c["Processed goat hide"]=new S({description:"Processed hide of a wild goat. It's a resistant material, with short and rough fur",value:60,material_type:"processed pelt"}),c["Piece of bear leather"]=new S({description:"Strong and resistant, but too thick for clothing",value:60,material_type:"piece of leather"}),c["Processed bear hide"]=new S({description:"Strong, resistant, and warm, with fluffy fur",value:90,material_type:"piece of leather"}),c["Piece of frog leather"]=new S({description:"The toxins have been removed and the slime coagulated into a waxy coating",value:60,material_type:"piece of leather"}),c["Piece of alligator leather"]=new S({description:"Strong and flexible, but too uncomfortable to use as clothing",value:150,material_type:"piece of leather"}),c["Piece of snakeskin leather"]=new S({description:"Durable and thin, but a poor insulator",value:150,material_type:"piece of leather"}),c["Animal fat"]=new S({description:"White, thick, oily substance, rendered from animal tissue",value:40,material_type:"fat"}),c.Sinew=new S({description:"Strong, elastic fiber, rendered from animal tissue",value:5}),c["Sinew string"]=new S({description:"Tough, durable fiber, processed from animal tissue",value:20}),c["Wool cloth"]=new S({description:"Thick and warm, might possibly absorb some punches",value:8,material_type:"fabric"}),c["Linen cloth"]=new S({description:"Bolt of durable and thin cloth that won't restrict mobility",value:14,material_type:"fabric"}),c["Iron chainmail"]=new S({description:"Dozens of tiny iron rings linked together. Nowhere near a wearable form, turning it into armor will still take a lot of effort and focus",value:12,material_type:"chainmail"}),c["Steel chainmail"]=new S({description:"Dozens of tiny steel rings linked together. Nowhere near a wearable form, turning it into armor will still take a lot of effort and focus",value:18,material_type:"chainmail"}),c["Scraps of wolf rat meat"]=new S({description:"Ignoring where they come from and all the attached diseases, they actually look edible. Just remember to cook it first",value:8,material_type:"meat"}),c["Processed rough wood"]=new S({description:"Cheapest form of wood, ready to be used. Despite being rather weak, it still has a lot of uses",value:6,material_type:"wood"}),c["Processed wood"]=new S({description:"Average quality wood, ready to be used",value:11,material_type:"wood"}),c["Processed ash wood"]=new S({description:"High quality wood, just waiting to be turned into a piece of equipment",value:20,material_type:"wood"}),c["Processed hickory wood"]=new S({description:"Top quality wood, suitable for all kinds of projects",value:35,material_type:"wood"}),c["Alchemical Wood"]=new S({description:"Extremely resilient wood, produced with alchemy",value:50,material_type:"wood"}),c["Processed weak monster bone"]=new S({description:"Polished and cleaned bones of a weak monster, just waiting to be turned into a piece of equipment",value:40,material_type:"bone"}),c.Wicker=new S({description:"Light but sturdy plant fibers, ready to be woven into useable items",value:10}),c["Willow bark"]=new S({description:"Wood bark with medicinal properties, carefully scraped from the wood",value:25}),c.Potash=new S({description:"An alchemical substance derived from plant ash, sought after for production of bleach, soap and glass",value:25}),c.Sulfur=new S({description:"A yellow substance used in alchemy",value:30}),c["Raw Glass"]=new S({name:"Raw glass",description:"Molten piece of glass, yet to be shaped into something useful",value:100}),c["Metal fishing hook"]=new S({name:"Metal fishing hook",description:"A small hook made of metal",value:10})})();(function(){c["Basic spare parts"]=new ht({name:"Basic spare parts",description:"Some cheap and simple spare parts, like bindings and screws, necessary for crafting equipment",value:30,component_tier:1})})();(function(){c["Cheap short iron blade"]=new Y({name:"Cheap short iron blade",description:"Crude blade made of iron. Perfect length for a dagger, but could be also used for a spear",component_type:"short blade",value:70,component_tier:1,name_prefix:"Cheap iron",attack_value:5,component_stats:{crit_rate:{flat:.06},attack_speed:{multiplier:1.2},evasion_points:{multiplier:1.05}}}),c["Short iron blade"]=new Y({name:"Short iron blade",description:"A good iron blade. Perfect length for a dagger, but could be also used for a spear",component_type:"short blade",value:160,component_tier:2,name_prefix:"Iron",attack_value:8,component_stats:{crit_rate:{flat:.08},attack_speed:{multiplier:1.3},evasion_points:{multiplier:1.13}}}),c["Short steel blade"]=new Y({name:"Short steel blade",description:"A good steel blade. Perfect length for a dagger, but could be also used for a spear",component_type:"short blade",value:240,component_tier:3,name_prefix:"Steel",attack_value:11,component_stats:{crit_rate:{flat:.1},attack_speed:{multiplier:1.35},evasion_points:{multiplier:1.2}}}),c["Cheap long iron blade"]=new Y({name:"Cheap long iron blade",description:"Crude blade made of iron, with a perfect length for a sword",component_type:"long blade",value:100,name_prefix:"Cheap iron",component_tier:1,attack_value:8,component_stats:{attack_speed:{multiplier:1.1},crit_rate:{flat:.02},attack_points:{multiplier:1.05}}}),c["Long iron blade"]=new Y({name:"Long iron blade",description:"Good blade made of iron, with a perfect length for a sword",component_type:"long blade",value:210,name_prefix:"Iron",component_tier:2,attack_value:13,component_stats:{attack_speed:{multiplier:1.15},crit_rate:{flat:.04},attack_points:{multiplier:1.13}}}),c["Long steel blade"]=new Y({name:"Long steel blade",description:"Good blade made of steel, with a perfect length for a sword",component_type:"long blade",value:310,name_prefix:"Steel",component_tier:3,attack_value:18,component_stats:{attack_speed:{multiplier:1.2},crit_rate:{flat:.05},attack_points:{multiplier:1.2}}}),c["Cheap iron axe head"]=new Y({name:"Cheap iron axe head",description:"A heavy axe head made of low quality iron",component_type:"axe head",value:100,name_prefix:"Cheap iron",component_tier:1,attack_value:10,component_stats:{attack_speed:{multiplier:.9}}}),c["Iron axe head"]=new Y({name:"Iron axe head",description:"A heavy axe head made of steel",component_type:"axe head",value:210,name_prefix:"Iron",component_tier:2,attack_value:16,component_stats:{attack_speed:{multiplier:.95}}}),c["Steel axe head"]=new Y({name:"Steel axe head",description:"A heavy axe head made of steel",component_type:"axe head",value:310,name_prefix:"Steel",component_tier:3,attack_value:22}),c["Cheap iron hammer head"]=new Y({name:"Cheap iron hammer head",description:"A crude ball made of low quality iron, with a small hole for the handle",component_type:"hammer head",value:100,name_prefix:"Cheap iron",component_tier:1,attack_value:12,component_stats:{attack_speed:{multiplier:.8}}}),c["Iron hammer head"]=new Y({name:"Iron hammer head",description:"A crude ball made of iron, with a small hole for the handle",component_type:"hammer head",value:210,name_prefix:"Iron",component_tier:2,attack_value:19,component_stats:{attack_speed:{multiplier:.85}}}),c["Steel hammer head"]=new Y({name:"Steel hammer head",description:"A blocky piece of steel, with a small hole for the handle",component_type:"hammer head",value:300,name_prefix:"Steel",component_tier:3,attack_value:26,component_stats:{attack_speed:{multiplier:.9}}}),c["Simple short wooden hilt"]=new Y({name:"Simple short wooden hilt",description:"A short handle for a sword or maybe a dagger",component_type:"short handle",value:8,component_tier:1}),c["Short wooden hilt"]=new Y({name:"Short wooden hilt",description:"A short handle for a sword or maybe a dagger",component_type:"short handle",value:32,component_tier:2,component_stats:{attack_speed:{multiplier:1.05}}}),c["Short ash wood hilt"]=new Y({name:"Short ash wood hilt",description:"A short handle for a sword or maybe a dagger",component_type:"short handle",value:48,component_tier:3,component_stats:{attack_speed:{multiplier:1.1}}}),c["Short hickory wood hilt"]=new Y({name:"Short hickory wood hilt",description:"A short handle for a sword or maybe a dagger",component_type:"short handle",value:48,component_tier:4,component_stats:{attack_speed:{multiplier:1.15}}}),c["Short alchemical wood hilt"]=new Y({name:"Short alchemical wood hilt",description:"A short handle for a sword or maybe a dagger",component_type:"short handle",value:64,component_tier:5,component_stats:{attack_speed:{multiplier:1.2}}}),c["Simple medium wooden handle"]=new Y({name:"Simple medium wooden handle",description:"A medium handle for an axe or a hammer",component_type:"medium handle",value:16,component_tier:1,component_stats:{attack_speed:{multiplier:.95}}}),c["Medium wooden handle"]=new Y({name:"Medium wooden handle",description:"A medium handle for an axe or a hammer",component_type:"medium handle",value:64,component_tier:2}),c["Medium ash wood handle"]=new Y({name:"Medium ash wood handle",description:"A medium handle for an axe or a hammer",component_type:"medium handle",value:96,component_tier:3,component_stats:{attack_speed:{multiplier:1.05}}}),c["Medium hickory wood handle"]=new Y({name:"Short hickory wood hilt",description:"A medium handle for an axe or a hammer",component_type:"medium handle",value:128,component_tier:4,component_stats:{attack_speed:{multiplier:1.1}}}),c["medium alchemical wood handle"]=new Y({name:"Short alchemical wood hilt",description:"A medium handle for an axe or a hammer",component_type:"medium handle",value:172,component_tier:5,component_stats:{attack_speed:{multiplier:1.15}}}),c["Simple long wooden shaft"]=new Y({name:"Simple long wooden shaft",description:"A long shaft for a spear, somewhat uneven",component_type:"long handle",value:24,component_tier:1,component_stats:{attack_speed:{multiplier:.9}}}),c["Long wooden shaft"]=new Y({name:"Long wooden shaft",description:"A long shaft for a spear, somewhat uneven",component_type:"long handle",value:100,component_tier:2,component_stats:{attack_speed:{multiplier:.95}}}),c["Long ash wood shaft"]=new Y({name:"Long ash wood shaft",description:"A long shaft for a spear",component_type:"long handle",value:150,component_tier:3}),c["Long hickory wood shaft"]=new Y({name:"Long hickory wood shaft",description:"A long shaft for a spear",component_type:"long handle",value:200,component_tier:4,component_stats:{attack_speed:{multiplier:1.05}}}),c["medium alchemical wood handle"]=new Y({name:"Short alchemical wood hilt",description:"A long shaft for a spear",component_type:"long handle",value:250,component_tier:5,component_stats:{attack_speed:{multiplier:1.1}}}),c["Cheap short iron hilt"]=new Y({name:"Cheap short iron hilt",description:"A short handle for a sword or maybe a dagger, heavy",component_type:"short handle",value:56,component_tier:1,component_stats:{attack_speed:{multiplier:.9},attack_power:{multiplier:1.05}}}),c["Short iron hilt"]=new Y({name:"Short iron hilt",description:"A short handle for a sword or maybe a dagger, heavy",component_type:"short handle",value:80,component_tier:2,component_stats:{attack_power:{multiplier:1.05}}}),c["Short steel hilt"]=new Y({name:"Short steel hilt",description:"A short handle for a sword or maybe a dagger, heavy",component_type:"short handle",value:120,component_tier:3,component_stats:{attack_power:{multiplier:1.1}}}),c["Cheap medium iron handle"]=new Y({name:"Cheap medium iron handle",description:"A medium handle for an axe or a hammer, very heavy",component_type:"medium handle",value:64,component_tier:1,component_stats:{attack_speed:{multiplier:.7},attack_power:{multiplier:1.2}}}),c["Medium iron handle"]=new Y({name:"Medium iron handle",description:"A medium handle for an axe or a hammer, very heavy",component_type:"medium handle",value:100,component_tier:2,component_stats:{attack_speed:{multiplier:.8},attack_power:{multiplier:1.2}}}),c["Medium steel handle"]=new Y({name:"Medium steel handle",description:"A medium handle for an axe or a hammer, very heavy",component_type:"medium handle",value:150,component_tier:3,component_stats:{attack_speed:{multiplier:.8},attack_power:{multiplier:1.27}}}),c["Cheap long iron shaft"]=new Y({name:"Cheap long iron shaft",description:"A long shaft for a spear, extremely heavy",component_type:"long handle",value:92,component_tier:1,component_stats:{attack_speed:{multiplier:.5},attack_power:{multiplier:1.6}}}),c["Long iron shaft"]=new Y({name:"Long iron shaft",description:"A long shaft for a spear, extremely heavy",component_type:"long handle",value:128,component_tier:2,component_stats:{attack_speed:{multiplier:.6},attack_power:{multiplier:1.6}}}),c["Long steel shaft"]=new Y({name:"Long steel shaft",description:"A long shaft for a spear, extremely heavy",component_type:"long handle",value:192,component_tier:3,component_stats:{attack_speed:{multiplier:.6},attack_power:{multiplier:1.75}}}),c["Short weak bone hilt"]=new Y({name:"Short weak bone hilt",description:"A short handle for a sword or maybe a dagger, made of a weak monster's bone",component_type:"short handle",value:120,component_tier:3,component_stats:{attack_power:{multiplier:1.05},attack_speed:{multiplier:1.05}}}),c["Medium weak bone handle"]=new Y({name:"Medium weak bone handle",description:"A medium handle for an axe or a hammer, made of a weak monster's bone",component_type:"medium handle",value:150,component_tier:3,component_stats:{attack_speed:{multiplier:.95},attack_power:{multiplier:1.1}}}),c["Long weak bone shaft"]=new Y({name:"Long weak bone shaft",description:"A long shaft for a spear, made of weak monster's bone",component_type:"long handle",value:192,component_tier:3,component_stats:{attack_speed:{multiplier:.8},attack_power:{multiplier:1.25}}}),c["Turtleshell hilt"]=new Y({name:"Turtleshell hilt",description:"A short handle for a sword or maybe a dagger, made of turtle shellplate",component_type:"short handle",value:140,component_tier:4,component_stats:{attack_speed:{multiplier:1.05},attack_points:{multiplier:1.1}}}),c["Turtleshell handle"]=new Y({name:"Turtleshell handle",description:"A medium handle for an axe or a hammer, made of turtle shellplate",component_type:"medium handle",value:190,component_tier:4,component_stats:{attack_points:{multiplier:1.1},attack_power:{multiplier:1.1}}}),c["Turtleshell shaft"]=new Y({name:"Turtleshell shaft",description:"A long shaft for a spear, made of turtle shellplate",component_type:"long handle",value:250,component_tier:4,component_stats:{attack_power:{multiplier:1.2},attack_speed:{multiplier:.95},attack_points:{multiplier:1.1}}})})();(function(){c["Cheap iron spear"]=new Me({components:{head:"Cheap short iron blade",handle:"Simple long wooden shaft"}}),c["Iron spear"]=new Me({components:{head:"Short iron blade",handle:"Simple long wooden shaft"}}),c["Steel spear"]=new Me({components:{head:"Short steel blade",handle:"Long wooden shaft"}}),c["Cheap iron dagger"]=new Me({components:{head:"Cheap short iron blade",handle:"Simple short wooden hilt"}}),c["Iron dagger"]=new Me({components:{head:"Short iron blade",handle:"Simple short wooden hilt"}}),c["Steel dagger"]=new Me({components:{head:"Short steel blade",handle:"Short wooden hilt"}}),c["Cheap iron sword"]=new Me({components:{head:"Cheap long iron blade",handle:"Simple short wooden hilt"}}),c["Iron sword"]=new Me({components:{head:"Long iron blade",handle:"Simple short wooden hilt"}}),c["Steel sword"]=new Me({components:{head:"Long steel blade",handle:"Short wooden hilt"}}),c["Cheap iron axe"]=new Me({components:{head:"Cheap iron axe head",handle:"Simple medium wooden handle"}}),c["Iron axe"]=new Me({components:{head:"Iron axe head",handle:"Simple medium wooden handle"}}),c["Steel axe"]=new Me({components:{head:"Steel axe head",handle:"Medium wooden handle"}}),c["Cheap iron battle hammer"]=new Me({components:{head:"Cheap iron hammer head",handle:"Simple medium wooden handle"}}),c["Iron battle hammer"]=new Me({components:{head:"Iron hammer head",handle:"Simple medium wooden handle"}}),c["Steel battle hammer"]=new Me({components:{head:"Steel hammer head",handle:"Medium wooden handle"}})})();(function(){c["Wolf leather helmet armor"]=new X({name:"Wolf leather helmet armor",description:"Strenghtened wolf leather, ready to be used as a part of a helmet",component_type:"helmet exterior",value:240,component_tier:2,full_armor_name:"Wolf leather helmet",defense_value:2,component_stats:{agility:{multiplier:.95}}}),c["Boar leather helmet armor"]=new X({name:"Boar leather helmet armor",description:"Strong boar leather, ready to be used as a part of a helmet",component_type:"helmet exterior",value:400,component_tier:3,full_armor_name:"Boar leather helmet",defense_value:3,component_stats:{agility:{multiplier:.95}}}),c["Bear leather helmet armor"]=new X({name:"Bear leather helmet armor",description:"Strong bear leather, ready to be used as a part of a helmet",component_type:"helmet exterior",value:600,component_tier:4,full_armor_name:"Bear leather helmet",defense_value:4,component_stats:{agility:{multiplier:.95}}}),c["Alligator leather helmet armor"]=new X({name:"Alligator leather helmet armor",description:"Strong alligator leather, ready to be used as a part of a helmet",component_type:"helmet exterior",value:900,component_tier:5,full_armor_name:"Alligator helmet",defense_value:7,component_stats:{cold_tolerance:{flat:-.5}}}),c["Wolf leather chestplate armor"]=new X({id:"Wolf leather chestplate armor",name:"Wolf leather cuirass",description:"Simple cuirass made of solid wolf leather, all it needs now is something softer to wear under it",component_type:"chestplate exterior",value:480,component_tier:2,full_armor_name:"Wolf leather armor",defense_value:4,component_stats:{agility:{multiplier:.95}}}),c["Boar leather chestplate armor"]=new X({id:"Boar leather chestplate armor",name:"Boar leather cuirass",description:"Strong cuirass made of boar leather",component_type:"chestplate exterior",value:800,component_tier:3,full_armor_name:"Boar leather armor",defense_value:6,component_stats:{agility:{multiplier:.95}}}),c["Bear leather chestplate armor"]=new X({id:"Bear leather chestplate armor",name:"Bear leather cuirass",description:"Strong cuirass made of bear leather",component_type:"chestplate exterior",value:1e3,component_tier:4,full_armor_name:"Bear leather armor",defense_value:8,component_stats:{agility:{multiplier:.95}}}),c["Alligator leather chestplate armor"]=new X({id:"Alligator leather chestplate armor",name:"Alligator leather cuirass",description:"Strong cuirass made of alligator leather",component_type:"chestplate exterior",value:1600,component_tier:5,full_armor_name:"Alligator armor",defense_value:12,component_stats:{cold_tolerance:{flat:-.5}}}),c["Wolf leather greaves"]=new X({name:"Wolf leather greaves",description:"Greaves made of wolf leather. Just attach them onto some pants and you are ready to go",component_type:"leg armor exterior",value:240,component_tier:2,full_armor_name:"Wolf leather armored pants",defense_value:2,component_stats:{agility:{multiplier:.95}}}),c["Boar leather greaves"]=new X({name:"Boar leather greaves",description:"Greaves made of thick boar leather. Just attach them onto some pants and you are ready to go",component_type:"leg armor exterior",value:400,component_tier:3,full_armor_name:"Boar leather armored pants",defense_value:3,component_stats:{agility:{multiplier:.95}}}),c["Bear leather greaves"]=new X({name:"Bear leather greaves",description:"Greaves made of thick bear leather. Just attach them onto some pants and you are ready to go",component_type:"leg armor exterior",value:600,component_tier:4,full_armor_name:"Bear leather armored pants",defense_value:4,component_stats:{agility:{multiplier:.95}}}),c["Alligator leather greaves"]=new X({name:"Alligator leather greaves",description:"Greaves made of alligator leather. Just attach them onto some pants and you are ready to go",component_type:"leg armor exterior",value:900,component_tier:5,full_armor_name:"Alligator armored pants",defense_value:7,component_stats:{cold_tolerance:{flat:-.5}}}),c["Wolf leather glove armor"]=new X({name:"Wolf leather glove armor",description:"Pieces of wolf leather shaped for gloves",component_type:"glove exterior",value:240,component_tier:2,full_armor_name:"Wolf leather gloves",defense_value:2}),c["Boar leather glove armor"]=new X({name:"Boar leather glove armor",description:"Pieces of boar leather shaped for gloves",component_type:"glove exterior",value:400,component_tier:3,full_armor_name:"Boar leather gloves",defense_value:3}),c["Bear leather glove armor"]=new X({name:"Bear leather glove armor",description:"Pieces of bear leather shaped for gloves",component_type:"glove exterior",value:600,component_tier:4,full_armor_name:"Bear leather gloves",defense_value:4}),c["Alligator leather glove armor"]=new X({name:"Alligator leather glove armor",description:"Pieces of alligator leather shaped for gloves",component_type:"glove exterior",value:900,component_tier:5,full_armor_name:"Alligator gloves",defense_value:7,component_stats:{cold_tolerance:{flat:-.5}}}),c["Wolf leather shoe armor"]=new X({name:"Wolf leather shoe armor",description:"Pieces of wolf leather shaped for shoes",component_type:"shoes exterior",value:240,component_tier:2,full_armor_name:"Wolf leather shoes",defense_value:2}),c["Boar leather shoe armor"]=new X({name:"Boar leather shoe armor",description:"Pieces of boar leather shaped for shoes",component_type:"shoes exterior",value:400,component_tier:3,full_armor_name:"Boar leather shoes",defense_value:3}),c["Bear leather shoe armor"]=new X({name:"Bear leather shoe armor",description:"Pieces of bear leather shaped for shoes",component_type:"shoes exterior",value:600,component_tier:4,full_armor_name:"Bear leather shoes",defense_value:4}),c["Alligator leather shoe armor"]=new X({name:"Alligator leather shoe armor",description:"Pieces of alligator leather shaped for shoes",component_type:"shoes exterior",value:900,component_tier:5,full_armor_name:"Alligator shoes",defense_value:7,component_stats:{cold_tolerance:{flat:-.5}}}),c["Iron chainmail helmet armor"]=new X({name:"Iron chainmail helmet armor",description:"Best way to keep your head in one piece",component_type:"helmet exterior",value:320,component_tier:2,full_armor_name:"Iron chainmail helmet",defense_value:4,component_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Steel chainmail helmet armor"]=new X({name:"Steel chainmail helmet armor",description:"Best way to keep your head in one piece",component_type:"helmet exterior",value:480,component_tier:3,full_armor_name:"Steel chainmail helmet",defense_value:6,component_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Turtleshell helmet armor"]=new X({name:"Turtleshell helmet armor",description:"Best way to keep your head in one piece",component_type:"helmet exterior",value:900,component_tier:5,full_armor_name:"Turtleshell platemail helmet",defense_value:13,component_stats:{attack_speed:{multiplier:.97},agility:{multiplier:.9}}}),c["Iron chainmail vest"]=new X({name:"Iron chainmail vest",description:"Basic iron chainmail. Nowhere near as strong as a plate armor",component_type:"chestplate exterior",value:640,component_tier:2,full_armor_name:"Iron chainmail armor",defense_value:8,component_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Steel chainmail vest"]=new X({name:"Steel chainmail vest",description:"Basic steel chainmail. Nowhere near as strong as a plate armor",component_type:"chestplate exterior",value:960,component_tier:3,full_armor_name:"Steel chainmail armor",defense_value:11,component_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Turtleshell chestplate"]=new X({name:"Turtleshell chestplate",description:"Basic turtle shellplate mail. Nowhere near as strong as a plate armor",component_type:"chestplate exterior",value:1400,component_tier:5,full_armor_name:"Turtleshell platemail armor",defense_value:26,component_stats:{attack_speed:{multiplier:.97},agility:{multiplier:.9}}}),c["Iron chainmail greaves"]=new X({name:"Iron chainmail greaves",description:"Greaves made of iron chainmail. Just attach them onto some pants and you are ready to go",component_type:"leg armor exterior",value:320,component_tier:2,full_armor_name:"Iron chainmail pants",defense_value:4,component_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Steel chainmail greaves"]=new X({name:"Steel chainmail greaves",description:"Greaves made of steel chainmail. Just attach them onto some pants and you are ready to go",component_type:"leg armor exterior",value:480,component_tier:3,full_armor_name:"Steel chainmail pants",defense_value:6,component_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Turtleshell greaves"]=new X({name:"Turtleshell greaves",description:"Greaves made of turtle shellplate. Just attach them onto some pants and you are ready to go",component_type:"leg armor exterior",value:1200,component_tier:5,full_armor_name:"Turtleshell platemail pants",defense_value:13,component_stats:{attack_speed:{multiplier:.97},agility:{multiplier:.9}}}),c["Iron chainmail glove"]=new X({name:"Iron chainmail glove",description:"Iron chainmail in a form ready to be applied onto a glove",component_type:"glove exterior",value:320,component_tier:2,full_armor_name:"Iron chainmail gloves",defense_value:4,component_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Steel chainmail glove"]=new X({name:"Steel chainmail glove",description:"Steel chainmail in a form ready to be applied onto a glove",component_type:"glove exterior",value:480,component_tier:3,full_armor_name:"Steel chainmail gloves",defense_value:6,component_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Turtleshell glove"]=new X({name:"Turtleshell glove",description:"Turtle shellplate in a form ready to be applied onto a glove",component_type:"glove exterior",value:1200,component_tier:5,full_armor_name:"Turtleshell platemail gloves",defense_value:13,component_stats:{attack_speed:{multiplier:.97},agility:{multiplier:.9}}}),c["Iron chainmail shoes"]=new X({name:"Iron chainmail shoes",description:"Iron chainmail in a form ready to be applied onto a pair of shoes",component_type:"shoes exterior",value:320,component_tier:2,full_armor_name:"Iron chainmail boots",defense_value:4,component_stats:{agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Steel chainmail shoes"]=new X({name:"Steel chainmail shoes",description:"Steel chainmail in a form ready to be applied onto a pair of shoes",component_type:"shoes exterior",value:480,component_tier:3,full_armor_name:"Steel chainmail boots",defense_value:6,component_stats:{agility:{multiplier:.9},cold_tolerance:{flat:-1}}}),c["Turtleshell shoes"]=new X({name:"Turtleshell shoes",description:"Turtle shellplate in a form ready to be applied onto a pair of shoes",component_type:"shoes exterior",value:1200,component_tier:5,full_armor_name:"Turtleshell platemail shoes",defense_value:13,component_stats:{attack_speed:{multiplier:.97},agility:{multiplier:.9}}})})();(function(){c["Cheap leather vest"]=new N({name:"Cheap leather vest",description:"Vest providing very low protection. Better not to know what's it made from",value:100,component_type:"chestplate interior",base_defense:2,component_tier:1,component_stats:{attack_speed:{multiplier:.99},cold_tolerance:{flat:1}}}),c["Leather vest"]=new N({name:"Leather vest",description:"Comfortable leather vest, offering low protection",value:300,component_type:"chestplate interior",base_defense:2,component_tier:2,component_stats:{cold_tolerance:{flat:1}}}),c["Goat leather vest"]=new N({name:"Goat leather vest",description:"Comfortable leather vest, offering mediocre protection",value:450,component_type:"chestplate interior",base_defense:3,component_tier:3,component_stats:{cold_tolerance:{flat:1}}}),c["Snakeskin vest"]=new N({name:"Snakeskin vest",description:"Comfortable snakeskin vest, offering decent protection",value:1200,component_type:"chestplate interior",base_defense:7,component_tier:5,component_stats:{attack_speed:{multiplier:1.02},agility:{multiplier:1.05},cold_tolerance:{flat:-.5}}}),c["Batrachian vest"]=new N({name:"Batrachian vest",description:"Comfortable leather vest, slippery enough to make enemy blows slide off",value:700,component_type:"chestplate interior",base_defense:4,component_tier:4,component_stats:{agility:{multiplier:1.05},cold_tolerance:{flat:1}},component_bonus_skill_levels:{Swimming:1}}),c["Cheap leather pants"]=new N({name:"Cheap leather pants",description:"Leather pants made from cheapest resources available",value:100,component_type:"leg armor interior",base_defense:1,component_tier:1,component_stats:{attack_speed:{multiplier:.99},cold_tolerance:{flat:1}}}),c["Leather pants"]=new N({name:"Leather pants",description:"Solid leather pants",value:300,component_type:"leg armor interior",base_defense:2,component_tier:2,component_stats:{cold_tolerance:{flat:2}}}),c["Goat leather pants"]=new N({name:"Goat leather pants",description:"Solid leather pants",value:450,component_type:"leg armor interior",base_defense:3,component_tier:3,component_stats:{cold_tolerance:{flat:2}}}),c["Snakeskin leggings"]=new N({name:"Snakeskin leggings",description:"Solid snakeskin leggings",value:1200,component_type:"leg armor interior",base_defense:7,component_tier:5,component_stats:{attack_speed:{multiplier:1.01},agility:{multiplier:1.05},cold_tolerance:{flat:-.5}}}),c["Batrachian pants"]=new N({name:"Batrachian pants",description:"Slippery leather pants",value:700,component_type:"leg armor interior",base_defense:3,component_tier:4,component_stats:{agility:{multiplier:1.05},cold_tolerance:{flat:1}},component_bonus_skill_levels:{Swimming:1}}),c["Cheap leather hat"]=new N({name:"Cheap leather hat",description:"A cheap leather hat to protect your head",value:100,component_type:"helmet interior",base_defense:1,component_tier:1,component_stats:{attack_speed:{multiplier:.99},cold_tolerance:{flat:1}}}),c["Leather hat"]=new N({name:"Leather hat",description:"A nice leather hat to protect your head",value:300,component_type:"helmet interior",base_defense:2,component_tier:2,component_stats:{cold_tolerance:{flat:1}}}),c["Goat leather hat"]=new N({name:"Goat leather hat",description:"A solid leather hat to protect your head",value:450,component_type:"helmet interior",base_defense:3,component_tier:3,component_stats:{cold_tolerance:{flat:1}}}),c["Snakeskin hat"]=new N({name:"Snakeskin hat",description:"A solid snakeskin hat to protect your head",value:1200,component_type:"helmet interior",base_defense:7,component_tier:5,component_stats:{attack_speed:{multiplier:1.02},agility:{multiplier:1.03},cold_tolerance:{flat:-.5}}}),c["Batrachian hat"]=new N({name:"Batrachian hat",description:"A slippery leather hat to protect your head",value:700,component_type:"helmet interior",base_defense:3,component_tier:4,component_stats:{agility:{multiplier:1.05},cold_tolerance:{flat:1}},component_bonus_skill_levels:{Swimming:1}}),c["Sun hat"]=new N({name:"Sun hat",description:"A wicker hat with a wide brim",value:100,component_type:"helmet interior",base_defense:0,component_tier:2,component_stats:{heat_tolerance:{flat:2}}}),c["Leather gloves"]=new N({name:"Leather gloves",description:"Strong leather gloves, perfect for handling rough and sharp objects",value:300,component_type:"glove interior",base_defense:1,component_tier:2,component_stats:{cold_tolerance:{flat:2}}}),c["Goat leather gloves"]=new N({name:"Goat leather gloves",description:"Strong leather gloves, perfect for handling rough and sharp objects",value:450,component_type:"glove interior",base_defense:2,component_tier:3,component_stats:{cold_tolerance:{flat:2}}}),c["Snakeskin gloves"]=new N({name:"Snakeskin gloves",description:"Strong snakeskin gloves, perfect for handling rough and sharp objects",value:1200,component_type:"glove interior",base_defense:6,component_tier:5,component_stats:{attack_speed:{multiplier:1.02},dexterity:{multiplier:1.02},cold_tolerance:{flat:-.5}}}),c["Batrachian gloves"]=new N({name:"Batrachian gloves",description:"Strong leather gloves, with membranes to help you swim",value:700,component_type:"glove interior",base_defense:2,component_tier:4,component_stats:{agility:{multiplier:1.05},cold_tolerance:{flat:1}},component_bonus_skill_levels:{Swimming:2}}),c["Cheap leather shoes"]=new N({name:"Cheap leather shoes",description:"Shoes made of thin and cheap leather. Even then, they are in every single aspect better than not having any",value:100,component_type:"shoes interior",base_defense:0,component_tier:1,component_stats:{agility:{multiplier:1.05},cold_tolerance:{flat:2}}}),c["Work shoes"]=new N({name:"Work shoes",description:"Work shoes made of a mix of leather and wool. While they provide no protection, they are very comfortable for moving around",value:300,component_type:"shoes interior",base_defense:0,component_tier:2,component_stats:{attack_speed:{multiplier:1.02},agility:{multiplier:1.15},cold_tolerance:{flat:2}}}),c["Leather shoes"]=new N({name:"Leather shoes",description:"Solid shoes made of leather, a must have for any traveler",value:300,component_type:"shoes interior",base_defense:1,component_tier:2,component_stats:{attack_speed:{multiplier:1.02},agility:{multiplier:1.1},cold_tolerance:{flat:2}}}),c["Goat leather shoes"]=new N({name:"Goat leather shoes",description:"Strong shoes made of leather, a must have for any traveler",value:450,component_type:"shoes interior",base_defense:2,component_tier:3,component_stats:{attack_speed:{multiplier:1.02},agility:{multiplier:1.15},cold_tolerance:{flat:2}}}),c["Snakeskin boots"]=new N({name:"Snakeskin boots",description:"Strong boots made of snakeskin, a must have for any traveler",value:1200,component_type:"shoes interior",base_defense:6,component_tier:5,component_stats:{attack_speed:{multiplier:1.05},agility:{multiplier:1.25},cold_tolerance:{flat:-.5}}}),c["Batrachian shoes"]=new N({name:"Batrachian shoes",description:"Strong shoes made of frog leather, that let you slide along the ground",value:700,component_type:"shoes interior",base_defense:2,component_tier:4,component_stats:{attack_speed:{multiplier:1.05},agility:{multiplier:1.15},cold_tolerance:{flat:1}},component_bonus_skill_levels:{Swimming:2}}),c["Wool shirt"]=new N({name:"Wool shirt",description:"It's not thick enough to provide any physical protection, but on the plus side it's light, it's warm, and it and doesn't block your moves",value:300,component_type:"chestplate interior",base_defense:0,component_tier:2,component_stats:{attack_speed:{multiplier:1.01},agility:{multiplier:1.02},cold_tolerance:{flat:3}}}),c["Linen vest"]=new N({name:"Linen vest",description:"A thin, breezy vest that won't get in your way, however it won't keep you warm and offers no protection from attacks",value:650,component_type:"chestplate interior",base_defense:0,component_tier:4,component_stats:{attack_speed:{multiplier:1.04},agility:{multiplier:1.05},cold_tolerance:{flat:.4}}}),c["Wool pants"]=new N({name:"Wool pants",description:"Nice woollen pants. Slightly itchy",value:100,component_type:"leg armor interior",base_defense:0,component_tier:2,component_stats:{cold_tolerance:{flat:3}}}),c["Linen leggings"]=new N({name:"Linen leggings",description:"Nice linen leggings",value:450,component_type:"leg armor interior",base_defense:0,component_tier:4,component_stats:{attack_speed:{multiplier:1.03},agility:{multiplier:1.04},cold_tolerance:{flat:.4}}}),c["Wool hat"]=new N({name:"Wool hat",description:"Simple woollen hat to protect your head from cold",value:300,component_type:"helmet interior",base_defense:0,component_tier:2,component_stats:{attack_speed:{multiplier:1.01},agility:{multiplier:1.01},cold_tolerance:{flat:2}}}),c["Linen bandanna"]=new N({name:"Linen bandanna",description:"Simple linen bandanna to keep hair and sweat away from your eyes",value:650,component_type:"helmet interior",base_defense:0,component_tier:4,component_stats:{attack_speed:{multiplier:1.02},agility:{multiplier:1.03},cold_tolerance:{flat:.4}}}),c["Wool gloves"]=new N({name:"Wool gloves",description:"Warm and comfy, but they don't provide any protection",value:300,component_type:"glove interior",base_defense:0,component_tier:2,component_stats:{cold_tolerance:{flat:3}}}),c["Linen gloves"]=new N({name:"Linen gloves",description:"Thin and tight, they help to maintain a grip on something, but they don't provide any protection",value:650,component_type:"glove interior",base_defense:0,component_tier:4,component_stats:{attack_speed:{multiplier:1.02},dexterity:{multiplier:1.02},cold_tolerance:{flat:.4}}}),c["Rat pelt cape"]=new Ft({name:"Rat pelt cape",item_tier:1,description:"It's a cape... made of wolf rat pelts. Only for poor or insane",value:100,base_stats:{cold_tolerance:{flat:2}}}),c["Wolf pelt cape"]=new Ft({name:"Wolf pelt cape",description:"An elegant cape made from wolf pelts. Doesn't provide much protection, but is light enough to not hinder your movements",value:400,item_tier:2,base_defense:2,base_stats:{cold_tolerance:{flat:4}}}),c["Boar hide cape"]=new Ft({name:"Boar hide cape",description:"A rough cape made from boar hides. Offers a nice protection, but is heavy and stiff",value:700,item_tier:3,base_defense:5,base_stats:{attack_speed:{multiplier:.9},agility:{multiplier:.9},cold_tolerance:{flat:5}}}),c["Goat hide cape"]=new Ft({name:"Goat hide cape",description:"A rough cape made from goat hides",value:700,item_tier:3,base_defense:3,base_stats:{attack_speed:{multiplier:.98},agility:{multiplier:.95},cold_tolerance:{flat:4}}}),c["Bear hide cape"]=new Ft({name:"Bear hide cape",description:"A thick, heavy, and warm furry cape, made from a bear hide",value:1e3,item_tier:4,base_defense:7,base_stats:{attack_speed:{multiplier:.95},agility:{multiplier:.95},cold_tolerance:{flat:7}}}),c["Batrachian cape"]=new Ft({name:"Batrachian cape",description:"A slippery cape made from frogskin. Technically waterproof, but doesn't cover your entire body",value:1e3,item_tier:4,base_defense:4,base_stats:{agility:{multiplier:.95},cold_tolerance:{flat:4}}})})();(function(){c["Wolf leather armor"]=new N({components:{internal:"Leather vest",external:"Wolf leather chestplate armor"}}),c["Wolf leather helmet"]=new N({components:{internal:"Leather hat",external:"Wolf leather helmet armor"}}),c["Wolf leather armored pants"]=new N({components:{internal:"Leather pants",external:"Wolf leather greaves"}}),c["Iron chainmail armor"]=new N({components:{internal:"Leather vest",external:"Iron chainmail vest"}}),c["Iron chainmail helmet"]=new N({components:{internal:"Leather hat",external:"Iron chainmail helmet armor"}}),c["Iron chainmail pants"]=new N({components:{internal:"Leather pants",external:"Iron chainmail greaves"}}),c["Steel chainmail armor"]=new N({components:{internal:"Goat leather vest",external:"Steel chainmail vest"}}),c["Steel chainmail helmet"]=new N({components:{internal:"Goat leather hat",external:"Steel chainmail helmet armor"}}),c["Steel chainmail pants"]=new N({components:{internal:"Goat leather pants",external:"Steel chainmail greaves"}}),c["Alligator armor"]=new N({components:{internal:"Linen vest",external:"Alligator leather chestplate armor"}}),c["Alligator helmet"]=new N({components:{internal:"Linen bandanna",external:"Alligator leather helmet armor"}}),c["Alligator armored pants"]=new N({components:{internal:"Linen leggings",external:"Alligator leather greaves"}}),c["Turtleshell platemail armor"]=new N({components:{internal:"Linen vest",external:"Turtleshell chestplate"}}),c["Turtleshell platemail helmet"]=new N({components:{internal:"Linen bandanna",external:"Turtleshell helmet armor"}}),c["Turtleshell platemail pants"]=new N({components:{internal:"Linen leggings",external:"Turtleshell greaves"}})})();(function(){c["Wooden training shield base"]=new Ce({name:"Wooden training shield base",description:"A primitive but cheap form of a shield",value:16,tags:{ignore_skill:!0},shield_strength:.5,shield_name:"Wooden training shield",component_tier:1,component_type:"shield base",component_stats:{attack_speed:{multiplier:.95}}}),c["Cheap wooden shield base"]=new Ce({name:"Cheap wooden shield base",description:"Cheap shield component made of wood, basically just a few planks barely holding together",value:16,shield_strength:1,shield_name:"Cheap wooden shield",component_tier:1,component_type:"shield base",component_stats:{attack_speed:{multiplier:.95}}}),c["Crude wooden shield base"]=new Ce({name:"Crude wooden shield base",description:"A shield base of rather bad quality, but at least it won't fall apart by itself",value:32,shield_strength:3,shield_name:"Crude wooden shield",component_tier:1,component_type:"shield base",component_stats:{attack_speed:{multiplier:.95}}}),c["Wooden shield base"]=new Ce({name:"Wooden shield base",description:"Proper wooden shield base, although it could use some additional reinforcement",value:80,shield_strength:5,shield_name:"Wooden shield",component_tier:2,component_type:"shield base",component_stats:{attack_speed:{multiplier:.95}}}),c["Ash wood shield base"]=new Ce({name:"Ash wood shield base",description:"Solid wooden shield base, although still nowhere near as resistant as metal",value:120,shield_strength:8,shield_name:"Ash wood shield",component_tier:3,component_type:"shield base",component_stats:{attack_speed:{multiplier:.95}}}),c["Hickory wood shield base"]=new Ce({name:"Hickory wood shield base",description:"Strong wooden shield base, more resistant than weaker metals",value:160,shield_strength:12,shield_name:"Hickory wood shield",component_tier:4,component_type:"shield base",component_stats:{attack_speed:{multiplier:.9}}}),c["Alchemical wood shield base"]=new Ce({name:"Alchemical wood shield base",description:"Shield base made of alchemical wood, stronger than steel",value:200,shield_strength:16,shield_name:"Alchemical wood shield",component_tier:5,component_type:"shield base",component_stats:{attack_speed:{multiplier:.9}}}),c["Crude iron shield base"]=new Ce({name:"Crude iron shield base",description:"Heavy shield base made of low quality iron",value:128,shield_strength:6,shield_name:"Crude iron shield",component_tier:1,component_type:"shield base",component_stats:{attack_speed:{multiplier:.75}}}),c["Iron shield base"]=new Ce({name:"Iron shield base",description:"Solid and strong shield base, although it's quite heavy",value:210,shield_strength:10,shield_name:"Iron shield",component_tier:2,component_type:"shield base",component_stats:{attack_speed:{multiplier:.8}}}),c["Steel shield base"]=new Ce({name:"Steel shield base",description:"Mighty shield base, although it's quite heavy",value:300,shield_strength:14,shield_name:"Steel shield",component_tier:3,component_type:"shield base",component_stats:{attack_speed:{multiplier:.85}}}),c["Turtleshell shield base"]=new Ce({name:"Turtleshell shield base",description:"Dense turtle shellplate base, although it's quite heavy",value:650,shield_strength:24,shield_name:"Turtleshell shield",component_tier:5,component_type:"shield base",component_stats:{attack_speed:{multiplier:.75}}}),c["Basic shield handle"]=new Ce({id:"Basic shield handle",name:"Crude wooden shield handle",description:"A simple handle for holding the shield",value:10,component_tier:1,component_type:"shield handle"}),c["Wooden shield handle"]=new Ce({name:"Wooden shield handle",description:"A decent wooden handle for holding the shield",value:32,component_tier:2,component_type:"shield handle",component_stats:{block_strength:{multiplier:1.1}}}),c["Ash wood shield handle"]=new Ce({name:"Ash wood shield handle",description:"A solid wooden handle for holding the shield",value:48,component_tier:3,component_type:"shield handle",component_stats:{block_strength:{multiplier:1.2}}}),c["Hickory wood shield handle"]=new Ce({name:"Hickory wood shield handle",description:"An exceptional wooden handle for holding the shield",value:64,component_tier:4,component_type:"shield handle",component_stats:{block_strength:{multiplier:1.25}}}),c["Alchemical wood shield handle"]=new Ce({name:"Alchemical wood shield handle",description:"A perfect wooden handle for holding the shield",value:82,component_tier:5,component_type:"shield handle",component_stats:{block_strength:{multiplier:1.3}}})})();(function(){c["Wooden training shield"]=new Ue({components:{shield_base:"Wooden training shield base",handle:"Basic shield handle"}}),c["Cheap wooden shield"]=new Ue({components:{shield_base:"Cheap wooden shield base",handle:"Basic shield handle"}}),c["Crude wooden shield"]=new Ue({components:{shield_base:"Crude wooden shield base",handle:"Basic shield handle"}}),c["Wooden shield"]=new Ue({components:{shield_base:"Wooden shield base",handle:"Wooden shield handle"}}),c["Ash wood shield"]=new Ue({components:{shield_base:"Ash wood shield base",handle:"Ash wood shield handle"}}),c["Hickory wood shield"]=new Ue({components:{shield_base:"Hickory wood shield base",handle:"Hickory wood shield handle"}}),c["Alchemical wood shield"]=new Ue({components:{shield_base:"Alchemical wood shield base",handle:"Alchemical wood shield handle"}}),c["Crude iron shield"]=new Ue({components:{shield_base:"Crude iron shield base",handle:"Basic shield handle"}}),c["Iron shield"]=new Ue({components:{shield_base:"Iron shield base",handle:"Wooden shield handle"}}),c["Steel shield"]=new Ue({components:{shield_base:"Steel shield base",handle:"Ash wood shield handle"}}),c["Turtleshell shield"]=new Ue({components:{shield_base:"Turtleshell shield base",handle:"Ash wood shield handle"}})})();(function(){c["Wolf trophy"]=new yi({name:"Wolf trophy",value:100,stats:{armor_penetration:{flat:50},crit_rate:{flat:.02}}}),c["Boar trophy"]=new yi({name:"Boar trophy",value:160,stats:{attack_power:{multiplier:1.1},crit_multiplier:{flat:.2}}}),c["Mountain goat trophy"]=new yi({name:"Mountain goat trophy",value:250,stats:{attack_power:{multiplier:1.05},defense:{flat:5,multiplier:1.05}}}),c["Bear trophy"]=new yi({name:"Bear trophy",value:400,stats:{attack_power:{multiplier:1.3},attack_speed:{multiplier:.9}}}),c["Crab trophy"]=new yi({name:"Crab trophy",value:650,stats:{attack_points:{multiplier:1.15},defense:{multiplier:1.15}}}),c["Simple dream catcher"]=new yi({name:"Simple dream catcher",description:"Sinew netting stretched over a willow hoop. You don't know how it works or what it does, but it makes you feel safer. It's design came to you in a dream",value:0,stats:{},base_bonus_skill_levels:{Sleeping:2,"Strength of mind":2}})})();(function(){c["Wool scarf"]=new pn({value:100,stats:{cold_tolerance:{flat:5}}}),c["Warrior's necklace"]=new pn({value:1e3,tags:{unique:!0,unsellable:!0},stats:{attack_power:{multiplier:1.1},attack_speed:{multiplier:1.1}}})})();(function(){c["Snake fang ring"]=new ks({value:2e3,tags:{unique:!0,unsellable:!0},stats:{crit_multiplier:{multiplier:1.3},crit_rate:{multiplier:1.2},unarmed_power:{flat:1}}})})();(function(){c["Old pickaxe"]=new mt({name:"Old pickaxe",description:"An old pickaxe that has seen better times, but is still usable",value:10,equip_slot:"pickaxe"}),c["Old axe"]=new mt({name:"Old axe",description:"An old axe that has seen better times, but is still usable",value:10,equip_slot:"axe"}),c["Old sickle"]=new mt({name:"Old sickle",description:"And old herb sickle that has seen better times, but is still usable",value:10,equip_slot:"sickle"}),c["Old shovel"]=new mt({name:"Old shovel",description:"And old shovel that has seen better times, but can still be used to dig something up",value:10,equip_slot:"shovel"}),c["Iron pickaxe"]=new mt({name:"Iron pickaxe",description:"A decent pickaxe made of iron, strong enough for most ores",value:1e3,equip_slot:"pickaxe",base_bonus_skill_levels:{Mining:3}}),c["Iron chopping axe"]=new mt({name:"Iron chopping axe",description:"A decent axe made of iron, hard and sharp enough for most of trees, even if they will still require an effort",value:1e3,equip_slot:"axe",base_bonus_skill_levels:{Woodcutting:3}}),c["Iron sickle"]=new mt({name:"Iron sickle",description:"A decent sickle made of iron, sharp enough for most of plants",value:1e3,equip_slot:"sickle",base_bonus_skill_levels:{Herbalism:3}}),c["Iron shovel"]=new mt({name:"Iron shovel",description:"A decent shovel made of iron, solid enough for most of your digging needs",value:1e3,equip_slot:"shovel",base_bonus_skill_levels:{Digging:3}}),c["Makeshift fishing pole"]=new mt({name:"Makeshift fishing pole",description:"Little more than a piece of string tied to a stick, but sufficient to get a catch",value:10,equip_slot:"fishing_pole"}),c["Wooden fishing pole"]=new mt({name:"Wooden fishing pole",description:"A simple, but proper fishing pole",value:200,equip_slot:"fishing_pole",base_bonus_skill_levels:{Fishing:3}}),c["Ash wood fishing pole"]=new mt({name:"Ash wood fishing pole",description:"A decent fishing pole",value:500,equip_slot:"fishing_pole",base_bonus_skill_levels:{Fishing:5}})})();(function(){c["Stale bread"]=new le({name:"Stale bread",description:"Big piece of an old bread, still edible",value:20,effects:[{effect:"Basic meal",duration:60}],tags:{food:!0},material_type:"bread"}),c["Fresh bread"]=new le({name:"Fresh bread",description:"Freshly baked bread, delicious",value:40,effects:[{effect:"Basic meal",duration:150}],tags:{food:!0},material_type:"bread"}),c["Bread kwas"]=new le({name:"Bread kwas",description:"Tastes like bread",value:40,effects:[{effect:"Well hydrated",duration:60}],recovery_chances:{"Glass bottle":.6},tags:{drink:!0}}),c.Carrot=new le({name:"Carrot",description:"A delicious root that can be eaten raw",value:20,effects:[{effect:"Basic meal",duration:10}],tags:{food:!0}}),c["Cooked carrot"]=new le({name:"Cooked carrot",description:"A delicious root, cooked",value:30,effects:[{effect:"Basic meal",duration:150}],tags:{food:!0}}),c.Potato=new le({name:"Potato",description:"A common tuber with versatile culinary usage. Just remember to cook it first!",value:15,effects:[{effect:"Slight food poisoning",duration:20}],tags:{food:!0}}),c["Cooked potato"]=new le({name:"Potato",description:"A common tuber with versatile culinary usage, though this one was simply cooked",value:40,effects:[{effect:"Basic meal",duration:150}],tags:{food:!0}}),c["Cooked clam"]=new le({name:"Boiled clam",description:"Common shellfish found around the lake shore that has been boiled, not steamed",value:6,effects:[{effect:"Basic meal",duration:90}],tags:{food:!0}}),c["Weak healing powder"]=new le({name:"Weak healing powder",description:"Not very potent, but can still make body heal noticeably faster for quite a while",value:40,effects:[{effect:"Weak healing powder",duration:240}],tags:{medicine:!0}}),c["Healing powder"]=new le({name:"Healing powder",description:"Not exactly powerful in its effects, but still makes the body heal noticeably faster and for a long time",value:100,effects:[{effect:"Healing powder",duration:300}],tags:{medicine:!0}}),c["Oneberry juice"]=new le({name:"Oneberry juice",description:"Tastes kinda nice and provides a quick burst of healing",value:80,effects:[{effect:"Weak healing potion",duration:10}],recovery_chances:{"Glass phial":.75},tags:{medicine:!0}}),c["Healing potion"]=new le({name:"Healing potion",description:"Tastes nice at first but has a bitter aftertaste. Provides a quick burst of healing",value:200,effects:[{effect:"Healing potion",duration:10}],recovery_chances:{"Glass phial":.75},tags:{medicine:!0}}),c["Healing balm"]=new le({name:"Healing balm",description:"Simply apply it to your wound and watch it heal",value:120,effects:[{effect:"Weak healing balm",duration:90}],tags:{medicine:!0}}),c["Roasted rat meat"]=new le({name:"Roasted rat meat",description:"Smell might be fine now, but it still seems like a bad idea to eat it",value:10,effects:[{effect:"Cheap meat meal",duration:45},{effect:"Slight food poisoning",duration:45}],tags:{food:!0}}),c["Roasted purified rat meat"]=new le({name:"Roasted purified rat meat",description:"Smells alright and should be safe to eat, yet you still have some doubts",value:20,effects:[{effect:"Cheap meat meal",duration:45}],tags:{food:!0}}),c["Fried pork"]=new le({name:"Fried pork",description:"It's dripping with fat and smells fantastic, all it lacks is some spices and a good side dish",value:40,effects:[{effect:"Simple meat meal",duration:90}],tags:{food:!0}}),c["Fried goat meat"]=new le({name:"Fried goat meat",description:"It has a nice aroma, but is a bit too tough. Perhaps a stew would have been a better choice?",value:40,effects:[{effect:"Simple meat meal",duration:90}],tags:{food:!0}}),c["Pork roast"]=new le({name:"Pork roast",description:"A generous amount of herbs has been rubbed into the meat, resulting in a hearty meal with a mouthwatering aroma",value:100,effects:[{effect:"Decent meat meal",duration:120}],tags:{food:!0}}),c["Goat stew"]=new le({name:"Goat stew",description:"Goat meat boiled to tenderness in a herbal broth. Perfect to warm yourself up for the road",value:100,effects:[{effect:"Decent meat meal",duration:120},{effect:"Hot meal",duration:60}],tags:{food:!0}}),c["Crab bisque"]=new le({name:"Crab bisque",description:"A smooth, creamy crab soup, lightly seasoned with fragrant herbs and vegetables",value:100,effects:[{effect:"Simple seafood soup",duration:120},{effect:"Hot meal",duration:30}],tags:{food:!0}}),c["Clam broth"]=new le({name:"Clam broth",description:"Briny, flavorful, and tastes of the ocean. In a good way",value:100,effects:[{effect:"Simple seafood soup",duration:90},{effect:"Hot meal",duration:30}],tags:{food:!0}}),c["Alligator jerky"]=new le({name:"Alligator jerky",description:"It's tough meat, but it'll keep you from going hungry for a long time",value:100,effects:[{effect:"Tough meat meal",duration:300}],tags:{food:!0}}),c["Snake jerky"]=new le({name:"Snake jerky",description:"It's rubbery meat, but it'll keep you from going hungry for a long time",value:100,effects:[{effect:"Tough meat meal",duration:300}],tags:{food:!0}}),c["Turtle jerky"]=new le({name:"Turtle jerky",description:"It's stringy meat, but it'll still keep you from going hungry for a long time",value:100,effects:[{effect:"Tough meat meal",duration:300}],tags:{food:!0}}),c["Turtle soup"]=new le({name:"Turtle soup",description:"Tonight you dine on turtle soup",value:100,effects:[{effect:"Simple seafood soup",duration:120},{effect:"Hot meal",duration:45}],tags:{food:!0}}),c["Swampland skewer"]=new le({name:"Swampland skewer",description:"There's no better way to feed on the creatures of the swampland",value:100,effects:[{effect:"Varied meat meal",duration:150},{effect:"Hot meal",duration:60}],tags:{food:!0}}),c["Basin gumbo"]=new le({name:"Basin gumbo",description:"An incredibly complex meal that's difficult to make, but it's got an indescribable taste",value:100,effects:[{effect:"Varied seafood meal",duration:90}],tags:{food:!0}}),c["Fried frog meat"]=new le({name:"Fried frog meat",description:"Tastes a bit like bird, and a bit like fish",value:50,effects:[{effect:"Simple meat meal",duration:120}],tags:{food:!0}}),c["Kingsized frog legs"]=new le({name:"Kingsized frog legs",description:"The legs are agreed to be the best part, and when cooked with proper seasoning, considered a delicacy by some",value:100,effects:[{effect:"Decent meat meal",duration:120}],tags:{food:!0}}),c["Fish skewer"]=new le({name:"Fish skewer",description:"Several small fish cooked together on a stick. While none of them have much meat on them individually, together they make for a servicable meal",value:20,effects:[{effect:"Cheap meat meal",duration:45}],tags:{food:!0}}),c["Fried fish"]=new le({name:"Fried fish",description:"A fish fried whole. A simple but fulfilling meal",value:40,effects:[{effect:"Simple meat meal",duration:60}],tags:{food:!0}}),c["Fish steak"]=new le({name:"Fish steak",description:"Properly filleted and cooked. A much better experience than eating them whole",value:60,effects:[{effect:"Decent meat meal",duration:60}],tags:{food:!0}})})();Object.keys(c).forEach(e=>{c[e].id=e,c[e].getName()||(c[e].name=e)});var de={},ki=class{constructor({name:t,id:i,related_skill:a,target_count:s=1,randomize_target_count:n=!1,is_unlocked:o=!1,stat_multipliers:l={},stamina_cost:d=1,description:u=""}){Va(this,"getDescription",function(){if(this.description)return this.description;if(this.related_skill)return f[this.related_skill].description});Va(this,"getStats",function(){if(this.related_skill){let t={};return Object.keys(this.stat_multipliers).forEach(i=>{this.stat_multipliers[i]<1?t[i]=this.stat_multipliers[i]+(1-this.stat_multipliers[i])*K(this.related_skill)/(2*f[this.related_skill].max_level):t[i]=this.stat_multipliers[i]+(this.stat_multipliers[i]-1)*K(this.related_skill)/f[this.related_skill].max_level}),t}else return this.stat_multipliers});if(a&&!f[a])throw`Tried to attach skill "${a}" to stance "${t}", but such a skill doesnt exist!`;if(this.name=t,this.id=i,this.related_skill=a,this.description=u,this.target_count<1)throw"Combat stance cannot target less than 1 enemy!";this.target_count=s,this.randomize_target_count=n,this.is_unlocked=o,this.stat_multipliers=l,this.stamina_cost=d}};de.normal=new ki({name:"Normal Stance",id:"normal",is_unlocked:!0,description:"A normal and basic stance. It doesn't excell in anything, but also doesn't suffer any major flaws and is energy efficient.",stat_multipliers:{}});de.quick=new ki({name:"Quick Steps",id:"quick",related_skill:"Quick steps",description:"A swift and precise technique that abandons strength in favor of greater speed",stat_multipliers:{attack_power:.8,attack_speed:1.2},stamina_cost:2});de.heavy=new ki({name:"Crushing Force",id:"heavy",related_skill:"Heavy strike",stat_multipliers:{attack_power:1.2,attack_speed:.8},stamina_cost:2});de.defensive=new ki({name:"Defensive Measures",id:"defensive",related_skill:"Defensive measures",stat_multipliers:{attack_power:.8,attack_speed:.8,evasion_points:1.2,block_strength:1.1},target_count:1,stamina_cost:2});de.wide=new ki({name:"Broad Arc",id:"wide",related_skill:"Wide swing",stat_multipliers:{attack_power:.4,attack_speed:.8},target_count:4,stamina_cost:4});de.berserk=new ki({name:"Berserker's Stride",id:"berserk",related_skill:"Berserker's stride",stat_multipliers:{attack_power:1.2,hit_chance:1.2,agility:.4,block_strength:.4},target_count:3,randomize_target_count:!0,stamina_cost:4});de["flowing water"]=new ki({name:"Flowing Water",id:"flowing water",related_skill:"Flowing water",stat_multipliers:{attack_power:1.2,agility:1.2,attack_speed:1.2},target_count:2,stamina_cost:4});var me=1e6;function Jr(){let e=[0,0],t=performance.now(),i=performance.now(),a=[0,0];console.log("Began verifying game objects."),console.log("Began verifying items.");for(let[b,g]of Object.entries(c)){let v=!1;if(b!==g.id&&(console.error(`Id mismatch: "${b}" - "${g.id}"`),v=!0),g.tags.usable)for(let y=0;y<g.effects.length;y++)z[g.effects[y].effect]||(console.error(`Effect "${g.effects[y].effect}" of item "${b}" is not defined in effect templates`),v=!0);if(g.stats&&Object.keys(g.stats).forEach(y=>{r.base_stats[y]===void 0?(console.error(`Item "${b}" has a non-existent stat "${y}"`),v=!0):Object.keys(g.stats[y]).forEach(I=>{I!=="multiplier"&&I!=="flat"&&(console.error(`Item "${b}" has a non-existent stat type "${I}" (should be 'multiplier' or 'flat')`),v=!0)})}),g.effects)for(let y=0;y<g.effects.length;y++)z[g.effects[y].effect]||(console.error(`Item "${b}" refers to a non-existent effect "${g.effects[y].effect}"`),v=!0);a[0]++,a[1]+=v,e[0]++,e[1]+=v}let s=performance.now();a[1]>0?console.log(`Finished verifying items in: ${Math.round(me*(s-i))/me}s
Found issue in ${a[1]} out of ${a[0]}`):console.log(`Finished verifying ${a[0]} items in: ${Math.round(me*(s-i))/me}s
No issues were found.`),i=performance.now();let n=[0,0];console.log("Began verifying skills.");for(let[b,g]of Object.entries(f)){let v=!1;b!==g.skill_id&&(console.error(`Id mismatch: "${b}" - "${g.skill_id}"`),v=!0),g.milestones&&Object.values(g.milestones).forEach(y=>{Object.keys(y).forEach(I=>{I!=="unlocks"&&I!=="stats"&&I!=="xp_multipliers"?(console.error(`Skill "${b}" has a milestone reward to a non-existent category of "${I}"`),v=!0):I==="unlocks"?Object.keys(y[I]).forEach($=>{$!=="skills"&&$!=="recipes"&&$!=="quests"&&(console.error(`Skill "${b}" has a milestone reward in form of unlocking "${$}" which is not supported`),v=!0)}):I==="stats"?Object.keys(y[I]).forEach($=>{r.base_stats[$]===void 0&&(console.error(`Skill "${b}" has a milestone reward for a non-existent stat "${$}"`),v=!0),Object.keys(y[I][$]).forEach(_e=>{_e!=="flat"&&_e!=="multiplier"&&(console.error(`Skill "${b}" has a milestone reward to stats of wrong type "${_e}". Should be "flat" or "multiplier"`),v=!0)})}):Object.keys(y[I]).forEach($=>{$!=="all"&&$!=="all_skill"&&$!=="hero"&&!f[$]&&($.includes("category_")?Ui[$.replace("category_","")]||(v=!0,console.error(`Skill "${b}" has a milestone reward for a non-existent skill "${$}"`)):(v=!0,console.error(`Skill "${b}" has a milestone reward for a non-existent skill "${$}"`)))})})}),n[0]++,n[1]+=v,e[0]++,e[1]+=v}s=performance.now(),n[1]>0?console.log(`Finished verifying skills in: ${Math.round(me*(s-i))/me}s
Found issue in ${n[1]} out of ${n[0]}`):console.log(`Finished verifying ${n[0]} skills in: ${Math.round(me*(s-i))/me}s
No issues were found.`),i=performance.now();let o=[0,0];console.log("Began verifying locations.");for(let[b,g]of Object.entries(m)){let v=!1;if(b!==g.id&&(console.error(`Id mismatch: "${b}" - "${g.id}"`),v=!0),g.tags.safe_zone){for(let y=0;y<g.dialogues.length;y++)q[g.dialogues[y]]||(console.error(`Location "${b}" refers to a non-existent dialogue "${q[g.dialogues[y]]}"`),v=!0);if(g.traders?.length>0){g.market_region?ze[g.market_region]||(console.error(`Location "${b}" has market region "${g.market_region}" assigned, but no such region is present in region mapping!`),v=!0):(console.error(`Location "${b}" has at least one trader but no trade region assigned!`),v=!0);for(let y=0;y<g.traders.length;y++)F[g.traders[y]]||(console.error(`Location "${b}" refers to a non-existent trader "${g.traders[y]}"`),v=!0)}for(let y=0;y<g.connected_locations.length;y++)g.connected_locations[y].location||(console.error(`Location "${b}" is connected to a non-existent location.`),v=!0);Object.keys(g.activities).forEach(y=>{A[g.activities[y].activity_name]||(console.error(`Location "${b}" refers to a non-existent activity "${g.activities[y].activity_name}"`),v=!0);for(let I=0;I<g.activities[y].gained_resources?.length;I++)c[g.activities[y].gained_resources.resources[I].name]||(console.error(`Activity "${y}" in location "${b}" refers to a non-existent item "${g.activities[y].gained_resources.resources[I].name}"`),v=!0)})}else if(g.tags["Combat zone"]){g.parent_location==null&&(console.error(`Combat location "${b}" refers to a non-existent parent"`),v=!0);for(let y=0;y<g.enemies_list?.length;y++)U[g.enemies_list[y]]||(console.error(`Location "${b}" refers to a non-existent enemy "${g.enemies_list[y]}"`),v=!0);for(let y=0;y<g.enemy_groups_list?.length;y++)for(let I=0;I<g.enemy_groups_list[y].enemies.length;I++)U[g.enemy_groups_list[y].enemies[I]]||(console.error(`Location "${b}" refers to a non-existent enemy "${g.enemy_groups_list[y].enemies[I]}"`),v=!0);if(g.first_reward&&bs(g.first_reward,"location",b),g.repeatable_reward&&(bs(g.repeatable_reward,"location",b)||(v=!0)),g.rewards_with_clear_requirement)for(let y=0;y<g.rewards_with_clear_requirement.length;y++)bs(g.rewards_with_clear_requirement[y],"location",b)||(v=!0)}o[0]++,o[1]+=v,e[0]++,e[1]+=v}s=performance.now(),o[1]>0?console.log(`Finished verifying locations in: ${Math.round(me*(s-i))/me}s
Found issue in ${o[1]} out of ${o[0]}`):console.log(`Finished verifying ${o[0]} locations in: ${Math.round(me*(s-i))/me}s
No issues were found.`),i=performance.now();let l=[0,0];console.log("Began verifying enemies.");for(let[b,g]of Object.entries(U)){let v=!1;b!==g.id&&(console.error(`Id mismatch: "${b}" - "${g.id}"`),v=!0);for(let y=0;y<g.loot_list.length;y++)c[g.loot_list[y].item_name]||(console.error(`Enemy "${b}" refers to a non-existent item "${g.loot_list[y].item_name}"`),v=!0);l[0]++,l[1]+=v,e[0]++,e[1]+=v}s=performance.now(),l[1]>0?console.log(`Finished verifying enemies in: ${Math.round(me*(s-i))/me}s
Found issue in ${l[1]} out of ${l[0]}`):console.log(`Finished verifying ${l[0]} in: ${Math.round(me*(s-i))/me}s
No issues were found.`),i=performance.now();let d=[0,0];console.log("Began verifying market regions.");for(let[b]of Object.entries(ze)){let g=!1,v=!1;Object.values(m).forEach(y=>{y.market_region===b&&(v=!0)}),v||(g=!0,console.error(`Market region "${b}" is not used for any location despite being defined in region connections!`)),d[0]++,d[1]+=g,e[0]++,e[1]+=g}s=performance.now(),d[1]>0?console.log(`Finished verifying market regions in: ${Math.round(me*(s-i))/me}s
Found issue in ${d[1]} out of ${d[0]}`):console.log(`Finished verifying ${d[0]} market regions in: ${Math.round(me*(s-i))/me}s
No issues were found.`),i=performance.now();let u=[0,0];console.log("Began verifying dialogues.");for(let[b,g]of Object.entries(q)){let v=!1;for(let[y,I]of Object.entries(g.textlines))ui.english[I.name]||(v=!0,console.error(`Textline "${y}" in "${b}" has no translation provided for starting text`)),ui.english[I.getText()]||(v=!0,console.error(`Textline "${y}" in "${b}" has no translation provided for answer text`)),I.rewards&&(bs(I.rewards,"textline",b,y)||(v=!0));for(let[y,I]of Object.entries(g.actions))ui.english[I.starting_text]||(v=!0,console.error(`Action "${y}" in "${b}" has no translation provided for starting text`)),ui.english[I.success_text]||(v=!0,console.error(`Textline "${y}" in "${b}" has no translation provided for success text`));u[0]++,u[1]+=v,e[0]++,e[1]+=v}s=performance.now(),u[1]>0?console.log(`Finished verifying dialogues in: ${Math.round(me*(s-i))/me}s
Found issue in ${u[1]} out of ${u[0]}`):console.log(`Finished verifying ${u[0]} dialogues in: ${Math.round(me*(s-i))/me}s
No issues were found.`),i=performance.now();let h=[0,0];console.log("Began verifying recipes."),Object.keys(G).forEach(b=>{Object.keys(G[b]).forEach(g=>{for(let[v,y]of Object.entries(G[b][g])){let I=!1;if(f[y.recipe_skill]||(I=!0,console.error(`Recipe "${b}" -> "${g}" -> "${v}" refers to nonexistent skill "${y.recipe_skill}"`)),g==="items"){c[y.result.result_id]||(I=!0,console.error(`Recipe "${b}" -> "${g}" -> "${v}" creates nonexistent item "${y.result.result_id}"`));for(let $=0;$<y.materials.length;$++)y.materials[$].material_id&&!c[y.materials[$].material_id]&&(I=!0,console.error(`Recipe "${b}" -> "${g}" -> "${v}" uses nonexistent material "${y.materials[$].material_id}"`))}else if(y.recipe_type==="componentless"||y.recipe_type==="component")for(let $=0;$<y.materials.length;$++)y.materials[$].material_id&&!c[y.materials[$].material_id]&&(I=!0,console.error(`Recipe "${b}" -> "${g}" -> "${v}" uses nonexistent material "${y.materials[$].material_id}"`)),c[y.materials[$].result_id]||(I=!0,console.error(`Recipe "${b}" -> "${g}" -> "${v}" creates nonexistent item "${y.materials[$].result_id}"`));h[0]++,h[1]+=I,e[0]++,e[1]+=I}})}),s=performance.now(),h[1]>0?console.log(`Finished verifying recipes in: ${Math.round(me*(s-i))/me}s
Found issue in ${h[1]} out of ${h[0]}`):console.log(`Finished verifying ${h[0]} recipes in: ${Math.round(me*(s-i))/me}s
No issues were found.`);let _=performance.now(),w;return e[1]>0?w=`Finished verifying game objects in: ${Math.round(me*(_-t))/me}s
Found issue in ${e[1]} out of ${e[0]}`:w=`Finished verifying ${e[0]} game objects in: ${Math.round(me*(_-t))/me}s
No issues were found.`,console.log(w),e[1]==0}function bs(e,t,i,a){let s=!0;return Object.keys(e).forEach(n=>{if(n==="xp"&&typeof e[n]!="number")console.error(bi(t,i,a)+"wrong kind of reward of 'xp' type, should be Number but found '"+typeof e[n]+"'"),s=!1;else if(n==="skill_xp")Object.keys(e[n]).forEach(o=>{f[o]||(console.error(bi(t,i,a)+"wrong skill id for 'skill_xp', no such skill as '"+o+"'"),s=!1),typeof e[n][o]!="number"&&(console.error(bi(t,i,a)+"wrong kind of reward of 'skill xp' type for '"+o+"', should be Number but found '"+typeof e[n][o]+"'"),s=!1)});else if(n==="locations")for(let o=0;o<e[n].length;o++)m[e[n][o].location]||(console.error(bi(t,i,a)+`non-existent location '${e[n][o].location}' listed for unlocks`),s=!1);else if(n==="textlines")for(let o=0;o<e[n].length;o++){q[e[n][o].dialogue]||(console.error(bi(t,i,a)+`non-existent dialogue '${e[n][o].dialogue}' listed for textline unlocks`),s=!1);for(let l=0;l<e[n][o].lines.length;l++)q[e[n][o].dialogue].textlines[e[n][o].lines[l]]||(console.error(bi(t,i,a)+`non-existent textline '${e[n][o].lines[l]}' listed for unlocks in dialogue '${e[n][o].dialogue}'`),s=!1)}else if(n==="move_to")m[e[n].location]||(console.error(bi(t,i,a)+`non-existent location '${e[n].location}' listed for moving to`),s=!1);else if(n==="quest_progress")for(let o=0;o<e[n].length;o++)O[e[n][o].quest_id]||(console.error(bi(t,i,a)+`non-existent quest '${e[n][o].quest_id}' listed for progressing`),s=!1),O[e[n][o].quest_id].quest_tasks.length<e[n][o].task_index&&(console.error(bi(t,i,a)+`too high task index for progressing quest '${e[n][o].quest_id}'`),s=!1)}),s}function bi(e,t,i){if(e==="location")return`Location "${t}" has a `;if(e==="textline")return`Textline "${i}" in dialogue "${t}" has a `}var Xr={add_reputation:({reputation:e,region:t})=>{if(Number.isInteger(e))if(t in r.reputation)r.reputation[t]+=e;else throw new Error(`Tried to add reputation to "${t}", which is not a valid reputation region!`);else throw new Error(`Tried to add "${e}", which is not a valid integer!`)}};var ha={},Zr="Running",ec=60,tc=4,Yo=class{constructor(){this.queue=[]}add_to_queue(t){this.queue.push(t),this.queue.sort((i,a)=>i[0]-a[0])}shift_from_queue(){return this.is_queue_empty()?"Queue is empty":this.queue.shift()}is_queue_empty(){return this.queue.length==0}},ja=class{constructor(){this.adjacent={},this.vertice_count=0}add_connection(t,i,a){this.adjacent[t]||(this.adjacent[t]=[]),this.adjacent[t].push([i,a])}update_time_skill_modifiers(){Object.keys(ha).forEach(t=>{ha[t]=1/tc**(f[t].current_level/f[t].max_level)})}update_time_skill_modifier(t){ha[t]=1/tc**(f[t].current_level/f[t].max_level)}get_total_skills_modifier(t){let i=1;for(let a=0;a<t.length;a++)t[a]in ha||this.update_time_skill_modifier(t[a]),i*=ha[t[a]];return i**t.length}fill_connections(t){Object.values(t).forEach(i=>{if(i.is_unlocked&&!i.is_finished){if(i.parent_location){let a=i.parent_location.connected_locations.find(o=>o.location===i).travel_time??ec,s=i.parent_location.connected_locations.find(o=>o.location===i).travel_time_skills||[Zr],n=this.get_total_skills_modifier(s);this.add_connection(i.id,i.parent_location.id,a*n)}else for(let a=0;a<i.connected_locations.length;a++)if(i.connected_locations[a].location.is_unlocked&&!i.connected_locations[a].location.is_finished){let s=i.connected_locations[a].travel_time_skills||[Zr],n=this.get_total_skills_modifier(s);this.add_connection(i.id,i.connected_locations[a].location.id,(i.connected_locations[a].travel_time??ec)*n)}}})}find_shortest_paths(t){let i=new Yo,a={};for(i.add_to_queue([0,t]),a[t]=0;!i.is_queue_empty();){let[,s]=i.shift_from_queue();if(this.adjacent[s])for(let[n,o]of this.adjacent[s])a[s]==null&&(a[s]=1/0),a[n]==null&&(a[n]=1/0),a[n]>a[s]+o&&(a[n]=a[s]+o,i.add_to_queue([a[n],n]))}return Object.keys(a).forEach(s=>{a[s]=Math.round(a[s])}),a}};var pt="save data",qt="dev save data",qn="backup save",Sn="dev backup save",Ie={is_gathering_unlocked:!1,is_crafting_unlocked:!1,is_strength_proved:!1,is_mofu_mofu_enabled:!0,is_guard_met:!1},ic={is_gathering_unlocked:"You have gained the ability to gather new materials! Remember to equip your tools first <br>[Note: equipped tools do not appear in inventory as you will be swapping them very rarely]",is_crafting_unlocked:"You have gained the ability to craft items and equipment!"},Jo=document.getElementById("loading_screen_play_button"),Ha={english:"english",mofu_english:"mofu_english"},Dt=Ha.mofu_english,sc=!1,Xo=0,Zo=0,bn=0,vn=0,el=0,tl=0,il=0,al=0,nl=0,Is=0,$s={},Hu=5,zu=1/360,Yu=.2,zi=0,Uo=1e3*60*60*20,Do=20,_a=0,pa=[0,0,0,0],gn=!1,wn=!1,H=null,In={},Gi,vi=[],fa=[],Fa=[],oc,Ri=0,Ra=0,yn=[],Pt=10,x,B,Es,za,Bt={},ni,Pa={},Du=!0,Yi=!1,ti=null,Lt=null,_t=null,Vu=60,qs=0,Qu=3600,Vo=0,Na=0,vs=0,kn,ac,Ze,Se={},xt=de.normal,Fe=de.normal,ii={},Vt={},gi={},we=1,Uu=1,M={uniform_text_size_in_action:!1,auto_return_to_bed:!0,remember_message_log_filters:!1,remember_sorting_options:!1,combat_disable_autoswitch:!1,log_every_gathering_period:!0,log_total_gathering_gain:!0,auto_use_when_longest_runs_out:!0,use_uncivilised_temperature_scale:!1,do_background_animations:!1,skip_play_button:!1,mofu_mofu_mode:!0,do_enemy_onhit_animations:!0,expo_threshold:9,hide_max_level_skills:!1,use_text_outlines_for_tooltips:!0,use_text_outlines_for_bars:!0},Fi={unlocks:!0,events:!0,combat:!0,loot:!0,crafting:!0,background:!0},Ku=.1,Ju=2,si=[],Hi={TOP:"top",ALL:"all"},xn=document.getElementById("character_name_field");xn.value=r.name;xn.addEventListener("change",()=>r.name=xn.value.toString().trim().length>0?xn.value:"Hero");var lc=document.getElementById("time_div");lc.innerText=E.toString();(function(){Object.keys(f).forEach(t=>{r.xp_bonuses.total_multiplier[t]=1,r.bonus_skill_levels.full[t]=0}),Object.keys(Ui).forEach(t=>{r.xp_bonuses.total_multiplier["category_"+t]=1})})();function rc(e){let t=document.getElementById("options_textsize");t.checked||e?(M.uniform_text_size_in_action=!0,document.documentElement.style.setProperty("--options_action_textsize","20px")):(M.uniform_text_size_in_action=!1,document.documentElement.style.setProperty("--options_action_textsize","16px")),e!==void 0&&(t.checked=e)}function cc(e){let t=document.getElementById("options_bed_return");e!==void 0?(M.auto_return_to_bed=e,t.checked=e):M.auto_return_to_bed=t.checked}function uc(e){let t=document.getElementById("options_save_messagelog_settings");t.checked||e?M.remember_message_log_filters=!0:M.remember_message_log_filters=!1,e!==void 0&&(t.checked=e,Fi.unlocks?document.documentElement.style.setProperty("--message_unlocks_display","inline-block"):(document.documentElement.style.setProperty("--message_unlocks_display","none"),document.getElementById("message_show_unlocks").classList.remove("active_selection_button")),Fi.combat?document.documentElement.style.setProperty("--message_combat_display","inline-block"):(document.documentElement.style.setProperty("--message_combat_display","none"),document.getElementById("message_show_combat").classList.remove("active_selection_button")),Fi.events?document.documentElement.style.setProperty("--message_events_display","inline-block"):(document.documentElement.style.setProperty("--message_events_display","none"),document.getElementById("message_show_events").classList.remove("active_selection_button")),Fi.loot?document.documentElement.style.setProperty("--message_loot_display","inline-block"):(document.documentElement.style.setProperty("--message_loot_display","none"),document.getElementById("message_show_loot").classList.remove("active_selection_button")),Fi.crafting?document.documentElement.style.setProperty("--message_crafting_display","inline-block"):(document.documentElement.style.setProperty("--message_crafting_display","none"),document.getElementById("message_show_crafting").classList.remove("active_selection_button")),Fi.background?document.documentElement.style.setProperty("--message_background_display","inline-block"):(document.documentElement.style.setProperty("--message_background_display","none"),document.getElementById("message_show_background").classList.remove("active_selection_button")))}function dc(e){let t=document.getElementById("options_dont_autoswitch_to_combat");t.checked||e?M.disable_combat_autoswitch=!0:M.disable_combat_autoswitch=!1,e!==void 0&&(t.checked=e)}function mc(e){let t=document.getElementById("options_log_all_gathering");t.checked||e?M.log_every_gathering_period=!0:M.log_every_gathering_period=!1,e!==void 0&&(t.checked=e)}function hc(e){let t=document.getElementById("options_log_gathering_result");t.checked||e?M.log_total_gathering_gain=!0:M.log_total_gathering_gain=!1,e!==void 0&&(t.checked=e)}function _c(e){let t=document.getElementById("options_expo_threshold");M.expo_threshold=e||t.value||0,e!==void 0&&(t.value=e),t.nextElementSibling.value="1e"+M.expo_threshold}function pc(e){let t=document.getElementById("options_use_uncivilised_temperature_scale");t.checked||e?M.use_uncivilised_temperature_scale=!0:M.use_uncivilised_temperature_scale=!1,e!==void 0&&(t.checked=e),ls()}function fc(e){let t=document.getElementById("options_do_background_animations");t.checked||e?M.do_background_animations=!0:(M.do_background_animations=!1,mn(),window.removeEventListener("resize",ua),window.removeEventListener("resize",ca),window.removeEventListener("resize",da)),e!==void 0&&(t.checked=e)}function gc(e){let t=document.getElementById("options_skip_play_button");t.checked||e?M.skip_play_button=!0:M.skip_play_button=!1,e!==void 0&&(t.checked=e)}function wc(e){let t=document.getElementById("options_mofu_mofu_mode");e!==void 0&&(t.checked=e),t.checked?(M.mofu_mofu_mode=!0,Ie.is_mofu_mofu_enabled=!0,Dt=Ha.mofu_english):(M.mofu_mofu_mode=!1,Ie.is_mofu_mofu_enabled=!1,Dt=Ha.english)}function yc(e){let t=document.getElementById("options_do_enemy_onhit_animations");t.checked||e?M.do_enemy_onhit_animations=!0:M.do_enemy_onhit_animations=!1,e!==void 0&&(t.checked=e)}function kc(e){let t=document.getElementById("options_hide_max_level_skills");t.checked||e?(M.hide_max_level_skills=!0,document.documentElement.style.setProperty("--maxxed_skill_display","none")):(M.hide_max_level_skills=!1,document.documentElement.style.setProperty("--maxxed_skill_display","block")),e!==void 0&&(t.checked=e)}function bc(e){let t=document.getElementById("options_tooltip_outline");t.checked||e?(M.use_text_outlines_for_tooltips=!0,document.documentElement.style.setProperty("--outline_white",document.documentElement.style.getPropertyValue("--outline_white_default")),document.documentElement.style.setProperty("--outline_black",document.documentElement.style.getPropertyValue("--outline_white_default"))):(M.use_text_outlines_for_tooltips=!1,document.documentElement.style.setProperty("--outline_white","0"),document.documentElement.style.setProperty("--outline_black","0")),e!==void 0&&(t.checked=e)}function vc(e){let t=document.getElementById("options_bar_outline");t.checked||e?(M.use_text_outlines_for_bars=!0,document.getElementById("character_xp_value").classList.add("outline_black_static"),document.getElementById("character_stamina_value").classList.add("outline_black_static"),document.getElementById("character_mana_value").classList.add("outline_black_static"),document.getElementById("character_health_value").classList.add("outline_black_static")):(M.use_text_outlines_for_bars=!1,document.getElementById("character_xp_value").classList.remove("outline_black_static"),document.getElementById("character_stamina_value").classList.remove("outline_black_static"),document.getElementById("character_mana_value").classList.remove("outline_black_static"),document.getElementById("character_health_value").classList.remove("outline_black_static")),e!==void 0&&(t.checked=e)}function jt({location_id:e,event:t,skip_travel_time:i=!1,do_quest_events:a=!0,skip_combat:s=!1}){if(t?.target.classList.contains("fast_travel_removal_button"))return;let n=x,o=m[e]||x;if(!(e!==x?.name&&o.is_finished)){if(Ko(),Ms(),kd(),!o)throw`No such location as "${e}"`;a&&$n({quest_event_type:"enter_location",quest_event_target:o.id,quest_event_count:1}),typeof x<"u"&&x.id!==o.id&&C(`[ Entering ${o.name} ]`,"message_travel"),o.crafting&&go(),x=o,ni||(ni=new ja,ni.fill_connections(m)),Bt[x.id]||(Bt[x.id]=ni.find_shortest_paths(x.id)),n&&!i&&Wd({value:Bt[n.id][x.id],source:"travel"}),ls(),Re(),"connected_locations"in x?as(x):(cr(x),s||Cc(),x.is_challenge||(Lt=x.id)),Pe({rewards:x.entrance_rewards})}}function Xu(){x.housing&&x.housing.is_unlocked||(ut[x.id]?Oc({location_id:x.id,update_choices:!1}):yd({location_id:x.id}))}function xc(e){if(B=Object.assign({},x.activities[e]),B.id=e,!A[B.activity_name])throw`No such activity as ${B.activity_name} could be found`;if(A[B.activity_name].type==="JOB"){if(!na(B)){B=null;return}}else if(A[B.activity_name].type==="TRAINING"){if(!na(B)){B=null;return}}else if(A[B.activity_name].type==="GATHERING"){if(!(!A[B.activity_name].required_tool_type||r.equipment[A[B.activity_name].required_tool_type])){C("You need to equip a proper tool to do that!"),B=null;return}B.gathered_materials={}}else throw`"${A[B.activity_name].type}" is not a valid activity type!`;B.gathering_time=0,B.gathering_time_needed=B.getActivityEfficiency().gathering_time_needed,ul({content_type:"activity",data:{activity:B}})}function sl(){if(C(`${r.name} finished ${B.activity_name}`,"activity_finished"),B.earnings&&(C(`${r.name} earned ${Ke(B.earnings)}`,"activity_money"),Sc(B.earnings)),B.gathered_materials&&M.log_total_gathering_gain){let e=[];Object.keys(B.gathered_materials).forEach(t=>{e.push({item_key:t,count:B.gathered_materials[t]})}),Zn({loot_list:e,is_a_summary:!0})}pi(),B=null,En(Hi.TOP)}function Zu(e,t){za=e;let i;Ze?i=q[Ze].actions[e]:i=x.actions[e];let a;if(ul({content_type:"action",data:{dialogue_key:Ze,action_key:e}}),!i.can_be_started(r)){xs({action_key:e,conditions_status:-1,dialogue_key:Ze});return}if(!i.check_conditions_on_finish&&(a=i.get_conditions_status(r),a==0)){xs({action_key:e,conditions_status:0,dialogue_key:Ze});return}if(t&&i.floating_click_effects){let s=i.floating_click_effects[Math.floor(Math.random()*i.floating_click_effects.length)];or(s,{x:t.pageX,y:t.pageY})}if(i.attempt_duration>0){let s=i.keep_progress?i.accumulated_progress:0,n=i.attempt_duration/.1;Es=setInterval(()=>{s>=n-1&&(clearInterval(Es),xs({action_key:e,conditions_status:a,dialogue_key:Ze})),s++,i.keep_progress&&(i.accumulated_progress=s),So(s/n)},1e3*.1/we)}else So(1),xs({action_key:e,conditions_status:a,dialogue_key:Ze})}function xs({action_key:e,conditions_status:t,dialogue_key:i}){pi(!0);let a;i?a=q[i].actions[e]:a=x.actions[e],typeof t>"u"&&(i?t=q[i].actions[e].get_conditions_status(r):t=x.actions[e].get_conditions_status(r));let s="If you see this, Miktaew screwed something up. Whoops!";if(t==-1)s=a.failure_texts.unable_to_begin[Math.floor(a.failure_texts.unable_to_begin.length*Math.random())];else if(t==0)s=a.failure_texts.conditional_loss[Math.floor(a.failure_texts.conditional_loss.length*Math.random())];else{let n=td({action_key:e,conditions_status:t,dialogue_key:i}),o=!1;n>Math.random()?(s=a.success_text,a.repeatable?a.completion_count++:qc({dialogue_key:i,location_key:x.id,action_key:e}),Pe({rewards:a.rewards,source_type:"action",source_name:i||x.id}),o=!0):s=a.failure_texts.random_loss[Math.floor(a.failure_texts.random_loss.length*Math.random())],Object.keys(a.conditions[0]?.items_by_id||{}).forEach(l=>{a.conditions[0].items_by_id[l].remove&&wt([{item_key:c[l].getInventoryKey(),item_count:a.conditions[0].items_by_id[l].count}])}),Object.keys(a.required.items_by_id||{}).forEach(l=>{(a.required.items_by_id[l].remove_on_success&&o||a.required.items_by_id[l].remove_on_fail&&!o)&&wt([{item_key:c[l].getInventoryKey(),item_count:a.required.items_by_id[l].count}])})}Sr(),i?(bd({data:{upstack_result_message:s}}),a.attempt_duration==0&&En(Hi.TOP)):qr(s)}function ed(){pi(),clearInterval(Es),za=null,En(Hi.TOP)}function td({action_key:e,conditions_status:t,dialogue_key:i}){let a;return i?a=q[i].actions[e]:a=x.actions[e],a.success_chances.length==1?a.success_chances[0]:t==1&&a.success_chances[1]?a.success_chances[1]:a.success_chances[0]+(a.success_chances[1]-a.success_chances[0])*t}function id({activity_id:e}){if(!A[e].is_unlocked){A[e].is_unlocked=!0;let t="";A[e].unlock_text&&(t=A[e].unlock_text+":<br>"),C(t+`Gained the ability of "${A[e].name}"`,"activity_unlocked")}}function ad(e){if(!e.activity.is_unlocked&&(e.activity.is_unlocked=!0,!e.skip_message)){let t="";m[e.location].activities[e.activity.activity_id].unlock_text&&(t=m[e.location].activities[e.activity.activity_id].unlock_text+":<br>"),(A[e.activity.activity_name].type!=="GATHERING"||Ie.is_gathering_unlocked)&&C(t+`Unlocked activity "${e.activity.activity_name}" in location "${e.location}"`,"activity_unlocked")}}function nc(e){if(!e.action.is_unlocked&&(e.action.is_unlocked=!0,!e.skip_message)){let t="";e.location?m[e.location].actions[e.action.action_id].unlock_text&&(t=m[e.location].actions[e.action.action_id].unlock_text+":<br>",C(t+`Unlocked action "${e.action.action_name}" in location "${e.location}"`,"activity_unlocked")):e.dialogue&&q[e.dialogue].actions[e.action.action_id].unlock_text&&(t=q[e.dialogue].actions[e.action.action_id].unlock_text+":<br>",C(t+`Unlocked action "${e.action.action_name}" wit "${e.dialogue}"`,"activity_unlocked"))}}function qc({location_key:e,dialogue_key:t,action_key:i}){t?q[t].actions[i].is_finished=!0:m[e].actions[i].is_finished=!0}function Sc(e){r.money+=e,ba()}function ol({ammount_to_restore:e=0,ammount_to_loose:t=0,add_xp:i=!0}={}){if(!e&&!t)return;let a=Math.min(r.stats.full.max_health-r.stats.full.health,e-t),s=Math.min(r.stats.full.max_health-r.stats.full.health+t,e);a&&(r.stats.full.health+=a,fi()),s&&i&&s>0&&ee({skill:f.Regeneration,xp_to_add:s}),r.stats.full.health<=0&&(r.stats.full.health=0,Bc({is_combat:"parent_location"in x}))}function nd(){if(r.stats.full.health<r.stats.full.max_health){let e=Math.round(Math.max(r.stats.full.max_health*.01,2)*(1+3*K("Regeneration")/f.Regeneration.max_level));ol({ammount_to_restore:e})}if(r.stats.full.stamina<r.stats.full.max_stamina){let e=Math.round(Math.max(r.stats.full.max_stamina/120,2));r.stats.full.stamina+=e,r.stats.full.stamina>r.stats.full.max_stamina&&(r.stats.full.stamina=r.stats.full.max_stamina),la()}}function sd(){if(r.stats.full.health<r.stats.full.max_health){let e=Math.round(Math.max(r.stats.full.max_health*.04,5)*(1+K("Sleeping")/f.Sleeping.max_level)*(1+3*K("Regeneration")/f.Regeneration.max_level));ol({ammount_to_restore:e})}if(r.stats.full.stamina<r.stats.full.max_stamina){let e=Math.round(Math.max(r.stats.full.max_stamina/30,5)*(1+K("Sleeping")/f.Sleeping.max_level));r.stats.full.stamina+=e,r.stats.full.stamina>r.stats.full.max_stamina&&(r.stats.full.stamina=r.stats.full.max_stamina),la()}}function ll(){Ir(),Yi=!0,ti=x.id}function Ic(){Yi=!1,jt({location_id:x.id,skip_travel_time:!0}),pi()}function $c(e){let t=Ss(e)?JSON.parse(e).id:e;if(!x?.parent_location){if(_t===t){Ts();return}else _t&&Ts();V[t].is_finished||(Yi&&Ic(),B&&sl(),_t=t,$r(t),is(_t))}}function Ts(){jt({location_id:x.id,skip_travel_time:!0}),pi();let e=_t;_t=null,is(e)}function od(){c[_t].addProgress(),is(_t);let e=V[_t];ee({skill:f.Literacy,xp_to_add:e.literacy_xp_rate}),e.is_finished&&(C(`Finished the book "${_t}"`),fs(_t,!0),Ts(),r.stats.add_book_bonus(e.bonuses),Re(),Pe({rewards:e.rewards}))}function No(){return _t}function na(e){if(!e.infinite){if(e.availability_time){if(e.availability_time.end>e.availability_time.start){if(E.hour*60+E.minute>e.availability_time.end*60||E.hour*60+E.minute<e.availability_time.start*60||!e.availability_seasons?.includes(E.getSeason()))return!1}else if(!e.availability_seasons?.includes(E.getSeason(1))||E.hour*60+E.minute>e.availability_time.start*60||E.hour*60+E.minute<e.availability_time.end*60)return!1}else if(!e.availability_seasons?.includes(E.getSeason()))return!1}return!0}function Dr(e){if(!e.infinite){if(e.availability_time.end>e.availability_time.start){if(E.hour*60+E.minute+e.gathering_time_needed-e.gathering_time%e.gathering_time_needed>e.availability_time.end*60||E.hour*60+E.minute<e.availability_time.start*60)return!1}else if(!e.availability_time.includes(E.getSeason(1))||E.hour*60+E.minute>e.availability_time.start*60&&E.hour*60+E.minute+e.working_period-e.gathering_time%e.gathering_time_needed>e.availability_time.end*60+24*60||E.hour*60+E.minute<e.availability_time.start*60&&E.hour*60+E.minute+e.working_period-e.gathering_time%e.gathering_time_needed>e.availability_time.end*60)return!1}return!0}function ld(e){ul({content_type:"dialogue",data:{dialogue_key:e}})}function rd(){Ze=null,En(Hi.TOP)}function cd(){as(x)}function ud(e){let i=q[Ze].textlines[e];Pe({rewards:i.rewards,source_type:"textline",inform_textline:!1,source_name:Ze}),i.otherUnlocks&&i.otherUnlocks();let a=dd(i);if(Ai()&&Math.random()<=.01){let s=a.split(" "),n=Math.floor(s.length*Math.random());s[n]="rat",a=s.join(" ")}i.branches_into?.length?ds({content_type:"dialogue_branch",data:{text:a,dialogue_key:Ze,textlines:i.branches_into}}):ds({content_type:"dialogue_answer",data:{text:a,dialogue_key:Ze}})}function dd(e){return e.getText({season:E.getSeason()})}function md(e){if(!de[e]){console.warn(`Tried to unlock stance "${e}", but no such stance exists!`);return}de[e].is_unlocked||C(`You have learned a new stance: "${de[e].name}"`,"location_unlocked"),de[e].is_unlocked=!0,ps(de,Fe,ii)}function Ya({stance_id:e,is_temporary:t=!1}){if(t){if(!de[e])throw new Error(`No such stance as "${e}"`);if(!de[e].is_unlocked)throw new Error(`Stance "${e}" is not yet unlocked!`)}else xt=de[e],$o(xt);Fe=de[e],Re(),H&&(rl(!0),Ca())}function Ec(e){ii[e]?delete ii[e]:de[e].is_unlocked?ii[e]=!0:console.warn(`Tried to fav a stance '${e}' despite it not being unlocked!`),Eo(de)}function Tc({enemies:e}={}){if(!x.get_next_enemies){Ko(),Ms();return}for(let a=0;a<H?.length;a++)Ao(a);H=e||x.get_next_enemies(),Ko();let t=1/r.stats.full.attack_speed;Gi=[...H.map(a=>1/a.stats.attack_speed)];let i=[t,...Gi].sort((a,s)=>a-s)[0];if(i<1){let a=1/i;t*=a;for(let s=0;s<H.length;s++)Gi[s]*=a,vi[s]=0,fa[s]=0,Fa[s]=[Date.now(),Date.now()]}else for(let a=0;a<H.length;a++)vi[a]=0,fa[a]=0,Fa[a]=[Date.now(),Date.now()];Ri=0,Ra=0,yn=[Date.now(),Date.now()];for(let a=0;a<H.length;a++)M.do_enemy_onhit_animations&&Wr(a),Mc(a,0,!0);cl({base_cooldown:t}),Ca(),_o()}function rl(e){if(!H)return;let t=1/r.stats.full.attack_speed;Gi=[...H.map(a=>1/a.stats.attack_speed)];let i=[t,...Gi].sort((a,s)=>a-s)[0];if(i<1){let a=1/i;t*=a;for(let s=0;s<H.length;s++)Gi[s]*=a}cl({base_cooldown:t,skip_persistence_xp_for_stance_change:e})}function Mc(e,t,i=!1){t=t||0,Mo(e,t/60),i&&(vi[e]=0,fa[e]=0),clearTimeout(In[e]),In[e]=setTimeout(()=>{Fa[e][0]=Date.now(),vi[e]+=Fa[e][0]-Fa[e][1]-Gi[e]*1e3/(60*we),Fa[e][1]=Date.now(),Mo(e,t/60),t++,t>=60&&(t=0,Lc(e)),Mc(e,t),vi[e]<=Pt/we&&vi[e]>=-Pt/we?fa[e]=vi[e]:vi[e]>Pt/we?fa[e]=Pt/we:vi[e]<-Pt/we&&(fa[e]=-Pt/we)},Gi[e]*1e3/(60*we)-fa[e])}function hd(e){clearTimeout(In[e])}function cl({base_cooldown:e,skip_persistence_xp_for_stance_change:t}){if(Ms(),!H)return;if(r.stats.full.stamina>=xt.stamina_cost/r.stats.full.stamina_efficiency){if(xt.id!==Fe.id){Ya({stance_id:xt.id});return}}else if(Fe.id!=="normal"){Ya({stance_id:"normal",is_temporary:!0});return}let i=Fe.target_count;i>1&&Fe.related_skill&&(i=i+Math.round(i*K(Fe.related_skill)/f[Fe.related_skill].max_level)),Fe.randomize_target_count&&(i=Math.floor(Math.random()*i)||1);let a=[],s=H.filter(l=>l.is_alive).slice(-i);for(;s.length>0;)a.push(s.pop());fd({stamina_to_use:Fe.stamina_cost,skip_persistence_xp_for_stance_change:t});let n=e/r.get_stamina_multiplier(),o=r.get_attack_power();Ac({base_cooldown:e,actual_cooldown:n,attack_power:o,targets:a,target_count:i})}function Ac({base_cooldown:e,actual_cooldown:t,attack_power:i,targets:a,count:s=0,is_new:n=!0,target_count:o=1,do_quest_events:l=!0}){Co(s/60),n&&(Ri=0,Ra=0),Ms(),oc=setTimeout(()=>{if(yn[0]=Date.now(),Ri+=yn[0]-yn[1]-t*1e3/(60*we),yn[1]=Date.now(),Co(s/60),s++,s>=60){s=0;let d=!1;for(let u=0;u<a.length;u++)_d({target:a[u],attack_power:i,target_count:a.length});Fe.related_skill&&(d=ee({skill:f[Fe.related_skill],xp_to_add:a.reduce((u,h)=>u+h.xp_value,0)/a.length}),d&&(Mr(Fe),Re())),H.filter(u=>u.is_alive).length!=0?cl({base_cooldown:e}):(x.enemy_groups_killed+=1,x.enemy_groups_killed>0&&x.enemy_groups_killed%x.enemy_count==0&&(gd(x),l&&$n({quest_event_type:"clear",quest_event_target:x.id,quest_event_count:1})),ur(x),Tc())}else Ac({base_cooldown:e,actual_cooldown:t,attack_power:i,targets:a,target_count:o,count:s,is_new:!1});Ri<=Pt/we&&Ri>=-Pt/we?Ra=Ri:Ri>Pt/we?Ra=Pt/we:Ri<-Pt/we&&(Ra=-Pt/we)},t*1e3/(60*we)-Ra)}function Ms(){clearTimeout(oc)}function Ko(){Object.keys(In).forEach(e=>{clearTimeout(In[e])})}function Cc(){H==null&&Tc()}function Lc(e){if(!H)return;let t=H.filter(w=>w.is_alive).length**(2/3),i=H[e],a=H.filter(w=>w.is_alive).length**(-1/3),s=0;Object.keys(i.tags).forEach(w=>{if(Gt[w])for(let b=0;b<Gt[w].length;b++){let g=f[Gt[w][b]];ee({skill:g,xp_to_add:i.xp_value/t});let{modifier_to_evasion:v,modifier_to_defense:y}=g.get_stat_modifiers();a*=v||1,s+=y||1}});let n=i.stats.attack,o=[],l=!1,d=!1;for(let w=0;w<i.stats.attack_count;w++)o.push(n*(1.2-Math.random()*.4));if(o=o.sort((w,b)=>b-w),r.equipment["off-hand"]?.offhand_type==="shield")if(r.stats.full.block_chance>Math.random()){r.equipment["off-hand"].tags.ignore_skill||(o=o.map(b=>b*(1-K("Shield blocking")/100))),ee({skill:f["Shield blocking"],xp_to_add:i.xp_value/t});let w=r.equipment["off-hand"].getShieldStrength()*(r.equipment["off-hand"].tags.ignore_skill?1:r.stats.total_multiplier.block_strength);if(w>o[0]){C(r.name+" blocked an attack","hero_blocked");return}else o=o.map(b=>Math.max(0,b-w)),d=!0}else ee({skill:f["Shield blocking"],xp_to_add:i.xp_value/(2*t)});else if(ga(i.stats.dexterity*Math.sqrt(i.stats.intuition??1),r.stats.full.evasion_points*a)<Math.random()){let b=r.wears_armor()?i.xp_value:i.xp_value*1.5;ee({skill:f.Evasion,xp_to_add:b/t}),C(r.name+" evaded an attack","enemy_missed");return}else ee({skill:f.Evasion,xp_to_add:i.xp_value/(2*t)});nl++,Ku>Math.random()&&(o=o.map(w=>w*Ju),l=!0,il++),r.wears_armor()||ee({skill:f["Iron skin"],xp_to_add:i.xp_value/t});let{damage_taken:u,fainted:h}=r.take_damage({damage_values:o,defense_modifier:s});ee({skill:f.Fortitude,xp_to_add:u**.6/t});let _=o.length>1?` x${o.length}`:"";if(l?d?C(r.name+" partially blocked, was critically hit"+_+" for "+Math.ceil(10*u)/10+" dmg","hero_attacked_critically"):C(r.name+" was critically hit"+_+" for "+Math.ceil(10*u)/10+" dmg","hero_attacked_critically"):d?C(r.name+" partially blocked, was hit"+_+" for "+Math.ceil(10*u)/10+" dmg","hero_attacked"):C(r.name+" was hit"+_+" for "+Math.ceil(10*u)/10+" dmg","hero_attacked"),i.on_hit(r),h){Bc();return}fi()}function _d({target:e,attack_power:t,target_count:i}){let a=t,s=H.length**.3334,n,o=!1,l=H.filter(h=>h.is_alive).length**(-1/4),d=1;if(ee({skill:f.Combat,xp_to_add:e.xp_value*s/i}),Object.keys(e.tags).forEach(h=>{if(Gt[h])for(let _=0;_<Gt[h].length;_++){let w=f[Gt[h][_]];ee({skill:w,xp_to_add:e.xp_value*s/i});let{modifier_to_damage:b,modifier_to_hit_chance:g}=w.get_stat_modifiers();l*=g||1,d*=b||1}}),ga(r.stats.full.attack_points*l,e.stats.agility*Math.sqrt(e.stats.intuition??1))>Math.random()){if(al++,r.equipment.weapon!=null?(n=Math.round(10*d*a*(1.2-Math.random()*.4))/10,ee({skill:f[Za[r.equipment.weapon.weapon_type]],xp_to_add:e.xp_value*s/i})):(n=Math.round(10*a*(1.2-Math.random()*.4))/10,ee({skill:f.Unarmed,xp_to_add:e.xp_value*s/i})),M.do_enemy_onhit_animations){let h=H.findIndex(_=>_===e);Br(h)}if(r.stats.full.crit_rate>Math.random()?(n=Math.round(10*n*r.stats.full.crit_multiplier)/10,o=!0,tl++,ee({skill:f.Perception,xp_to_add:1/i})):o=!1,n=Math.ceil(10*Math.max(n-Math.max(0,e.stats.defense-r.stats.full.armor_penetration),n*.1,1))/10,e.stats.health-=n,n>Is&&(Is=n),o?C(e.name+" was critically hit for "+n+" dmg","enemy_attacked_critically"):C(e.name+" was hit for "+n+" dmg","enemy_attacked"),e.on_damaged(r),e.stats.health<=0){el++,e.stats.health=0,e.on_death(r),C(e.name+" was defeated","enemy_defeated");let h=e.xp_value*s;As(h/i,!0);let _=e.get_loot({drop_chance_modifier:1/i**.6667});_.length>0&&(Zn({loot_list:_,is_combat:!0}),_=_.map(w=>({item_key:c[w.item_id].getInventoryKey(),count:w.count})),et(_)),pd(e)}_o()}else C(r.name+" has missed","hero_missed")}function pd(e,t=!0){e.is_alive=!1,e.add_to_bestiary&&(Xt[e.name]?(Xt[e.name]+=1,Lr(e.name)):(Xt[e.name]=1,To(e.name)));let i=H.findIndex(a=>a===e);hd(i),t&&($n({quest_event_type:"kill",quest_event_target:e.id,quest_event_count:1}),Object.keys(e.tags||{}).forEach(a=>{$n({quest_event_type:"kill_any",quest_event_target:a,quest_event_count:1})}))}function Bc({is_combat:e=!0}={}){e&&(Zo++,C(r.name+" has lost consciousness","hero_defeat"),fi(),M.auto_return_to_bed&&ti?(jt({location_id:ti}),ll()):jt({location_id:x.parent_location.id})),ci("Recovering",5)}function fd({stamina_to_use:e=1,skip_persistence_xp_for_stance_change:t=!1}){if(r.stats.full.stamina-=e/(r.stats.full.stamina_efficiency||1),r.stats.full.stamina<0&&(r.stats.full.stamina=0),r.stats.full.stamina<1){r.stats.full.health/r.stats.full.max_health<.2&&(e*=2);for(let i=0;i<ws.length;i++)Se[ws[i]]&&(e*=1.19**i);t||ee({skill:f.Persistence,xp_to_add:e}),os()}la()}function ee({skill:e,xp_to_add:t=1,should_info:i=!0,use_bonus:a=!0,add_to_parent:s=!0,cap_gained_xp:n=!0,is_from_loading:o=!1,do_quest_events:l=!0}){let d=!1;if(t==0)return d;if(t<0)return console.error(`Tried to add negative xp to skill ${e.skill_id}`),d;if(isNaN(t))return console.error(`Tried to add NaN xp to skill ${e.skill_id}`),d;a&&(t=t*Uu*ji(e.skill_id),e.parent_skill&&(t*=e.get_parent_xp_multiplier())),n&&typeof e.xp_to_next_lvl===Number&&(t=Math.min(t,e.xp_to_next_lvl*Os));let u=e.name(),h=e.visibility_treshold>e.total_xp,{message:_,gains:w,unlocks:b}=e.add_xp({xp_to_add:t}),g=e.name();if(e.parent_skill&&s&&e.total_xp>f[e.parent_skill].total_xp){let y=Math.min(e.total_xp-f[e.parent_skill].total_xp,t);ee({skill:f[e.parent_skill],xp_to_add:y,should_info:i,use_bonus:!1,add_to_parent:s,cap_gained_xp:!1,is_from_loading:o})}let v=e.visibility_treshold<=e.total_xp;if(h&&v&&(Io(e),ra(e,!1),(typeof i>"u"||i)&&C(`Unlocked new skill: ${e.name()}`,"skill_raised")),w&&(r.stats.add_skill_milestone_bonus(w),e.skill_id==="Unarmed"&&r.stats.add_all_equipment_bonus()),v){if(u!==g){if(gt[e.skill_id])for(let y=0;y<gt[e.skill_id].length;y++)ra(f[gt[e.skill_id][y]],!1);Object.keys(Yt).forEach(y=>{(V[y]?.bonuses?.xp_multipliers||{})[e.skill_id]&&fs(y,!0)}),Object.keys(r.inventory).forEach(y=>{let I=xe(y);if(I.tags.usable){let $=I.effects;for(let _e=0;_e<$.length;_e++)if(z[$[_e].effect].effects?.bonus_skill_levels?.[e.skill_id]){ve({item_key:y});return}}else I.tags.book?(V[I.id]?.bonuses?.xp_multipliers||{})[e.skill_id]&&ve({item_key:y}):I.tags.equippable&&I.getBonusSkillLevels()[e.skill_id]&&ve({item_key:y})}),Object.keys(r.equipment).forEach(y=>{if(!r.equipment[y])return;r.equipment[y].getBonusSkillLevels()[e.skill_id]&&(Pi(),ve({equip_slot:y}))})}typeof _<"u"?(d=!0,_=_.replace("%HeroName%",r.name),ra(e,!0),(typeof i>"u"||i)&&Re(),typeof e.get_effect_description<"u"&&Er(e),e.is_parent?hs():Ba(e),cs(),Pe({source_name:e.skill_id,source_type:"skill",rewards:b,inform_overall:i}),(typeof i>"u"||i)&&C(_,"skill_raised"),u!==g&&(!h&&(typeof i>"u"||i)&&C(`Skill ${u} upgraded to ${g}`,"skill_raised"),x?.connected_locations&&!B&&Object.keys(x.activities).forEach(y=>{A[x.activities[y].activity_name].base_skills_names.includes(e.skill_id)&&ss(A[y])}),La()),ha[e.skill_id]&&!o&&(ni=new ja,ni.fill_connections(m),Bt={},Bt[x.id]=ni.find_shortest_paths(x.id)),Pn[e.skill_id]&&Object.keys(Xt).forEach(y=>{U[y].tags[Pn[e.skill_id]]&&Cr(y)}),l&&$n({quest_event_type:"reach_skill",quest_event_target:e.skill_id,quest_event_count:e.current_level})):ra(e,!1)}return d}function As(e,t=!0,i){let a=r.add_xp({xp_to_add:e,use_bonus:i});a&&(t&&C(a,"level_up"),r.stats.full.health=r.stats.full.max_health,Re()),xr(a)}function gd(e){let t=!1;if(e.enemy_groups_killed==e.enemy_count||e.is_challenge?(e.is_challenge&&Wc({location:e,challenge_self_lock:!0}),t=!0,e.first_reward&&Pe({rewards:e.first_reward,source_type:"location",source_name:e.name,is_first_clear:!0,source_id:e.id})):e.repeatable_reward.xp&&typeof e.repeatable_reward.xp=="number"&&Pe({rewards:{xp:e.repeatable_reward.xp},source_type:"location",source_name:e.name,is_first_clear:!1,source_id:e.id}),e.rewards_with_clear_requirement)for(let i=0;i<e.rewards_with_clear_requirement.length;i++)e.enemy_groups_killed==e.enemy_count*e.rewards_with_clear_requirement[i].required_clear_count&&Pe({rewards:e.rewards_with_clear_requirement[i],source_type:"location",source_name:e.name,is_first_clear:!1,source_id:e.id});Pe({rewards:{...e.repeatable_reward,xp:null},source_type:"location",source_name:e.name,is_first_clear:!1,source_id:e.id}),e.otherUnlocks(),t&&x?.parent_location&&jt({location_id:x.parent_location.id})}function Pe({rewards:e={},source_type:t,source_name:i,is_first_clear:a,inform_overall:s=!0,inform_textline:n=!0,only_unlocks:o=!1,is_from_loading:l=!1}){let d=!1;if(e.messages&&!l)for(let u=0;u<e.messages.length;u++)C(e.messages[u]);if(e.money&&typeof e.money=="number"&&!o&&(s&&C(`${r.name} earned ${Ke(e.money)}`),Sc(e.money)),e.xp&&typeof e.xp=="number"&&!o&&(t==="location"?s&&(a?C(`Obtained ${e.xp}xp for clearing ${i} for the first time`,"location_reward"):C(`Obtained additional ${e.xp}xp for clearing ${i}`,"location_reward")):C(`Gained ${e.xp}xp`,"location_reward"),As(e.xp)),e.skill_xp&&!o&&Object.keys(e.skill_xp).forEach(u=>{typeof e.skill_xp[u]=="number"&&(s&&C(`${r.name} gained ${e.skill_xp[u]}xp to ${f[u].name()}`),ee({skill:f[u],xp_to_add:e.skill_xp[u],cap_gained_xp:!1}))}),e.locations)for(let u=0;u<e.locations.length;u++)d=wd({location:m[e.locations[u].location],skip_message:s&&e.locations[u].skip_message||l})||d;if(e.flags)for(let u=0;u<e.flags.length;u++){let h=Ie[e.flags[u]];Ie[e.flags[u]]=!0,!h&&ic[e.flags[u]]&&s&&C(`${ic[e.flags[u]]}`,"activity_unlocked")}if(e.textlines)for(let u=0;u<e.textlines.length;u++){let h=!1;for(let _=0;_<e.textlines[u].lines.length;_++)q[e.textlines[u].dialogue].textlines[e.textlines[u].lines[_]].is_unlocked==!1&&(h=!0,q[e.textlines[u].dialogue].textlines[e.textlines[u].lines[_]].is_unlocked=!0);h&&n&&s&&!e.textlines[u].skip_message&&i!==e.textlines[u].dialogue&&C(`You should talk to ${q[e.textlines[u].dialogue].getName({is_mofu_mofu_enabled:Ie.is_mofu_mofu_enabled})}`,"dialogue_unlocked")}if(e.dialogues)for(let u=0;u<e.dialogues?.length;u++){let h=q[e.dialogues[u]];h.is_unlocked||(h.is_unlocked=!0,C(`You can now talk with ${h.name}`,"activity_unlocked"))}if(e.traders)for(let u=0;u<e.traders.length;u++){let h=F[e.traders[u].trader];h.is_unlocked||(h.is_unlocked=!0,e.traders[u].skip_message||(h.unlock_message?C(h.unlock_message,"activity_unlocked"):C(`You can now trade with ${h.name}`,"activity_unlocked")))}if(e.housing)for(let u=0;u<e.housing.length;u++)m[e.housing[u]].housing.is_unlocked=!0;if(e.crafting)for(let u=0;u<e.crafting.length;u++)m[e.crafting[u]].crafting.is_unlocked=!0,C(`You can now use a crafting station in ${m[e.crafting[u]].name}`,"activity_unlocked");if(e.global_activities)for(let u=0;u<e.global_activities?.length;u++)id({activity_id:e.global_activities[u]});if(e.activities)for(let u=0;u<e.activities?.length;u++)(!m[e.activities[u].location].activities[e.activities[u].activity].tags?.gathering||Ie.is_gathering_unlocked)&&ad({location:m[e.activities[u].location].name,activity:m[e.activities[u].location].activities[e.activities[u].activity],skip_message:l});if(e.actions)for(let u=0;u<e.actions?.length;u++)e.actions[u].dialogue?nc({dialogue:q[e.actions[u].dialogue]?.name,action:q[e.actions[u].dialogue].actions[e.actions[u].action],skip_message:l}):e.actions[u].location&&nc({location:m[e.actions[u].location]?.name,action:m[e.actions[u].location].actions[e.actions[u].action],skip_message:l});if(e.stances)for(let u=0;u<e.stances.length;u++)md(e.stances[u]);if(e.skills){for(let u=0;u<e.skills.length;u++)if(!f[e.skills[u]].is_unlocked){f[e.skills[u]].is_unlocked=!0,Io(f[e.skills[u]]),ra(f[e.skills[u]],!1),s&&C(`Unlocked new skill: ${f[e.skills[u]].name()}`),t==="skill"&&(gt[e.skills[u]]||(gt[e.skills[u]]=[]),f[i]?gt[e.skills[u]].push(i):console.error(`Tried to register skill "${i}" as related to "${e.skills[u]}", but the former does not exist!`));for(let h=0;h<gt[e.skills[u]]?.length;h++)ra(f[gt[e.skills[u]][h]],!1)}}if(e.recipes)for(let u=0;u<e.recipes.length;u++)G[e.recipes[u].category][e.recipes[u].subcategory][e.recipes[u].recipe_id].is_unlocked||(G[e.recipes[u].category][e.recipes[u].subcategory][e.recipes[u].recipe_id].is_unlocked=!0,s&&C(`Unlocked new recipe: ${G[e.recipes[u].category][e.recipes[u].subcategory][e.recipes[u].recipe_id].name}`));if(e.quests)for(let u=0;u<e.quests.length;u++)!ge.isQuestActive(e.quests[u])&&!ge.isQuestFinished(e.quests[u])&&ge.startQuest({quest_id:e.quests[u]});if(e.quest_progress)for(let u=0;u<e.quest_progress.length;u++){let h=e.quest_progress[u].quest_id,_=e.quest_progress[u].task_index;_==O[h].getCompletedTaskCount()&&(O[h]?.quest_tasks[_]?ge.finishQuestTask({quest_id:h,task_index:_,skip_warning:!0}):console.warn(`Tried to complete ${_}'th task for quest '${h}', but either quest or index does not exist!`))}if(e.locks){if(e.locks.textlines&&Object.keys(e.locks.textlines).forEach(u=>{for(let h=0;h<e.locks.textlines[u].length;h++)q[u].textlines[e.locks.textlines[u][h]].is_finished=!0}),e.locks.locations)for(let u=0;u<e.locks.locations.length;u++)d=Wc({location:m[e.locks.locations[u]]})||d;if(e.locks.traders)for(let u=0;u<e.locks.traders.length;u++)F[e.locks.traders[u]].is_finished=!0;if(e.locks.quests)for(let u=0;u<e.locks.quests.length;u++)ge.finishQuest({quest_id:e.locks.quests[u],skip_rewards:!0});if(e.locks.actions)for(let u=0;u<e.locks.actions.length;u++)qc({dialogue_key:e.locks.actions[u].dialogue,location_key:e.locks.actions[u].location,action_key:e.locks.actions[u].action})}if(e.items&&!o)for(let u=0;u<e.items.length;u++){let h,_;typeof e.items[u]=="string"?(h=c[e.items[u]],_=1):(h=c[e.items[u].item],_=e.items[u].count||1),C(`${r.name} obtained "${h.getName()} x${_}"`),et([{item_key:h.getInventoryKey(),count:_}])}e.reputation&&(Object.keys(e.reputation).forEach(u=>{Xr.add_reputation({region:u,reputation:e.reputation[u]})}),xo()),d&&!l&&(ni=new ja,ni.fill_connections(m),Bt={},Bt[x.id]=ni.find_shortest_paths(x.id)),e.move_to&&!o&&(t!=="action"?jt({location_id:e.move_to.location}):x=m[e.move_to.location])}function wd({location:e,skip_message:t}){let i=!1;if(!e.is_unlocked){if(e.is_unlocked=!0,i=!0,!t){let a=e.unlock_text||`Unlocked location ${e.name}`;C(a,"location_unlocked")}x&&!Ze&&!za&&jt({location_id:x.id,skip_travel_time:!0})}return e.housing?.is_unlocked&&(Pa[e.id]=!0),i}function Wc({location:e,challenge_self_lock:t=!1}){let i=!1;return ut[e.id]&&(delete ut[e.id],t||ns({location_id:e.id})),e.is_finished||(i=!0,e.is_finished=!0),Lt===e.id&&(Lt=null),i}function yd({location_id:e}){if(ut[e]){console.warn(`Tried to favourite location "${m[e].name}" despite it already being in favourites`);return}ut[e]=!0,dn()}function Oc({location_id:e,update_choices:t=!0}){if(!ut[e]){console.warn(`Tried to unfavourite location "${m[e].name}" despite it not being in favourites`);return}delete ut[e],dn(),t&&ns({location_id:e})}function kd(){H=null;for(let e=0;e<7;e++)Ao(e)}function Pc(e,t=1){let i=e.parentNode.parentNode.dataset.crafting_category,a=e.parentNode.parentNode.dataset.crafting_subcategory,s=e.parentNode.dataset.recipe_id,n=x.crafting.tiers[i];if(!i||!a||!s)throw new Error(`Tried to use a recipe but either category, subcategory, or recipe id was not passed: ${i} - ${a} - ${s}`);if(G[i][a][s]){let o=G[i][a][s],l=document.querySelector(`[data-crafting_category="${i}"][data-crafting_subcategory="${a}"] [data-recipe_id="${s}"]`),d=!1,u,h;if(a==="items"){let{available_ammount:_,materials:w}=o.get_availability(),b=Math.min(t,_),g=b,v;if(b>0){let y=o.get_success_chance(n);u=o.getResult();let{result_id:I,count:$}=u,_e=f[o.recipe_skill],Le=_e.total_xp_to_next_lvl-_e.total_xp,Ve=Math.min(_e.xp_to_next_lvl*Ps,It({category:i,subcategory:a,recipe_id:s})*ji(_e.skill_id)),Ge=Ve*y,He=Math.ceil(Le/Ge);g=Math.min(He,b),v=Math.floor(g*y);let oi=Math.random()<g*y-v?1:0;v+=oi;let li=(v+(g-v)/4)*Ve,lt=0,St=0;if(g<b&&li<Le){for(let J=0;J<2&&g+lt+St<b&&(Math.random()<y?lt++:St++,!(li+Ve*(lt+St/4)>=Le));J++);g+=lt+St,v+=lt}h=li+Ve*(lt+St/4),bn+=g,vn+=v;for(let J=0;J<o.materials.length;J++)if(o.materials[J].material_id){let Be=c[o.materials[J].material_id].getInventoryKey();wt([{item_key:Be,item_count:o.materials[J].count*g}])}for(let J=0;J<w.length;J++){let Be=c[w[J]].material_type,rt=o.materials.find(fe=>fe.material_type===Be);wt([{item_key:c[w[J]].getInventoryKey(),item_count:rt.count*g}])}if(v>0){et([{item_key:c[I].getInventoryKey(),count:$*v}]);let J=`Created ${c[I].getName()}`;g>1?J+=` [${$*v} out of ${$*g}]`:J+=` x${$*v}`,C(J,"crafting")}else{let J=`Failed to create ${c[I].getName()}`;g>1?J+=` [0 out of ${$*g}]`:J+=` x${$*g}`,C(J,"crafting")}d=ee({skill:_e,xp_to_add:h,cap_gained_xp:!1,use_bonus:!1}),Object.keys(c[I].tags).forEach(J=>{let Be=pl[J];Be&&ee({skill:f[Be],xp_to_add:h/2,cap_gained_xp:!0,use_bonus:!1})&&(r.stats.add_active_effect_bonus(),Re(),Object.keys(r.inventory).forEach(fe=>{r.inventory[fe].item.tags.medicine&&ve({item_key:fe})}))}),g<b?Pc(e,b-g):(ko(),yr())}else console.warn("Tried to use a recipe without having enough materials!")}else if(a==="components"||o.recipe_type==="component"||o.recipe_type==="componentless"){let _=l.children[1].querySelector(".selected_material");if(_){let w=_.dataset.item_key,{id:b}=JSON.parse(w),g=o.materials.filter(v=>v.material_id===b)[0];if(g.count<=r.inventory[w]?.count){let v=f[o.recipe_skill],y=Math.min(t,Math.floor(r.inventory[w].count/g.count)),I=v.total_xp_to_next_lvl-v.total_xp,$=0,_e={},Le=0,Ve={},Ge=o.getResult(r.inventory[w].item,n),He;for(let J=0;J<y;J++){let Be=Ge.component_tier??Ge.item_tier;if(He=o.get_quality(n-Be),_e[He]=_e[He]+1||1,Ve[He]=Ve[He]+1||1,Le++,$+=Math.min(v.xp_to_next_lvl*Ps,It({category:i,subcategory:a,recipe_id:s,material_count:g.count,result_tier:Be,rarity_multiplier:Ee[at(He)]})*ji(v.skill_id)),$>=I){let fe=Object.keys(_e).map(Ut=>Number(Ut)).sort((Ut,ri)=>ri-Ut)[0];Le>1?C(`Created ${Ge.getName()} x${Le} [highest quality: ${fe}% x${_e[fe]}] (+${Math.floor($)} xp)`,"crafting"):C(`Created ${Ge.getName()} [${fe}% quality] x1 (+${Math.floor($)} xp)`,"crafting"),ee({skill:v,xp_to_add:$,cap_gained_xp:!1,use_bonus:!1}),_e={},Le=0,$=0,I=v.total_xp_to_next_lvl-v.total_xp}}if(bn+=y,vn+=y,Le>0){let Be=Object.keys(_e).map(rt=>Number(rt)).sort((rt,fe)=>fe-rt)[0];Le>1?C(`Created ${Ge.getName()} x${Le} [highest quality: ${Be}% x${_e[Be]}] (+${Math.floor($)} xp)`,"crafting"):C(`Created ${Ge.getName()} [${Be}% quality] x1 (+${Math.floor($)} xp)`,"crafting"),ee({skill:v,xp_to_add:$,cap_gained_xp:!1,use_bonus:!1})}let oi=Ge.getInventoryKey(),li=JSON.parse(oi),lt=Object.keys(Ve).map(J=>Number(J)),St=[];for(let J=0;J<lt.length;J++){let Be=JSON.stringify({...li,quality:lt[J]});St.push({item_key:Be,count:Ve[lt[J]]})}et(St),wt([{item_key:w,item_count:g.count*y}]),_.classList.remove("selected_material"),r.inventory[w]?g.count>r.inventory[w].count&&_.classList.add("recipe_unavailable"):_.remove(),yo({category:i,subcategory:a,recipe_id:s,refreshing:!0})}else console.log("Tried to create an item without having necessary materials")}else return}else if(a==="equipment"){let _=l.children[1].children[0].children[1].querySelector(".selected_component")?.dataset.item_key,w=l.children[1].children[1].children[1].querySelector(".selected_component")?.dataset.item_key;if(!_||!w)return;if(!r.inventory[_]||!r.inventory[w])throw new Error("Tried to create item with components that are not present in the inventory!");if(r.inventory[_].count&&r.inventory[w].count){let b=f[o.recipe_skill],g=Math.min(t,r.inventory[_].count,r.inventory[w].count),v=b.total_xp_to_next_lvl-b.total_xp,y=0,I={},$=0,_e=r.inventory[_].item,Le=r.inventory[w].item,Ve={},Ge=o.getResult(_e,Le,n),He,oi=o.get_component_quality_weighted(_e,Le),li=Math.max(_e.component_tier,Le.component_tier);for(let fe=0;fe<g;fe++)if(He=o.get_quality(oi,n-Math.max(li)||0),I[He]=I[He]+1||1,Ve[He]=Ve[He]+1||1,$++,y+=Math.min(b.xp_to_next_lvl,It({category:i,subcategory:a,recipe_id:s,selected_components:[_e,Le],rarity_multiplier:Ee[at(He)]})*ji(b.skill_id)),y>=v){let ri=Object.keys(I).map(Da=>Number(Da)).sort((Da,Vc)=>Vc-Da)[0];$>1?C(`Created ${Ge.getName()} x${$} [highest quality: ${ri}% x${I[ri]}] (+${Math.floor(y)} xp)`,"crafting"):C(`Created ${Ge.getName()} [${ri}% quality] x1 (+${Math.floor(y)} xp)`,"crafting"),ee({skill:b,xp_to_add:y,use_bonus:!1,cap_gained_xp:!1}),I={},$=0,y=0,v=b.total_xp_to_next_lvl-b.total_xp}if(bn+=g,vn+=g,$>0){let Ut=Object.keys(I).map(ri=>Number(ri)).sort((ri,Da)=>Da-ri)[0];$>1?C(`Created ${Ge.getName()} x${$} [highest quality: ${Ut}% x${I[Ut]}] (+${Math.floor(y)} xp)`,"crafting"):C(`Created ${Ge.getName()} [${Ut}% quality] x1 (+${Math.floor(y)} xp)`,"crafting"),ee({skill:b,xp_to_add:y,use_bonus:!1,cap_gained_xp:!1})}let lt=Ge.getInventoryKey(),St=JSON.parse(lt),J=Object.keys(Ve).map(fe=>Number(fe)),Be=[];for(let fe=0;fe<J.length;fe++){let Ut=JSON.stringify({...St,quality:J[fe]});Be.push({item_key:Ut,count:Ve[J[fe]]})}et(Be),wt([{item_key:_,item_count:g},{item_key:w,item_count:g}]);let rt={};rt[_]=!0,rt[w]=!0,wo({category:i,recipe_id:s,component_keys:rt})}}}else throw new Error(`Tried to use a recipe that doesn't exist: ${i} -> ${a} -> ${s}`)}function ul({content_type:e,data:t,what_to_remove:i=Hi.TOP}){si.push({content_type:e,data:t,what_to_remove:i}),jc()}function En(){let t=si.pop().what_to_remove||Hi.TOP;if(t!==Hi.TOP)if(t===Hi.ALL)for(;si[0];)si.pop();else throw new Error(`No such content stack removal option as "${t}"`);jc()}function bd({data:e}){si.length>1&&(si[si.length-2].data.special=e)}function jc(){if(Ze?Ze=null:B?(B=null,pi()):za&&(za=null,pi(),clearInterval(Es)),si.length){let{content_type:e,data:t}=si[si.length-1];if(e.startsWith("dialogue")&&(Ze=t.dialogue_key),e!=="dialogue"){if(e!=="dialogue_answer"){if(e!=="dialogue_branch")if(e==="action")Ze=t.dialogue_key,za=t.action_key;else if(e==="activity")B=t.activity;else throw new Error(`Error on switching action box content: no such content type as "${e}"`)}}e&&ds({content_type:e,data:t})}else jt({location_id:x.id,skip_travel_time:!0})}function vd(e){Kr(e),H?(rl(!0),Ca()):x.tags.safe_zone&&Object.keys(x.activities).forEach(t=>{x.activities[t].gained_resources&&ss(x.activities[t])})}function xd(e){Ho(e),H&&(rl(!0),Ca())}function Nc(e){let{id:t}=JSON.parse(e),i=c[t].effects,a=!1;for(let s=0;s<i.length;s++){let n=c[t].effects[s].duration;(!Se[i[s].effect]||Se[i[s].effect].duration<n)&&(Se[i[s].effect]=new te({...z[i[s].effect],duration:n}),a=!0)}if(a){La(),r.stats.add_active_effect_bonus(),Re();let s=[];Object.keys(c[t].recovery_chances).forEach(n=>{c[t].recovery_chances[n]>Math.random()&&s.push({item_id:n})}),et(s),Object.keys(Di).forEach(n=>{c[t].tags[Di[n]]&&ee({skill:f[n],xp_to_add:(c[t].value/10)**.6667})&&(r.stats.add_active_effect_bonus(),Re(),Object.keys(r.inventory).forEach(l=>{r.inventory[l].item.tags[Di[n]]&&ve({item_key:l})}))}),wt([{item_key:e}])}}function qd(e){if(c[e]){if(!c[e].tags.usable)throw new Error(`Tried to add "${e}" to auto consume, but it's not a consumable.`)}else throw new Error(`Tried to add "${e}" to auto consume, but no such item exists.`);Vt[e]=!0}function ys(e){if(!Vt[e])throw new Error(`Tried to remove "${e}" from auto consume, but it's not there.`);delete Vt[e],r.inventory[c[e].getInventoryKey()]}function Sd(e){if(c[e]){if(!c[e].tags.usable)throw new Error(`Tried to change "${e}" auto consume status, but it's not a consumable.`)}else throw new Error(`Tried to change "${e}" auto consum status, but no such item exists.`);Vt[e]?ys(e):qd(e),r.inventory[c[e].getInventoryKey()]}function Id(e){gi[e]=!0}function zo(e){delete gi[e]}function $d(e,t){t in gi?(zo(t),ts(e,!1)):(Id(t),ts(e,!0)),r.inventory[t]&&ve({item_key:t});let i=xe(t).equip_slot;i&&r.equipment[i]?.getInventoryKey()===t&&ve({equip_slot:i})}function ci(e,t){let i=!1;Object.keys(Se).forEach(a=>{i||Object.keys(z[a].group_tags).forEach(s=>{i||s in z[e].group_tags&&(z[a].group_tags[s]>z[e].group_tags[s]?i=!0:delete Se[a])})}),!i&&(Se[e]=new te({...z[e],duration:t}),r.stats.add_active_effect_bonus(),La(),Re())}function $n({quest_event_type:e,quest_event_target:t,quest_event_count:i}){ge.catchQuestEvent({quest_event_type:e,quest_event_target:t,quest_event_count:i,additional_quest_tags:{location:x?.id||"",season:E.getSeason()||""}})}function Ed(){ci("Spark of Inspiration",1800),C("Gained a Spark of Inspiration!","export_reward")}function Rc(){let e=new Date,t=e.getFullYear(),i=e.getMonth()+1,a=i>9?i.toString():"0"+i.toString(),s=e.getDate()>9?e.getDate().toString():"0"+e.getDate().toString(),n=e.getHours()>9?e.getHours().toString():"0"+e.getHours().toString(),o=e.getMinutes()>9?e.getMinutes().toString():"0"+e.getMinutes().toString(),l=e.getSeconds()>9?e.getSeconds().toString():"0"+e.getSeconds().toString();return`${t}-${a}-${s} ${n}_${o}_${l}`}function Nt(){return window.location.href.endsWith("-dev/")}function Ss(e){try{return JSON.parse(e)&&!!e}catch{return!1}}function Fc(){try{let e={};e["game version"]=zs,e["current time"]=E,e.language=Dt,e.saved_at=Rc(),e.total_playtime=Xo,e.total_deaths=Zo,e.total_crafting_attempts=bn,e.total_crafting_successes=vn,e.total_kills=el,e.total_crits_done=tl,e.total_crits_taken=il,e.total_hits_done=al,e.total_hits_taken=nl,e.strongest_hit=Is,e.gathered_materials=$s,e.global_flags=Ie,e.last_rewarded_export=zi||0,e.character={name:r.name,titles:r.titles,inventory:{},equipment:r.equipment,money:r.money,xp:{total_xp:r.xp.total_xp},hp_to_full:r.stats.full.max_health-r.stats.full.health,stamina_to_full:r.stats.full.max_stamina-r.stats.full.stamina,reputation:r.reputation},e.player_storage={inventory:{}},e.rain_counter=_a,e.cold_status_counters=pa,e.are_finished_quests_hidden=document.getElementById("quest_hiding_button").checked,Object.keys(r.inventory).forEach(t=>{e.character.inventory[t]={count:r.inventory[t].count}}),Object.keys(dt.inventory).forEach(t=>{e.player_storage.inventory[t]={count:dt.inventory[t].count}}),e.favourite_consumables=Vt,e.favourite_items=gi,e.recipes={},Object.keys(G).forEach(t=>{e.recipes[t]={},Object.keys(G[t]).forEach(i=>{e.recipes[t][i]={},Object.keys(G[t][i]).forEach(a=>{e.recipes[t][i][a]={},e.recipes[t][i][a].is_unlocked=G[t][i][a].is_unlocked,e.recipes[t][i][a].is_finished=G[t][i][a].is_finished})})}),e.skill_category_order=Ne,e.skills={},Object.keys(f).forEach(function(t){f[t].is_parent||(e.skills[f[t].skill_id]={total_xp:f[t].total_xp})}),e["current location"]=x.id,e.locations={},Object.keys(m).forEach(function(t){e.locations[t]={},m[t].is_unlocked&&(e.locations[t].is_unlocked=!0),m[t].is_finished&&(e.locations[t].is_finished=!0),"parent_location"in m[t]&&(e.locations[t].enemy_groups_killed=m[t].enemy_groups_killed),m[t].activities&&(e.locations[t].unlocked_activities=[],Object.keys(m[t].activities).forEach(i=>{m[t].activities[i].is_unlocked&&e.locations[t].unlocked_activities.push(i)})),m[t].actions&&(e.locations[t].actions={},Object.keys(m[t].actions).forEach(i=>{(m[t].actions[i].is_unlocked||m[t].actions[i].is_finished)&&(e.locations[t].actions[i]={},m[t].actions[i].is_unlocked&&(e.locations[t].actions[i].is_unlocked=!0,m[t].actions[i].keep_progress&&(e.locations[t].actions[i].accumulated_progress=m[t].actions[i].accumulated_progress),m[t].actions[i].repeatable&&(e.locations[t].actions[i].completion_count=m[t].actions[i].completion_count)),m[t].actions[i].is_finished&&(e.locations[t].actions[i].is_finished=!0))})),m[t].housing?.is_unlocked&&(e.locations[t].housing_unlocked=!0),m[t].crafting?.is_unlocked&&(e.locations[t].crafting_unlocked=!0)}),e.favourite_locations=ut,e.activities={},Object.keys(A).forEach(function(t){A[t].is_unlocked&&(e.activities[t]={is_unlocked:!0})}),B&&(e.current_activity={activity_id:B.id,earnings:B.earnings,gathering_time:B.gathering_time,gathered_materials:B.gathered_materials}),e.dialogues={},Object.keys(q).forEach(function(t){e.dialogues[t]={is_unlocked:q[t].is_unlocked,is_finished:q[t].is_finished,textlines:{},actions:{}},q[t].textlines&&Object.keys(q[t].textlines).forEach(i=>{e.dialogues[t].textlines[i]={is_unlocked:q[t].textlines[i].is_unlocked,is_finished:q[t].textlines[i].is_finished}}),q[t].actions&&Object.keys(q[t].actions).forEach(i=>{e.dialogues[t].actions[i]={is_unlocked:q[t].actions[i].is_unlocked,is_finished:q[t].actions[i].is_finished},q[t].actions[i].keep_progress&&(e.dialogues[t].actions[i].accumulated_progress=q[t].actions[i].accumulated_progress),q[t].actions[i].repeatable&&(e.dialogues[t].actions[i].completion_count=q[t].actions[i].completion_count)})}),e.traders={},Object.keys(F).forEach(function(t){if(F[t].is_finished)e.traders[t]={is_unlocked:F[t].is_unlocked,is_finished:F[t].is_finished};else if(F[t].is_unlocked)if(F[t].last_refresh==-1||F[t].can_refresh())e.traders[t]={last_refresh:-1,is_unlocked:F[t].is_unlocked};else{let i={};Object.keys(F[t].inventory).forEach(a=>{i[a]={count:F[t].inventory[a].count}}),e.traders[t]={inventory:i,last_refresh:F[t].last_refresh,is_unlocked:F[t].is_unlocked,is_finished:F[t].is_finished}}}),e.books={},Object.keys(V).forEach(t=>{(V[t].accumulated_time>0||V[t].is_finished)&&(e.books[t]={accumulated_time:V[t].accumulated_time,is_finished:V[t].is_finished})}),e.quests={},Object.keys(O).forEach(t=>{e.quests[t]={is_active:t in st,is_finished:O[t].is_finished,task_status:[]};for(let i=0;i<O[t].quest_tasks.length;i++)if(O[t].quest_tasks[i].is_finished)e.quests[t].task_status[i]={is_finished:!0};else if(t in st){e.quests[t].task_status[i]={progress:st[t].quest_tasks[i].task_condition};return}}),e.is_reading=_t,e.is_sleeping=Yi,e.active_effects=Se,e.enemy_killcount=Xt,e.item_log=Ni.items,e.loot_sold_count=Q,e.last_combat_location=Lt,e.last_location_with_bed=ti,e.options=M,e.stances={},Object.keys(de).forEach(t=>{de[t].is_unlocked&&(e.stances[t]=!0)}),e.current_stance=Fe,e.selected_stance=xt,e.faved_stances=ii,e.message_filters={unlocks:document.documentElement.style.getPropertyValue("--message_unlocks_display")!=="none",events:document.documentElement.style.getPropertyValue("--message_events_display")!=="none",combat:document.documentElement.style.getPropertyValue("--message_combat_display")!=="none",loot:document.documentElement.style.getPropertyValue("--message_loot_display")!=="none",background:document.documentElement.style.getPropertyValue("--message_background_display")!=="none",crafting:document.documentElement.style.getPropertyValue("--message_crafting_display")!=="none"},e.skill_list_state={};for(let t=0;t<vt.childElementCount;t++)e.skill_list_state[t]=vt.children[t].classList.contains("skill_category_expanded");return JSON.stringify(e)}catch(e){console.error("Something went wrong on saving the game!"),console.error(e),C("FAILED TO CREATE A SAVE FILE, PLEASE CHECK CONSOLE FOR ERRORS AND REPORT IT","message_critical")}}function Td(){return Date.now()-zi>Uo&&(zi=Date.now(),Ed()),Gc(),btoa(Fc())}function Ga({key:e,is_manual:t}){let i=Fc();return i&&(localStorage.setItem(e,i),t&&(C("Saved the game manually"),qs=0)),JSON.parse(i).saved_at}function Gc(){Nt()?Ga({key:qt,is_manual:!0}):Ga({key:pt,is_manual:!0})}function Qo(e){try{let t=!1;E.loadTime(e["current time"]),lc.innerText=E.toString(),Object.keys(e.global_flags||{}).forEach(n=>{n==="is_deep_forest_beaten"?Ie.is_strength_proved=e.global_flags[n]:Ie[n]=e.global_flags[n]}),e.language&&(Ha[e.language]?Dt=e.language:(console.warn(`Language ${e.language} could not be found.`),M.mofu_mofu_mode?Dt=Ha.mofu_english:Dt=Ha.english)),zi=e.last_rewarded_export||zi,Xo=e.total_playtime||0,Zo=e.total_deaths||0,bn=e.total_crafting_attempts||0,vn=e.total_crafting_successes||0,el=e.total_kills||0,tl=e.total_crits_done||0,il=e.total_crits_taken||0,al=e.total_hits_done||0,nl=e.total_hits_taken||0,Is=e.strongest_hit||0,$s=e.gathered_materials||{},xn.value=e.character.name,r.name=e.character.name,ti=e.last_location_with_bed,Lt=e.last_combat_location,M.uniform_text_size_in_action=e.options?.uniform_text_size_in_action,rc(M.uniform_text_size_in_action),M.auto_return_to_bed=e.options?.auto_return_to_bed,cc(M.auto_return_to_bed),M.disable_combat_autoswitch=e.options?.disable_combat_autoswitch,dc(M.disable_combat_autoswitch),M.remember_message_log_filters=e.options?.remember_message_log_filters,e.message_filters&&Object.keys(Fi).forEach(n=>{Fi[n]=e.message_filters[n]??!0}),uc(M.remember_message_log_filters),M.log_every_gathering_period=e.options?.log_every_gathering_period,mc(M.log_every_gathering_period),M.log_total_gathering_gain=e.options?.log_total_gathering_gain,hc(M.log_total_gathering_gain),M.do_background_animations=e.options?.do_background_animations,fc(M.do_background_animations),M.skip_play_button=e.options?.skip_play_button,gc(M.skip_play_button),M.mofu_mofu_mode=e.options?.mofu_mofu_mode,wc(M.mofu_mofu_mode),M.do_enemy_onhit_animations=e.options?.do_enemy_onhit_animations,yc(M.do_enemy_onhit_animations),M.expo_threshold=e.options?.expo_threshold,_c(M.expo_threshold),M.hide_max_level_skills=e.options?.hide_max_level_skills,kc(M.hide_max_level_skills),M.use_text_outlines_for_tooltips=e.options?.use_text_outlines_for_tooltips,bc(M.use_text_outlines_for_tooltips),M.use_text_outlines_for_bars=e.options?.use_text_outlines_for_bars,vc(M.use_text_outlines_for_bars),document.getElementById("quest_hiding_button").checked=e.are_finished_quests_hidden,Lo();let i=Ka("v0.3.5",e["game version"])==1;r.money=(e.character.money||0)*((i==1)*10||1),ba(),As(e.character.xp.total_xp,!1),_a=e.rain_counter||0;for(let n=0;n<e.cold_status_counters?.length;n++)pa[n]=e.cold_status_counters[n]||0;if(Object.keys(e.favourite_consumables||{}).forEach(n=>{Vt[n]=!0}),Object.keys(e.favourite_items||{}).forEach(n=>{gi[n]=!0}),xo(),Wt("Checking out your books"),e.skill_category_order&&e.skill_category_order.forEach((n,o)=>{Ne[o]=n}),e.books){let n=0,o=e.skills.Literacy.total_xp;Object.keys(e.books).forEach(l=>{c[l]||(console.warn(`Book ${l} couldn't be found and was skipped!`),t=!0),e.books[l].accumulated_time>0&&(e.books[l].is_finished?(c[l].setAsFinished(),r.stats.add_book_bonus(V[l].bonuses),Pe({rewards:V[l].rewards,only_unlocks:!0,inform_overall:!1,is_from_loading:!0}),n+=V[l].required_time*V[l].literacy_xp_rate):(c[l].addProgress(e.books[l].accumulated_time),n+=V[l].accumulated_time*V[l].literacy_xp_rate)),fs(l,e.books[l].is_finished)}),n>o?(ee({skill:f.Literacy,should_info:!1,xp_to_add:n,use_bonus:!1,cap_gained_xp:!1,is_from_loading:!0}),console.warn(`Saved XP for "Literacy skill" was less than it should be based on progress with books (${o} vs ${n}), so it was adjusted to match it!`),t=!0):ee({skill:f.Literacy,should_info:!1,xp_to_add:o,use_bonus:!1,cap_gained_xp:!1,is_from_loading:!0})}Object.keys(e.skills).forEach(n=>{n!=="Literacy"&&(f[n]&&!f[n].is_parent?e.skills[n].total_xp>0&&ee({skill:f[n],xp_to_add:e.skills[n].total_xp,should_info:!1,add_to_parent:!0,use_bonus:!1,cap_gained_xp:!1,is_from_loading:!0}):e.skills[n].total_xp>0&&(console.warn(`Skill "${n}" couldn't be found!`),t=!0))}),e.stances&&Object.keys(e.stances).forEach(n=>{e.stances&&(de[n].is_unlocked=!0)}),ps(de,Fe,ii),e.faved_stances&&Object.keys(e.faved_stances).forEach(n=>{de[n]&&de[n].is_unlocked&&Ec(n)}),e.current_stance&&(Fe=de[e.current_stance.id]||de[e.current_stance],xt=de[e.selected_stance.id]||de[e.selected_stance],Ya({stance_id:xt.id})),Object.keys(e.character.equipment).forEach(function(n){if(e.character.equipment[n]!=null){let o=Ka("v0.4.4",e["game version"])==1?100:1;if(n==="weapon"){let{quality:l,equip_slot:d}=e.character.equipment[n],u;if(e.character.equipment[n].components)u=e.character.equipment[n].components;else{let{head:h,handle:_}=e.character.equipment[n];u={head:h,handle:_}}if(!c[u.head])console.warn(`Skipped item: weapon head component "${u.head}" couldn't be found!`),t=!0;else if(!c[u.handle])console.warn(`Skipped item: weapon handle component "${u.handle}" couldn't be found!`),t=!0;else{let h=be({components:u,quality:l*o,equip_slot:d,item_type:"EQUIPPABLE"});wi(h,!0)}}else if(n==="off-hand"){let{quality:l,equip_slot:d}=e.character.equipment[n],u;if(e.character.equipment[n].components)u=e.character.equipment[n].components;else{let{shield_base:h,handle:_}=e.character.equipment[n];u={shield_base:h,handle:_}}if(!c[u.shield_base])console.warn(`Skipped item: shield base component "${u.shield_base}" couldn't be found!`),t=!0;else if(!c[u.handle])console.warn(`Skipped item: shield handle "${u.handle}" couldn't be found!`),t=!0;else{let h=be({components:u,quality:l*o,equip_slot:d,item_type:"EQUIPPABLE"});wi(h,!0)}}else if(e.character.equipment[n].equip_slot==="artifact"||e.character.equipment[n].tags?.tool)wi(be({...c[e.character.equipment[n].id]}),!0);else{let{quality:l,equip_slot:d}=e.character.equipment[n];if(e.character.equipment[n].components&&e.character.equipment[n].components.internal.includes(" [component]")){let u=be({...c[e.character.equipment[n].components.internal.replace(" [component]","")],quality:l*o});wi(u,!0)}else if(e.character.equipment[n].components){let u=e.character.equipment[n].components;if(!c[u.internal])console.warn(`Skipped item: internal armor component "${u.internal}" couldn't be found!`),t=!0;else if(u.external&&!c[u.external])console.warn(`Skipped item: external armor component "${u.external}" couldn't be found!`),t=!0;else{let h=be({components:u,quality:l*o,equip_slot:d,item_type:"EQUIPPABLE"});wi(h,!0)}}else{let u=be({...c[e.character.equipment[n].name],quality:l*o});wi(u,!0)}}}}),r.equipment.weapon===null&&wi(null,!0);let a=[];Object.keys(e.character.inventory).forEach(n=>{if(Ss(n)){let{id:o,components:l,quality:d}=JSON.parse(n);if(o&&!d)if(c[o])o==="Coal"&&Qe(e["game version"],"v0.4.6.12")?a.push({item_key:c.Charcoal.getInventoryKey(),count:e.character.inventory[n].count,quality:d}):a.push({item_key:n,count:e.character.inventory[n].count,quality:d});else{console.warn(`Inventory item "${n}" from save on version "${e["game version"]} couldn't be found!`),t=!0;return}else if(l){let{head:u,handle:h,shield_base:_,internal:w,external:b}=l;if(u)if(c[u])if(c[h])a.push({item_key:n,count:e.character.inventory[n].count,quality:d});else{console.warn(`Skipped item: weapon handle component "${h}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: weapon head component "${u}" couldn't be found!`),t=!0;return}else if(_)if(c[_])if(c[h])a.push({item_key:n,count:e.character.inventory[n].count,quality:d});else{console.warn(`Skipped item: shield handle component "${h}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: shield base component "${_}" couldn't be found!`),t=!0;return}else if(w)if(c[w])if(c[b]){if(!fn(w))return;a.push({item_key:n,count:e.character.inventory[n].count,quality:d})}else{console.warn(`Skipped item: external armor component "${b}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: internal armor component "${w}" couldn't be found!`),t=!0;return}else console.error(`Intentory key "${n}" from save on version "${e["game version"]} seems to refer to non-existing item type!`)}else d?a.push({item_key:n,count:e.character.inventory[n].count,quality:d}):console.error(`Intentory key "${n}" from save on version "${e["game version"]} is incorrect!`)}else if(Array.isArray(e.character.inventory[n]))for(let o=0;o<e.character.inventory[n].length;o++)if(e.character.inventory[n][o].item_type==="EQUIPPABLE")if(e.character.inventory[n][o].equip_slot==="weapon"){let{quality:l}=e.character.inventory[n][o],d;if(e.character.inventory[n][o].components)d=e.character.inventory[n][o].components;else{let{head:u,handle:h}=e.character.inventory[n][o];d={head:u,handle:h}}if(!c[d.head])console.warn(`Skipped item: weapon head component "${d.head}" couldn't be found!`),t=!0;else if(!c[d.handle])console.warn(`Skipped item: weapon handle component "${d.handle}" couldn't be found!`),t=!0;else{let u=be({item_type:"EQUIPPABLE",equip_slot:"weapon",components:d});a.push({item_key:u.getInventoryKey(),count:1,quality:l*100})}}else if(e.character.inventory[n][o].equip_slot==="off-hand"){let{quality:l}=e.character.inventory[n][o],d;if(e.character.inventory[n][o].components)d=e.character.inventory[n][o].components;else{let{shield_base:u,handle:h}=e.character.inventory[n][o];d={shield_base:u,handle:h}}if(!c[d.shield_base])console.warn(`Skipped item: shield base component "${d.shield_base}" couldn't be found!`),t=!0;else if(!c[d.handle])console.warn(`Skipped item: shield handle "${d.handle}" couldn't be found!`),t=!0;else{let u=be({item_type:"EQUIPPABLE",equip_slot:"off-hand",components:d});a.push({item_key:u.getInventoryKey(),count:1,quality:l*100})}}else if(e.character.inventory[n][o].equip_slot==="artifact"||e.character.inventory[n][o].equip_slot==="amulet")a.push({item_key:n,count:1});else if(e.character.inventory[n][o].components&&e.character.inventory[n][o].components.internal.includes(" [component]"))a.push({item_key:n,count:1});else if(e.character.inventory[n][o].components){let l=e.character.inventory[n][o].components;if(!c[l.internal])console.warn(`Skipped item: internal armor component "${l.internal}" couldn't be found!`),t=!0;else if(l.external&&!c[l.external])console.warn(`Skipped item: external armor component "${l.external}" couldn't be found!`),t=!0;else{let d=be({item_type:"EQUIPPABLE",components:l});a.push({item_key:d.getInventoryKey(),count:1,quality:e.character.inventory[n][o].quality*100})}}else a.push({item_id:n,count:1});else a.push({item_id:n,count:1,quality:e.character.inventory[n][o].quality*100});else if(c[n])a.push({item_id:n,count:e.character.inventory[n].count});else{console.warn(`Inventory item "${n}" from save on version "${e["game version"]}" couldn't be found!`),t=!0;return}}),et(a);let s=[];if(e.player_storage&&(Object.keys(e.player_storage.inventory).forEach(function(n){if(Ss(n)){let{id:o,components:l,quality:d}=JSON.parse(n);if(o&&!d)if(c[o])s.push({item_key:n,count:e.player_storage.inventory[n].count,quality:d});else{console.warn(`Inventory item "${n}" from save on version "${e["game version"]} couldn't be found!`),t=!0;return}else if(l){let{head:u,handle:h,shield_base:_,internal:w,external:b}=l;if(u)if(c[u])if(c[h])s.push({item_key:n,count:e.player_storage.inventory[n].count,quality:d});else{console.warn(`Skipped item: weapon handle component "${h}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: weapon head component "${u}" couldn't be found!`),t=!0;return}else if(_)if(c[_])if(c[h])s.push({item_key:n,count:e.player_storage.inventory[n].count,quality:d});else{console.warn(`Skipped item: shield handle component "${h}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: shield base component "${_}" couldn't be found!`),t=!0;return}else if(w)if(c[w])if(c[b]){if(!fn(w))return;s.push({item_key:n,count:e.player_storage.inventory[n].count,quality:d})}else{console.warn(`Skipped item: external armor component "${b}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: internal armor component "${w}" couldn't be found!`),t=!0;return}else console.error(`Intentory key "${n}" from save on version "${e["game version"]} seems to refer to non-existing item type!`)}else d?s.push({item_key:n,count:e.player_storage.inventory[n].count,quality:d}):console.error(`Intentory key "${n}" from save on version "${e["game version"]} is incorrect!`)}}),dt.add_to_inventory(s)),Wt("Meowing at your cat"),Object.keys(e.dialogues).forEach(function(n){if(q[n])q[n].is_unlocked=e.dialogues[n].is_unlocked,q[n].is_finished=e.dialogues[n].is_finished;else{if(n==="cute little rat"&&Qe(e["game version"],"v0.5.0"))return;console.warn(`Dialogue "${n}" couldn't be found!`),t=!0;return}e.dialogues[n].textlines&&Object.keys(e.dialogues[n].textlines).forEach(o=>{if(q[n].textlines[o])q[n].textlines[o].is_unlocked=e.dialogues[n].textlines[o].is_unlocked,q[n].textlines[o].is_finished=e.dialogues[n].textlines[o].is_finished;else{console.warn(`Textline "${o}" in dialogue "${n}" couldn't be found!`),t=!0;return}}),e.dialogues[n].actions&&Object.keys(e.dialogues[n].actions).forEach(o=>{if(q[n].actions[o])q[n].actions[o].is_unlocked=e.dialogues[n].actions[o].is_unlocked,q[n].actions[o].is_finished=e.dialogues[n].actions[o].is_finished,q[n].actions[o].keep_progress&&e.dialogues[n].actions[o].accumulated_progress&&(q[n].actions[o].accumulated_progress=e.dialogues[n].actions[o].accumulated_progress),q[n].actions[o].repeatable&&(q[n].actions[o].completion_count=e.dialogues[n].actions[o].completion_count||0);else{console.warn(`Textline "${o}" in dialogue "${n}" couldn't be found!`),t=!0;return}})}),Qe(e["game version"],"v0.5.1")&&(Pe({rewards:{textlines:[{dialogue:"village elder",lines:["crab rumors"]}]},inform_overall:!1}),q["village guard"].textlines.hello.is_finished&&Pe({rewards:{flags:["is_guard_met"],textlines:[{dialogue:"village elder",lines:["about guard"]},{dialogue:"old craftsman",lines:["about guard"]},{dialogue:"village millers",lines:["about guard"]}]},inform_overall:!1}),q["village guard"].textlines.wide.is_finished&&Pe({rewards:{textlines:[{dialogue:"village guard",lines:["hi","tips 2","serious","teach more"]}]},inform_overall:!1})),Object.keys(e.traders).forEach(function(n){let o=[];if(F[n]){if(F[n].is_unlocked=e.traders[n].is_unlocked,e.traders[n].is_finished){F[n].is_finished=!0;return}e.traders[n].inventory&&Object.keys(e.traders[n].inventory).forEach(function(l){if(Ss(l)){let{id:d,components:u,quality:h}=JSON.parse(l);if(d&&!h)if(c[d])o.push({item_key:l,count:e.traders[n].inventory[l].count});else{console.warn(`Inventory item "${l}" from save on version "${e["game version"]} couldn't be found!`),t=!0;return}else if(u){let{head:_,handle:w,shield_base:b,internal:g,external:v}=u;if(_)if(c[_])if(c[w])o.push({item_key:l,count:e.traders[n].inventory[l].count,quality:h});else{console.warn(`Skipped item: weapon handle component "${w}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: weapon head component "${_}" couldn't be found!`),t=!0;return}else if(b)if(c[b])if(c[w])o.push({item_key:l,count:e.traders[n].inventory[l].count,quality:h});else{console.warn(`Skipped item: shield handle component "${w}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: shield base component "${b}" couldn't be found!`),t=!0;return}else if(g)if(c[g])if(c[v]){if(!fn(g))return;o.push({item_key:l,count:e.traders[n].inventory[l].count,quality:h})}else{console.warn(`Skipped item: external armor component "${v}" couldn't be found!`),t=!0;return}else{console.warn(`Skipped item: internal armor component "${g}" couldn't be found!`),t=!0;return}else console.error(`Intentory key "${l}" from save on version "${e["game version"]} seems to refer to non-existing item type!`)}else h?o.push({item_key:l,count:e.traders[n].inventory[l].count,quality:h}):console.error(`Intentory key "${l}" from save on version "${e["game version"]} is incorrect!`)}else if(Array.isArray(e.traders[n].inventory[l]))for(let d=0;d<e.traders[n].inventory[l].length;d++)if(e.traders[n].inventory[l][d].item_type==="EQUIPPABLE")if(e.traders[n].inventory[l][d].equip_slot==="weapon"){let{quality:u}=e.traders[n].inventory[l][d],h;if(e.traders[n].inventory[l][d].components)h=e.traders[n].inventory[l][d].components;else{let{head:_,handle:w}=e.traders[n].inventory[l][d];h={head:_,handle:w}}if(!c[h.head])console.warn(`Skipped item: weapon head component "${h.head}" couldn't be found!`),t=!0;else if(!c[h.handle])console.warn(`Skipped item: weapon handle component "${h.handle}" couldn't be found!`),t=!0;else{let _=be({components:h,item_type:"EQUIPPABLE",equip_slot:"weapon"});o.push({item_key:_.getInventoryKey(),count:1,quality:u*100})}}else if(e.traders[n].inventory[l][d].equip_slot==="off-hand"){let{quality:u}=e.traders[n].inventory[l][d],h;if(e.traders[n].inventory[l][d].components)h=e.traders[n].inventory[l][d].components;else{let{shield_base:_,handle:w}=e.traders[n].inventory[l][d];h={shield_base:_,handle:w}}if(!c[h.shield_base])console.warn(`Skipped item: shield base component "${h.shield_base}" couldn't be found!`),t=!0;else if(!c[h.handle])console.warn(`Skipped item: shield handle "${h.handle}" couldn't be found!`),t=!0;else{let _=be({components:h,item_type:"EQUIPPABLE",equip_slot:"off-hand"});o.push({item_key:_.getInventoryKey(),count:1,quality:u*100})}}else{let{quality:u}=e.traders[n].inventory[l][d];if(e.traders[n].inventory[l][d].components&&e.traders[n].inventory[l][d].components.internal.includes(" [component]")){let h=be({...c[l]});o.push({item_key:h.getInventoryKey(),count:1,quality:u*100})}else if(e.traders[n].inventory[l][d].components){let h=e.traders[n].inventory[l][d].components;if(!c[h.internal])console.warn(`Skipped item: internal armor component "${h.internal}" couldn't be found!`),t=!0;else if(h.external&&!c[h.external])console.warn(`Skipped item: external armor component "${h.external}" couldn't be found!`),t=!0;else{let _=be({components:h,item_type:"EQUIPPABLE",equip_slot:"armor"});o.push({item_key:_.getInventoryKey(),count:1,quality:u*100})}}else o.push({item_id:l,count:1,quality:u*100})}else console.warn('Skipped item, no such item type as "0" could be found'),t=!0;else e.traders[n].inventory[l].item.value=c[l].value,c[l].item_type==="EQUIPPABLE"?e.traders[n].inventory[l].item.equip_effect=c[l].equip_effect:c[l].item_type==="USABLE"&&(e.traders[n].inventory[l].item.use_effect=c[l].use_effect),o.push({item_id:l,count:e.traders[n].inventory[l].count})}),F[n].refresh(),F[n].inventory={},Fs(n,o),F[n].last_refresh=e.traders[n].last_refresh}else{console.warn(`Trader "${n} couldn't be found!`),t=!0;return}}),Wt("Hiding rats in your walls"),Object.keys(e.locations).forEach(function(n){if(m[n]){if(e.locations[n].is_unlocked&&(m[n].is_unlocked=!0),e.locations[n].is_finished&&(m[n].is_finished=!0),"parent_location"in m[n]){if(m[n].enemy_groups_killed=e.locations[n].enemy_groups_killed||0,Qe(e["game version"],"v0.4.6")){if(m[n].rewards_with_clear_requirement)for(let o=0;o<m[n].rewards_with_clear_requirement.length;o++)m[n].enemy_groups_killed==m[n].enemy_count*m[n].rewards_with_clear_requirement[o].required_clear_count&&Pe({rewards:m[n].rewards_with_clear_requirement[o],source_type:"location",source_name:m[n].name,is_first_clear:!1,source_id:m[n].id,is_from_loading:!0})}else if(m[n].rewards_with_clear_requirement)for(let o=0;o<m[n].rewards_with_clear_requirement.length;o++)m[n].enemy_groups_killed>=m[n].enemy_count*m[n].rewards_with_clear_requirement[o].required_clear_count&&Pe({rewards:m[n].rewards_with_clear_requirement[o],source_type:"location",source_name:m[n].name,is_first_clear:!1,source_id:m[n].id,only_unlocks:!0,is_from_loading:!0});m[n].first_reward&&Pe({rewards:m[n].first_reward,source_type:"location",is_first_clear:!0,source_id:location.id,is_from_loading:!0,only_unlocks:!0})}if(e.locations[n].unlocked_activities)for(let o=0;o<e.locations[n].unlocked_activities.length;o++)m[n].activities[e.locations[n].unlocked_activities[o]]&&(e.locations[n].unlocked_activities[o]==="plowing the fields"?m[n].activities.fieldwork.is_unlocked=!0:m[n].activities[e.locations[n].unlocked_activities[o]].is_unlocked=!0);e.locations[n].actions&&Object.keys(e.locations[n].actions).forEach(o=>{e.locations[n].actions[o].is_unlocked&&(m[n].actions[o].is_unlocked=!0,m[n].actions[o].keep_progress&&e.locations[n].actions[o].accumulated_progress&&(m[n].actions[o].accumulated_progress=e.locations[n].actions[o].accumulated_progress),m[n].actions[o].repeatable&&(m[n].actions[o].completion_count=e.locations[n].actions[o].completion_count||0)),e.locations[n].actions[o].is_finished&&(m[n].actions[o].is_finished=!0)}),e.locations[n].housing_unlocked?Object.keys(m[n].housing).length?(m[n].housing.is_unlocked=!0,e.locations[n].is_unlocked&&(Pa[n]=!0)):(console.warn(`Location "${m[n].name}" was saved as having a bed unlocked, but it no longer has this mechanic and was skipped!`),t=!0):m[n].housing?.is_unlocked&&(Pa[n]=!0),e.locations[n].crafting_unlocked&&(Object.keys(m[n].crafting).length?m[n].crafting.is_unlocked=!0:(console.warn(`Location "${m[n].name}" was saved as having a crafting unlocked, but it no longer has this mechanic and was skipped!`),t=!0))}else{console.warn(`Location "${n}" couldn't be found!`),t=!0;return}}),Qe(e["game version"],"v0.5")&&m["Nearby cave"].activities.climbing.is_unlocked&&(A.climbing.is_unlocked=!0),Qe(e["game version"],"v0.5.1.4")&&e.locations["Lake camp"]?.is_unlocked&&(m["Lake beach"].housing.is_unlocked=!0,e["current location"]==="Lake camp"&&(e["current location"]="Lake beach")),Qe(e["game version"],"v0.5.1.5")&&(ti==="Lake camp"&&(ti="Lake beach"),m["Lake beach"].actions["create lake camp"].is_finished&&Pe({rewards:{housing:["Lake beach"]},inform_overall:!1})),Qe(e["game version"],"v0.4.6.7")&&(m["Town square"].is_unlocked=!1,e["current location"]==="Town square"&&(e["current location"]="Village")),Object.keys(e.activities).forEach(function(n){A[n]?A[n].is_unlocked=e.activities[n].is_unlocked||!1:n==="plowing the fields"?A.fieldwork.is_unlocked=e.activities[n].is_unlocked||!1:(console.warn(`Activity "${n}" couldn't be found!`),t=!0)}),Qe(e["game version"],"v0.5")){let n={},o=Object.keys(ze).length;Object.keys(e.loot_sold_count).forEach(l=>{let d=e.loot_sold_count[l];Object.keys(ze).forEach(u=>{n[u]||(n[u]={}),n[u][l]=[{sold:0,recovered:0}],n[u][l][0].sold=Math.floor(d.sold/o),n[u][l][0].recovered=Math.floor(d.recovered/o)})}),Xa(n),q["old craftsman"].textlines.learn.is_finished&&et([{item_id:"Old shovel"}])}else if(Qe(e["game version"],"v0.5.0.22")&&Qe("v0.5",e["game version"])){let n={};Object.keys(e.loot_sold_count).forEach(o=>{n[o]={},Object.keys(e.loot_sold_count[o]).forEach(l=>{n[o][l]=[];for(let d=0;d<e.loot_sold_count[o][l].length;d++){if(e.loot_sold_count[o][l][d].sold>Rt){console.warn(`Encountered a large sold count (${e.loot_sold_count[o][l][d].sold}) of a trade group "${l}" at tier ${d}. Due to the save being from a game version where a certain bug could make these values keep growing by themselves, it was reduced to ${Rt}, and it's recovered_count was lowered proportionally.`);let u=e.loot_sold_count[o][l][d].recovered/e.loot_sold_count[o][l][d].sold;e.loot_sold_count[o][l][d].sold=Rt,e.loot_sold_count[o][l][d].recovered=Rt*u}n[o][l].push({sold:e.loot_sold_count[o][l][d].sold,recovered:e.loot_sold_count[o][l][d].recovered})}})}),Xa(n)}else Xa(e.loot_sold_count||{});if(Ka(e["game version"],"v0.4.4")>=0&&(Object.keys(e.active_effects).forEach(function(n){Se[n]=new te({...z[n],duration:e.active_effects[n].duration})}),r.stats.add_active_effect_bonus()),Wt("Hiding from the vet"),e.character.hp_to_full==null||e.character.hp_to_full>=r.stats.full.max_health?r.stats.full.health=1:r.stats.full.health=r.stats.full.max_health-e.character.hp_to_full,e.character.stamina_to_full==null||e.character.stamina_to_full>=r.stats.full.max_stamina?r.stats.full.stamina=0:r.stats.full.stamina=r.stats.full.max_stamina-e.character.stamina_to_full,Wt("Hiding rats in your walls (again!)"),e.enemy_killcount&&Object.keys(e.enemy_killcount).forEach(n=>{Xt[n]=e.enemy_killcount[n],To(n)}),Wt("Looking for things that can be done tomorrow instead"),e.quests&&Object.keys(e.quests).forEach(n=>{if(e.quests[n].is_finished){for(let o=0;o<O[n].quest_tasks.length;o++)O[n].quest_tasks[o].is_finished=!0;ge.startQuest({quest_id:n,should_inform:!1}),ge.finishQuest({quest_id:n,should_inform:!1,only_unlocks:!0,is_from_loading:!0})}else if(e.quests[n].is_active){ge.startQuest({quest_id:n,should_inform:!1});for(let d=0;d<e.quests[n].task_status.length-1;d++)O[n].quest_tasks[d].is_finished=!0;let o=e.quests[n].task_status.length-1,l=e.quests[n].task_status[o].progress;Object.keys(l||{}).forEach(d=>{if(!O[n].quest_tasks[o].task_condition[d]){console.warn(`Skipped loading progress for quest "${n}", no such task group as "${d}" was present.`),t=!0;return}Object.keys(l[d]).forEach(u=>{if(!O[n].quest_tasks[o].task_condition[d][u]){console.warn(`Skipped loading progress for quest "${n}", no such task type as "${u}" was present.`),t=!0;return}Object.keys(l[d][u]).forEach(h=>{if(!O[n].quest_tasks[o].task_condition[d][u][h]){console.warn(`Skipped loading progress for quest "${n}", no such task target as "${h}" was present.`),t=!0;return}O[n].quest_tasks[o].task_condition[d][u][h].current=l[d][u][h].current})})}),O[n].is_hidden||tn(n)}}),Qe(e["game version"],"v0.5.0")&&(ge.startQuest({quest_id:"Lost memory",should_inform:!1}),q["village elder"].textlines["what happened"].is_finished&&(ge.finishQuestTask({quest_id:"Lost memory",task_index:0,skip_message:!0}),q["village elder"].textlines["need to"].is_finished&&(ge.finishQuestTask({quest_id:"Lost memory",task_index:1,skip_message:!0}),q["village elder"].textlines["cleared cave"].is_finished&&(ge.finishQuestTask({quest_id:"Lost memory",task_index:2,skip_message:!0}),q["suspicious man"].textlines.defeated.is_finished&&ge.finishQuestTask({quest_id:"Lost memory",task_index:3,skip_message:!0})))),m["Suspicious wall"].is_finished&&(ge.startQuest({quest_id:"The Infinite Rat Saga",should_inform:!1}),m["Mysterious gate"].enemy_groups_killed>=m["Mysterious gate"].enemy_count&&(ge.finishQuestTask({quest_id:"The Infinite Rat Saga",task_index:0,skip_message:!0}),m["Nearby cave"].actions["open the gate"].is_finished&&(ge.finishQuestTask({quest_id:"The Infinite Rat Saga",task_index:1,skip_message:!0}),m["Writhing tunnel"].enemy_groups_killed>=m["Writhing tunnel"].enemy_count&&ge.finishQuestTask({quest_id:"The Infinite Rat Saga",task_index:2,skip_message:!0})))),q["suspicious man"].textlines.gang.is_finished&&(ge.startQuest({quest_id:"Light in the darkness",should_inform:!1}),ge.finishQuestTask({quest_id:"Light in the darkness",task_index:0,skip_message:!0}),m["Gang hideout"].is_finished&&ge.finishQuestTask({quest_id:"Light in the darkness",task_index:1,skip_message:!0})),(q["farm supervisor"].textlines.fight0.is_finished||q["farm supervisor"].textlines.fight.is_finished)&&(ge.startQuest({quest_id:"Ploughs to swords",should_inform:!1}),q["farm supervisor"].textlines.fight.is_finished&&(ge.finishQuestTask({quest_id:"Ploughs to swords",task_index:0,skip_message:!0}),q["farm supervisor"].textlines["defeated boars"].is_finished&&ge.finishQuestTask({quest_id:"Ploughs to swords",task_index:1,skip_message:!0})))),Qe(e["game version"],"v0.5.0.7")&&Qe("v0.5.0",e["game version"])&&(q["farm supervisor"].textlines.fight0.is_finished||q["farm supervisor"].textlines.fight.is_finished)&&(ge.startQuest({quest_id:"Ploughs to swords",should_inform:!1}),q["farm supervisor"].textlines.fight.is_finished&&(ge.finishQuestTask({quest_id:"Ploughs to swords",task_index:0,skip_message:!0}),q["farm supervisor"].textlines["defeated boars"].is_finished&&ge.finishQuestTask({quest_id:"Ploughs to swords",task_index:1,skip_message:!0}))),q["farm supervisor"].textlines["defeated boars"].is_finished&&(q["farm supervisor"].textlines.troubled.is_unlocked=!0),Wt("Mixing catnip with more catnip"),e.recipes&&Object.keys(e.recipes).forEach(n=>{Object.keys(e.recipes[n]).forEach(o=>{Object.keys(e.recipes[n][o]).forEach(l=>{if(!G[n][o][l]){if(Qe(e["game version"],"v0.5.0")&&(n==="crafting"&&o==="items"&&(G.butchering.items[l]||G.woodworking.items[l])||l==="Shield base"||l==="Shield handle"))return;console.warn(`Could not find recipe "${n}"->"${o}"->"${l}". It might have been removed.`),t=!0;return}e.recipes[n][o][l].is_unlocked&&(G[n][o][l].is_unlocked=!0),e.recipes[n][o][l].is_finished&&(G[n][o][l].is_finished=!0)})})}),Wt("Doing some finishing pats"),e.favourite_locations&&Object.keys(e.favourite_locations).forEach(n=>{m[n]?ut[n]=!0:(console.warn(`Saved favourite locations included "${n}", which is not a valid location id`),t=!0)}),e.skill_list_state&&Object.keys(e.skill_list_state).forEach(n=>{vt.childElementCount>0&&e.skill_list_state[n]&&vt.children[n].classList.add("skill_category_expanded")}),e.item_log&&(Ni.items=e.item_log),us(),Re(),ve(),fi(),La(),fo(),jt({location_id:e["current location"],skip_travel_time:!0,do_quest_events:!1,skip_combat:!0}),M.use_uncivilised_temperature_scale=e.options?.use_uncivilised_temperature_scale,pc(M.use_uncivilised_temperature_scale),e.current_activity){let n=e.current_activity.activity_id;typeof n<"u"&&x.activities[n]&&A[x.activities[n].activity_name]?(xc(n),A[x.activities[n].activity_name].type==="JOB"?(B.earnings=e.current_activity.earnings*((i==1)*10||1),document.getElementById("action_end_earnings").innerText=`(earnings: ${Ke(B.earnings)})`):A[x.activities[n].activity_name].type==="GATHERING"&&(B.gathered_materials=e.current_activity.gathered_materials||{}),B.gathering_time=e.current_activity.gathering_time):(console.warn(`Couldn't find saved activity "${n}"! It might have been removed`),t=!0)}e.is_sleeping&&ll(),e.is_reading&&$c(e.is_reading),t&&Gr(),vo(),gs(e["game version"])}catch(t){throw gs(e["game version"]),t}}function Md(e){try{Nt()?localStorage.setItem(qt,atob(e)):localStorage.setItem(pt,atob(e)),window.location.reload(!1)}catch(t){console.error("Something went wrong on preparing to load from file!"),console.error(t)}}function Ad(){try{Nt()?localStorage.getItem(qt)?(Qo(JSON.parse(localStorage.getItem(qt))),C("Loaded dev save. If you want to use save from live version, import it through options panel or manually")):(Qo(JSON.parse(localStorage.getItem(pt))),C("Dev save was not found. Loaded live version save.")):Qo(JSON.parse(localStorage.getItem(pt)))}catch(e){sc=!0,Wt("Something went wrong \u{1F62D}"),Fr(),console.error("Something went wrong on loading from localStorage!"),console.error(e)}}function Cd(){try{Nt()?localStorage.getItem(Sn)?(localStorage.setItem(qt,localStorage.getItem(Sn)),window.location.reload(!1)):(console.log("Can't load backup as there is none yet."),C("Can't load backup as there is none yet.")):localStorage.getItem(qn)?(localStorage.setItem(pt,localStorage.getItem(qn)),window.location.reload(!1)):(console.log("Can't load backup as there is none yet."),C("Can't load backup as there is none yet."))}catch(e){console.error("Something went wrong on loading from localStorage!"),console.error(e)}}function Ld(){try{Nt()?localStorage.getItem(pt)?(localStorage.setItem(qt,localStorage.getItem(pt)),window.location.reload(!1)):(console.log("There are no saves on the other release."),C("There are no saves on the other release.")):localStorage.getItem(qt)?(localStorage.setItem(pt,localStorage.getItem(qt)),window.location.reload(!1)):(console.log("There are no saves on the other release."),C("There are no saves on the other release."))}catch(e){console.error("Something went wrong on loading from localStorage!"),console.error(e)}}function Bd(){let e=prompt('This will erase all your progress and you will have to start from the very beginning. If you are sure this is what you want, type "reset" below');if(e==="reset"||e==='"reset"')return Nt()?(localStorage.removeItem(qt),localStorage.setItem("skip_live_import","true")):localStorage.removeItem(pt),window.location.reload(),!1;console.log("Hard reset was cancelled.")}function Hc(e){let t=Si(E);E.goUp(e||(Yi?6:1)),t!==Si(E)&&Re(),vo()}function Wd({value:e=0,source:t}){Hc(e),zc({time_in_minutes:e,is_sleep:Yi,is_travel:t==="travel"})}function zc({time_in_minutes:e=1,is_travel:t}){let i=!1;return Object.keys(Se).forEach(a=>{(!t||t&&Se[a].affected_by_travel)&&(Se[a].duration-=e,Se[a].duration<=0&&(delete Se[a],r.stats.add_active_effect_bonus(),Re(),i=!0))}),i}function Yc(){setTimeout(()=>{ac=Date.now(),Na+=ac-kn-1e3/we,kn=Date.now();let e=!1,t=E.day;Hc(),kn-zi>Uo?document.getElementById("save_to_file_button").classList.add("export_button_with_reward"):document.getElementById("save_to_file_button").classList.remove("export_button_with_reward"),Nr(kn-zi,Uo),E.day>t&&(wl(Hu,zu),yl(Yu),Rs()&&(ve({is_trade:!0}),Kt())),e=e||zc({time_in_minutes:1}),bo(),La();let a=Rn();x.is_under_roof?((gn||wn)&&(mn(),window.removeEventListener("resize",da),window.removeEventListener("resize",ua),window.removeEventListener("resize",ca)),gn=!1,wn=!1):Fn()?(_a>=Vr?ci("Wet",30):a<0?_a+=.25:_a++,!gn&&M.do_background_animations&&(window.removeEventListener("resize",da),a>=0?(window.addEventListener("resize",ca),window.removeEventListener("resize",ua),ca()):(window.addEventListener("resize",ua),window.removeEventListener("resize",ca),ua())),gn=M.do_background_animations):(_a>0&&_a--,gn=!1,!wn&&Si()?(M.do_background_animations&&(window.addEventListener("resize",da),window.removeEventListener("resize",ua),window.removeEventListener("resize",ca),da()),wn=M.do_background_animations):wn&&!Si()&&(mn(),window.removeEventListener("resize",da))),Do!==a&&(e||Re(),ls()),Do=a;let s=!1;for(let l=Oa.length-1;l>=0;l--)if(Do+Oi()<=Oa[l]){if(Se.Wet&&pa[l]>=Ur||pa[l]>=Qr){if(s)continue;ci(ws[l],60)}else pa[l]++;ee({skill:f["Cold resistance"],xp_to_add:.2})}else pa[l]>0&&pa[l]--;if("parent_location"in x){Object.keys(Vt).forEach(l=>{let d=c[l].getInventoryKey();if(!r.inventory[d]){ys(l);return}let u=c[l].effects.sort((h,_)=>M.auto_use_when_longest_runs_out?_.duration-h.duration:h.duration-_.duration);if(!Se[u[0].effect]){Nc(d);return}});for(let l=0;l<x.types.length;l++){let d=x.types[l].type,u=x.types[l].stage;if($e[d].stages[u].applied_effects)for(let h=0;h<$e[d].stages[u].applied_effects.length;h++)ci($e[d].stages[u].applied_effects[h].effect,$e[d].stages[u].applied_effects[h].duration)}ee({skill:f.Breathing,xp_to_add:.1})}else{if(Yi?(sd(),ee({skill:f.Sleeping,xp_to_add:x.housing?.sleeping_xp_per_tick})):(Du&&nd(),_t&&od()),xt.id!==Fe.id&&Ya({stance_id:xt.id}),B){if(B.applied_effects)for(let d=0;d<B.applied_effects.length;d++)ci(B.applied_effects[d].effect,B.applied_effects[d].duration);if(A[B.activity_name].type==="TRAINING"?ee({skill:f.Breathing,xp_to_add:.5}):ee({skill:f.Breathing,xp_to_add:.1}),B.gathering_time+=1,B.gathering_time>=B.gathering_time_needed){let{gathering_time_needed:d,gained_resources:u}=B.getActivityEfficiency(),h=[],_=B.skill_names||A[B.activity_name].base_skills_names;for(let w=0;w<_?.length;w++)ee({skill:f[_[w]],xp_to_add:B.skill_xp_per_tick[w]});if(u){ss(B);for(let w=0;w<u.length;w++)if(Math.random()>1-u[w].chance){let b=random_range(u[w].count[0],u[w].count[1]);h.push({item_key:c[u[w].name].getInventoryKey(),count:b}),$s[u[w].name]=($s[u[w].name]||0)+b}if(h.length>0){M.log_every_gathering_period&&Zn({loot_list:h});for(let w=0;w<h.length;w++)B.gathered_materials[h[w].item_key]=B.gathered_materials[h[w].item_key]+h[w].count||h[w].count;et(h)}}A[B.activity_name].type==="JOB"&&(B.earnings+=B.get_payment()),B.gathering_time=0,B.gathering_time_needed=d}qo(B),na(B)||sl()}else{ee({skill:f.Breathing,xp_to_add:.1});let d=document.getElementsByClassName("activity_div");for(let u=0;u<d.length;u++){let h=x.activities[d[u].getAttribute("data-activity")];(A[h.activity_name].type==="JOB"||A[h.activity_name].type==="TRAINING")&&(na(h)?(d[u].classList.remove("activity_unavailable"),d[u].classList.add("start_activity")):(d[u].classList.remove("start_activity"),d[u].classList.add("activity_unavailable")))}}let l=x.getBackgroundNoises();l.length>0&&Math.random()<1/600&&C(`"${l[Math.floor(Math.random()*l.length)]}"`,"background"),B&&Math.random()<1/100&&(l=A[B.activity_name].getBackgroundNoises(),l.length>0&&C(`"${l[Math.floor(Math.random()*l.length)]}"`,"background"))}let n=0,o=0;if(r.stats.full.health_regeneration_flat&&(n+=r.stats.full.health_regeneration_flat),r.stats.full.health_regeneration_percent&&(n+=r.stats.full.max_health*r.stats.full.health_regeneration_percent/100),r.stats.full.health_loss_flat&&(o-=r.stats.full.health_loss_flat),r.stats.full.health_loss_percent&&(o+=r.stats.full.max_health*r.stats.full.health_loss_percent/100),ol({ammount_to_restore:n,ammount_to_loose:o}),r.stats.full.stamina_regeneration_flat&&(r.stats.full.stamina+=r.stats.full.stamina_regeneration_flat),r.stats.full.stamina_regeneration_percent&&(r.stats.full.stamina+=r.stats.full.max_stamina*r.stats.full.stamina_regeneration_percent/100),r.stats.full.mana_regeneration_flat&&(r.stats.full.mana+=r.stats.full.mana_regeneration_flat),r.stats.full.mana_regeneration_percent&&(r.stats.full.mana+=r.stats.full.max_mana*r.stats.full.mana_regeneration_percent/100),r.stats.full.stamina>r.stats.full.max_stamina&&(r.stats.full.stamina=r.stats.full.max_stamina),(r.stats.full.stamina_regeneration_flat||r.stats.full.stamina_regeneration_percent)&&la(),qs+=1,qs>=Vu*we&&(qs=0,Nt()?Ga({key:qt}):Ga({key:pt}),console.log("Auto-saved the game!")),Vo+=1,Vo>=Qu*we){Vo=0;let l;Nt()?l=Ga({key:Sn}):l=Ga({key:qn}),l&&Wa(l),console.log("Created an automatic backup!")}if(!Yi&&x&&x.light_level==="normal"&&Si()&&ee({skill:f["Night vision"],xp_to_add:1}),x){let l=x.gained_skills,d=!1;for(let u=0;u<l?.length;u++)d=ee({skill:x.gained_skills[u].skill,xp_to_add:x.gained_skills[u].xp})||d;d&&mr(x)}Na<=100/we&&Na>=-100/we?vs=Na:Na>100/we?vs=100/we:Na<-100/we&&(vs=-100/we),Xo+=1/we,Yc()},1e3/we-vs)}function Dc(){typeof x>"u"&&jt({location_id:"Village",skip_travel_time:!0}),x.parent_location&&Cc(),fi(),kn=Date.now(),Yc()}window.equip_item=vd;window.unequip_item=xd;window.change_location=jt;window.reload_normal_location=cd;window.handleLocationIconClick=Xu;window.remove_location_from_favourites=Oc;window.start_dialogue=ld;window.end_dialogue=rd;window.start_textline=ud;window.remove_fast_travel_choice=ns;window.start_activity=xc;window.end_activity=sl;window.start_game_action=Zu;window.end_game_action=ed;window.start_sleeping=ll;window.end_sleeping=Ic;window.start_reading=$c;window.end_reading=Ts;window.start_trade=$l;window.exit_trade=Ml;window.add_to_buying_list=Al;window.remove_from_buying_list=Cl;window.add_to_selling_list=Ll;window.remove_from_selling_list=Bl;window.cancel_trade=El;window.accept_trade=Tl;window.is_in_trade=Rs;window.update_displayed_total_price=rr;window.open_storage=jl;window.exit_storage=Nl;window.move_item_to_storage=Rl;window.remove_item_from_storage=Fl;window.is_storage_open=Gl;window.format_money=Ke;window.get_character_money=r.get_character_money;window.use_item=Nc;window.change_consumable_favourite_status=Sd;window.change_item_favourite_status=$d;window.update_fav_display=ts;window.do_enemy_combat_action=Lc;window.sort_displayed_inventory=Aa;window.update_displayed_character_inventory=ve;window.update_displayed_trader_inventory=Kt;window.update_displayed_storage_inventory=ho;window.sort_displayed_skills=_s;window.change_stance=Ya;window.fav_stance=Ec;window.openCraftingWindow=hr;window.closeCraftingWindow=_r;window.switchCraftingRecipesPage=po;window.switchCraftingRecipesSubpage=pr;window.useRecipe=Pc;window.updateDisplayedComponentChoice=wo;window.updateDisplayedMaterialChoice=yo;window.updateRecipeTooltip=aa;window.remove_from_content_stack=En;window.option_uniform_textsize=rc;window.option_bed_return=cc;window.option_combat_autoswitch=dc;window.option_remember_filters=uc;window.option_log_all_gathering=mc;window.option_log_gathering_result=hc;window.option_use_uncivilised_temperature_scale=pc;window.option_do_background_animations=fc;window.option_skip_play_button=gc;window.option_mofu_mofu_mode=wc;window.option_do_enemy_onhit_animations=yc;window.option_expo_threshold=_c;window.option_hide_max_level_skills=kc;window.option_use_text_outlines_for_tooltips=bc;window.option_use_text_outlines_for_bars=vc;window.change_completed_quest_visibility=Lo;window.getDate=Rc;window.isOnDev=Nt;window.saveProgress=Gc;window.save_to_file=Td;window.load_progress=Md;window.loadBackup=Cd;window.importOtherReleaseSave=Ld;window.hardReset=Bd;window.get_game_version=Yn;window.run=Dc;window.Verify_Game_Objects=Jr;Wt("Waking up from a nyap...");Jo.addEventListener("click",Dc);Jo.addEventListener("click",Rr);!Nt()&&pt in localStorage||Nt()&&(qt in localStorage||!("skip_live_import"in localStorage)&&pt in localStorage)?(Ad(),Re(),rs()):(gs(),et([{item_id:"Cheap iron sword",quality:40},{item_id:"Cheap leather pants",quality:40},{item_id:"Stale bread",count:5}]),As(0),r.money=102,ba(),Re(),ps(de,Fe,ii),Ya({stance_id:"normal"}),fo(),jt({location_id:"Village",skip_travel_time:!0}),ge.startQuest({quest_id:"Lost memory"}),zi=Date.now()-1e3*60*60*16);sc?(Wo(),Hr("Play...?"),Oo()):(Wt("Waiting for you to click 'PLAY'"),Wo(),Oo());Pi();Aa({sort_by:"name",target:"character"});M.skip_play_button&&Jo.click();Nt()?(C("It looks like you are playing on the dev release. It is recommended to keep the developer console open (in Chrome/Firefox/Edge it's at F12 => 'Console' tab) in case of any errors/warnings appearing in there.","notification"),localStorage[Sn]?Wa(JSON.parse(localStorage[Sn]).saved_at):Wa(),localStorage[pt]?hn(JSON.parse(localStorage[pt]).saved_at||"",!0):hn(null,!0)):(localStorage[qn]?Wa(JSON.parse(localStorage[qn]).saved_at):Wa(),localStorage[qt]?hn(JSON.parse(localStorage[qt]).saved_at||""):hn());})();
//# sourceMappingURL=bundle.js.map
